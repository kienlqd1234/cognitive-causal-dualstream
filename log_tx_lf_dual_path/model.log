2025-06-10 14:13:44,779 INFO Starting noise-aware loss test...
2025-06-10 14:13:44,779 INFO Configuration check - use_dual_path_srl: True
2025-06-10 14:13:44,780 INFO Configuration check - variant_type: hedge
2025-06-10 14:13:44,780 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-10 14:13:44,782 INFO Start graph assembling...
2025-06-10 14:13:46,549 INFO Creating Dual-Path SRL module...
2025-06-10 14:13:46,679 INFO Dual-Pathway SRL module created.
2025-06-10 14:13:47,085 INFO Using Temporal Attention (TAP)
2025-06-10 14:13:49,372 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:13:49,374 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:14:07,893 INFO ASSEMBLE: word table #replacement: 19482
2025-06-10 14:14:09,158 INFO Word table init: done!
2025-06-10 14:14:09,159 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-10 14:14:09,159 INFO Starting Epoch 1/10...
2025-06-10 14:14:40,235 INFO --- Epoch 1, Batch 1 (Overall batch 1) ---
2025-06-10 14:14:40,235 INFO Total Loss: 0.6912632584571838
2025-06-10 14:14:40,236 INFO Accuracy: 0.6250
2025-06-10 14:14:40,236 INFO MCC: 0.3759
2025-06-10 14:14:40,236 INFO Ca-TSU - Causal Consistency Loss: 0.04498511180281639
2025-06-10 14:14:40,237 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.6449003  0.35509968 0.         0.         0.        ]
2025-06-10 14:14:40,237 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.55744624 0.4425538  0.         0.         0.        ]
2025-06-10 14:14:40,237 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01169321 0.01534439 0.         0.         0.        ]
2025-06-10 14:15:11,097 INFO --- Epoch 1, Batch 2 (Overall batch 2) ---
2025-06-10 14:15:11,097 INFO Total Loss: 1.0464383363723755
2025-06-10 14:15:11,097 INFO Accuracy: 0.4375
2025-06-10 14:15:11,098 INFO MCC: -0.1395
2025-06-10 14:15:11,098 INFO Ca-TSU - Causal Consistency Loss: 0.028707250952720642
2025-06-10 14:15:11,098 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:15:11,099 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:15:11,099 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00263523 0.         0.         0.         0.        ]
2025-06-10 14:15:39,121 INFO --- Epoch 1, Batch 3 (Overall batch 3) ---
2025-06-10 14:15:39,121 INFO Total Loss: 1.2853204011917114
2025-06-10 14:15:39,121 INFO Accuracy: 0.5000
2025-06-10 14:15:39,122 INFO MCC: -0.0628
2025-06-10 14:15:39,122 INFO Ca-TSU - Causal Consistency Loss: 0.03536881133913994
2025-06-10 14:15:39,123 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15546286 0.19893855 0.4395371  0.2060614  0.        ]
2025-06-10 14:15:39,123 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.31503522 0.18859586 0.2929918  0.20337716 0.        ]
2025-06-10 14:15:39,123 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00748545 0.00658077 0.00891795 0.00788024 0.        ]
2025-06-10 14:16:04,354 INFO --- Epoch 1, Batch 4 (Overall batch 4) ---
2025-06-10 14:16:04,354 INFO Total Loss: 1.5416841506958008
2025-06-10 14:16:04,355 INFO Accuracy: 0.5312
2025-06-10 14:16:04,355 INFO MCC: 0.0422
2025-06-10 14:16:04,355 INFO Ca-TSU - Causal Consistency Loss: 0.028559666126966476
2025-06-10 14:16:04,355 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.37672082 0.2636828  0.17186199 0.18773444 0.        ]
2025-06-10 14:16:04,357 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.3343261  0.16278246 0.33880192 0.16408956 0.        ]
2025-06-10 14:16:04,358 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0097892  0.01023125 0.00934129 0.01030768 0.        ]
2025-06-10 14:16:22,292 INFO --- Epoch 1, Batch 5 (Overall batch 5) ---
2025-06-10 14:16:22,292 INFO Total Loss: 1.6710668802261353
2025-06-10 14:16:22,293 INFO Accuracy: 0.5000
2025-06-10 14:16:22,293 INFO MCC: 0.0510
2025-06-10 14:16:22,293 INFO Ca-TSU - Causal Consistency Loss: 0.025421924889087677
2025-06-10 14:16:22,294 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.27264237 0.14777061 0.3467819  0.23280509 0.        ]
2025-06-10 14:16:22,294 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.23028292 0.30409425 0.21412393 0.25149882 0.        ]
2025-06-10 14:16:22,295 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [5.7057297e-09 5.5026264e-09 5.0915347e-09 5.2632667e-09 0.0000000e+00]
2025-06-10 14:16:38,083 INFO --- Epoch 1, Batch 6 (Overall batch 6) ---
2025-06-10 14:16:38,083 INFO Total Loss: 1.8861353397369385
2025-06-10 14:16:38,084 INFO Accuracy: 0.4375
2025-06-10 14:16:38,084 INFO MCC: -0.0976
2025-06-10 14:16:38,084 INFO Ca-TSU - Causal Consistency Loss: 0.023700367659330368
2025-06-10 14:16:38,085 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:16:38,085 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:16:38,085 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00684654 0.         0.         0.         0.        ]
2025-06-10 14:16:57,476 INFO --- Epoch 1, Batch 7 (Overall batch 7) ---
2025-06-10 14:16:57,476 INFO Total Loss: 1.920729160308838
2025-06-10 14:16:57,476 INFO Accuracy: 0.5000
2025-06-10 14:16:57,476 INFO MCC: -0.0159
2025-06-10 14:16:57,478 INFO Ca-TSU - Causal Consistency Loss: 0.01820702664554119
2025-06-10 14:16:57,478 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04138479 0.09374519 0.07650205 0.04063914 0.02940851]
2025-06-10 14:16:57,479 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.05865964 0.06658319 0.07233801 0.05367438 0.06087347]
2025-06-10 14:16:57,479 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01141262 0.02014875 0.01388341 0.00726372 0.00546423]
2025-06-10 14:17:14,790 INFO --- Epoch 1, Batch 8 (Overall batch 8) ---
2025-06-10 14:17:14,791 INFO Total Loss: 1.9291067123413086
2025-06-10 14:17:14,791 INFO Accuracy: 0.5312
2025-06-10 14:17:14,792 INFO MCC: 0.1619
2025-06-10 14:17:14,792 INFO Ca-TSU - Causal Consistency Loss: 0.016138244420289993
2025-06-10 14:17:14,792 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5448925  0.45510754 0.         0.         0.        ]
2025-06-10 14:17:14,793 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.49508578 0.5049142  0.         0.         0.        ]
2025-06-10 14:17:14,793 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00993281 0.0111551  0.         0.         0.        ]
2025-06-10 14:17:32,795 INFO --- Epoch 1, Batch 9 (Overall batch 9) ---
2025-06-10 14:17:32,796 INFO Total Loss: 1.904154896736145
2025-06-10 14:17:32,796 INFO Accuracy: 0.4688
2025-06-10 14:17:32,796 INFO MCC: 0.0086
2025-06-10 14:17:32,796 INFO Ca-TSU - Causal Consistency Loss: 0.016583256423473358
2025-06-10 14:17:32,797 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04128702 0.04088296 0.05719009 0.04497521 0.05436123]
2025-06-10 14:17:32,797 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.04604235 0.05286306 0.04585924 0.04265636 0.05874721]
2025-06-10 14:17:32,797 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0125032  0.01126993 0.01173906 0.01169738 0.01207342]
2025-06-10 14:17:50,796 INFO --- Epoch 1, Batch 10 (Overall batch 10) ---
2025-06-10 14:17:50,797 INFO Total Loss: 1.9829416275024414
2025-06-10 14:17:50,797 INFO Accuracy: 0.5312
2025-06-10 14:17:50,797 INFO MCC: 0.1459
2025-06-10 14:17:50,798 INFO Ca-TSU - Causal Consistency Loss: 0.014230865053832531
2025-06-10 14:17:50,798 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:17:50,798 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:17:50,799 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01344965 0.         0.         0.         0.        ]
2025-06-10 14:18:07,502 INFO --- Epoch 1, Batch 11 (Overall batch 11) ---
2025-06-10 14:18:07,503 INFO Total Loss: 1.9538975954055786
2025-06-10 14:18:07,503 INFO Accuracy: 0.5000
2025-06-10 14:18:07,503 INFO MCC: 0.1491
2025-06-10 14:18:07,503 INFO Ca-TSU - Causal Consistency Loss: 0.01201130636036396
2025-06-10 14:18:07,504 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.2410987  0.23201895 0.16425963 0.15646915 0.12775062]
2025-06-10 14:18:07,504 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.20900942 0.17469798 0.16278839 0.14806424 0.17862998]
2025-06-10 14:18:07,504 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00735499 0.00614406 0.00695054 0.00913037 0.00823336]
2025-06-10 14:18:23,980 INFO --- Epoch 1, Batch 12 (Overall batch 12) ---
2025-06-10 14:18:23,981 INFO Total Loss: 1.940817952156067
2025-06-10 14:18:23,981 INFO Accuracy: 0.4688
2025-06-10 14:18:23,981 INFO MCC: -0.0882
2025-06-10 14:18:23,982 INFO Ca-TSU - Causal Consistency Loss: 0.014133270829916
2025-06-10 14:18:23,982 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04416995 0.05392295 0.05199429 0.04824588 0.04147683]
2025-06-10 14:18:23,983 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.0446592  0.06314727 0.06222966 0.05061837 0.06206336]
2025-06-10 14:18:23,983 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00623262 0.01004959 0.00538365 0.00668617 0.00929299]
2025-06-10 14:18:40,252 INFO --- Epoch 1, Batch 13 (Overall batch 13) ---
2025-06-10 14:18:40,253 INFO Total Loss: 1.7363024950027466
2025-06-10 14:18:40,253 INFO Accuracy: 0.5938
2025-06-10 14:18:40,253 INFO MCC: 0.1779
2025-06-10 14:18:40,254 INFO Ca-TSU - Causal Consistency Loss: 0.016451749950647354
2025-06-10 14:18:40,254 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.64527315 0.35472688 0.         0.         0.        ]
2025-06-10 14:18:40,254 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.48835686 0.5116431  0.         0.         0.        ]
2025-06-10 14:18:40,255 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00693596 0.00725002 0.         0.         0.        ]
2025-06-10 14:18:57,909 INFO --- Epoch 1, Batch 14 (Overall batch 14) ---
2025-06-10 14:18:57,909 INFO Total Loss: 1.8305370807647705
2025-06-10 14:18:57,909 INFO Accuracy: 0.4375
2025-06-10 14:18:57,911 INFO MCC: -0.1260
2025-06-10 14:18:57,911 INFO Ca-TSU - Causal Consistency Loss: 0.016603318974375725
2025-06-10 14:18:57,911 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:18:57,912 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:18:57,912 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00613976 0.         0.         0.         0.        ]
2025-06-10 14:19:13,141 INFO --- Epoch 1, Batch 15 (Overall batch 15) ---
2025-06-10 14:19:13,141 INFO Total Loss: 1.7783586978912354
2025-06-10 14:19:13,142 INFO Accuracy: 0.5000
2025-06-10 14:19:13,142 INFO MCC: 0.0000
2025-06-10 14:19:13,142 INFO Ca-TSU - Causal Consistency Loss: 0.009403243660926819
2025-06-10 14:19:13,143 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:13,143 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:13,143 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01412474 0.         0.         0.         0.        ]
2025-06-10 14:19:28,480 INFO --- Epoch 1, Batch 16 (Overall batch 16) ---
2025-06-10 14:19:28,480 INFO Total Loss: 1.6955759525299072
2025-06-10 14:19:28,482 INFO Accuracy: 0.4375
2025-06-10 14:19:28,482 INFO MCC: -0.1395
2025-06-10 14:19:28,482 INFO Ca-TSU - Causal Consistency Loss: 0.01037558913230896
2025-06-10 14:19:28,482 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:28,483 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:28,483 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [4.782615e-05 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
2025-06-10 14:19:46,203 INFO --- Epoch 1, Batch 17 (Overall batch 17) ---
2025-06-10 14:19:46,204 INFO Total Loss: 1.6293549537658691
2025-06-10 14:19:46,204 INFO Accuracy: 0.5000
2025-06-10 14:19:46,204 INFO MCC: -0.0039
2025-06-10 14:19:46,204 INFO Ca-TSU - Causal Consistency Loss: 0.010351749137043953
2025-06-10 14:19:46,205 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.24851768 0.35949397 0.39198837 0.         0.        ]
2025-06-10 14:19:46,205 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.36277807 0.27283084 0.3643911  0.         0.        ]
2025-06-10 14:19:46,205 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00054518 0.00053618 0.00057082 0.         0.        ]
2025-06-10 14:20:01,870 INFO --- Epoch 1, Batch 18 (Overall batch 18) ---
2025-06-10 14:20:01,871 INFO Total Loss: 1.4807223081588745
2025-06-10 14:20:01,872 INFO Accuracy: 0.5625
2025-06-10 14:20:01,872 INFO MCC: 0.1348
2025-06-10 14:20:01,872 INFO Ca-TSU - Causal Consistency Loss: 0.0102686807513237
2025-06-10 14:20:01,873 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:01,873 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:01,873 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01178216 0.         0.         0.         0.        ]
2025-06-10 14:20:15,955 INFO --- Epoch 1, Batch 19 (Overall batch 19) ---
2025-06-10 14:20:15,955 INFO Total Loss: 1.3848131895065308
2025-06-10 14:20:15,956 INFO Accuracy: 0.5312
2025-06-10 14:20:15,956 INFO MCC: 0.0636
2025-06-10 14:20:15,956 INFO Ca-TSU - Causal Consistency Loss: 0.015332534909248352
2025-06-10 14:20:15,956 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:15,957 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:15,957 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00340907 0.         0.         0.         0.        ]
2025-06-10 14:20:33,401 INFO --- Epoch 1, Batch 20 (Overall batch 20) ---
2025-06-10 14:20:33,401 INFO Total Loss: 1.3456878662109375
2025-06-10 14:20:33,401 INFO Accuracy: 0.5000
2025-06-10 14:20:33,401 INFO MCC: 0.0000
2025-06-10 14:20:33,402 INFO Ca-TSU - Causal Consistency Loss: 0.012012497521936893
2025-06-10 14:20:33,402 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:33,402 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:33,403 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0082539 0.        0.        0.        0.       ]
2025-06-10 14:20:36,092 INFO Reached max_batches_to_test (20). Stopping training for test.
2025-06-10 14:20:36,573 INFO Saved training metrics plot to results\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp_training_metrics.png
2025-06-10 14:28:31,730 INFO Starting noise-aware loss test...
2025-06-10 14:28:31,730 INFO Configuration check - use_dual_path_srl: True
2025-06-10 14:28:31,731 INFO Configuration check - variant_type: hedge
2025-06-10 14:28:31,731 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-10 14:28:31,733 INFO Start graph assembling...
2025-06-10 14:28:33,558 INFO Creating Dual-Path SRL module...
2025-06-10 14:28:33,684 INFO Dual-Pathway SRL module created.
2025-06-10 14:28:34,111 INFO Using Temporal Attention (TAP)
2025-06-10 14:28:36,547 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:28:36,548 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:28:55,322 INFO ASSEMBLE: word table #replacement: 19482
2025-06-10 14:28:56,599 INFO Word table init: done!
2025-06-10 14:28:56,600 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-10 14:28:56,600 INFO Starting Epoch 1/10...
2025-06-10 14:29:33,083 INFO --- Epoch 1, Batch 1 (Overall batch 1) ---
2025-06-10 14:29:33,084 INFO Total Loss: 0.8427320718765259
2025-06-10 14:29:33,084 INFO Accuracy: 0.4688
2025-06-10 14:29:33,085 INFO MCC: -0.0401
2025-06-10 14:29:33,085 INFO Ca-TSU - Causal Consistency Loss: 0.036219898611307144
2025-06-10 14:29:33,086 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.3537426 0.6462574 0.        0.        0.       ]
2025-06-10 14:29:33,086 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.5357624  0.46423754 0.         0.         0.        ]
2025-06-10 14:29:33,086 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00690266 0.00597948 0.         0.         0.        ]
2025-06-10 14:29:33,247 ERROR Failed to save checkpoint at step 1: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-1.data-00000-of-00001.tempstate11299603582367476804 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-1.data-00000-of-00001.tempstate11299603582367476804 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:30:01,651 INFO --- Epoch 1, Batch 2 (Overall batch 2) ---
2025-06-10 14:30:01,652 INFO Total Loss: 1.1517069339752197
2025-06-10 14:30:01,652 INFO Accuracy: 0.3125
2025-06-10 14:30:01,652 INFO MCC: -0.3637
2025-06-10 14:30:01,652 INFO Ca-TSU - Causal Consistency Loss: 0.033610567450523376
2025-06-10 14:30:01,653 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:01,653 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:01,654 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0071842 0.        0.        0.        0.       ]
2025-06-10 14:30:33,692 INFO --- Epoch 1, Batch 3 (Overall batch 3) ---
2025-06-10 14:30:33,693 INFO Total Loss: 1.3257668018341064
2025-06-10 14:30:33,693 INFO Accuracy: 0.4375
2025-06-10 14:30:33,693 INFO MCC: -0.1260
2025-06-10 14:30:33,693 INFO Ca-TSU - Causal Consistency Loss: 0.02857900969684124
2025-06-10 14:30:33,694 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:33,694 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:33,695 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0108463 0.        0.        0.        0.       ]
2025-06-10 14:30:51,998 INFO --- Epoch 1, Batch 4 (Overall batch 4) ---
2025-06-10 14:30:51,999 INFO Total Loss: 1.4439176321029663
2025-06-10 14:30:51,999 INFO Accuracy: 0.5625
2025-06-10 14:30:52,000 INFO MCC: 0.1869
2025-06-10 14:30:52,000 INFO Ca-TSU - Causal Consistency Loss: 0.01361310575157404
2025-06-10 14:30:52,000 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:52,001 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:52,001 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01437455 0.         0.         0.         0.        ]
2025-06-10 14:31:08,251 INFO --- Epoch 1, Batch 5 (Overall batch 5) ---
2025-06-10 14:31:08,252 INFO Total Loss: 1.590864658355713
2025-06-10 14:31:08,252 INFO Accuracy: 0.5938
2025-06-10 14:31:08,252 INFO MCC: 0.1879
2025-06-10 14:31:08,253 INFO Ca-TSU - Causal Consistency Loss: 0.021592147648334503
2025-06-10 14:31:08,253 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:08,253 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:08,254 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0124786 0.        0.        0.        0.       ]
2025-06-10 14:31:27,017 INFO --- Epoch 1, Batch 6 (Overall batch 6) ---
2025-06-10 14:31:27,018 INFO Total Loss: 1.8875336647033691
2025-06-10 14:31:27,018 INFO Accuracy: 0.4375
2025-06-10 14:31:27,019 INFO MCC: -0.0931
2025-06-10 14:31:27,019 INFO Ca-TSU - Causal Consistency Loss: 0.02220180071890354
2025-06-10 14:31:27,021 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.10557188 0.14514366 0.15680319 0.17895603 0.19979197]
2025-06-10 14:31:27,022 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.1831847  0.15235725 0.15619075 0.18146072 0.15409678]
2025-06-10 14:31:27,022 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00194862 0.00137531 0.0018897  0.00419468 0.00297176]
2025-06-10 14:31:27,058 ERROR Failed to save checkpoint at step 6: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-6.data-00000-of-00001.tempstate2327753616084797176 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-6.data-00000-of-00001.tempstate2327753616084797176 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:31:42,877 INFO --- Epoch 1, Batch 7 (Overall batch 7) ---
2025-06-10 14:31:42,878 INFO Total Loss: 1.9436997175216675
2025-06-10 14:31:42,878 INFO Accuracy: 0.3125
2025-06-10 14:31:42,878 INFO MCC: -0.3945
2025-06-10 14:31:42,878 INFO Ca-TSU - Causal Consistency Loss: 0.01890394277870655
2025-06-10 14:31:42,878 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.09475238 0.09518866 0.17558682 0.11018278 0.13540033]
2025-06-10 14:31:42,880 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.14125422 0.10523706 0.13944611 0.13651392 0.10535693]
2025-06-10 14:31:42,880 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00758685 0.00936174 0.00868807 0.0097725  0.00851275]
2025-06-10 14:31:57,859 INFO --- Epoch 1, Batch 8 (Overall batch 8) ---
2025-06-10 14:31:57,860 INFO Total Loss: 1.932431697845459
2025-06-10 14:31:57,860 INFO Accuracy: 0.5625
2025-06-10 14:31:57,861 INFO MCC: 0.1112
2025-06-10 14:31:57,861 INFO Ca-TSU - Causal Consistency Loss: 0.020756317302584648
2025-06-10 14:31:57,861 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:57,862 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:57,862 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [9.993352e-07 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
2025-06-10 14:32:13,427 INFO --- Epoch 1, Batch 9 (Overall batch 9) ---
2025-06-10 14:32:13,427 INFO Total Loss: 1.8604029417037964
2025-06-10 14:32:13,428 INFO Accuracy: 0.6875
2025-06-10 14:32:13,428 INFO MCC: 0.3780
2025-06-10 14:32:13,428 INFO Ca-TSU - Causal Consistency Loss: 0.016269303858280182
2025-06-10 14:32:13,429 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.4902626  0.50973743 0.         0.         0.        ]
2025-06-10 14:32:13,429 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.52795994 0.47204006 0.         0.         0.        ]
2025-06-10 14:32:13,429 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [8.7390088e-11 1.5307074e-10 0.0000000e+00 0.0000000e+00 0.0000000e+00]
2025-06-10 14:32:31,688 INFO --- Epoch 1, Batch 10 (Overall batch 10) ---
2025-06-10 14:32:31,689 INFO Total Loss: 1.8636600971221924
2025-06-10 14:32:31,689 INFO Accuracy: 0.6250
2025-06-10 14:32:31,689 INFO MCC: 0.2582
2025-06-10 14:32:31,690 INFO Ca-TSU - Causal Consistency Loss: 0.01746019907295704
2025-06-10 14:32:31,690 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:32:31,690 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:32:31,691 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00344196 0.         0.         0.         0.        ]
2025-06-10 14:32:45,555 INFO --- Epoch 1, Batch 11 (Overall batch 11) ---
2025-06-10 14:32:45,556 INFO Total Loss: 1.880403757095337
2025-06-10 14:32:45,556 INFO Accuracy: 0.5938
2025-06-10 14:32:45,556 INFO MCC: 0.1479
2025-06-10 14:32:45,557 INFO Ca-TSU - Causal Consistency Loss: 0.01897585019469261
2025-06-10 14:32:45,557 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15054497 0.17803632 0.3400595  0.1903544  0.14100482]
2025-06-10 14:32:45,558 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.18822972 0.17102672 0.24173748 0.20728675 0.19171937]
2025-06-10 14:32:45,558 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00126056 0.00195729 0.01647661 0.00132098 0.00079475]
2025-06-10 14:32:45,581 ERROR Failed to save checkpoint at step 11: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-11.data-00000-of-00001.tempstate16834503337397851289 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-11.data-00000-of-00001.tempstate16834503337397851289 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:33:00,191 INFO --- Epoch 1, Batch 12 (Overall batch 12) ---
2025-06-10 14:33:00,192 INFO Total Loss: 1.832196831703186
2025-06-10 14:33:00,192 INFO Accuracy: 0.6250
2025-06-10 14:33:00,192 INFO MCC: 0.2582
2025-06-10 14:33:00,192 INFO Ca-TSU - Causal Consistency Loss: 0.013793786987662315
2025-06-10 14:33:00,193 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.38965675 0.6103433  0.         0.         0.        ]
2025-06-10 14:33:00,193 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.4101287 0.5898713 0.        0.        0.       ]
2025-06-10 14:33:00,194 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00751075 0.00572139 0.         0.         0.        ]
2025-06-10 14:33:15,834 INFO --- Epoch 1, Batch 13 (Overall batch 13) ---
2025-06-10 14:33:15,835 INFO Total Loss: 1.8053133487701416
2025-06-10 14:33:15,835 INFO Accuracy: 0.5312
2025-06-10 14:33:15,835 INFO MCC: 0.0710
2025-06-10 14:33:15,836 INFO Ca-TSU - Causal Consistency Loss: 0.011693351902067661
2025-06-10 14:33:15,836 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15058275 0.1532625  0.14927688 0.37802517 0.1688527 ]
2025-06-10 14:33:15,836 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.20051017 0.18505283 0.16825156 0.2969915  0.14919388]
2025-06-10 14:33:15,837 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.05884494 0.03266201 0.00388337 0.36279082 0.00289302]
2025-06-10 14:33:32,379 INFO --- Epoch 1, Batch 14 (Overall batch 14) ---
2025-06-10 14:33:32,380 INFO Total Loss: 1.7795695066452026
2025-06-10 14:33:32,380 INFO Accuracy: 0.4375
2025-06-10 14:33:32,381 INFO MCC: -0.0712
2025-06-10 14:33:32,381 INFO Ca-TSU - Causal Consistency Loss: 0.009554932825267315
2025-06-10 14:33:32,381 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.32679352 0.3467344  0.32647204 0.         0.        ]
2025-06-10 14:33:32,382 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.3615828  0.31316608 0.32525113 0.         0.        ]
2025-06-10 14:33:32,382 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [3.9781452e-07 3.7304127e-07 3.6401735e-07 0.0000000e+00 0.0000000e+00]
2025-06-10 14:33:46,585 INFO --- Epoch 1, Batch 15 (Overall batch 15) ---
2025-06-10 14:33:46,585 INFO Total Loss: 1.7312123775482178
2025-06-10 14:33:46,585 INFO Accuracy: 0.5000
2025-06-10 14:33:46,586 INFO MCC: 0.0039
2025-06-10 14:33:46,586 INFO Ca-TSU - Causal Consistency Loss: 0.012392021715641022
2025-06-10 14:33:46,586 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5877599 0.4122401 0.        0.        0.       ]
2025-06-10 14:33:46,586 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.57553285 0.4244671  0.         0.         0.        ]
2025-06-10 14:33:46,587 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00699067 0.00821034 0.         0.         0.        ]
2025-06-10 14:34:00,483 INFO --- Epoch 1, Batch 16 (Overall batch 16) ---
2025-06-10 14:34:00,484 INFO Total Loss: 1.5935499668121338
2025-06-10 14:34:00,484 INFO Accuracy: 0.5938
2025-06-10 14:34:00,484 INFO MCC: 0.1683
2025-06-10 14:34:00,485 INFO Ca-TSU - Causal Consistency Loss: 0.012732548639178276
2025-06-10 14:34:00,485 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:00,486 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:00,486 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00371759 0.         0.         0.         0.        ]
2025-06-10 14:34:00,520 ERROR Failed to save checkpoint at step 16: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-16.data-00000-of-00001.tempstate12571900181829409298 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-16.data-00000-of-00001.tempstate12571900181829409298 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:34:16,123 INFO --- Epoch 1, Batch 17 (Overall batch 17) ---
2025-06-10 14:34:16,125 INFO Total Loss: 1.5651130676269531
2025-06-10 14:34:16,126 INFO Accuracy: 0.5000
2025-06-10 14:34:16,126 INFO MCC: -0.0120
2025-06-10 14:34:16,126 INFO Ca-TSU - Causal Consistency Loss: 0.012104494497179985
2025-06-10 14:34:16,127 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:16,127 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:16,128 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00787563 0.         0.         0.         0.        ]
2025-06-10 14:34:32,726 INFO --- Epoch 1, Batch 18 (Overall batch 18) ---
2025-06-10 14:34:32,727 INFO Total Loss: 1.4784307479858398
2025-06-10 14:34:32,727 INFO Accuracy: 0.5312
2025-06-10 14:34:32,727 INFO MCC: 0.1078
2025-06-10 14:34:32,727 INFO Ca-TSU - Causal Consistency Loss: 0.012060520239174366
2025-06-10 14:34:32,728 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.20480542 0.29533973 0.19460708 0.3052478  0.        ]
2025-06-10 14:34:32,728 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.21395637 0.25814566 0.24928778 0.2786102  0.        ]
2025-06-10 14:34:32,728 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [1.3279214e-09 1.2969722e-09 1.2777368e-09 1.3407484e-09 0.0000000e+00]
2025-06-10 14:34:47,840 INFO --- Epoch 1, Batch 19 (Overall batch 19) ---
2025-06-10 14:34:47,841 INFO Total Loss: 1.4162315130233765
2025-06-10 14:34:47,841 INFO Accuracy: 0.5000
2025-06-10 14:34:47,841 INFO MCC: 0.0000
2025-06-10 14:34:47,842 INFO Ca-TSU - Causal Consistency Loss: 0.00846626702696085
2025-06-10 14:34:47,842 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5775047  0.42249534 0.         0.         0.        ]
2025-06-10 14:34:47,843 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.49347252 0.5065275  0.         0.         0.        ]
2025-06-10 14:34:47,843 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00539553 0.00667245 0.         0.         0.        ]
2025-06-11 16:41:54,251 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 16:41:54,251 INFO Configuration - use_dual_path_srl: True
2025-06-11 16:41:54,252 INFO Configuration - use_enhanced_srl: True
2025-06-11 16:41:54,252 INFO Configuration - use_noise_aware_loss: True
2025-06-11 16:41:54,252 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 16:41:54,253 INFO Configuration - variant_type: hedge
2025-06-11 16:41:54,253 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 16:41:54,259 INFO Start graph assembling...
2025-06-11 16:41:55,981 INFO Using enhanced dual-path SRL architecture
2025-06-11 16:41:55,981 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 16:41:56,382 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 16:41:56,726 INFO Using Temporal Attention (TAP)
2025-06-11 16:52:43,423 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 16:52:43,423 INFO Configuration - use_dual_path_srl: True
2025-06-11 16:52:43,423 INFO Configuration - use_enhanced_srl: True
2025-06-11 16:52:43,424 INFO Configuration - use_ca_tsu: True
2025-06-11 16:52:43,424 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 16:52:43,424 INFO Configuration - use_noise_aware_loss: True
2025-06-11 16:52:43,424 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 16:52:43,425 INFO Configuration - variant_type: hedge
2025-06-11 16:52:43,425 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 16:52:43,427 INFO Start graph assembling...
2025-06-11 16:52:45,226 INFO Using enhanced dual-path SRL architecture
2025-06-11 16:52:45,226 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 16:52:45,635 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 16:52:45,972 INFO Using Temporal Attention (TAP)
2025-06-11 16:52:46,024 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 16:52:46,057 INFO Creating enhanced SRL loss...
2025-06-11 16:52:46,057 WARNING h_t_dual_path not found, using x as text representation
2025-06-11 16:52:46,116 INFO Added enhanced SRL loss
2025-06-11 16:52:48,737 INFO Graph assembled successfully.
2025-06-11 16:52:48,738 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 16:52:48,738 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 16:53:07,073 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 16:53:08,964 INFO Word table initialized
2025-06-11 16:53:08,965 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 16:53:08,965 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 16:53:08,965 INFO Setting default noise_aware_weight to 0.5
2025-06-11 16:53:08,965 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 16:53:08,965 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 16:53:08,966 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 16:53:08,966 INFO Evaluation will be performed every 10 steps
2025-06-11 16:53:09,064 INFO Starting training test for 50 batches
2025-06-11 16:53:27,141 ERROR Error during testing: Fetch argument None has invalid type <class 'NoneType'>
2025-06-11 16:53:27,144 ERROR Traceback (most recent call last):
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 655, in test_noise_aware_loss
    results = sess.run(ops_to_run, feed_dict=feed_dict)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 889, in run
    run_metadata_ptr)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1105, in _run
    self._graph, fetches, feed_dict_tensor, feed_handles=feed_handles)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 414, in __init__
    self._fetch_mapper = _FetchMapper.for_fetch(fetches)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 234, in for_fetch
    return _ListFetchMapper(fetch)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 341, in __init__
    self._mappers = [_FetchMapper.for_fetch(fetch) for fetch in fetches]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 341, in <listcomp>
    self._mappers = [_FetchMapper.for_fetch(fetch) for fetch in fetches]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 231, in for_fetch
    (fetch, type(fetch)))
TypeError: Fetch argument None has invalid type <class 'NoneType'>

2025-06-11 16:53:27,144 INFO Completed test on 1 batches
2025-06-11 16:53:27,214 INFO Test completed successfully!
2025-06-11 17:00:11,305 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 17:00:11,305 INFO Configuration - use_dual_path_srl: True
2025-06-11 17:00:11,306 INFO Configuration - use_enhanced_srl: True
2025-06-11 17:00:11,306 INFO Configuration - use_ca_tsu: True
2025-06-11 17:00:11,306 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 17:00:11,306 INFO Configuration - use_noise_aware_loss: True
2025-06-11 17:00:11,306 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 17:00:11,306 INFO Configuration - variant_type: hedge
2025-06-11 17:00:11,307 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 17:00:11,309 INFO Start graph assembling...
2025-06-11 17:00:13,053 INFO Using enhanced dual-path SRL architecture
2025-06-11 17:00:13,053 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 17:00:13,465 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 17:00:13,801 INFO Using Temporal Attention (TAP)
2025-06-11 17:00:13,845 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 17:00:13,878 INFO Creating enhanced SRL loss...
2025-06-11 17:00:13,878 WARNING h_t_dual_path not found, using x as text representation
2025-06-11 17:00:13,937 INFO Added enhanced SRL loss
2025-06-11 17:00:16,557 INFO Graph assembled successfully.
2025-06-11 17:00:16,558 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 17:00:16,559 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 17:00:34,805 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 17:00:36,188 INFO Word table initialized
2025-06-11 17:00:36,188 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 17:00:36,189 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 17:00:36,189 INFO Setting default noise_aware_weight to 0.5
2025-06-11 17:00:36,189 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 17:00:36,189 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 17:00:36,189 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 17:00:36,189 INFO Evaluation will be performed every 10 steps
2025-06-11 17:00:36,304 INFO Starting training test for 50 batches
2025-06-11 17:01:11,537 INFO Batch 1/50 (Step 1):
2025-06-11 17:01:11,538 INFO   Total Loss: 0.7275
2025-06-11 17:01:11,538 INFO   Accuracy: 0.4688
2025-06-11 17:01:11,538 INFO   MCC: -0.0626
2025-06-11 17:01:11,538 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:01:11,540 INFO   MSIN Cross-Attention sample: [0.05629849 0.05552643 0.04454555 0.04444347 0.04463113]
2025-06-11 17:02:59,215 INFO Batch 5/50 (Step 5):
2025-06-11 17:02:59,215 INFO   Total Loss: 1.7372
2025-06-11 17:02:59,216 INFO   Accuracy: 0.5312
2025-06-11 17:02:59,216 INFO   MCC: 0.0401
2025-06-11 17:02:59,216 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:02:59,217 INFO   MSIN Cross-Attention sample: [0.03328626 0.04436834 0.05564114 0.05531683 0.04462983]
2025-06-11 17:04:26,926 INFO Batch 10/50 (Step 10):
2025-06-11 17:04:26,927 INFO   Total Loss: 1.9956
2025-06-11 17:04:26,927 INFO   Accuracy: 0.5625
2025-06-11 17:04:26,927 INFO   MCC: 0.0976
2025-06-11 17:04:26,927 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:04:26,928 INFO   MSIN Cross-Attention sample: [0.05532703 0.04454517 0.05571126 0.05555197 0.04439992]
2025-06-11 17:04:26,928 INFO Evaluating on dev set at batch 10/50...
2025-06-11 17:06:17,587 INFO Dev evaluation results:
2025-06-11 17:06:17,587 INFO 	Eval, eval loss: 2.232137441635132, acc: 0.469512
2025-06-11 17:07:38,756 INFO Batch 15/50 (Step 15):
2025-06-11 17:07:38,757 INFO   Total Loss: 1.7618
2025-06-11 17:07:38,757 INFO   Accuracy: 0.3750
2025-06-11 17:07:38,758 INFO   MCC: -0.2381
2025-06-11 17:07:38,758 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:07:38,758 INFO   MSIN Cross-Attention sample: [0.05587037 0.05587744 0.04440376 0.05539591 0.05571232]
2025-06-11 17:09:00,089 INFO Batch 20/50 (Step 20):
2025-06-11 17:09:00,090 INFO   Total Loss: 1.4490
2025-06-11 17:09:00,090 INFO   Accuracy: 0.5625
2025-06-11 17:09:00,091 INFO   MCC: 0.1260
2025-06-11 17:09:00,091 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:09:00,092 INFO   MSIN Cross-Attention sample: [0.04274248 0.05436801 0.05544857 0.05658913 0.05558465]
2025-06-11 17:09:00,092 INFO Evaluating on dev set at batch 20/50...
2025-06-11 17:10:44,176 INFO Dev evaluation results:
2025-06-11 17:10:44,177 INFO 	Eval, eval loss: 1.5737576484680176, acc: 0.513720
2025-06-11 17:12:04,477 INFO Batch 25/50 (Step 25):
2025-06-11 17:12:04,477 INFO   Total Loss: 1.1947
2025-06-11 17:12:04,478 INFO   Accuracy: 0.5625
2025-06-11 17:12:04,478 INFO   MCC: 0.1291
2025-06-11 17:12:04,478 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:12:04,478 INFO   MSIN Cross-Attention sample: [0.04452675 0.04428817 0.04446664 0.05561009 0.05553747]
2025-06-11 17:13:22,094 INFO Batch 30/50 (Step 30):
2025-06-11 17:13:22,094 INFO   Total Loss: 0.9324
2025-06-11 17:13:22,094 INFO   Accuracy: 0.5625
2025-06-11 17:13:22,095 INFO   MCC: 0.3021
2025-06-11 17:13:22,095 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:13:22,095 INFO   MSIN Cross-Attention sample: [0.04366367 0.04424892 0.04386728 0.0476025  0.05713603]
2025-06-11 17:13:22,096 INFO Evaluating on dev set at batch 30/50...
2025-06-11 17:15:13,876 INFO Dev evaluation results:
2025-06-11 17:15:13,876 INFO 	Eval, eval loss: 1.2468117475509644, acc: 0.483232
2025-06-11 17:16:27,219 INFO Batch 35/50 (Step 35):
2025-06-11 17:16:27,220 INFO   Total Loss: 2.7134
2025-06-11 17:16:27,220 INFO   Accuracy: 0.4375
2025-06-11 17:16:27,220 INFO   MCC: 0.0413
2025-06-11 17:16:27,220 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:16:27,221 INFO   MSIN Cross-Attention sample: [0.05532048 0.05547402 0.05547402 0.05547402 0.05547402]
2025-06-11 17:17:44,016 INFO Batch 40/50 (Step 40):
2025-06-11 17:17:44,017 INFO   Total Loss: 0.8641
2025-06-11 17:17:44,017 INFO   Accuracy: 0.3750
2025-06-11 17:17:44,017 INFO   MCC: -0.2431
2025-06-11 17:17:44,018 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:17:44,018 INFO   MSIN Cross-Attention sample: [0.05601314 0.03333925 0.04479375 0.03383328 0.04452918]
2025-06-11 17:17:44,018 INFO Evaluating on dev set at batch 40/50...
2025-06-11 17:19:33,713 INFO Dev evaluation results:
2025-06-11 17:19:33,714 INFO 	Eval, eval loss: 1.0767498016357422, acc: 0.541159
2025-06-11 17:20:47,460 INFO Batch 45/50 (Step 45):
2025-06-11 17:20:47,460 INFO   Total Loss: 1.2128
2025-06-11 17:20:47,461 INFO   Accuracy: 0.5625
2025-06-11 17:20:47,461 INFO   MCC: 0.0976
2025-06-11 17:20:47,461 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:20:47,462 INFO   MSIN Cross-Attention sample: [0.05177472 0.01906194 0.0914574  0.103177   0.05437533]
2025-06-11 17:22:03,089 INFO Batch 50/50 (Step 50):
2025-06-11 17:22:03,090 INFO   Total Loss: 0.8023
2025-06-11 17:22:03,090 INFO   Accuracy: 0.4375
2025-06-11 17:22:03,090 INFO   MCC: -0.1348
2025-06-11 17:22:03,090 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:22:03,091 INFO   MSIN Cross-Attention sample: [0.03354196 0.04419372 0.05555586 0.04450319 0.05525457]
2025-06-11 17:22:03,091 INFO Evaluating on dev set at batch 50/50...
2025-06-11 17:23:53,197 INFO Dev evaluation results:
2025-06-11 17:23:53,197 INFO 	Eval, eval loss: 1.0000360012054443, acc: 0.524390
2025-06-11 17:23:53,197 INFO Final evaluation on dev set:
2025-06-11 17:25:43,750 INFO 	Eval, eval loss: 0.9873076677322388, acc: 0.548780
2025-06-11 17:25:43,750 ERROR Failed to save checkpoint: 'latest_filename' collides with 'save_path': 'checkpoint' and './checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\checkpoint'
2025-06-11 17:25:44,616 INFO Training metrics plots saved to results/model_test
2025-06-11 17:25:44,617 INFO Evaluating on test set:
2025-06-11 17:28:21,714 INFO 	Eval, eval loss: 1.0687851905822754, acc: 0.504960
2025-06-11 17:28:21,726 INFO Test summary saved to results/model_test\test_summary_20250611_172821.json
2025-06-11 17:28:21,726 INFO Completed test on 50 batches
2025-06-11 17:28:27,514 INFO Test completed successfully!
2025-06-11 18:09:45,200 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:09:45,200 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:09:45,200 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:09:45,201 INFO Configuration - use_ca_tsu: True
2025-06-11 18:09:45,201 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:09:45,201 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:09:45,202 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:09:45,202 INFO Configuration - variant_type: hedge
2025-06-11 18:09:45,203 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:09:45,205 INFO Start graph assembling...
2025-06-11 18:09:45,520 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:09:46,901 INFO use_dual_path_srl: True
2025-06-11 18:09:46,901 INFO variant_type: hedge
2025-06-11 18:09:46,901 INFO use_enhanced_srl: True
2025-06-11 18:09:46,902 INFO Enhanced SRL enabled from config
2025-06-11 18:09:46,902 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:09:46,902 INFO SRL condition: True = True and True
2025-06-11 18:09:46,902 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:09:46,902 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:09:47,294 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:09:47,294 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:09:47,295 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:09:47,622 INFO Using Temporal Attention (TAP)
2025-06-11 18:09:47,666 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:09:47,699 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:09:47,700 INFO Creating enhanced SRL loss...
2025-06-11 18:09:47,700 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:09:47,755 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:09:47,757 INFO Base prediction loss created: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:09:47,758 INFO Final enhanced SRL loss created with weight 0.1: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:09:47,759 INFO Added enhanced SRL loss to generative ATA
2025-06-11 18:09:50,231 INFO Graph assembled successfully.
2025-06-11 18:09:50,232 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:09:50,233 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:10:08,589 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:10:10,177 INFO Word table initialized
2025-06-11 18:10:10,178 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:10:10,178 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:10:10,178 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:10:10,179 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:10:10,179 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:10:10,179 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:10:10,179 INFO Evaluation will be performed every 10 steps
2025-06-11 18:10:10,270 INFO Starting training test for 50 batches
2025-06-11 18:13:28,283 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:13:28,284 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:13:28,284 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:13:28,284 INFO Configuration - use_ca_tsu: True
2025-06-11 18:13:28,284 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:13:28,284 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:13:28,285 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:13:28,285 INFO Configuration - variant_type: hedge
2025-06-11 18:13:28,286 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:13:28,288 INFO Start graph assembling...
2025-06-11 18:13:28,603 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:13:30,117 INFO use_dual_path_srl: True
2025-06-11 18:13:30,117 INFO variant_type: hedge
2025-06-11 18:13:30,117 INFO use_enhanced_srl: True
2025-06-11 18:13:30,118 INFO Enhanced SRL enabled from config
2025-06-11 18:13:30,118 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:13:30,118 INFO SRL condition: True = True and True
2025-06-11 18:13:30,118 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:13:30,119 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:13:30,510 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:13:30,511 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:13:30,511 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:13:30,848 INFO Using Temporal Attention (TAP)
2025-06-11 18:13:30,891 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:13:30,924 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:13:30,925 INFO Creating enhanced SRL loss...
2025-06-11 18:13:30,926 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:13:30,982 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:13:30,984 INFO Base prediction loss created: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:13:30,985 INFO Final enhanced SRL loss created with weight 0.1: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:13:30,987 INFO Added enhanced SRL loss to generative ATA
2025-06-11 18:13:33,589 INFO Graph assembled successfully.
2025-06-11 18:13:33,590 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:13:33,591 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:13:52,257 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:13:53,679 INFO Word table initialized
2025-06-11 18:13:53,680 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:13:53,680 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:13:53,680 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:13:53,680 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:13:53,681 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:13:53,681 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:13:53,681 INFO Evaluation will be performed every 10 steps
2025-06-11 18:13:53,783 INFO Starting training test for 50 batches
2025-06-11 18:14:04,168 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:14:19,000 INFO Batch 1/50 (Step 1):
2025-06-11 18:14:19,000 INFO   Total Loss: 1.3315
2025-06-11 18:14:19,001 INFO   Accuracy: 0.4375
2025-06-11 18:14:19,001 INFO   MCC: -0.1395
2025-06-11 18:14:19,001 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 18:14:19,001 INFO   MSIN Cross-Attention sample: [0.04442088 0.05547361 0.04451589 0.05576415 0.0444136 ]
2025-06-11 18:14:34,068 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:08,846 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:32,415 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:53,436 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:08,428 INFO Batch 5/50 (Step 5):
2025-06-11 18:16:08,428 INFO   Total Loss: 1.6109
2025-06-11 18:16:08,429 INFO   Accuracy: 0.5625
2025-06-11 18:16:08,430 INFO   MCC: 0.1260
2025-06-11 18:16:08,430 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 18:16:08,430 INFO   MSIN Cross-Attention sample: [0.04460614 0.05561072 0.05560695 0.05552963 0.04423304]
2025-06-11 18:16:17,684 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:33,236 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:49,993 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:17:08,564 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:52:00,969 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:52:00,969 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:52:00,969 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:52:00,969 INFO Configuration - use_ca_tsu: True
2025-06-11 18:52:00,970 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:52:00,970 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:52:00,970 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:52:00,970 INFO Configuration - variant_type: hedge
2025-06-11 18:52:00,970 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:52:00,973 INFO Start graph assembling...
2025-06-11 18:52:01,302 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:52:02,713 INFO use_dual_path_srl: True
2025-06-11 18:52:02,713 INFO variant_type: hedge
2025-06-11 18:52:02,713 INFO use_enhanced_srl: True
2025-06-11 18:52:02,713 INFO Enhanced SRL enabled from config
2025-06-11 18:52:02,714 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:52:02,714 INFO SRL condition: True = True and True
2025-06-11 18:52:02,714 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:52:02,714 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:52:03,110 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:52:03,111 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:52:03,111 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:52:03,450 INFO Using Temporal Attention (TAP)
2025-06-11 18:52:03,493 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:52:03,514 INFO Creating enhanced SRL loss...
2025-06-11 18:52:03,515 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:52:03,568 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:52:03,569 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:52:03,570 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:52:03,572 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 18:52:03,583 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:52:06,158 INFO Graph assembled successfully.
2025-06-11 18:52:06,160 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:52:06,160 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:52:24,332 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:52:25,770 INFO Word table initialized
2025-06-11 18:52:25,771 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:52:25,771 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:52:25,771 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:52:25,771 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:52:25,772 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:52:25,772 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:52:25,772 INFO Evaluation will be performed every 10 steps
2025-06-11 18:52:25,860 INFO Starting training test for 50 batches
2025-06-11 18:52:50,568 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:00:09,715 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:00:09,716 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:00:09,716 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:00:09,716 INFO Configuration - use_ca_tsu: True
2025-06-11 19:00:09,716 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:00:09,717 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:00:09,717 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:00:09,717 INFO Configuration - variant_type: hedge
2025-06-11 19:00:09,718 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:00:09,720 INFO Start graph assembling...
2025-06-11 19:00:10,088 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:00:11,512 INFO use_dual_path_srl: True
2025-06-11 19:00:11,512 INFO variant_type: hedge
2025-06-11 19:00:11,513 INFO use_enhanced_srl: True
2025-06-11 19:00:11,513 INFO Enhanced SRL enabled from config
2025-06-11 19:00:11,513 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:00:11,513 INFO SRL condition: True = True and True
2025-06-11 19:00:11,513 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:00:11,513 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:00:11,897 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:00:11,898 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:00:11,898 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:00:12,237 INFO Using Temporal Attention (TAP)
2025-06-11 19:00:12,279 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:00:12,279 INFO Ca-TSU enabled: True
2025-06-11 19:00:12,280 INFO Ca-TSU weight: 0.3
2025-06-11 19:00:12,280 INFO Causal loss lambda: 0.3
2025-06-11 19:00:12,280 INFO Enhanced SRL enabled: True
2025-06-11 19:00:12,280 INFO Noise-Aware Loss enabled: True
2025-06-11 19:00:12,280 INFO Noise-Aware weight: 0.5
2025-06-11 19:00:12,301 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:00:12,301 INFO Creating enhanced SRL loss...
2025-06-11 19:00:12,301 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:00:12,355 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:00:12,356 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:00:12,357 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:00:12,375 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:00:12,394 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:00:12,397 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:00:12,399 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:00:12,400 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:00:12,401 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:00:12,413 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:00:15,062 INFO Graph assembled successfully.
2025-06-11 19:00:15,065 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:00:15,065 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:00:33,493 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:00:35,016 INFO Word table initialized
2025-06-11 19:00:35,017 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:00:35,017 INFO Enhanced SRL is already enabled.
2025-06-11 19:00:35,017 INFO Noise-aware loss is already enabled.
2025-06-11 19:00:35,018 INFO Ca-TSU is already enabled.
2025-06-11 19:00:35,018 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:00:35,018 INFO Evaluation will be performed every 10 steps
2025-06-11 19:00:35,144 INFO Starting training test for 50 batches
2025-06-11 19:00:48,772 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:01:03,838 INFO Batch 1/50 (Step 1):
2025-06-11 19:01:03,839 INFO   Total Loss: 0.7869
2025-06-11 19:01:03,839 INFO   Accuracy: 0.5312
2025-06-11 19:01:03,840 INFO   MCC: 0.0626
2025-06-11 19:01:03,840 INFO   Avg Reliability Weight: 0.4886
2025-06-11 19:01:03,840 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:01:03,841 INFO   MSIN Cross-Attention sample: [0.05513986 0.04466706 0.05578171 0.04466706 0.05375522]
2025-06-11 19:01:12,969 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:01:43,988 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:03,117 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:23,945 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:35,658 INFO Batch 5/50 (Step 5):
2025-06-11 19:02:35,658 INFO   Total Loss: 1.7067
2025-06-11 19:02:35,659 INFO   Accuracy: 0.5000
2025-06-11 19:02:35,659 INFO   MCC: -0.0120
2025-06-11 19:02:35,659 INFO   Avg Reliability Weight: 0.4937
2025-06-11 19:02:35,659 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:02:35,660 INFO   MSIN Cross-Attention sample: [0.03331814 0.04452743 0.05562393 0.04441233 0.05562393]
2025-06-11 19:02:40,190 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:03:02,005 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:14:00,421 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:14:00,421 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:14:00,422 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:14:00,422 INFO Configuration - use_ca_tsu: True
2025-06-11 19:14:00,422 INFO Configuration - causal_loss_lambda: 1.0
2025-06-11 19:14:00,422 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:14:00,423 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:14:00,423 INFO Configuration - variant_type: hedge
2025-06-11 19:14:00,424 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:14:00,427 INFO Start graph assembling...
2025-06-11 19:14:00,766 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:14:02,228 INFO use_dual_path_srl: True
2025-06-11 19:14:02,229 INFO variant_type: hedge
2025-06-11 19:14:02,229 INFO use_enhanced_srl: True
2025-06-11 19:14:02,229 INFO Enhanced SRL enabled from config
2025-06-11 19:14:02,229 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:14:02,230 INFO SRL condition: True = True and True
2025-06-11 19:14:02,230 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:14:02,230 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:14:02,552 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:14:02,553 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:14:02,553 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:14:02,964 INFO Using Temporal Attention (TAP)
2025-06-11 19:14:03,008 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:14:03,008 INFO Ca-TSU enabled: True
2025-06-11 19:14:03,009 INFO Ca-TSU weight: 0.3
2025-06-11 19:14:03,009 INFO Causal loss lambda: 1.0
2025-06-11 19:14:03,009 INFO Enhanced SRL enabled: True
2025-06-11 19:14:03,009 INFO Noise-Aware Loss enabled: True
2025-06-11 19:14:03,010 INFO Noise-Aware weight: 0.5
2025-06-11 19:14:03,031 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:14:03,031 INFO Creating enhanced SRL loss...
2025-06-11 19:14:03,032 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:14:03,086 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:14:03,088 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:14:03,088 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:14:03,107 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:14:03,126 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:14:03,130 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:14:03,131 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:14:03,132 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:14:03,133 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:14:03,147 INFO Adding causal consistency loss with lambda: 1.0
2025-06-11 19:14:05,762 INFO Graph assembled successfully.
2025-06-11 19:14:05,764 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:14:05,764 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:14:06,055 INFO Verifying model configuration...
2025-06-11 19:14:06,055 INFO Ca-TSU enabled: True
2025-06-11 19:14:06,056 INFO Enhanced SRL enabled: True
2025-06-11 19:14:06,056 INFO Noise-Aware Loss enabled: True
2025-06-11 19:14:06,056 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:14:06,056 INFO Evaluation will be performed every 10 steps
2025-06-11 19:14:06,056 ERROR Error running test: test_noise_aware_loss() got an unexpected keyword argument 'max_test_steps'
2025-06-11 19:15:44,496 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:15:44,496 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:15:44,496 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:15:44,497 INFO Configuration - use_ca_tsu: True
2025-06-11 19:15:44,497 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:15:44,497 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:15:44,497 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:15:44,497 INFO Configuration - variant_type: hedge
2025-06-11 19:15:44,498 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:15:44,500 INFO Start graph assembling...
2025-06-11 19:15:44,815 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:15:46,265 INFO use_dual_path_srl: True
2025-06-11 19:15:46,265 INFO variant_type: hedge
2025-06-11 19:15:46,265 INFO use_enhanced_srl: True
2025-06-11 19:15:46,265 INFO Enhanced SRL enabled from config
2025-06-11 19:15:46,266 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:15:46,266 INFO SRL condition: True = True and True
2025-06-11 19:15:46,266 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:15:46,266 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:15:46,586 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:15:46,586 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:15:46,587 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:15:46,998 INFO Using Temporal Attention (TAP)
2025-06-11 19:15:47,041 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:15:47,041 INFO Ca-TSU enabled: True
2025-06-11 19:15:47,042 INFO Ca-TSU weight: 0.3
2025-06-11 19:15:47,042 INFO Causal loss lambda: 0.3
2025-06-11 19:15:47,042 INFO Enhanced SRL enabled: True
2025-06-11 19:15:47,042 INFO Noise-Aware Loss enabled: True
2025-06-11 19:15:47,043 INFO Noise-Aware weight: 0.5
2025-06-11 19:15:47,066 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:15:47,066 INFO Creating enhanced SRL loss...
2025-06-11 19:15:47,067 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:15:47,122 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:15:47,124 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:15:47,125 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:15:47,143 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:15:47,164 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:15:47,167 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:15:47,169 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:15:47,170 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:15:47,171 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:15:47,184 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:15:49,846 INFO Graph assembled successfully.
2025-06-11 19:15:49,847 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:15:49,848 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:15:50,143 INFO Verifying model configuration...
2025-06-11 19:15:50,144 INFO Ca-TSU enabled: True
2025-06-11 19:15:50,144 INFO Enhanced SRL enabled: True
2025-06-11 19:15:50,144 INFO Noise-Aware Loss enabled: True
2025-06-11 19:15:50,145 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:15:50,145 INFO Evaluation will be performed every 10 steps
2025-06-11 19:16:08,512 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:16:10,085 INFO Word table initialized
2025-06-11 19:16:10,087 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:16:10,087 INFO Enhanced SRL is already enabled.
2025-06-11 19:16:10,087 INFO Noise-aware loss is already enabled.
2025-06-11 19:16:10,087 INFO Ca-TSU is already enabled.
2025-06-11 19:16:10,087 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:16:10,087 INFO Evaluation will be performed every 10 steps
2025-06-11 19:16:10,186 INFO Starting training test for 50 batches
2025-06-11 19:16:28,073 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:16:42,336 INFO Batch 1/50 (Step 1):
2025-06-11 19:16:42,337 INFO   Total Loss: 0.8279
2025-06-11 19:16:42,338 INFO   Accuracy: 0.4688
2025-06-11 19:16:42,338 INFO   MCC: -0.0552
2025-06-11 19:16:42,338 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:16:42,338 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:16:42,339 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:16:42,339 INFO   Avg Reliability Weight: 0.5167
2025-06-11 19:16:42,339 INFO   Ca-TSU - Alpha_i sample: [0.04039568 0.07477292 0.05826773 0.02485894 0.06349684]
2025-06-11 19:16:42,340 INFO   Ca-TSU - Omega_i sample: [0.03566391 0.02657074 0.03793029 0.0486159  0.08013925]
2025-06-11 19:16:42,340 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:16:42,340 INFO   MSIN Cross-Attention sample: [0.03433576 0.03388414 0.04425747 0.05547943 0.05668126]
2025-06-11 19:16:56,490 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:17:21,883 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:17:45,619 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:01,094 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:12,158 INFO Batch 5/50 (Step 5):
2025-06-11 19:18:12,158 INFO   Total Loss: 2.0284
2025-06-11 19:18:12,159 INFO   Accuracy: 0.5625
2025-06-11 19:18:12,159 INFO   MCC: 0.1111
2025-06-11 19:18:12,159 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:18:12,159 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:18:12,159 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:18:12,160 INFO   Avg Reliability Weight: 0.5149
2025-06-11 19:18:12,160 INFO   Ca-TSU - Alpha_i sample: [0.3131488 0.6868512 0.        0.        0.       ]
2025-06-11 19:18:12,160 INFO   Ca-TSU - Omega_i sample: [0.45779496 0.54220504 0.         0.         0.        ]
2025-06-11 19:18:12,161 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:18:12,161 INFO   MSIN Cross-Attention sample: [0.05564253 0.04403903 0.05546587 0.05550609 0.02254248]
2025-06-11 19:18:20,105 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:37,971 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:53,432 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:08,851 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:23,260 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:35,156 INFO Batch 10/50 (Step 10):
2025-06-11 19:19:35,157 INFO   Total Loss: 2.8623
2025-06-11 19:19:35,157 INFO   Accuracy: 0.6250
2025-06-11 19:19:35,158 INFO   MCC: 0.2431
2025-06-11 19:19:35,158 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Avg Reliability Weight: 0.5050
2025-06-11 19:19:35,159 INFO   Ca-TSU - Alpha_i sample: [0.50195    0.49804994 0.         0.         0.        ]
2025-06-11 19:19:35,159 INFO   Ca-TSU - Omega_i sample: [0.3619579 0.6380421 0.        0.        0.       ]
2025-06-11 19:19:35,159 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:19:35,159 INFO   MSIN Cross-Attention sample: [0.05535481 0.05531765 0.04428756 0.03305654 0.05557296]
2025-06-11 19:19:35,159 INFO Evaluating on dev set at batch 10/50...
2025-06-11 19:19:36,562 ERROR Error during testing: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

Caused by op 'dual_path_placeholders/msg_mask_ph', defined at:
  File "src/test_noise_aware_loss.py", line 121, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 82, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "src\..\src\Executor_tx_lf_dual_path.py", line 22, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "src\..\src\Model_tx_lf_dual_path.py", line 1390, in assemble_graph
    name='msg_mask_ph'
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1599, in placeholder
    return gen_array_ops._placeholder(dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 3090, in _placeholder
    "Placeholder", dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

2025-06-11 19:19:36,567 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1323, in _do_call
    return fn(*args)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1302, in _run_fn
    status, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 817, in test_noise_aware_loss
    dev_results = self.generation(sess, 'dev')
  File "src\..\src\Executor_tx_lf_dual_path.py", line 131, in generation
    feed_dict=feed_dict)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 889, in run
    run_metadata_ptr)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1317, in _do_run
    options, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

Caused by op 'dual_path_placeholders/msg_mask_ph', defined at:
  File "src/test_noise_aware_loss.py", line 121, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 82, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "src\..\src\Executor_tx_lf_dual_path.py", line 22, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "src\..\src\Model_tx_lf_dual_path.py", line 1390, in assemble_graph
    name='msg_mask_ph'
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1599, in placeholder
    return gen_array_ops._placeholder(dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 3090, in _placeholder
    "Placeholder", dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]


2025-06-11 19:19:36,569 INFO Completed test on 10 batches
2025-06-11 19:19:36,717 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_191936.txt
2025-06-11 19:22:39,087 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:22:39,087 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:22:39,087 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:22:39,087 INFO Configuration - use_ca_tsu: True
2025-06-11 19:22:39,087 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:22:39,087 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:22:39,088 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:22:39,088 INFO Configuration - variant_type: hedge
2025-06-11 19:22:39,088 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:22:39,090 INFO Start graph assembling...
2025-06-11 19:22:39,409 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:22:40,881 INFO use_dual_path_srl: True
2025-06-11 19:22:40,881 INFO variant_type: hedge
2025-06-11 19:22:40,882 INFO use_enhanced_srl: True
2025-06-11 19:22:40,882 INFO Enhanced SRL enabled from config
2025-06-11 19:22:40,882 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:22:40,882 INFO SRL condition: True = True and True
2025-06-11 19:22:40,882 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:22:40,883 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:22:41,221 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:22:41,222 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:22:41,222 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:22:41,670 INFO Using Temporal Attention (TAP)
2025-06-11 19:22:41,718 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:22:41,718 INFO Ca-TSU enabled: True
2025-06-11 19:22:41,719 INFO Ca-TSU weight: 0.3
2025-06-11 19:22:41,719 INFO Causal loss lambda: 0.3
2025-06-11 19:22:41,719 INFO Enhanced SRL enabled: True
2025-06-11 19:22:41,719 INFO Noise-Aware Loss enabled: True
2025-06-11 19:22:41,719 INFO Noise-Aware weight: 0.5
2025-06-11 19:22:41,743 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:22:41,743 INFO Creating enhanced SRL loss...
2025-06-11 19:22:41,744 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:22:41,805 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:22:41,807 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:22:41,807 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:22:41,829 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:22:41,852 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:22:41,856 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:22:41,858 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:22:41,859 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:22:41,860 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:22:41,875 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:22:44,635 INFO Graph assembled successfully.
2025-06-11 19:22:44,636 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:22:44,637 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:22:44,941 INFO Verifying model configuration...
2025-06-11 19:22:44,941 INFO Ca-TSU enabled: True
2025-06-11 19:22:44,941 INFO Enhanced SRL enabled: True
2025-06-11 19:22:44,942 INFO Noise-Aware Loss enabled: True
2025-06-11 19:22:44,942 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:22:44,942 INFO Evaluation will be performed every 10 steps
2025-06-11 19:23:03,470 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:23:04,891 INFO Word table initialized
2025-06-11 19:23:04,892 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:23:04,892 INFO Enhanced SRL is already enabled.
2025-06-11 19:23:04,892 INFO Noise-aware loss is already enabled.
2025-06-11 19:23:04,893 INFO Ca-TSU is already enabled.
2025-06-11 19:23:04,893 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:23:04,893 INFO Evaluation will be performed every 10 steps
2025-06-11 19:23:04,993 INFO Starting training test for 50 batches
2025-06-11 19:23:19,641 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:23:33,455 INFO Batch 1/50 (Step 1):
2025-06-11 19:23:33,456 INFO   Total Loss: 0.8296
2025-06-11 19:23:33,456 INFO   Accuracy: 0.5312
2025-06-11 19:23:33,457 INFO   MCC: 0.0710
2025-06-11 19:23:33,457 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Avg Reliability Weight: 0.5138
2025-06-11 19:23:33,458 INFO   Ca-TSU - Alpha_i sample: [1. 0. 0. 0. 0.]
2025-06-11 19:23:33,458 INFO   Ca-TSU - Omega_i sample: [1. 0. 0. 0. 0.]
2025-06-11 19:23:33,458 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:23:33,459 INFO   MSIN Cross-Attention sample: [0.05526636 0.05572525 0.05552258 0.05534501 0.04480899]
2025-06-11 19:23:48,723 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:15,727 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:32,510 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:55,099 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:06,957 INFO Batch 5/50 (Step 5):
2025-06-11 19:25:06,958 INFO   Total Loss: 2.1663
2025-06-11 19:25:06,958 INFO   Accuracy: 0.5938
2025-06-11 19:25:06,958 INFO   MCC: 0.1189
2025-06-11 19:25:06,958 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:25:06,958 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:25:06,959 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:25:06,959 INFO   Avg Reliability Weight: 0.5198
2025-06-11 19:25:06,959 INFO   Ca-TSU - Alpha_i sample: [0.41033483 0.5896652  0.         0.         0.        ]
2025-06-11 19:25:06,960 INFO   Ca-TSU - Omega_i sample: [0.4440763  0.55592364 0.         0.         0.        ]
2025-06-11 19:25:06,960 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:25:06,960 INFO   MSIN Cross-Attention sample: [0.0536579  0.05461273 0.05562618 0.0574426  0.05558947]
2025-06-11 19:25:12,331 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:31,966 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:50,288 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:07,109 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:22,799 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:34,525 INFO Batch 10/50 (Step 10):
2025-06-11 19:26:34,525 INFO   Total Loss: 1.9956
2025-06-11 19:26:34,525 INFO   Accuracy: 0.5312
2025-06-11 19:26:34,526 INFO   MCC: 0.0658
2025-06-11 19:26:34,526 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Avg Reliability Weight: 0.5367
2025-06-11 19:26:34,527 INFO   Ca-TSU - Alpha_i sample: [0.13459796 0.24689054 0.21098895 0.14978819 0.10822627]
2025-06-11 19:26:34,527 INFO   Ca-TSU - Omega_i sample: [0.18274665 0.2262676  0.14796993 0.1835611  0.1195037 ]
2025-06-11 19:26:34,527 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:26:34,528 INFO   MSIN Cross-Attention sample: [0.05554115 0.05573942 0.0443105  0.05564027 0.04452428]
2025-06-11 19:26:34,528 INFO Evaluating on dev set at batch 10/50...
2025-06-11 19:26:34,528 ERROR Error during testing: 'DataPipe' object has no attribute 'size'
2025-06-11 19:26:34,530 ERROR Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 122, in generation
    for _ in range(self.pipe.size[phase] // 32 + 1):
AttributeError: 'DataPipe' object has no attribute 'size'

2025-06-11 19:26:34,530 INFO Dev evaluation results:
2025-06-11 19:26:34,531 ERROR Error during testing: 'loss'
2025-06-11 19:26:34,535 ERROR Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 884, in test_noise_aware_loss
    stat_logger.print_eval_res(dev_results)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\stat_logger.py", line 20, in print_eval_res
    eval_loss, eval_acc = result_dict['loss'], result_dict['acc']
KeyError: 'loss'

2025-06-11 19:26:34,535 INFO Completed test on 10 batches
2025-06-11 19:26:34,700 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_192634.txt
2025-06-11 23:42:00,134 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:42:00,135 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:42:00,135 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:42:00,135 INFO Configuration - use_ca_tsu: True
2025-06-11 23:42:00,135 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:42:00,136 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:42:00,136 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:42:00,136 INFO Configuration - variant_type: hedge
2025-06-11 23:42:00,136 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:42:00,149 INFO Start graph assembling...
2025-06-11 23:42:01,973 INFO use_dual_path_srl: True
2025-06-11 23:42:01,974 INFO variant_type: hedge
2025-06-11 23:42:01,974 INFO use_enhanced_srl: True
2025-06-11 23:42:01,975 INFO Enhanced SRL enabled from config
2025-06-11 23:42:01,975 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:42:01,975 INFO SRL condition: True = True and True
2025-06-11 23:42:01,975 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:42:01,975 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:42:02,299 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:42:02,299 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:42:02,300 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:42:02,711 INFO Using Temporal Attention (TAP)
2025-06-11 23:42:02,756 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:42:02,756 INFO Ca-TSU enabled: True
2025-06-11 23:42:02,756 INFO Ca-TSU weight: 0.3
2025-06-11 23:42:02,757 INFO Causal loss lambda: 0.3
2025-06-11 23:42:02,757 INFO Enhanced SRL enabled: True
2025-06-11 23:42:02,757 INFO Noise-Aware Loss enabled: True
2025-06-11 23:42:02,757 INFO Noise-Aware weight: 0.5
2025-06-11 23:42:02,768 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:42:02,768 INFO Creating enhanced SRL loss...
2025-06-11 23:42:02,769 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:42:02,776 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:42:02,778 ERROR Error running test: module 'tensorflow.python.ops.nn' has no attribute 'softmax_cross_entropy_with_logits_v2'
2025-06-11 23:43:04,479 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:43:04,480 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:43:04,480 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:43:04,480 INFO Configuration - use_ca_tsu: True
2025-06-11 23:43:04,481 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:43:04,481 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:43:04,481 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:43:04,481 INFO Configuration - variant_type: hedge
2025-06-11 23:43:04,482 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:43:04,484 INFO Start graph assembling...
2025-06-11 23:43:06,209 INFO use_dual_path_srl: True
2025-06-11 23:43:06,209 INFO variant_type: hedge
2025-06-11 23:43:06,210 INFO use_enhanced_srl: True
2025-06-11 23:43:06,210 INFO Enhanced SRL enabled from config
2025-06-11 23:43:06,210 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:43:06,210 INFO SRL condition: True = True and True
2025-06-11 23:43:06,210 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:43:06,210 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:43:06,533 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:43:06,533 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:43:06,533 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:43:06,943 INFO Using Temporal Attention (TAP)
2025-06-11 23:43:06,987 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:43:06,988 INFO Ca-TSU enabled: True
2025-06-11 23:43:06,988 INFO Ca-TSU weight: 0.3
2025-06-11 23:43:06,988 INFO Causal loss lambda: 0.3
2025-06-11 23:43:06,988 INFO Enhanced SRL enabled: True
2025-06-11 23:43:06,988 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:06,989 INFO Noise-Aware weight: 0.5
2025-06-11 23:43:06,999 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:06,999 INFO Creating enhanced SRL loss...
2025-06-11 23:43:06,999 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:43:07,008 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:43:07,021 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:07,022 INFO Creating reliability weights for noise-aware loss
2025-06-11 23:43:07,028 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:07,036 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:07,036 ERROR Error running test: module 'tensorflow.python.ops.nn' has no attribute 'softmax_cross_entropy_with_logits_v2'
2025-06-11 23:43:38,154 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:43:38,155 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:43:38,155 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:43:38,155 INFO Configuration - use_ca_tsu: True
2025-06-11 23:43:38,155 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:43:38,155 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:43:38,156 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:43:38,156 INFO Configuration - variant_type: hedge
2025-06-11 23:43:38,157 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:43:38,159 INFO Start graph assembling...
2025-06-11 23:43:39,852 INFO use_dual_path_srl: True
2025-06-11 23:43:39,852 INFO variant_type: hedge
2025-06-11 23:43:39,852 INFO use_enhanced_srl: True
2025-06-11 23:43:39,853 INFO Enhanced SRL enabled from config
2025-06-11 23:43:39,853 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:43:39,853 INFO SRL condition: True = True and True
2025-06-11 23:43:39,853 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:43:39,854 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:43:40,166 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:43:40,166 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:43:40,166 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:43:40,565 INFO Using Temporal Attention (TAP)
2025-06-11 23:43:40,608 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:43:40,608 INFO Ca-TSU enabled: True
2025-06-11 23:43:40,609 INFO Ca-TSU weight: 0.3
2025-06-11 23:43:40,609 INFO Causal loss lambda: 0.3
2025-06-11 23:43:40,609 INFO Enhanced SRL enabled: True
2025-06-11 23:43:40,609 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:40,609 INFO Noise-Aware weight: 0.5
2025-06-11 23:43:40,619 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:40,619 INFO Creating enhanced SRL loss...
2025-06-11 23:43:40,620 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:43:40,628 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:43:40,639 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:40,639 INFO Creating reliability weights for noise-aware loss
2025-06-11 23:43:40,647 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:40,655 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:40,669 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 23:43:40,679 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:44,287 INFO Graph assembled successfully.
2025-06-11 23:43:44,601 INFO Verifying model configuration...
2025-06-11 23:43:44,602 INFO Ca-TSU enabled: True
2025-06-11 23:43:44,602 INFO Enhanced SRL enabled: True
2025-06-11 23:43:44,602 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:44,602 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 23:43:44,602 INFO Evaluation will be performed every 10 steps
2025-06-11 23:44:02,718 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 23:44:38,972 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_234438.txt
2025-06-12 00:04:17,828 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:04:17,828 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:04:17,828 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:04:17,828 INFO Configuration - use_ca_tsu: True
2025-06-12 00:04:17,829 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:04:17,829 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:04:17,829 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:04:17,829 INFO Configuration - variant_type: hedge
2025-06-12 00:04:17,831 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:04:17,833 INFO Start graph assembling...
2025-06-12 00:04:19,763 INFO use_dual_path_srl: True
2025-06-12 00:04:19,764 INFO variant_type: hedge
2025-06-12 00:04:19,764 INFO use_enhanced_srl: True
2025-06-12 00:04:19,764 INFO Enhanced SRL enabled from config
2025-06-12 00:04:19,765 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:04:19,765 INFO SRL condition: True = True and True
2025-06-12 00:04:19,765 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:04:19,765 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:04:20,146 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:04:20,146 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:04:20,147 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:04:20,598 INFO Using Temporal Attention (TAP)
2025-06-12 00:04:20,646 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:04:20,646 INFO Ca-TSU enabled: True
2025-06-12 00:04:20,647 INFO Ca-TSU weight: 0.3
2025-06-12 00:04:20,647 INFO Causal loss lambda: 0.3
2025-06-12 00:04:20,647 INFO Enhanced SRL enabled: True
2025-06-12 00:04:20,647 INFO Noise-Aware Loss enabled: True
2025-06-12 00:04:20,648 INFO Noise-Aware weight: 0.5
2025-06-12 00:04:20,658 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:20,659 INFO Creating enhanced SRL loss...
2025-06-12 00:04:20,660 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:04:20,669 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:04:20,680 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:20,681 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:04:20,687 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:04:20,694 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:04:20,711 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:04:20,720 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:24,949 INFO Graph assembled successfully.
2025-06-12 00:04:25,291 INFO Verifying model configuration...
2025-06-12 00:04:25,292 INFO Ca-TSU enabled: True
2025-06-12 00:04:25,292 INFO Enhanced SRL enabled: True
2025-06-12 00:04:25,292 INFO Noise-Aware Loss enabled: True
2025-06-12 00:04:25,293 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:04:25,293 INFO Evaluation will be performed every 10 steps
2025-06-12 00:04:43,500 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:09:34,293 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:09:34,293 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:09:34,293 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:09:34,293 INFO Configuration - use_ca_tsu: True
2025-06-12 00:09:34,294 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:09:34,294 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:09:34,294 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:09:34,294 INFO Configuration - variant_type: hedge
2025-06-12 00:09:34,296 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:09:34,298 INFO Start graph assembling...
2025-06-12 00:09:35,994 INFO use_dual_path_srl: True
2025-06-12 00:09:35,994 INFO variant_type: hedge
2025-06-12 00:09:35,995 INFO use_enhanced_srl: True
2025-06-12 00:09:35,995 INFO Enhanced SRL enabled from config
2025-06-12 00:09:35,995 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:09:35,995 INFO SRL condition: True = True and True
2025-06-12 00:09:35,995 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:09:35,996 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:09:36,040 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:09:36,044 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:09:36,064 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:09:36,293 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:09:36,293 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:09:36,294 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:09:36,692 INFO Using Temporal Attention (TAP)
2025-06-12 00:09:36,737 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:09:36,737 INFO Ca-TSU enabled: True
2025-06-12 00:09:36,737 INFO Ca-TSU weight: 0.3
2025-06-12 00:09:36,738 INFO Causal loss lambda: 0.3
2025-06-12 00:09:36,738 INFO Enhanced SRL enabled: True
2025-06-12 00:09:36,738 INFO Noise-Aware Loss enabled: True
2025-06-12 00:09:36,738 INFO Noise-Aware weight: 0.5
2025-06-12 00:09:36,748 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:36,748 INFO Creating enhanced SRL loss...
2025-06-12 00:09:36,749 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:09:36,757 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:09:36,769 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:36,769 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:09:36,777 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:09:36,783 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:09:36,797 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:09:36,807 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:40,465 INFO Graph assembled successfully.
2025-06-12 00:09:40,779 INFO Verifying model configuration...
2025-06-12 00:09:40,779 INFO Ca-TSU enabled: True
2025-06-12 00:09:40,779 INFO Enhanced SRL enabled: True
2025-06-12 00:09:40,780 INFO Noise-Aware Loss enabled: True
2025-06-12 00:09:40,780 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:09:40,780 INFO Evaluation will be performed every 10 steps
2025-06-12 00:09:58,753 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:16:10,637 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:16:10,638 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:16:10,638 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:16:10,638 INFO Configuration - use_ca_tsu: True
2025-06-12 00:16:10,639 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:16:10,639 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:16:10,639 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:16:10,639 INFO Configuration - variant_type: hedge
2025-06-12 00:16:10,640 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:16:10,642 INFO Start graph assembling...
2025-06-12 00:16:12,393 INFO use_dual_path_srl: True
2025-06-12 00:16:12,393 INFO variant_type: hedge
2025-06-12 00:16:12,394 INFO use_enhanced_srl: True
2025-06-12 00:16:12,394 INFO Enhanced SRL enabled from config
2025-06-12 00:16:12,394 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:16:12,394 INFO SRL condition: True = True and True
2025-06-12 00:16:12,394 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:16:12,395 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:16:12,440 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:16:12,444 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:16:12,468 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:16:12,694 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:16:12,695 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:16:12,695 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:16:13,125 INFO Using Temporal Attention (TAP)
2025-06-12 00:16:13,176 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:16:13,177 INFO Ca-TSU enabled: True
2025-06-12 00:16:13,177 INFO Ca-TSU weight: 0.3
2025-06-12 00:16:13,177 INFO Causal loss lambda: 0.3
2025-06-12 00:16:13,177 INFO Enhanced SRL enabled: True
2025-06-12 00:16:13,178 INFO Noise-Aware Loss enabled: True
2025-06-12 00:16:13,178 INFO Noise-Aware weight: 0.5
2025-06-12 00:16:13,189 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:13,190 INFO Creating enhanced SRL loss...
2025-06-12 00:16:13,190 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:16:13,197 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:16:13,209 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:13,210 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:16:13,216 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:16:13,224 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:16:13,238 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:16:13,248 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:16,915 INFO Graph assembled successfully.
2025-06-12 00:16:17,224 INFO Verifying model configuration...
2025-06-12 00:16:17,224 INFO Ca-TSU enabled: True
2025-06-12 00:16:17,224 INFO Enhanced SRL enabled: True
2025-06-12 00:16:17,224 INFO Noise-Aware Loss enabled: True
2025-06-12 00:16:17,224 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:16:17,225 INFO Evaluation will be performed every 10 steps
2025-06-12 00:16:35,906 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:17:11,956 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_001711.txt
2025-06-12 00:17:17,247 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:17:17,250 INFO Start graph assembling...
2025-06-12 00:17:19,061 INFO use_dual_path_srl: True
2025-06-12 00:17:19,061 INFO variant_type: hedge
2025-06-12 00:17:19,062 INFO use_enhanced_srl: True
2025-06-12 00:17:19,062 INFO Enhanced SRL enabled from config
2025-06-12 00:17:19,062 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:17:19,062 INFO SRL condition: True = True and True
2025-06-12 00:17:19,063 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:17:19,063 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:17:19,111 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:17:19,116 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:17:19,141 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:17:19,379 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:17:19,379 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:17:19,379 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:17:19,806 INFO Using Temporal Attention (TAP)
2025-06-12 00:17:19,854 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:17:19,855 INFO Ca-TSU enabled: True
2025-06-12 00:17:19,855 INFO Ca-TSU weight: 0.3
2025-06-12 00:17:19,855 INFO Causal loss lambda: 0.3
2025-06-12 00:17:19,855 INFO Enhanced SRL enabled: True
2025-06-12 00:17:19,856 INFO Noise-Aware Loss enabled: True
2025-06-12 00:17:19,856 INFO Noise-Aware weight: 0.5
2025-06-12 00:17:19,866 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:19,868 INFO Creating enhanced SRL loss...
2025-06-12 00:17:19,868 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:17:19,876 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:17:19,886 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:19,887 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:17:19,894 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:17:19,902 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:17:19,920 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:17:19,930 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:23,687 INFO Graph assembled successfully.
2025-06-12 00:19:46,160 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:19:46,160 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:19:46,161 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:19:46,161 INFO Configuration - use_ca_tsu: True
2025-06-12 00:19:46,161 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:19:46,161 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:19:46,162 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:19:46,162 INFO Configuration - variant_type: hedge
2025-06-12 00:19:46,162 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:19:46,164 INFO Start graph assembling...
2025-06-12 00:19:47,969 INFO use_dual_path_srl: True
2025-06-12 00:19:47,969 INFO variant_type: hedge
2025-06-12 00:19:47,969 INFO use_enhanced_srl: True
2025-06-12 00:19:47,970 INFO Enhanced SRL enabled from config
2025-06-12 00:19:47,970 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:19:47,970 INFO SRL condition: True = True and True
2025-06-12 00:19:47,970 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:19:47,970 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:19:48,014 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:19:48,019 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:19:48,038 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:19:48,258 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:19:48,259 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:19:48,259 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:19:48,664 INFO Using Temporal Attention (TAP)
2025-06-12 00:19:48,714 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:19:48,714 INFO Ca-TSU enabled: True
2025-06-12 00:19:48,715 INFO Ca-TSU weight: 0.3
2025-06-12 00:19:48,715 INFO Causal loss lambda: 0.3
2025-06-12 00:19:48,715 INFO Enhanced SRL enabled: True
2025-06-12 00:19:48,716 INFO Noise-Aware Loss enabled: True
2025-06-12 00:19:48,716 INFO Noise-Aware weight: 0.5
2025-06-12 00:19:48,728 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:48,729 INFO Creating enhanced SRL loss...
2025-06-12 00:19:48,729 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:19:48,749 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:19:48,762 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:48,762 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:19:48,769 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:19:48,777 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:19:48,794 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:19:48,803 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:52,703 INFO Graph assembled successfully.
2025-06-12 00:19:53,016 INFO Verifying model configuration...
2025-06-12 00:19:53,017 INFO Ca-TSU enabled: True
2025-06-12 00:19:53,017 INFO Enhanced SRL enabled: True
2025-06-12 00:19:53,017 INFO Noise-Aware Loss enabled: True
2025-06-12 00:19:53,017 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:19:53,017 INFO Evaluation will be performed every 10 steps
2025-06-12 00:20:11,913 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:24:46,572 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:24:46,572 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:24:46,573 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:24:46,573 INFO Configuration - use_ca_tsu: True
2025-06-12 00:24:46,573 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:24:46,573 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:24:46,573 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:24:46,573 INFO Configuration - variant_type: hedge
2025-06-12 00:24:46,574 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:24:46,576 INFO Start graph assembling...
2025-06-12 00:24:48,428 INFO use_dual_path_srl: True
2025-06-12 00:24:48,428 INFO variant_type: hedge
2025-06-12 00:24:48,430 INFO use_enhanced_srl: True
2025-06-12 00:24:48,430 INFO Enhanced SRL enabled from config
2025-06-12 00:24:48,430 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:24:48,430 INFO SRL condition: True = True and True
2025-06-12 00:24:48,430 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:24:48,430 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:24:48,484 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:24:48,489 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:24:48,508 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:24:48,747 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:24:48,748 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:24:48,748 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:24:49,186 INFO Using Temporal Attention (TAP)
2025-06-12 00:24:49,239 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:24:49,239 INFO Ca-TSU enabled: True
2025-06-12 00:24:49,239 INFO Ca-TSU weight: 0.3
2025-06-12 00:24:49,240 INFO Causal loss lambda: 0.3
2025-06-12 00:24:49,240 INFO Enhanced SRL enabled: True
2025-06-12 00:24:49,240 INFO Noise-Aware Loss enabled: True
2025-06-12 00:24:49,240 INFO Noise-Aware weight: 0.5
2025-06-12 00:24:49,254 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:49,254 INFO Creating enhanced SRL loss...
2025-06-12 00:24:49,254 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:24:49,268 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:24:49,280 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:49,281 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:24:49,288 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:24:49,296 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:24:49,312 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:24:49,321 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:53,133 INFO Graph assembled successfully.
2025-06-12 00:24:53,455 INFO Verifying model configuration...
2025-06-12 00:24:53,456 INFO Ca-TSU enabled: True
2025-06-12 00:24:53,456 INFO Enhanced SRL enabled: True
2025-06-12 00:24:53,456 INFO Noise-Aware Loss enabled: True
2025-06-12 00:24:53,456 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:24:53,457 INFO Evaluation will be performed every 10 steps
2025-06-12 00:25:11,933 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:25:48,929 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_002548.txt
2025-06-12 00:27:42,702 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:27:42,702 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:27:42,703 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:27:42,703 INFO Configuration - use_ca_tsu: True
2025-06-12 00:27:42,703 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:27:42,703 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:27:42,704 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:27:42,704 INFO Configuration - variant_type: hedge
2025-06-12 00:27:42,704 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:27:42,706 INFO Start graph assembling...
2025-06-12 00:27:44,579 INFO use_dual_path_srl: True
2025-06-12 00:27:44,580 INFO variant_type: hedge
2025-06-12 00:27:44,580 INFO use_enhanced_srl: True
2025-06-12 00:27:44,581 INFO Enhanced SRL enabled from config
2025-06-12 00:27:44,581 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:27:44,581 INFO SRL condition: True = True and True
2025-06-12 00:27:44,581 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:27:44,582 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:27:44,627 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:27:44,632 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:27:44,652 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:27:44,885 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:27:44,885 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:27:44,886 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:27:45,329 INFO Using Temporal Attention (TAP)
2025-06-12 00:27:45,373 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:27:45,373 INFO Ca-TSU enabled: True
2025-06-12 00:27:45,374 INFO Ca-TSU weight: 0.3
2025-06-12 00:27:45,374 INFO Causal loss lambda: 0.3
2025-06-12 00:27:45,374 INFO Enhanced SRL enabled: True
2025-06-12 00:27:45,374 INFO Noise-Aware Loss enabled: True
2025-06-12 00:27:45,374 INFO Noise-Aware weight: 0.5
2025-06-12 00:27:45,385 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:27:45,385 INFO Creating enhanced SRL loss...
2025-06-12 00:27:45,385 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:27:45,385 ERROR Error running test: local variable 'static_h_size' referenced before assignment
2025-06-12 00:28:42,205 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:28:42,206 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:28:42,206 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:28:42,207 INFO Configuration - use_ca_tsu: True
2025-06-12 00:28:42,207 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:28:42,207 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:28:42,207 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:28:42,207 INFO Configuration - variant_type: hedge
2025-06-12 00:28:42,208 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:28:42,210 INFO Start graph assembling...
2025-06-12 00:28:44,159 INFO use_dual_path_srl: True
2025-06-12 00:28:44,160 INFO variant_type: hedge
2025-06-12 00:28:44,160 INFO use_enhanced_srl: True
2025-06-12 00:28:44,160 INFO Enhanced SRL enabled from config
2025-06-12 00:28:44,160 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:28:44,161 INFO SRL condition: True = True and True
2025-06-12 00:28:44,161 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:28:44,161 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:28:44,207 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:28:44,212 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:28:44,231 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:28:44,463 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:28:44,463 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:28:44,464 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:28:44,926 INFO Using Temporal Attention (TAP)
2025-06-12 00:28:44,978 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:28:44,978 INFO Ca-TSU enabled: True
2025-06-12 00:28:44,978 INFO Ca-TSU weight: 0.3
2025-06-12 00:28:44,979 INFO Causal loss lambda: 0.3
2025-06-12 00:28:44,979 INFO Enhanced SRL enabled: True
2025-06-12 00:28:44,979 INFO Noise-Aware Loss enabled: True
2025-06-12 00:28:44,979 INFO Noise-Aware weight: 0.5
2025-06-12 00:28:44,992 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:44,992 INFO Creating enhanced SRL loss...
2025-06-12 00:28:44,992 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:28:44,998 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 00:28:45,012 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:28:45,028 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:45,028 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:28:45,036 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:28:45,037 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 00:28:45,042 INFO Created W_reliability with shape: (100, 1)
2025-06-12 00:28:45,047 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:28:45,069 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:28:45,080 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:48,728 INFO Graph assembled successfully.
2025-06-12 00:28:49,039 INFO Verifying model configuration...
2025-06-12 00:28:49,039 INFO Ca-TSU enabled: True
2025-06-12 00:28:49,039 INFO Enhanced SRL enabled: True
2025-06-12 00:28:49,040 INFO Noise-Aware Loss enabled: True
2025-06-12 00:28:49,040 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:28:49,040 INFO Evaluation will be performed every 10 steps
2025-06-12 00:29:07,836 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:34:47,151 INFO 	Eval, eval loss: 0.892702579498291, acc: 0.490854
2025-06-12 00:39:40,962 INFO 	Eval, eval loss: 0.8282244205474854, acc: 0.513720
2025-06-12 00:44:27,642 INFO 	Eval, eval loss: 0.7621829509735107, acc: 0.518293
2025-06-12 00:49:01,225 INFO 	Eval, eval loss: 0.7787623405456543, acc: 0.495427
2025-06-12 17:47:16,091 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 17:47:16,092 INFO Configuration - use_dual_path_srl: True
2025-06-12 17:47:16,092 INFO Configuration - use_enhanced_srl: True
2025-06-12 17:47:16,092 INFO Configuration - use_ca_tsu: True
2025-06-12 17:47:16,093 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 17:47:16,093 INFO Configuration - use_noise_aware_loss: True
2025-06-12 17:47:16,093 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 17:47:16,093 INFO Configuration - variant_type: hedge
2025-06-12 17:47:16,094 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 17:47:16,101 INFO Start graph assembling...
2025-06-12 17:47:17,836 INFO use_dual_path_srl: True
2025-06-12 17:47:17,836 INFO variant_type: hedge
2025-06-12 17:47:17,836 INFO use_enhanced_srl: True
2025-06-12 17:47:17,836 INFO Enhanced SRL enabled from config
2025-06-12 17:47:17,837 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 17:47:17,837 INFO SRL condition: True = True and True
2025-06-12 17:47:17,837 INFO Using enhanced dual-path SRL architecture
2025-06-12 17:47:17,837 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 17:47:17,882 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 17:47:17,887 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 17:47:17,906 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 17:47:18,128 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 17:47:18,129 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 17:47:18,129 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 17:47:18,527 INFO Using Temporal Attention (TAP)
2025-06-12 17:47:18,571 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 17:47:18,572 INFO Ca-TSU enabled: True
2025-06-12 17:47:18,572 INFO Ca-TSU weight: 0.3
2025-06-12 17:47:18,572 INFO Causal loss lambda: 0.3
2025-06-12 17:47:18,572 INFO Enhanced SRL enabled: True
2025-06-12 17:47:18,573 INFO Noise-Aware Loss enabled: True
2025-06-12 17:47:18,573 INFO Noise-Aware weight: 0.5
2025-06-12 17:47:18,584 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:18,585 INFO Creating enhanced SRL loss...
2025-06-12 17:47:18,585 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 17:47:18,589 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 17:47:18,597 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 17:47:18,608 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:18,609 INFO Creating reliability weights for noise-aware loss
2025-06-12 17:47:18,615 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 17:47:18,615 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 17:47:18,621 INFO Created W_reliability with shape: (100, 1)
2025-06-12 17:47:18,623 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 17:47:18,639 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 17:47:18,648 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:22,217 INFO Graph assembled successfully.
2025-06-12 17:47:22,528 INFO Verifying model configuration...
2025-06-12 17:47:22,528 INFO Ca-TSU enabled: True
2025-06-12 17:47:22,529 INFO Enhanced SRL enabled: True
2025-06-12 17:47:22,529 INFO Noise-Aware Loss enabled: True
2025-06-12 17:47:22,529 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 17:47:22,529 INFO Evaluation will be performed every 10 steps
2025-06-12 17:47:40,928 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 17:53:10,537 INFO 	Eval, eval loss: 0.8751025795936584, acc: 0.493902
2025-06-12 17:57:41,763 INFO 	Eval, eval loss: 0.8034499883651733, acc: 0.521341
2025-06-12 18:02:08,203 INFO 	Eval, eval loss: 0.8108055591583252, acc: 0.481707
2025-06-12 18:06:17,690 INFO 	Eval, eval loss: 0.7536460757255554, acc: 0.524390
2025-06-12 18:10:33,877 INFO 	Eval, eval loss: 0.7572818994522095, acc: 0.525915
2025-06-12 18:12:34,971 INFO 	Eval, eval loss: 0.7903890013694763, acc: 0.519817
2025-06-12 18:12:36,650 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_181236.txt
2025-06-12 19:31:09,521 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 19:31:09,522 INFO Configuration - use_dual_path_srl: True
2025-06-12 19:31:09,522 INFO Configuration - use_enhanced_srl: True
2025-06-12 19:31:09,522 INFO Configuration - use_ca_tsu: True
2025-06-12 19:31:09,522 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 19:31:09,523 INFO Configuration - use_noise_aware_loss: True
2025-06-12 19:31:09,523 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 19:31:09,523 INFO Configuration - variant_type: hedge
2025-06-12 19:31:09,524 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 19:31:09,525 INFO Start graph assembling...
2025-06-12 19:31:11,305 INFO use_dual_path_srl: True
2025-06-12 19:31:11,305 INFO variant_type: hedge
2025-06-12 19:31:11,306 INFO use_enhanced_srl: True
2025-06-12 19:31:11,306 INFO Enhanced SRL enabled from config
2025-06-12 19:31:11,306 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 19:31:11,306 INFO SRL condition: True = True and True
2025-06-12 19:31:11,307 INFO Using enhanced dual-path SRL architecture
2025-06-12 19:31:11,307 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 19:31:11,352 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 19:31:11,357 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 19:31:11,375 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 19:31:11,597 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 19:31:11,597 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 19:31:11,598 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 19:31:11,994 INFO Using Temporal Attention (TAP)
2025-06-12 19:31:12,040 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 19:31:12,040 INFO Ca-TSU enabled: True
2025-06-12 19:31:12,041 INFO Ca-TSU weight: 0.3
2025-06-12 19:31:12,041 INFO Causal loss lambda: 0.3
2025-06-12 19:31:12,041 INFO Enhanced SRL enabled: True
2025-06-12 19:31:12,041 INFO Noise-Aware Loss enabled: True
2025-06-12 19:31:12,042 INFO Noise-Aware weight: 0.5
2025-06-12 19:31:12,052 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:12,052 INFO Creating enhanced SRL loss...
2025-06-12 19:31:12,052 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 19:31:12,059 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 19:31:12,067 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 19:31:12,078 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:12,079 INFO Creating reliability weights for noise-aware loss
2025-06-12 19:31:12,085 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 19:31:12,085 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 19:31:12,090 INFO Created W_reliability with shape: (100, 1)
2025-06-12 19:31:12,093 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 19:31:12,108 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 19:31:12,119 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:15,819 INFO Graph assembled successfully.
2025-06-12 19:31:16,173 INFO Verifying model configuration...
2025-06-12 19:31:16,173 INFO Ca-TSU enabled: True
2025-06-12 19:31:16,173 INFO Enhanced SRL enabled: True
2025-06-12 19:31:16,174 INFO Noise-Aware Loss enabled: True
2025-06-12 19:31:16,174 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 19:31:16,174 INFO Evaluation will be performed every 10 steps
2025-06-12 19:31:35,695 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 19:37:02,153 INFO 	Eval, eval loss: 0.8321214318275452, acc: 0.527439
2025-06-12 19:41:31,135 INFO 	Eval, eval loss: 0.8202773928642273, acc: 0.515244
2025-06-12 19:45:45,279 INFO 	Eval, eval loss: 0.7907822728157043, acc: 0.498476
2025-06-12 19:49:54,894 INFO 	Eval, eval loss: 0.7974898219108582, acc: 0.506098
2025-06-12 19:54:07,346 INFO 	Eval, eval loss: 0.7508732080459595, acc: 0.535061
2025-06-12 19:56:00,125 INFO 	Eval, eval loss: 0.8410829901695251, acc: 0.509146
2025-06-12 19:58:41,110 INFO 	Eval, eval loss: 0.8626457452774048, acc: 0.481151
2025-06-12 19:58:41,392 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_195841.txt
2025-06-12 19:58:41,392 INFO Test completed successfully!
2025-06-12 23:27:25,344 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 23:27:25,346 INFO Configuration - use_dual_path_srl: True
2025-06-12 23:27:25,346 INFO Configuration - use_enhanced_srl: True
2025-06-12 23:27:25,346 INFO Configuration - use_ca_tsu: True
2025-06-12 23:27:25,346 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 23:27:25,347 INFO Configuration - use_noise_aware_loss: True
2025-06-12 23:27:25,347 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 23:27:25,347 INFO Configuration - variant_type: hedge
2025-06-12 23:27:25,348 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 23:27:25,359 INFO Start graph assembling...
2025-06-12 23:27:27,363 INFO use_dual_path_srl: True
2025-06-12 23:27:27,363 INFO variant_type: hedge
2025-06-12 23:27:27,364 INFO use_enhanced_srl: True
2025-06-12 23:27:27,364 INFO Enhanced SRL enabled from config
2025-06-12 23:27:27,364 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 23:27:27,364 INFO SRL condition: True = True and True
2025-06-12 23:27:27,365 INFO Using enhanced dual-path SRL architecture
2025-06-12 23:27:27,365 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 23:27:27,432 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 23:27:27,439 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 23:27:27,468 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 23:27:27,772 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 23:27:27,773 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 23:27:27,773 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 23:27:28,252 INFO Using Temporal Attention (TAP)
2025-06-12 23:27:28,303 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 23:27:28,304 INFO Ca-TSU enabled: True
2025-06-12 23:27:28,304 INFO Ca-TSU weight: 0.3
2025-06-12 23:27:28,304 INFO Causal loss lambda: 0.3
2025-06-12 23:27:28,304 INFO Enhanced SRL enabled: True
2025-06-12 23:27:28,305 INFO Noise-Aware Loss enabled: True
2025-06-12 23:27:28,305 INFO Noise-Aware weight: 0.5
2025-06-12 23:27:28,316 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:28,316 INFO Creating enhanced SRL loss...
2025-06-12 23:27:28,317 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 23:27:28,322 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 23:27:28,334 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 23:27:28,346 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:28,347 INFO Creating reliability weights for noise-aware loss
2025-06-12 23:27:28,354 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:27:28,355 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 23:27:28,359 INFO Created W_reliability with shape: (100, 1)
2025-06-12 23:27:28,362 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:27:28,377 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 23:27:28,387 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:32,102 INFO Graph assembled successfully.
2025-06-12 23:27:32,423 INFO Verifying model configuration...
2025-06-12 23:27:32,424 INFO Ca-TSU enabled: True
2025-06-12 23:27:32,424 INFO Enhanced SRL enabled: True
2025-06-12 23:27:32,424 INFO Noise-Aware Loss enabled: True
2025-06-12 23:27:32,424 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 23:27:32,425 INFO Evaluation will be performed every 10 steps
2025-06-12 23:27:50,640 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 23:50:31,636 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 23:50:31,636 INFO Configuration - use_dual_path_srl: True
2025-06-12 23:50:31,636 INFO Configuration - use_enhanced_srl: True
2025-06-12 23:50:31,637 INFO Configuration - use_ca_tsu: True
2025-06-12 23:50:31,637 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 23:50:31,637 INFO Configuration - use_noise_aware_loss: True
2025-06-12 23:50:31,637 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 23:50:31,637 INFO Configuration - variant_type: hedge
2025-06-12 23:50:31,638 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 23:50:31,640 INFO Start graph assembling...
2025-06-12 23:50:33,462 INFO use_dual_path_srl: True
2025-06-12 23:50:33,462 INFO variant_type: hedge
2025-06-12 23:50:33,463 INFO use_enhanced_srl: True
2025-06-12 23:50:33,463 INFO Enhanced SRL enabled from config
2025-06-12 23:50:33,463 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 23:50:33,463 INFO SRL condition: True = True and True
2025-06-12 23:50:33,463 INFO Using enhanced dual-path SRL architecture
2025-06-12 23:50:33,464 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 23:50:33,513 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 23:50:33,517 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 23:50:33,541 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 23:50:33,784 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 23:50:33,784 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 23:50:33,785 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 23:50:34,247 INFO Using Temporal Attention (TAP)
2025-06-12 23:50:34,298 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 23:50:34,299 INFO Ca-TSU enabled: True
2025-06-12 23:50:34,299 INFO Ca-TSU weight: 0.3
2025-06-12 23:50:34,299 INFO Causal loss lambda: 0.3
2025-06-12 23:50:34,299 INFO Enhanced SRL enabled: True
2025-06-12 23:50:34,299 INFO Noise-Aware Loss enabled: True
2025-06-12 23:50:34,300 INFO Noise-Aware weight: 0.5
2025-06-12 23:50:34,312 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:34,313 INFO Creating enhanced SRL loss...
2025-06-12 23:50:34,313 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 23:50:34,318 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 23:50:34,329 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 23:50:34,343 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:34,343 INFO Creating reliability weights for noise-aware loss
2025-06-12 23:50:34,355 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:50:34,356 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 23:50:34,363 INFO Created W_reliability with shape: (100, 1)
2025-06-12 23:50:34,365 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:50:34,393 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 23:50:34,406 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:38,214 INFO Graph assembled successfully.
2025-06-12 23:50:38,542 INFO Verifying model configuration...
2025-06-12 23:50:38,542 INFO Ca-TSU enabled: True
2025-06-12 23:50:38,542 INFO Enhanced SRL enabled: True
2025-06-12 23:50:38,543 INFO Noise-Aware Loss enabled: True
2025-06-12 23:50:38,543 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 23:50:38,543 INFO Evaluation will be performed every 10 steps
2025-06-12 23:50:57,360 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:04:09,685 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:04:09,700 INFO Start graph assembling...
2025-06-13 18:04:12,086 INFO use_dual_path_srl: True
2025-06-13 18:04:12,086 INFO variant_type: hedge
2025-06-13 18:04:12,086 INFO use_enhanced_srl: True
2025-06-13 18:04:12,086 INFO Enhanced SRL enabled from config
2025-06-13 18:04:12,087 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:04:12,087 INFO SRL condition: True = True and True
2025-06-13 18:04:12,087 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:04:12,087 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:04:12,143 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:04:12,149 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:04:12,170 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:04:12,435 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:04:12,436 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:04:12,436 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:04:12,910 INFO Using Temporal Attention (TAP)
2025-06-13 18:04:12,957 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:04:12,957 INFO Ca-TSU enabled: True
2025-06-13 18:04:12,957 INFO Ca-TSU weight: 0.3
2025-06-13 18:04:12,958 INFO Causal loss lambda: 0.3
2025-06-13 18:04:12,958 INFO Enhanced SRL enabled: True
2025-06-13 18:04:12,958 INFO Noise-Aware Loss enabled: True
2025-06-13 18:04:12,958 INFO Noise-Aware weight: 0.5
2025-06-13 18:04:12,969 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:04:12,970 INFO Creating enhanced SRL loss...
2025-06-13 18:04:12,970 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:04:12,973 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:04:12,982 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:04:12,993 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:04:12,994 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:04:13,001 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:04:13,001 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:04:13,006 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:04:13,008 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:04:13,026 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:05:11,803 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:05:11,807 INFO Start graph assembling...
2025-06-13 18:05:13,627 INFO use_dual_path_srl: True
2025-06-13 18:05:13,627 INFO variant_type: hedge
2025-06-13 18:05:13,627 INFO use_enhanced_srl: True
2025-06-13 18:05:13,627 INFO Enhanced SRL enabled from config
2025-06-13 18:05:13,628 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:05:13,628 INFO SRL condition: True = True and True
2025-06-13 18:05:13,628 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:05:13,628 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:05:13,674 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:05:13,678 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:05:13,697 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:05:13,922 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:05:13,922 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:05:13,923 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:05:14,325 INFO Using Temporal Attention (TAP)
2025-06-13 18:05:14,369 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:05:14,370 INFO Ca-TSU enabled: True
2025-06-13 18:05:14,370 INFO Ca-TSU weight: 0.3
2025-06-13 18:05:14,370 INFO Causal loss lambda: 0.3
2025-06-13 18:05:14,370 INFO Enhanced SRL enabled: True
2025-06-13 18:05:14,371 INFO Noise-Aware Loss enabled: True
2025-06-13 18:05:14,371 INFO Noise-Aware weight: 0.5
2025-06-13 18:05:14,381 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:05:14,382 INFO Creating enhanced SRL loss...
2025-06-13 18:05:14,382 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:05:14,387 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:05:14,395 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:05:14,406 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:05:14,406 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:05:14,413 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:05:14,413 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:05:14,420 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:05:14,422 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:05:14,437 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:07:26,716 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:07:26,719 INFO Start graph assembling...
2025-06-13 18:07:28,457 INFO use_dual_path_srl: True
2025-06-13 18:07:28,457 INFO variant_type: hedge
2025-06-13 18:07:28,457 INFO use_enhanced_srl: True
2025-06-13 18:07:28,457 INFO Enhanced SRL enabled from config
2025-06-13 18:07:28,457 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:07:28,458 INFO SRL condition: True = True and True
2025-06-13 18:07:28,458 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:07:28,458 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:07:28,511 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:07:28,518 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:07:28,543 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:07:28,780 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:07:28,780 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:07:28,781 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:07:29,185 INFO Using Temporal Attention (TAP)
2025-06-13 18:07:29,229 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:07:29,229 INFO Ca-TSU enabled: True
2025-06-13 18:07:29,229 INFO Ca-TSU weight: 0.3
2025-06-13 18:07:29,230 INFO Causal loss lambda: 0.3
2025-06-13 18:07:29,230 INFO Enhanced SRL enabled: True
2025-06-13 18:07:29,230 INFO Noise-Aware Loss enabled: True
2025-06-13 18:07:29,230 INFO Noise-Aware weight: 0.5
2025-06-13 18:07:29,241 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,241 INFO Creating enhanced SRL loss...
2025-06-13 18:07:29,241 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:07:29,245 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:07:29,253 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:07:29,264 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,264 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:07:29,271 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:07:29,272 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:07:29,276 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:07:29,278 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:07:29,293 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:07:29,342 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:07:29,347 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,347 INFO Loss component verification:
2025-06-13 18:07:29,374 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:07:33,042 INFO Graph assembled successfully.
2025-06-13 18:16:02,825 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 18:16:02,825 INFO Configuration - use_dual_path_srl: True
2025-06-13 18:16:02,825 INFO Configuration - use_enhanced_srl: True
2025-06-13 18:16:02,825 INFO Configuration - use_ca_tsu: True
2025-06-13 18:16:02,825 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 18:16:02,826 INFO Configuration - use_noise_aware_loss: True
2025-06-13 18:16:02,826 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 18:16:02,826 INFO Configuration - variant_type: hedge
2025-06-13 18:16:02,826 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:16:02,828 INFO Start graph assembling...
2025-06-13 18:16:04,554 INFO use_dual_path_srl: True
2025-06-13 18:16:04,555 INFO variant_type: hedge
2025-06-13 18:16:04,555 INFO use_enhanced_srl: True
2025-06-13 18:16:04,555 INFO Enhanced SRL enabled from config
2025-06-13 18:16:04,555 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:16:04,555 INFO SRL condition: True = True and True
2025-06-13 18:16:04,556 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:16:04,556 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:16:04,605 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:16:04,609 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:16:04,629 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:16:04,858 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:16:04,858 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:16:04,858 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:16:05,314 INFO Using Temporal Attention (TAP)
2025-06-13 18:16:05,359 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:16:05,359 INFO Ca-TSU enabled: True
2025-06-13 18:16:05,360 INFO Ca-TSU weight: 0.3
2025-06-13 18:16:05,360 INFO Causal loss lambda: 0.3
2025-06-13 18:16:05,360 INFO Enhanced SRL enabled: True
2025-06-13 18:16:05,360 INFO Noise-Aware Loss enabled: True
2025-06-13 18:16:05,361 INFO Noise-Aware weight: 0.5
2025-06-13 18:16:05,379 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,379 INFO Creating enhanced SRL loss...
2025-06-13 18:16:05,380 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:16:05,384 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:16:05,393 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:16:05,404 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,405 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:16:05,412 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:16:05,412 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:16:05,417 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:16:05,419 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:16:05,436 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:16:05,487 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:16:05,493 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,494 INFO Loss component verification:
2025-06-13 18:16:05,494 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 18:16:05,494 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 18:16:05,494 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 18:16:05,495 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 18:16:05,495 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:16:09,221 INFO Graph assembled successfully.
2025-06-13 18:16:09,548 INFO Verifying model configuration...
2025-06-13 18:16:09,548 INFO Ca-TSU enabled: True
2025-06-13 18:16:09,549 INFO Enhanced SRL enabled: True
2025-06-13 18:16:09,549 INFO Noise-Aware Loss enabled: True
2025-06-13 18:16:09,549 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 18:16:09,549 INFO Evaluation will be performed every 10 steps
2025-06-13 18:16:27,957 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:22:22,631 INFO 	Eval, eval loss: 0.8802575469017029, acc: 0.489329
2025-06-13 18:50:19,329 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 18:50:19,329 INFO Configuration - use_dual_path_srl: True
2025-06-13 18:50:19,330 INFO Configuration - use_enhanced_srl: True
2025-06-13 18:50:19,330 INFO Configuration - use_ca_tsu: True
2025-06-13 18:50:19,330 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 18:50:19,330 INFO Configuration - use_noise_aware_loss: True
2025-06-13 18:50:19,330 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 18:50:19,330 INFO Configuration - variant_type: hedge
2025-06-13 18:50:19,331 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:50:19,334 INFO Start graph assembling...
2025-06-13 18:50:21,128 INFO use_dual_path_srl: True
2025-06-13 18:50:21,128 INFO variant_type: hedge
2025-06-13 18:50:21,128 INFO use_enhanced_srl: True
2025-06-13 18:50:21,129 INFO Enhanced SRL enabled from config
2025-06-13 18:50:21,129 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:50:21,129 INFO SRL condition: True = True and True
2025-06-13 18:50:21,129 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:50:21,130 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:50:21,183 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:50:21,190 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:50:21,218 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:50:21,472 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:50:21,473 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:50:21,473 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:50:21,898 INFO Using Temporal Attention (TAP)
2025-06-13 18:50:21,942 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:50:21,943 INFO Ca-TSU enabled: True
2025-06-13 18:50:21,943 INFO Ca-TSU weight: 0.3
2025-06-13 18:50:21,943 INFO Causal loss lambda: 0.3
2025-06-13 18:50:21,944 INFO Enhanced SRL enabled: True
2025-06-13 18:50:21,944 INFO Noise-Aware Loss enabled: True
2025-06-13 18:50:21,944 INFO Noise-Aware weight: 0.5
2025-06-13 18:50:21,955 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:21,955 INFO Creating enhanced SRL loss...
2025-06-13 18:50:21,956 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:50:21,958 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:50:21,968 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:50:21,979 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:21,980 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:50:21,987 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:50:21,987 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:50:21,993 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:50:21,995 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:50:22,013 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:50:22,066 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:50:22,070 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:22,070 INFO Loss component verification:
2025-06-13 18:50:22,071 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 18:50:22,071 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 18:50:22,071 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 18:50:22,071 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 18:50:22,072 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:50:26,086 INFO Graph assembled successfully.
2025-06-13 18:50:26,431 INFO Verifying model configuration...
2025-06-13 18:50:26,432 INFO Ca-TSU enabled: True
2025-06-13 18:50:26,432 INFO Enhanced SRL enabled: True
2025-06-13 18:50:26,432 INFO Noise-Aware Loss enabled: True
2025-06-13 18:50:26,432 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 18:50:26,433 INFO Evaluation will be performed every 10 steps
2025-06-13 18:50:45,093 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:54:17,121 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_185417.txt
2025-06-13 18:54:17,122 INFO Test completed successfully!
2025-06-13 20:32:25,345 INFO Starting component loss verification...
2025-06-13 20:32:25,345 INFO Configuration - use_dual_path_srl: True
2025-06-13 20:32:25,346 INFO Configuration - use_enhanced_srl: True
2025-06-13 20:32:25,346 INFO Configuration - use_ca_tsu: True
2025-06-13 20:32:25,346 INFO Configuration - use_noise_aware_loss: True
2025-06-13 20:32:25,346 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 20:32:25,352 ERROR Missing components: enhanced_srl_loss_raw, causal_consistency_loss_raw, noise_aware_loss_raw
2025-06-13 20:32:59,218 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 20:32:59,218 INFO Configuration - use_dual_path_srl: True
2025-06-13 20:32:59,218 INFO Configuration - use_enhanced_srl: True
2025-06-13 20:32:59,218 INFO Configuration - use_ca_tsu: True
2025-06-13 20:32:59,219 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 20:32:59,219 INFO Configuration - use_noise_aware_loss: True
2025-06-13 20:32:59,219 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 20:32:59,219 INFO Configuration - variant_type: hedge
2025-06-13 20:32:59,220 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 20:32:59,222 INFO Start graph assembling...
2025-06-13 20:33:01,094 INFO use_dual_path_srl: True
2025-06-13 20:33:01,094 INFO variant_type: hedge
2025-06-13 20:33:01,094 INFO use_enhanced_srl: True
2025-06-13 20:33:01,094 INFO Enhanced SRL enabled from config
2025-06-13 20:33:01,095 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 20:33:01,095 INFO SRL condition: True = True and True
2025-06-13 20:33:01,095 INFO Using enhanced dual-path SRL architecture
2025-06-13 20:33:01,095 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 20:33:01,147 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 20:33:01,152 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 20:33:01,175 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 20:33:01,416 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 20:33:01,417 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 20:33:01,418 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 20:33:01,846 INFO Using Temporal Attention (TAP)
2025-06-13 20:33:01,890 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 20:33:01,891 INFO Ca-TSU enabled: True
2025-06-13 20:33:01,891 INFO Ca-TSU weight: 0.3
2025-06-13 20:33:01,892 INFO Causal loss lambda: 0.3
2025-06-13 20:33:01,892 INFO Enhanced SRL enabled: True
2025-06-13 20:33:01,892 INFO Noise-Aware Loss enabled: True
2025-06-13 20:33:01,892 INFO Noise-Aware weight: 0.5
2025-06-13 20:33:01,903 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:01,904 INFO Creating enhanced SRL loss...
2025-06-13 20:33:01,904 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 20:33:01,907 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 20:33:01,916 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 20:33:01,926 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:01,927 INFO Creating reliability weights for noise-aware loss
2025-06-13 20:33:01,933 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 20:33:01,934 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 20:33:01,938 INFO Created W_reliability with shape: (100, 1)
2025-06-13 20:33:01,941 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 20:33:01,956 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 20:33:02,005 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 20:33:02,006 INFO Loss component verification:
2025-06-13 20:33:02,006 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 20:33:02,006 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 20:33:02,006 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 20:33:02,007 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 20:33:02,007 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 20:33:02,014 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:02,015 INFO Loss component verification:
2025-06-13 20:33:02,015 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 20:33:02,016 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 20:33:02,016 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 20:33:02,016 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 20:33:02,016 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 20:33:05,666 INFO Graph assembled successfully.
2025-06-13 20:33:05,992 INFO Verifying model configuration...
2025-06-13 20:33:05,992 INFO Ca-TSU enabled: True
2025-06-13 20:33:05,992 INFO Enhanced SRL enabled: True
2025-06-13 20:33:05,993 INFO Noise-Aware Loss enabled: True
2025-06-13 20:33:05,993 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 20:33:05,993 INFO Evaluation will be performed every 10 steps
2025-06-13 20:33:24,320 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:13:26,405 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:13:26,406 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:13:26,406 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:13:26,406 INFO Configuration - use_ca_tsu: True
2025-06-13 23:13:26,406 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:13:26,407 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:13:26,407 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:13:26,407 INFO Configuration - variant_type: hedge
2025-06-13 23:13:26,408 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:13:26,410 INFO Start graph assembling...
2025-06-13 23:13:28,109 INFO use_dual_path_srl: True
2025-06-13 23:13:28,109 INFO variant_type: hedge
2025-06-13 23:13:28,110 INFO use_enhanced_srl: True
2025-06-13 23:13:28,110 INFO Enhanced SRL enabled from config
2025-06-13 23:13:28,110 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:13:28,111 INFO SRL condition: True = True and True
2025-06-13 23:13:28,111 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:13:28,111 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:13:28,154 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:13:28,159 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:13:28,177 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:13:28,396 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:13:28,397 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:13:28,397 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:13:28,787 INFO Using Temporal Attention (TAP)
2025-06-13 23:13:28,830 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:13:28,831 INFO Ca-TSU enabled: True
2025-06-13 23:13:28,831 INFO Ca-TSU weight: 0.3
2025-06-13 23:13:28,831 INFO Causal loss lambda: 0.3
2025-06-13 23:13:28,831 INFO Enhanced SRL enabled: True
2025-06-13 23:13:28,832 INFO Noise-Aware Loss enabled: True
2025-06-13 23:13:28,832 INFO Noise-Aware weight: 0.5
2025-06-13 23:13:28,843 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,843 INFO Creating enhanced SRL loss...
2025-06-13 23:13:28,843 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:13:28,847 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:13:28,856 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:13:28,866 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,866 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:13:28,873 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:13:28,874 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:13:28,879 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:13:28,882 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:13:28,900 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:13:28,951 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:13:28,951 INFO Loss component verification:
2025-06-13 23:13:28,952 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:13:28,952 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:13:28,952 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:13:28,952 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:13:28,952 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:13:28,960 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,960 INFO Loss component verification:
2025-06-13 23:13:28,960 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:13:28,961 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:13:28,961 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:13:28,961 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:13:28,962 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:13:32,487 INFO Graph assembled successfully.
2025-06-13 23:13:32,807 INFO Verifying model configuration...
2025-06-13 23:13:32,808 INFO Ca-TSU enabled: True
2025-06-13 23:13:32,808 INFO Enhanced SRL enabled: True
2025-06-13 23:13:32,809 INFO Noise-Aware Loss enabled: True
2025-06-13 23:13:32,809 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:13:32,809 INFO Evaluation will be performed every 10 steps
2025-06-13 23:14:52,028 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:14:52,030 INFO Start graph assembling...
2025-06-13 23:14:53,705 INFO use_dual_path_srl: True
2025-06-13 23:14:53,706 INFO variant_type: hedge
2025-06-13 23:14:53,706 INFO use_enhanced_srl: True
2025-06-13 23:14:53,706 INFO Enhanced SRL enabled from config
2025-06-13 23:14:53,707 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:14:53,707 INFO SRL condition: True = True and True
2025-06-13 23:14:53,707 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:14:53,708 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:14:53,750 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:14:53,755 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:14:53,773 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:14:53,988 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:14:53,989 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:14:53,989 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:14:54,378 INFO Using Temporal Attention (TAP)
2025-06-13 23:14:54,422 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:14:54,422 INFO Ca-TSU enabled: True
2025-06-13 23:14:54,423 INFO Ca-TSU weight: 0.3
2025-06-13 23:14:54,423 INFO Causal loss lambda: 0.3
2025-06-13 23:14:54,423 INFO Enhanced SRL enabled: True
2025-06-13 23:14:54,424 INFO Noise-Aware Loss enabled: True
2025-06-13 23:14:54,424 INFO Noise-Aware weight: 0.5
2025-06-13 23:14:54,435 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,435 INFO Creating enhanced SRL loss...
2025-06-13 23:14:54,436 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:14:54,439 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:14:54,447 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:14:54,458 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,458 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:14:54,465 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:14:54,465 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:14:54,470 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:14:54,473 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:14:54,487 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:14:54,538 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:14:54,539 INFO Loss component verification:
2025-06-13 23:14:54,539 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:14:54,539 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:14:54,539 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:14:54,540 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:14:54,540 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:14:54,548 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,548 INFO Loss component verification:
2025-06-13 23:14:54,548 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:14:54,548 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:14:54,549 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:14:54,549 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:14:54,549 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:14:58,081 INFO Graph assembled successfully.
2025-06-13 23:14:58,402 INFO Verifying model configuration...
2025-06-13 23:14:58,402 INFO Ca-TSU enabled: True
2025-06-13 23:14:58,402 INFO Enhanced SRL enabled: True
2025-06-13 23:14:58,403 INFO Noise-Aware Loss enabled: True
2025-06-13 23:14:58,403 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:14:58,403 INFO Evaluation will be performed every 10 steps
2025-06-13 23:15:16,473 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:29:03,586 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:29:03,586 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:29:03,586 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:29:03,586 INFO Configuration - use_ca_tsu: True
2025-06-13 23:29:03,587 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:29:03,587 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:29:03,587 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:29:03,587 INFO Configuration - variant_type: hedge
2025-06-13 23:29:03,588 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:29:03,589 INFO Start graph assembling...
2025-06-13 23:29:05,368 INFO use_dual_path_srl: True
2025-06-13 23:29:05,368 INFO variant_type: hedge
2025-06-13 23:29:05,369 INFO use_enhanced_srl: True
2025-06-13 23:29:05,369 INFO Enhanced SRL enabled from config
2025-06-13 23:29:05,369 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:29:05,370 INFO SRL condition: True = True and True
2025-06-13 23:29:05,370 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:29:05,370 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:29:05,418 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:29:05,422 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:29:05,442 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:29:05,666 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:29:05,666 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:29:05,666 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:29:06,076 INFO Using Temporal Attention (TAP)
2025-06-13 23:29:06,120 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:29:06,121 INFO Ca-TSU enabled: True
2025-06-13 23:29:06,121 INFO Ca-TSU weight: 0.3
2025-06-13 23:29:06,121 INFO Causal loss lambda: 0.3
2025-06-13 23:29:06,122 INFO Enhanced SRL enabled: True
2025-06-13 23:29:06,122 INFO Noise-Aware Loss enabled: True
2025-06-13 23:29:06,122 INFO Noise-Aware weight: 0.5
2025-06-13 23:29:06,132 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,132 INFO Creating enhanced SRL loss...
2025-06-13 23:29:06,133 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:29:06,136 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:29:06,145 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:29:06,156 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,156 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:29:06,162 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:29:06,162 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:29:06,167 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:29:06,170 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:29:06,185 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:29:06,236 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:29:06,237 INFO Loss component verification:
2025-06-13 23:29:06,237 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:29:06,237 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:29:06,238 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:29:06,238 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:29:06,238 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:29:06,246 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,247 INFO Loss component verification:
2025-06-13 23:29:06,247 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:29:06,248 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:29:06,248 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:29:06,248 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:29:06,248 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:29:09,946 INFO Graph assembled successfully.
2025-06-13 23:29:10,568 INFO Verifying model configuration...
2025-06-13 23:29:10,570 INFO Ca-TSU enabled: True
2025-06-13 23:29:10,570 INFO Enhanced SRL enabled: True
2025-06-13 23:29:10,570 INFO Noise-Aware Loss enabled: True
2025-06-13 23:29:10,570 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:29:10,571 INFO Evaluation will be performed every 10 steps
2025-06-13 23:29:29,428 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:33:03,573 INFO Epoch: loss: 0.980134, acc: 0.515625
2025-06-13 23:35:01,616 INFO 	Eval, eval loss: 0.8753952383995056, acc: 0.518293
2025-06-13 23:35:01,883 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_233501.txt
2025-06-13 23:35:01,883 INFO Test completed successfully!
2025-06-13 23:38:30,045 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:38:30,045 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:38:30,045 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:38:30,046 INFO Configuration - use_ca_tsu: True
2025-06-13 23:38:30,046 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:38:30,046 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:38:30,046 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:38:30,046 INFO Configuration - variant_type: hedge
2025-06-13 23:38:30,047 INFO Full model configuration:
2025-06-13 23:38:30,047 INFO   alpha: 0.5
2025-06-13 23:38:30,047 INFO   batch_size: 32
2025-06-13 23:38:30,047 INFO   ca_tsu_weight: 0.3
2025-06-13 23:38:30,047 INFO   causal_loss_lambda: 0.3
2025-06-13 23:38:30,047 INFO   clip: 15.0
2025-06-13 23:38:30,048 INFO   consistency_loss_weight: 0.05
2025-06-13 23:38:30,048 INFO   constant_kl_lambda: 0.1
2025-06-13 23:38:30,048 INFO   daily_att: y
2025-06-13 23:38:30,048 INFO   decay_rate: 0.96
2025-06-13 23:38:30,048 INFO   decay_step: 100
2025-06-13 23:38:30,048 INFO   dropout_ce: 0.0
2025-06-13 23:38:30,049 INFO   dropout_mel: 0.0
2025-06-13 23:38:30,049 INFO   dropout_mel_in: 0.3
2025-06-13 23:38:30,049 INFO   dropout_vmd: 0.0
2025-06-13 23:38:30,049 INFO   dropout_vmd_in: 0.3
2025-06-13 23:38:30,049 INFO   enhanced_srl_weight: 0.1
2025-06-13 23:38:30,050 INFO   entropy_regularization_lambda: 0.001
2025-06-13 23:38:30,050 INFO   g_size: 50
2025-06-13 23:38:30,050 INFO   h_size: 150
2025-06-13 23:38:30,050 INFO   init_stock_with_word: 0
2025-06-13 23:38:30,050 INFO   kl_lambda_anneal_rate: 0.005
2025-06-13 23:38:30,050 INFO   kl_lambda_start_step: 0
2025-06-13 23:38:30,051 INFO   lr: 0.001
2025-06-13 23:38:30,051 INFO   max_n_days: 5
2025-06-13 23:38:30,051 INFO   max_n_msgs: 20
2025-06-13 23:38:30,051 INFO   max_n_words: 30
2025-06-13 23:38:30,051 INFO   mel_cell_type: gru
2025-06-13 23:38:30,052 INFO   mel_h_size: 100
2025-06-13 23:38:30,052 INFO   mode: all
2025-06-13 23:38:30,052 INFO   momentum: 0.9
2025-06-13 23:38:30,052 INFO   msin_h_size: 100
2025-06-13 23:38:30,052 INFO   n_epochs: 10
2025-06-13 23:38:30,052 INFO   noise_aware_weight: 0.5
2025-06-13 23:38:30,053 INFO   opt: adam
2025-06-13 23:38:30,053 INFO   pathway_competition_type: dynamic
2025-06-13 23:38:30,053 INFO   prediction_loss_weight: 0.1
2025-06-13 23:38:30,053 INFO   residual_connection_weight: 0.1
2025-06-13 23:38:30,053 INFO   shuffle: 1
2025-06-13 23:38:30,053 INFO   stock_embed_size: 150
2025-06-13 23:38:30,054 INFO   td_temporal_attention: True
2025-06-13 23:38:30,054 INFO   use_ca_tsu: True
2025-06-13 23:38:30,054 INFO   use_constant_kl_lambda: 0
2025-06-13 23:38:30,054 INFO   use_dual_path_srl: True
2025-06-13 23:38:30,054 INFO   use_enhanced_srl: True
2025-06-13 23:38:30,054 INFO   use_g_bn: 0
2025-06-13 23:38:30,055 INFO   use_in_bn: 0
2025-06-13 23:38:30,055 INFO   use_noise_aware_loss: True
2025-06-13 23:38:30,055 INFO   use_o_bn: 0
2025-06-13 23:38:30,055 INFO   variant_type: hedge
2025-06-13 23:38:30,055 INFO   vmd_cell_type: gru
2025-06-13 23:38:30,056 INFO   vmd_rec: zh
2025-06-13 23:38:30,056 INFO   volatility_adaptation_factor: 0.3
2025-06-13 23:38:30,056 INFO   volatility_reg_weight: 0.05
2025-06-13 23:38:30,056 INFO   weight_init: xavier-uniform
2025-06-13 23:38:30,056 INFO   word_embed_size: 50
2025-06-13 23:38:30,057 INFO   word_embed_type: glove
2025-06-13 23:38:30,057 INFO   y_size: 2
2025-06-13 23:38:30,057 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:38:30,060 INFO Start graph assembling...
2025-06-13 23:38:31,848 INFO use_dual_path_srl: True
2025-06-13 23:38:31,849 INFO variant_type: hedge
2025-06-13 23:38:31,849 INFO use_enhanced_srl: True
2025-06-13 23:38:31,849 INFO Enhanced SRL enabled from config
2025-06-13 23:38:31,849 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:38:31,849 INFO SRL condition: True = True and True
2025-06-13 23:38:31,850 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:38:31,850 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:38:31,895 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:38:31,899 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:38:31,918 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:38:32,143 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:38:32,143 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:38:32,144 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:38:32,566 INFO Using Temporal Attention (TAP)
2025-06-13 23:38:32,610 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:38:32,611 INFO Ca-TSU enabled: True
2025-06-13 23:38:32,611 INFO Ca-TSU weight: 0.3
2025-06-13 23:38:32,611 INFO Causal loss lambda: 0.3
2025-06-13 23:38:32,612 INFO Enhanced SRL enabled: True
2025-06-13 23:38:32,612 INFO Noise-Aware Loss enabled: True
2025-06-13 23:38:32,612 INFO Noise-Aware weight: 0.5
2025-06-13 23:38:32,622 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,623 INFO Creating enhanced SRL loss...
2025-06-13 23:38:32,623 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:38:32,626 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:38:32,635 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:38:32,646 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,646 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:38:32,652 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:38:32,653 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:38:32,658 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:38:32,660 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:38:32,675 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:38:32,726 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:38:32,726 INFO Loss component verification:
2025-06-13 23:38:32,727 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:38:32,727 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:38:32,727 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:38:32,727 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:38:32,727 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:38:32,735 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,735 INFO Loss component verification:
2025-06-13 23:38:32,735 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:38:32,736 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:38:32,736 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:38:32,736 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:38:32,736 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:38:36,649 INFO Graph assembled successfully.
2025-06-13 23:38:37,006 INFO Verifying model configuration...
2025-06-13 23:38:37,006 INFO Ca-TSU enabled: True
2025-06-13 23:38:37,007 INFO Enhanced SRL enabled: True
2025-06-13 23:38:37,007 INFO Noise-Aware Loss enabled: True
2025-06-13 23:38:37,007 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:38:37,007 INFO Evaluation will be performed every 10 steps
2025-06-13 23:38:57,467 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:43:03,260 INFO Epoch: loss: 0.950624, acc: 0.531250
2025-06-13 23:44:53,544 INFO 	Eval, eval loss: 0.8483394980430603, acc: 0.500000
2025-06-13 23:44:53,778 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_234453.txt
2025-06-13 23:44:53,779 INFO Test completed successfully!
2025-06-14 02:26:10,152 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 02:26:10,152 INFO Configuration - use_dual_path_srl: True
2025-06-14 02:26:10,153 INFO Configuration - use_enhanced_srl: True
2025-06-14 02:26:10,153 INFO Configuration - use_ca_tsu: True
2025-06-14 02:26:10,153 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 02:26:10,153 INFO Configuration - use_noise_aware_loss: True
2025-06-14 02:26:10,153 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 02:26:10,153 INFO Configuration - variant_type: hedge
2025-06-14 02:26:10,154 INFO Full model configuration:
2025-06-14 02:26:10,154 INFO   alpha: 0.5
2025-06-14 02:26:10,154 INFO   batch_size: 32
2025-06-14 02:26:10,154 INFO   ca_tsu_weight: 0.3
2025-06-14 02:26:10,155 INFO   causal_loss_lambda: 0.3
2025-06-14 02:26:10,155 INFO   clip: 15.0
2025-06-14 02:26:10,155 INFO   consistency_loss_weight: 0.05
2025-06-14 02:26:10,155 INFO   constant_kl_lambda: 0.1
2025-06-14 02:26:10,156 INFO   daily_att: y
2025-06-14 02:26:10,156 INFO   decay_rate: 0.96
2025-06-14 02:26:10,156 INFO   decay_step: 100
2025-06-14 02:26:10,156 INFO   dropout_ce: 0.0
2025-06-14 02:26:10,156 INFO   dropout_mel: 0.0
2025-06-14 02:26:10,157 INFO   dropout_mel_in: 0.3
2025-06-14 02:26:10,157 INFO   dropout_vmd: 0.0
2025-06-14 02:26:10,157 INFO   dropout_vmd_in: 0.3
2025-06-14 02:26:10,157 INFO   enhanced_srl_weight: 0.1
2025-06-14 02:26:10,157 INFO   entropy_regularization_lambda: 0.001
2025-06-14 02:26:10,158 INFO   g_size: 50
2025-06-14 02:26:10,158 INFO   h_size: 150
2025-06-14 02:26:10,158 INFO   init_stock_with_word: 0
2025-06-14 02:26:10,158 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 02:26:10,159 INFO   kl_lambda_start_step: 0
2025-06-14 02:26:10,159 INFO   lr: 0.001
2025-06-14 02:26:10,159 INFO   max_n_days: 5
2025-06-14 02:26:10,159 INFO   max_n_msgs: 20
2025-06-14 02:26:10,159 INFO   max_n_words: 30
2025-06-14 02:26:10,159 INFO   mel_cell_type: gru
2025-06-14 02:26:10,160 INFO   mel_h_size: 100
2025-06-14 02:26:10,160 INFO   mode: all
2025-06-14 02:26:10,160 INFO   momentum: 0.9
2025-06-14 02:26:10,160 INFO   msin_h_size: 100
2025-06-14 02:26:10,161 INFO   n_epochs: 10
2025-06-14 02:26:10,161 INFO   noise_aware_weight: 0.5
2025-06-14 02:26:10,161 INFO   opt: adam
2025-06-14 02:26:10,161 INFO   pathway_competition_type: dynamic
2025-06-14 02:26:10,161 INFO   prediction_loss_weight: 0.1
2025-06-14 02:26:10,162 INFO   residual_connection_weight: 0.1
2025-06-14 02:26:10,162 INFO   shuffle: 1
2025-06-14 02:26:10,162 INFO   stock_embed_size: 150
2025-06-14 02:26:10,162 INFO   td_temporal_attention: True
2025-06-14 02:26:10,162 INFO   use_ca_tsu: True
2025-06-14 02:26:10,163 INFO   use_constant_kl_lambda: 0
2025-06-14 02:26:10,163 INFO   use_dual_path_srl: True
2025-06-14 02:26:10,163 INFO   use_enhanced_srl: True
2025-06-14 02:26:10,163 INFO   use_g_bn: 0
2025-06-14 02:26:10,163 INFO   use_in_bn: 0
2025-06-14 02:26:10,164 INFO   use_noise_aware_loss: True
2025-06-14 02:26:10,164 INFO   use_o_bn: 0
2025-06-14 02:26:10,164 INFO   variant_type: hedge
2025-06-14 02:26:10,164 INFO   vmd_cell_type: gru
2025-06-14 02:26:10,164 INFO   vmd_rec: zh
2025-06-14 02:26:10,165 INFO   volatility_adaptation_factor: 0.3
2025-06-14 02:26:10,165 INFO   volatility_reg_weight: 0.05
2025-06-14 02:26:10,165 INFO   weight_init: xavier-uniform
2025-06-14 02:26:10,165 INFO   word_embed_size: 50
2025-06-14 02:26:10,165 INFO   word_embed_type: glove
2025-06-14 02:26:10,166 INFO   y_size: 2
2025-06-14 02:26:10,166 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 02:26:10,172 INFO Start graph assembling...
2025-06-14 02:26:11,941 INFO use_dual_path_srl: True
2025-06-14 02:26:11,942 INFO variant_type: hedge
2025-06-14 02:26:11,943 INFO use_enhanced_srl: True
2025-06-14 02:26:11,943 INFO Enhanced SRL enabled from config
2025-06-14 02:26:11,943 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 02:26:11,944 INFO SRL condition: True = True and True
2025-06-14 02:26:11,944 INFO Using enhanced dual-path SRL architecture
2025-06-14 02:26:11,944 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 02:26:11,989 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 02:26:11,994 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 02:26:12,013 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 02:26:12,236 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 02:26:12,236 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 02:26:12,236 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 02:26:12,636 INFO Using Temporal Attention (TAP)
2025-06-14 02:26:12,680 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 02:26:12,680 INFO Ca-TSU enabled: True
2025-06-14 02:26:12,680 INFO Ca-TSU weight: 0.3
2025-06-14 02:26:12,680 INFO Causal loss lambda: 0.3
2025-06-14 02:26:12,680 INFO Enhanced SRL enabled: True
2025-06-14 02:26:12,680 INFO Noise-Aware Loss enabled: True
2025-06-14 02:26:12,682 INFO Noise-Aware weight: 0.5
2025-06-14 02:26:12,692 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,693 INFO Creating enhanced SRL loss...
2025-06-14 02:26:12,693 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 02:26:12,697 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 02:26:12,706 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 02:26:12,718 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,718 INFO Creating reliability weights for noise-aware loss
2025-06-14 02:26:12,725 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:26:12,726 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 02:26:12,731 INFO Created W_reliability with shape: (100, 1)
2025-06-14 02:26:12,734 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:26:12,750 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 02:26:12,800 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 02:26:12,801 INFO Loss component verification:
2025-06-14 02:26:12,801 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:26:12,801 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:26:12,801 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:26:12,802 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:26:12,802 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:26:12,809 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,810 INFO Loss component verification:
2025-06-14 02:26:12,810 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:26:12,810 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:26:12,812 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:26:12,812 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:26:12,812 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:26:16,495 INFO Graph assembled successfully.
2025-06-14 02:26:16,820 INFO Verifying model configuration...
2025-06-14 02:26:16,820 INFO Ca-TSU enabled: True
2025-06-14 02:26:16,822 INFO Enhanced SRL enabled: True
2025-06-14 02:26:16,822 INFO Noise-Aware Loss enabled: True
2025-06-14 02:26:16,822 INFO Checking model components for noise-aware loss...
2025-06-14 02:26:16,822 INFO Model has 'use_noise_aware_loss': True
2025-06-14 02:26:16,822 INFO use_noise_aware_loss value: True
2025-06-14 02:26:16,823 INFO Model has 'noise_aware_weight': True
2025-06-14 02:26:16,823 INFO noise_aware_weight value: 0.5
2025-06-14 02:26:16,823 INFO Model has 'noise_aware_loss': True
2025-06-14 02:26:16,823 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 02:26:16,824 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 02:26:16,824 INFO Model has 'reliability_weights': True
2025-06-14 02:26:16,824 INFO Model has 'use_enhanced_srl': True
2025-06-14 02:26:16,824 INFO use_enhanced_srl value: True
2025-06-14 02:26:16,825 INFO Model has 'enhanced_srl_loss': True
2025-06-14 02:26:16,825 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 02:26:16,825 INFO Model has 'use_ca_tsu': True
2025-06-14 02:26:16,825 INFO use_ca_tsu value: True
2025-06-14 02:26:16,825 INFO Model has 'causal_consistency_loss': True
2025-06-14 02:26:16,826 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 02:26:16,826 INFO Model has 'loss_components': True
2025-06-14 02:26:16,826 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 02:26:16,826 INFO Manually activating loss components...
2025-06-14 02:26:16,826 INFO Components manually activated:
2025-06-14 02:26:16,827 INFO use_enhanced_srl: True
2025-06-14 02:26:16,827 INFO use_ca_tsu: True
2025-06-14 02:26:16,827 INFO use_noise_aware_loss: True
2025-06-14 02:26:16,827 INFO use_dual_path_srl: True
2025-06-14 02:26:16,827 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-14 02:26:16,828 INFO Evaluation will be performed every 10 steps
2025-06-14 02:26:36,444 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 02:31:17,270 INFO Epoch: loss: 0.958961, acc: 0.515625
2025-06-14 02:33:24,213 INFO 	Eval, eval loss: 0.8459105491638184, acc: 0.521341
2025-06-14 02:33:24,561 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_023324.txt
2025-06-14 02:33:24,562 INFO Test completed successfully!
2025-06-14 02:45:00,050 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 02:45:00,050 INFO Configuration - use_dual_path_srl: True
2025-06-14 02:45:00,052 INFO Configuration - use_enhanced_srl: True
2025-06-14 02:45:00,052 INFO Configuration - use_ca_tsu: True
2025-06-14 02:45:00,052 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 02:45:00,052 INFO Configuration - use_noise_aware_loss: True
2025-06-14 02:45:00,053 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 02:45:00,053 INFO Configuration - variant_type: hedge
2025-06-14 02:45:00,053 INFO Full model configuration:
2025-06-14 02:45:00,053 INFO   alpha: 0.5
2025-06-14 02:45:00,054 INFO   batch_size: 32
2025-06-14 02:45:00,054 INFO   ca_tsu_weight: 0.3
2025-06-14 02:45:00,054 INFO   causal_loss_lambda: 0.3
2025-06-14 02:45:00,054 INFO   clip: 15.0
2025-06-14 02:45:00,055 INFO   consistency_loss_weight: 0.05
2025-06-14 02:45:00,055 INFO   constant_kl_lambda: 0.1
2025-06-14 02:45:00,055 INFO   daily_att: y
2025-06-14 02:45:00,055 INFO   decay_rate: 0.96
2025-06-14 02:45:00,055 INFO   decay_step: 100
2025-06-14 02:45:00,056 INFO   dropout_ce: 0.0
2025-06-14 02:45:00,056 INFO   dropout_mel: 0.0
2025-06-14 02:45:00,056 INFO   dropout_mel_in: 0.3
2025-06-14 02:45:00,056 INFO   dropout_vmd: 0.0
2025-06-14 02:45:00,057 INFO   dropout_vmd_in: 0.3
2025-06-14 02:45:00,057 INFO   enhanced_srl_weight: 0.1
2025-06-14 02:45:00,057 INFO   entropy_regularization_lambda: 0.001
2025-06-14 02:45:00,057 INFO   g_size: 50
2025-06-14 02:45:00,058 INFO   h_size: 150
2025-06-14 02:45:00,058 INFO   init_stock_with_word: 0
2025-06-14 02:45:00,058 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 02:45:00,058 INFO   kl_lambda_start_step: 0
2025-06-14 02:45:00,058 INFO   lr: 0.001
2025-06-14 02:45:00,059 INFO   max_n_days: 5
2025-06-14 02:45:00,059 INFO   max_n_msgs: 20
2025-06-14 02:45:00,059 INFO   max_n_words: 30
2025-06-14 02:45:00,059 INFO   mel_cell_type: gru
2025-06-14 02:45:00,060 INFO   mel_h_size: 100
2025-06-14 02:45:00,060 INFO   mode: all
2025-06-14 02:45:00,060 INFO   momentum: 0.9
2025-06-14 02:45:00,060 INFO   msin_h_size: 100
2025-06-14 02:45:00,061 INFO   n_epochs: 10
2025-06-14 02:45:00,061 INFO   noise_aware_weight: 0.5
2025-06-14 02:45:00,061 INFO   opt: adam
2025-06-14 02:45:00,061 INFO   pathway_competition_type: dynamic
2025-06-14 02:45:00,062 INFO   prediction_loss_weight: 0.1
2025-06-14 02:45:00,062 INFO   residual_connection_weight: 0.1
2025-06-14 02:45:00,062 INFO   shuffle: 1
2025-06-14 02:45:00,062 INFO   stock_embed_size: 150
2025-06-14 02:45:00,062 INFO   td_temporal_attention: True
2025-06-14 02:45:00,062 INFO   use_ca_tsu: True
2025-06-14 02:45:00,063 INFO   use_constant_kl_lambda: 0
2025-06-14 02:45:00,063 INFO   use_dual_path_srl: True
2025-06-14 02:45:00,063 INFO   use_enhanced_srl: True
2025-06-14 02:45:00,063 INFO   use_g_bn: 0
2025-06-14 02:45:00,063 INFO   use_in_bn: 0
2025-06-14 02:45:00,064 INFO   use_noise_aware_loss: True
2025-06-14 02:45:00,064 INFO   use_o_bn: 0
2025-06-14 02:45:00,064 INFO   variant_type: hedge
2025-06-14 02:45:00,064 INFO   vmd_cell_type: gru
2025-06-14 02:45:00,064 INFO   vmd_rec: zh
2025-06-14 02:45:00,065 INFO   volatility_adaptation_factor: 0.3
2025-06-14 02:45:00,065 INFO   volatility_reg_weight: 0.05
2025-06-14 02:45:00,065 INFO   weight_init: xavier-uniform
2025-06-14 02:45:00,065 INFO   word_embed_size: 50
2025-06-14 02:45:00,066 INFO   word_embed_type: glove
2025-06-14 02:45:00,066 INFO   y_size: 2
2025-06-14 02:45:00,067 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 02:45:00,069 INFO Start graph assembling...
2025-06-14 02:45:01,955 INFO use_dual_path_srl: True
2025-06-14 02:45:01,956 INFO variant_type: hedge
2025-06-14 02:45:01,956 INFO use_enhanced_srl: True
2025-06-14 02:45:01,956 INFO Enhanced SRL enabled from config
2025-06-14 02:45:01,956 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 02:45:01,956 INFO SRL condition: True = True and True
2025-06-14 02:45:01,956 INFO Using enhanced dual-path SRL architecture
2025-06-14 02:45:01,957 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 02:45:02,000 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 02:45:02,006 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 02:45:02,024 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 02:45:02,250 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 02:45:02,250 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 02:45:02,251 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 02:45:02,660 INFO Using Temporal Attention (TAP)
2025-06-14 02:45:02,703 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 02:45:02,704 INFO Ca-TSU enabled: True
2025-06-14 02:45:02,704 INFO Ca-TSU weight: 0.3
2025-06-14 02:45:02,704 INFO Causal loss lambda: 0.3
2025-06-14 02:45:02,704 INFO Enhanced SRL enabled: True
2025-06-14 02:45:02,705 INFO Noise-Aware Loss enabled: True
2025-06-14 02:45:02,705 INFO Noise-Aware weight: 0.5
2025-06-14 02:45:02,715 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,716 INFO Creating enhanced SRL loss...
2025-06-14 02:45:02,716 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 02:45:02,719 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 02:45:02,727 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 02:45:02,738 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,738 INFO Creating reliability weights for noise-aware loss
2025-06-14 02:45:02,744 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:45:02,745 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 02:45:02,750 INFO Created W_reliability with shape: (100, 1)
2025-06-14 02:45:02,752 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:45:02,769 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 02:45:02,819 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 02:45:02,819 INFO Loss component verification:
2025-06-14 02:45:02,819 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:45:02,820 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:45:02,820 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:45:02,820 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:45:02,820 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:45:02,828 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,828 INFO Loss component verification:
2025-06-14 02:45:02,828 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:45:02,829 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:45:02,829 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:45:02,829 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:45:02,829 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:45:07,349 INFO Graph assembled successfully.
2025-06-14 02:45:07,691 INFO Verifying model configuration...
2025-06-14 02:45:07,692 INFO Ca-TSU enabled: True
2025-06-14 02:45:07,692 INFO Enhanced SRL enabled: True
2025-06-14 02:45:07,692 INFO Noise-Aware Loss enabled: True
2025-06-14 02:45:07,694 INFO Checking model components for noise-aware loss...
2025-06-14 02:45:07,694 INFO Model has 'use_noise_aware_loss': True
2025-06-14 02:45:07,695 INFO use_noise_aware_loss value: True
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_weight': True
2025-06-14 02:45:07,695 INFO noise_aware_weight value: 0.5
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_loss': True
2025-06-14 02:45:07,695 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 02:45:07,696 INFO Model has 'reliability_weights': True
2025-06-14 02:45:07,696 INFO Model has 'use_enhanced_srl': True
2025-06-14 02:45:07,696 INFO use_enhanced_srl value: True
2025-06-14 02:45:07,696 INFO Model has 'enhanced_srl_loss': True
2025-06-14 02:45:07,697 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 02:45:07,697 INFO Model has 'use_ca_tsu': True
2025-06-14 02:45:07,697 INFO use_ca_tsu value: True
2025-06-14 02:45:07,697 INFO Model has 'causal_consistency_loss': True
2025-06-14 02:45:07,697 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 02:45:07,697 INFO Model has 'loss_components': True
2025-06-14 02:45:07,698 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 02:45:07,698 INFO Manually activating loss components...
2025-06-14 02:45:07,698 INFO Components manually activated:
2025-06-14 02:45:07,698 INFO use_enhanced_srl: True
2025-06-14 02:45:07,698 INFO use_ca_tsu: True
2025-06-14 02:45:07,699 INFO use_noise_aware_loss: True
2025-06-14 02:45:07,699 INFO use_dual_path_srl: True
2025-06-14 02:45:07,699 INFO Running test_noise_aware_loss...
2025-06-14 02:45:27,274 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 02:49:57,864 INFO Epoch: loss: 0.994126, acc: 0.540625
2025-06-14 02:52:07,056 INFO 	Eval, eval loss: 0.8706127405166626, acc: 0.510671
2025-06-14 02:52:07,326 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_025207.txt
2025-06-14 02:52:07,327 INFO Test completed successfully!
2025-06-14 03:10:31,188 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 03:10:31,189 INFO Configuration - use_dual_path_srl: True
2025-06-14 03:10:31,189 INFO Configuration - use_enhanced_srl: True
2025-06-14 03:10:31,189 INFO Configuration - use_ca_tsu: True
2025-06-14 03:10:31,189 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 03:10:31,189 INFO Configuration - use_noise_aware_loss: True
2025-06-14 03:10:31,190 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 03:10:31,190 INFO Configuration - variant_type: hedge
2025-06-14 03:10:31,190 INFO Full model configuration:
2025-06-14 03:10:31,190 INFO   alpha: 0.5
2025-06-14 03:10:31,190 INFO   batch_size: 32
2025-06-14 03:10:31,191 INFO   ca_tsu_weight: 0.3
2025-06-14 03:10:31,191 INFO   causal_loss_lambda: 0.3
2025-06-14 03:10:31,191 INFO   clip: 15.0
2025-06-14 03:10:31,191 INFO   consistency_loss_weight: 0.05
2025-06-14 03:10:31,191 INFO   constant_kl_lambda: 0.1
2025-06-14 03:10:31,191 INFO   daily_att: y
2025-06-14 03:10:31,192 INFO   decay_rate: 0.96
2025-06-14 03:10:31,192 INFO   decay_step: 100
2025-06-14 03:10:31,192 INFO   dropout_ce: 0.0
2025-06-14 03:10:31,192 INFO   dropout_mel: 0.0
2025-06-14 03:10:31,192 INFO   dropout_mel_in: 0.3
2025-06-14 03:10:31,192 INFO   dropout_vmd: 0.0
2025-06-14 03:10:31,192 INFO   dropout_vmd_in: 0.3
2025-06-14 03:10:31,192 INFO   enhanced_srl_weight: 0.1
2025-06-14 03:10:31,193 INFO   entropy_regularization_lambda: 0.001
2025-06-14 03:10:31,193 INFO   g_size: 50
2025-06-14 03:10:31,193 INFO   h_size: 150
2025-06-14 03:10:31,193 INFO   init_stock_with_word: 0
2025-06-14 03:10:31,193 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 03:10:31,194 INFO   kl_lambda_start_step: 0
2025-06-14 03:10:31,194 INFO   lr: 0.001
2025-06-14 03:10:31,194 INFO   max_n_days: 5
2025-06-14 03:10:31,194 INFO   max_n_msgs: 20
2025-06-14 03:10:31,195 INFO   max_n_words: 30
2025-06-14 03:10:31,195 INFO   mel_cell_type: gru
2025-06-14 03:10:31,195 INFO   mel_h_size: 100
2025-06-14 03:10:31,195 INFO   mode: all
2025-06-14 03:10:31,195 INFO   momentum: 0.9
2025-06-14 03:10:31,196 INFO   msin_h_size: 100
2025-06-14 03:10:31,196 INFO   n_epochs: 10
2025-06-14 03:10:31,196 INFO   noise_aware_weight: 0.5
2025-06-14 03:10:31,196 INFO   opt: adam
2025-06-14 03:10:31,196 INFO   pathway_competition_type: dynamic
2025-06-14 03:10:31,196 INFO   prediction_loss_weight: 0.1
2025-06-14 03:10:31,197 INFO   residual_connection_weight: 0.1
2025-06-14 03:10:31,197 INFO   shuffle: 1
2025-06-14 03:10:31,197 INFO   stock_embed_size: 150
2025-06-14 03:10:31,197 INFO   td_temporal_attention: True
2025-06-14 03:10:31,197 INFO   use_ca_tsu: True
2025-06-14 03:10:31,197 INFO   use_constant_kl_lambda: 0
2025-06-14 03:10:31,198 INFO   use_dual_path_srl: True
2025-06-14 03:10:31,198 INFO   use_enhanced_srl: True
2025-06-14 03:10:31,198 INFO   use_g_bn: 0
2025-06-14 03:10:31,198 INFO   use_in_bn: 0
2025-06-14 03:10:31,198 INFO   use_noise_aware_loss: True
2025-06-14 03:10:31,199 INFO   use_o_bn: 0
2025-06-14 03:10:31,199 INFO   variant_type: hedge
2025-06-14 03:10:31,199 INFO   vmd_cell_type: gru
2025-06-14 03:10:31,199 INFO   vmd_rec: zh
2025-06-14 03:10:31,199 INFO   volatility_adaptation_factor: 0.3
2025-06-14 03:10:31,200 INFO   volatility_reg_weight: 0.05
2025-06-14 03:10:31,200 INFO   weight_init: xavier-uniform
2025-06-14 03:10:31,200 INFO   word_embed_size: 50
2025-06-14 03:10:31,200 INFO   word_embed_type: glove
2025-06-14 03:10:31,200 INFO   y_size: 2
2025-06-14 03:10:31,201 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 03:10:31,203 INFO Start graph assembling...
2025-06-14 03:10:32,965 INFO use_dual_path_srl: True
2025-06-14 03:10:32,965 INFO variant_type: hedge
2025-06-14 03:10:32,965 INFO use_enhanced_srl: True
2025-06-14 03:10:32,966 INFO Enhanced SRL enabled from config
2025-06-14 03:10:32,966 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 03:10:32,966 INFO SRL condition: True = True and True
2025-06-14 03:10:32,966 INFO Using enhanced dual-path SRL architecture
2025-06-14 03:10:32,966 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 03:10:33,012 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 03:10:33,017 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 03:10:33,038 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 03:10:33,261 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 03:10:33,261 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 03:10:33,262 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 03:10:33,671 INFO Using Temporal Attention (TAP)
2025-06-14 03:10:33,715 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 03:10:33,716 INFO Ca-TSU enabled: True
2025-06-14 03:10:33,716 INFO Ca-TSU weight: 0.3
2025-06-14 03:10:33,716 INFO Causal loss lambda: 0.3
2025-06-14 03:10:33,717 INFO Enhanced SRL enabled: True
2025-06-14 03:10:33,717 INFO Noise-Aware Loss enabled: True
2025-06-14 03:10:33,717 INFO Noise-Aware weight: 0.5
2025-06-14 03:10:33,726 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,727 INFO Creating enhanced SRL loss...
2025-06-14 03:10:33,727 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 03:10:33,730 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 03:10:33,739 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 03:10:33,749 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,749 INFO Creating reliability weights for noise-aware loss
2025-06-14 03:10:33,755 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 03:10:33,756 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 03:10:33,761 INFO Created W_reliability with shape: (100, 1)
2025-06-14 03:10:33,763 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 03:10:33,778 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 03:10:33,828 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 03:10:33,828 INFO Loss component verification:
2025-06-14 03:10:33,829 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 03:10:33,829 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 03:10:33,829 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 03:10:33,829 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 03:10:33,829 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 03:10:33,836 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,837 INFO Loss component verification:
2025-06-14 03:10:33,837 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 03:10:33,838 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 03:10:33,838 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 03:10:33,838 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 03:10:33,838 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 03:10:38,069 INFO Graph assembled successfully.
2025-06-14 03:10:38,506 INFO Verifying model configuration...
2025-06-14 03:10:38,506 INFO Ca-TSU enabled: True
2025-06-14 03:10:38,506 INFO Enhanced SRL enabled: True
2025-06-14 03:10:38,507 INFO Noise-Aware Loss enabled: True
2025-06-14 03:10:38,507 INFO Checking model components for noise-aware loss...
2025-06-14 03:10:38,507 INFO Model has 'use_noise_aware_loss': True
2025-06-14 03:10:38,507 INFO use_noise_aware_loss value: True
2025-06-14 03:10:38,508 INFO Model has 'noise_aware_weight': True
2025-06-14 03:10:38,508 INFO noise_aware_weight value: 0.5
2025-06-14 03:10:38,508 INFO Model has 'noise_aware_loss': True
2025-06-14 03:10:38,508 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 03:10:38,509 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 03:10:38,509 INFO Model has 'reliability_weights': True
2025-06-14 03:10:38,509 INFO Model has 'use_enhanced_srl': True
2025-06-14 03:10:38,509 INFO use_enhanced_srl value: True
2025-06-14 03:10:38,509 INFO Model has 'enhanced_srl_loss': True
2025-06-14 03:10:38,510 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 03:10:38,510 INFO Model has 'use_ca_tsu': True
2025-06-14 03:10:38,510 INFO use_ca_tsu value: True
2025-06-14 03:10:38,511 INFO Model has 'causal_consistency_loss': True
2025-06-14 03:10:38,511 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 03:10:38,511 INFO Model has 'loss_components': True
2025-06-14 03:10:38,511 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 03:10:38,512 INFO Manually activating loss components...
2025-06-14 03:10:38,512 INFO Components manually activated:
2025-06-14 03:10:38,512 INFO use_enhanced_srl: True
2025-06-14 03:10:38,512 INFO use_ca_tsu: True
2025-06-14 03:10:38,512 INFO use_noise_aware_loss: True
2025-06-14 03:10:38,513 INFO use_dual_path_srl: True
2025-06-14 03:10:38,513 INFO Running test_noise_aware_loss...
2025-06-14 03:10:57,603 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 03:16:45,993 INFO 	Eval, eval loss: 0.9241406321525574, acc: 0.490854
2025-06-14 03:16:46,258 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_031646.txt
2025-06-14 03:16:46,258 INFO Test completed successfully!
2025-06-15 13:31:32,653 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 13:31:32,654 INFO Configuration - use_dual_path_srl: True
2025-06-15 13:31:32,654 INFO Configuration - use_enhanced_srl: True
2025-06-15 13:31:32,654 INFO Configuration - use_ca_tsu: True
2025-06-15 13:31:32,654 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 13:31:32,655 INFO Configuration - use_noise_aware_loss: True
2025-06-15 13:31:32,655 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 13:31:32,655 INFO Configuration - variant_type: hedge
2025-06-15 13:31:32,655 INFO Full model configuration:
2025-06-15 13:31:32,655 INFO   alpha: 0.5
2025-06-15 13:31:32,655 INFO   batch_size: 32
2025-06-15 13:31:32,656 INFO   ca_tsu_weight: 0.3
2025-06-15 13:31:32,656 INFO   causal_loss_lambda: 0.3
2025-06-15 13:31:32,656 INFO   clip: 15.0
2025-06-15 13:31:32,656 INFO   consistency_loss_weight: 0.05
2025-06-15 13:31:32,656 INFO   constant_kl_lambda: 0.1
2025-06-15 13:31:32,657 INFO   daily_att: y
2025-06-15 13:31:32,657 INFO   decay_rate: 0.96
2025-06-15 13:31:32,657 INFO   decay_step: 100
2025-06-15 13:31:32,657 INFO   dropout_ce: 0.0
2025-06-15 13:31:32,657 INFO   dropout_mel: 0.0
2025-06-15 13:31:32,658 INFO   dropout_mel_in: 0.3
2025-06-15 13:31:32,658 INFO   dropout_vmd: 0.0
2025-06-15 13:31:32,658 INFO   dropout_vmd_in: 0.3
2025-06-15 13:31:32,658 INFO   enhanced_srl_weight: 0.1
2025-06-15 13:31:32,659 INFO   entropy_regularization_lambda: 0.001
2025-06-15 13:31:32,659 INFO   g_size: 50
2025-06-15 13:31:32,659 INFO   h_size: 150
2025-06-15 13:31:32,659 INFO   init_stock_with_word: 0
2025-06-15 13:31:32,659 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 13:31:32,660 INFO   kl_lambda_start_step: 0
2025-06-15 13:31:32,660 INFO   lr: 0.001
2025-06-15 13:31:32,660 INFO   max_n_days: 5
2025-06-15 13:31:32,660 INFO   max_n_msgs: 20
2025-06-15 13:31:32,660 INFO   max_n_words: 30
2025-06-15 13:31:32,662 INFO   mel_cell_type: gru
2025-06-15 13:31:32,662 INFO   mel_h_size: 100
2025-06-15 13:31:32,662 INFO   mode: all
2025-06-15 13:31:32,662 INFO   momentum: 0.9
2025-06-15 13:31:32,662 INFO   msin_h_size: 100
2025-06-15 13:31:32,663 INFO   n_epochs: 10
2025-06-15 13:31:32,663 INFO   noise_aware_weight: 0.5
2025-06-15 13:31:32,663 INFO   opt: adam
2025-06-15 13:31:32,663 INFO   pathway_competition_type: dynamic
2025-06-15 13:31:32,664 INFO   prediction_loss_weight: 0.1
2025-06-15 13:31:32,664 INFO   residual_connection_weight: 0.1
2025-06-15 13:31:32,664 INFO   shuffle: 1
2025-06-15 13:31:32,664 INFO   stock_embed_size: 150
2025-06-15 13:31:32,665 INFO   td_temporal_attention: True
2025-06-15 13:31:32,665 INFO   use_ca_tsu: True
2025-06-15 13:31:32,665 INFO   use_constant_kl_lambda: 0
2025-06-15 13:31:32,665 INFO   use_dual_path_srl: True
2025-06-15 13:31:32,665 INFO   use_enhanced_srl: True
2025-06-15 13:31:32,665 INFO   use_g_bn: 0
2025-06-15 13:31:32,666 INFO   use_in_bn: 0
2025-06-15 13:31:32,666 INFO   use_noise_aware_loss: True
2025-06-15 13:31:32,666 INFO   use_o_bn: 0
2025-06-15 13:31:32,666 INFO   variant_type: hedge
2025-06-15 13:31:32,666 INFO   vmd_cell_type: gru
2025-06-15 13:31:32,667 INFO   vmd_rec: zh
2025-06-15 13:31:32,667 INFO   volatility_adaptation_factor: 0.3
2025-06-15 13:31:32,667 INFO   volatility_reg_weight: 0.05
2025-06-15 13:31:32,667 INFO   weight_init: xavier-uniform
2025-06-15 13:31:32,667 INFO   word_embed_size: 50
2025-06-15 13:31:32,668 INFO   word_embed_type: glove
2025-06-15 13:31:32,668 INFO   y_size: 2
2025-06-15 13:31:32,669 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 13:31:32,676 INFO Start graph assembling...
2025-06-15 13:31:34,388 INFO use_dual_path_srl: True
2025-06-15 13:31:34,388 INFO variant_type: hedge
2025-06-15 13:31:34,388 INFO use_enhanced_srl: True
2025-06-15 13:31:34,389 INFO Enhanced SRL enabled from config
2025-06-15 13:31:34,389 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 13:31:34,389 INFO SRL condition: True = True and True
2025-06-15 13:31:34,390 INFO Using enhanced dual-path SRL architecture
2025-06-15 13:31:34,390 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 13:31:34,435 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 13:31:34,439 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 13:31:34,460 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 13:31:34,674 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 13:31:34,675 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 13:31:34,675 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 13:31:35,064 INFO Using Temporal Attention (TAP)
2025-06-15 13:31:35,110 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-15 13:31:35,110 INFO Ca-TSU enabled: True
2025-06-15 13:31:35,111 INFO Ca-TSU weight: 0.3
2025-06-15 13:31:35,111 INFO Causal loss lambda: 0.3
2025-06-15 13:31:35,111 INFO Enhanced SRL enabled: True
2025-06-15 13:31:35,111 INFO Noise-Aware Loss enabled: True
2025-06-15 13:31:35,111 INFO Noise-Aware weight: 0.5
2025-06-15 13:31:35,122 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,122 INFO Creating enhanced SRL loss...
2025-06-15 13:31:35,123 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-15 13:31:35,126 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-15 13:31:35,133 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-15 13:31:35,146 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,147 INFO Creating reliability weights for noise-aware loss
2025-06-15 13:31:35,153 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-15 13:31:35,154 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-15 13:31:35,158 INFO Created W_reliability with shape: (100, 1)
2025-06-15 13:31:35,161 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-15 13:31:35,176 INFO Adding causal consistency loss with lambda: 0.3
2025-06-15 13:31:35,227 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-15 13:31:35,228 INFO Loss component verification:
2025-06-15 13:31:35,228 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-15 13:31:35,229 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-15 13:31:35,229 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-15 13:31:35,229 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-15 13:31:35,229 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-15 13:31:35,237 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,237 INFO Loss component verification:
2025-06-15 13:31:35,237 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-15 13:31:35,237 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-15 13:31:35,237 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-15 13:31:35,238 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-15 13:31:35,238 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-15 13:31:38,727 INFO Graph assembled successfully.
2025-06-15 13:31:39,045 INFO Verifying model configuration...
2025-06-15 13:31:39,045 INFO Ca-TSU enabled: True
2025-06-15 13:31:39,045 INFO Enhanced SRL enabled: True
2025-06-15 13:31:39,046 INFO Noise-Aware Loss enabled: True
2025-06-15 13:31:39,046 INFO Checking model components for noise-aware loss...
2025-06-15 13:31:39,047 INFO Model has 'use_noise_aware_loss': True
2025-06-15 13:31:39,047 INFO use_noise_aware_loss value: True
2025-06-15 13:31:39,047 INFO Model has 'noise_aware_weight': True
2025-06-15 13:31:39,047 INFO noise_aware_weight value: 0.5
2025-06-15 13:31:39,048 INFO Model has 'noise_aware_loss': True
2025-06-15 13:31:39,048 INFO Model has 'separate_noise_aware_loss': True
2025-06-15 13:31:39,048 INFO Model has 'noise_aware_loss_raw': True
2025-06-15 13:31:39,048 INFO Model has 'reliability_weights': True
2025-06-15 13:31:39,048 INFO Model has 'use_enhanced_srl': True
2025-06-15 13:31:39,049 INFO use_enhanced_srl value: True
2025-06-15 13:31:39,049 INFO Model has 'enhanced_srl_loss': True
2025-06-15 13:31:39,049 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-15 13:31:39,049 INFO Model has 'use_ca_tsu': True
2025-06-15 13:31:39,049 INFO use_ca_tsu value: True
2025-06-15 13:31:39,049 INFO Model has 'causal_consistency_loss': True
2025-06-15 13:31:39,049 INFO Model has 'causal_consistency_loss_raw': True
2025-06-15 13:31:39,049 INFO Model has 'loss_components': True
2025-06-15 13:31:39,049 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-15 13:31:39,051 INFO Manually activating loss components...
2025-06-15 13:31:39,051 INFO Components manually activated:
2025-06-15 13:31:39,051 INFO use_enhanced_srl: True
2025-06-15 13:31:39,051 INFO use_ca_tsu: True
2025-06-15 13:31:39,052 INFO use_noise_aware_loss: True
2025-06-15 13:31:39,052 INFO use_dual_path_srl: True
2025-06-15 13:31:39,052 INFO Running test_noise_aware_loss...
2025-06-15 13:31:58,890 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 13:37:32,281 INFO 	Eval, eval loss: 0.8381810188293457, acc: 0.501524
2025-06-15 13:37:32,496 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_133732.txt
2025-06-15 13:37:32,497 INFO Test completed successfully!
2025-06-15 17:55:20,854 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 17:55:20,854 INFO Configuration - use_dual_path_srl: True
2025-06-15 17:55:20,855 INFO Configuration - use_enhanced_srl: True
2025-06-15 17:55:20,855 INFO Configuration - use_ca_tsu: True
2025-06-15 17:55:20,855 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 17:55:20,855 INFO Configuration - use_noise_aware_loss: True
2025-06-15 17:55:20,856 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 17:55:20,856 INFO Configuration - variant_type: hedge
2025-06-15 17:55:20,856 INFO Full model configuration:
2025-06-15 17:55:20,856 INFO   alpha: 0.5
2025-06-15 17:55:20,856 INFO   batch_size: 32
2025-06-15 17:55:20,857 INFO   ca_tsu_weight: 0.3
2025-06-15 17:55:20,857 INFO   causal_loss_lambda: 0.3
2025-06-15 17:55:20,857 INFO   clip: 15.0
2025-06-15 17:55:20,857 INFO   consistency_loss_weight: 0.05
2025-06-15 17:55:20,857 INFO   constant_kl_lambda: 0.1
2025-06-15 17:55:20,858 INFO   daily_att: y
2025-06-15 17:55:20,858 INFO   decay_rate: 0.96
2025-06-15 17:55:20,858 INFO   decay_step: 100
2025-06-15 17:55:20,858 INFO   dropout_ce: 0.0
2025-06-15 17:55:20,858 INFO   dropout_mel: 0.0
2025-06-15 17:55:20,858 INFO   dropout_mel_in: 0.3
2025-06-15 17:55:20,859 INFO   dropout_vmd: 0.0
2025-06-15 17:55:20,859 INFO   dropout_vmd_in: 0.3
2025-06-15 17:55:20,859 INFO   enhanced_srl_weight: 0.1
2025-06-15 17:55:20,859 INFO   entropy_regularization_lambda: 0.001
2025-06-15 17:55:20,859 INFO   g_size: 50
2025-06-15 17:55:20,860 INFO   h_size: 150
2025-06-15 17:55:20,860 INFO   init_stock_with_word: 0
2025-06-15 17:55:20,860 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 17:55:20,860 INFO   kl_lambda_start_step: 0
2025-06-15 17:55:20,861 INFO   lr: 0.001
2025-06-15 17:55:20,861 INFO   max_n_days: 5
2025-06-15 17:55:20,861 INFO   max_n_msgs: 20
2025-06-15 17:55:20,861 INFO   max_n_words: 30
2025-06-15 17:55:20,862 INFO   mel_cell_type: gru
2025-06-15 17:55:20,862 INFO   mel_h_size: 100
2025-06-15 17:55:20,862 INFO   mode: all
2025-06-15 17:55:20,862 INFO   momentum: 0.9
2025-06-15 17:55:20,862 INFO   msin_h_size: 100
2025-06-15 17:55:20,862 INFO   n_epochs: 10
2025-06-15 17:55:20,862 INFO   noise_aware_weight: 0.5
2025-06-15 17:55:20,863 INFO   opt: adam
2025-06-15 17:55:20,863 INFO   pathway_competition_type: dynamic
2025-06-15 17:55:20,863 INFO   prediction_loss_weight: 0.1
2025-06-15 17:55:20,863 INFO   residual_connection_weight: 0.1
2025-06-15 17:55:20,864 INFO   shuffle: 1
2025-06-15 17:55:20,864 INFO   stock_embed_size: 150
2025-06-15 17:55:20,864 INFO   td_temporal_attention: True
2025-06-15 17:55:20,864 INFO   use_ca_tsu: True
2025-06-15 17:55:20,865 INFO   use_constant_kl_lambda: 0
2025-06-15 17:55:20,865 INFO   use_dual_path_srl: True
2025-06-15 17:55:20,865 INFO   use_enhanced_srl: True
2025-06-15 17:55:20,865 INFO   use_g_bn: 0
2025-06-15 17:55:20,865 INFO   use_in_bn: 0
2025-06-15 17:55:20,865 INFO   use_noise_aware_loss: True
2025-06-15 17:55:20,866 INFO   use_o_bn: 0
2025-06-15 17:55:20,866 INFO   variant_type: hedge
2025-06-15 17:55:20,866 INFO   vmd_cell_type: gru
2025-06-15 17:55:20,866 INFO   vmd_rec: zh
2025-06-15 17:55:20,866 INFO   volatility_adaptation_factor: 0.3
2025-06-15 17:55:20,866 INFO   volatility_reg_weight: 0.05
2025-06-15 17:55:20,866 INFO   weight_init: xavier-uniform
2025-06-15 17:55:20,866 INFO   word_embed_size: 50
2025-06-15 17:55:20,868 INFO   word_embed_type: glove
2025-06-15 17:55:20,868 INFO   y_size: 2
2025-06-15 17:55:20,869 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 17:55:20,875 INFO Start graph assembling...
2025-06-15 17:55:22,681 INFO use_dual_path_srl: True
2025-06-15 17:55:22,682 INFO variant_type: hedge
2025-06-15 17:55:22,682 INFO use_enhanced_srl: True
2025-06-15 17:55:22,682 INFO Enhanced SRL enabled from config
2025-06-15 17:55:22,682 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 17:55:22,683 INFO SRL condition: True = True and True
2025-06-15 17:55:22,683 INFO Using enhanced dual-path SRL architecture
2025-06-15 17:55:22,683 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 17:55:22,729 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 17:55:22,734 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 17:55:22,755 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 17:55:22,978 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 17:55:22,978 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 17:55:22,979 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 17:55:23,402 INFO Using Temporal Attention (TAP)
2025-06-15 17:55:23,447 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 17:55:23,447 INFO Ca-TSU enabled: True
2025-06-15 17:55:23,448 INFO Enhanced SRL enabled: True
2025-06-15 17:55:23,448 INFO Noise-Aware Loss enabled: True
2025-06-15 17:55:23,459 ERROR Error running test: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].
2025-06-15 17:55:23,466 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 34, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1510, in assemble_graph
    self._build_ata()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1295, in _build_ata
    self._create_generative_ata()  # This now sets self.loss to the generative objective
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1206, in _create_generative_ata
    kl_T = tf.gather_nd(self.kl, indexed_T_kl) # Shape: [batch_size]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 1970, in gather_nd
    "GatherNd", params=params, indices=indices, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 691, in _call_cpp_shape_fn_impl
    raise ValueError(err.message)
ValueError: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].

2025-06-15 18:07:10,506 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:07:10,506 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:07:10,507 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:07:10,507 INFO Configuration - use_ca_tsu: True
2025-06-15 18:07:10,507 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:07:10,507 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:07:10,508 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:07:10,508 INFO Configuration - variant_type: hedge
2025-06-15 18:07:10,508 INFO Full model configuration:
2025-06-15 18:07:10,508 INFO   alpha: 0.5
2025-06-15 18:07:10,508 INFO   batch_size: 32
2025-06-15 18:07:10,509 INFO   ca_tsu_weight: 0.3
2025-06-15 18:07:10,509 INFO   causal_loss_lambda: 0.3
2025-06-15 18:07:10,509 INFO   clip: 15.0
2025-06-15 18:07:10,509 INFO   consistency_loss_weight: 0.05
2025-06-15 18:07:10,509 INFO   constant_kl_lambda: 0.1
2025-06-15 18:07:10,510 INFO   daily_att: y
2025-06-15 18:07:10,510 INFO   decay_rate: 0.96
2025-06-15 18:07:10,510 INFO   decay_step: 100
2025-06-15 18:07:10,510 INFO   dropout_ce: 0.0
2025-06-15 18:07:10,510 INFO   dropout_mel: 0.0
2025-06-15 18:07:10,511 INFO   dropout_mel_in: 0.3
2025-06-15 18:07:10,511 INFO   dropout_vmd: 0.0
2025-06-15 18:07:10,511 INFO   dropout_vmd_in: 0.3
2025-06-15 18:07:10,511 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:07:10,511 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:07:10,511 INFO   g_size: 50
2025-06-15 18:07:10,512 INFO   h_size: 150
2025-06-15 18:07:10,512 INFO   init_stock_with_word: 0
2025-06-15 18:07:10,512 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:07:10,512 INFO   kl_lambda_start_step: 0
2025-06-15 18:07:10,513 INFO   lr: 0.001
2025-06-15 18:07:10,513 INFO   max_n_days: 5
2025-06-15 18:07:10,513 INFO   max_n_msgs: 20
2025-06-15 18:07:10,513 INFO   max_n_words: 30
2025-06-15 18:07:10,514 INFO   mel_cell_type: gru
2025-06-15 18:07:10,514 INFO   mel_h_size: 100
2025-06-15 18:07:10,514 INFO   mode: all
2025-06-15 18:07:10,514 INFO   momentum: 0.9
2025-06-15 18:07:10,514 INFO   msin_h_size: 100
2025-06-15 18:07:10,515 INFO   n_epochs: 10
2025-06-15 18:07:10,515 INFO   noise_aware_weight: 0.5
2025-06-15 18:07:10,515 INFO   opt: adam
2025-06-15 18:07:10,515 INFO   pathway_competition_type: dynamic
2025-06-15 18:07:10,515 INFO   prediction_loss_weight: 0.1
2025-06-15 18:07:10,516 INFO   residual_connection_weight: 0.1
2025-06-15 18:07:10,516 INFO   shuffle: 1
2025-06-15 18:07:10,516 INFO   stock_embed_size: 150
2025-06-15 18:07:10,516 INFO   td_temporal_attention: True
2025-06-15 18:07:10,517 INFO   use_ca_tsu: True
2025-06-15 18:07:10,517 INFO   use_constant_kl_lambda: 0
2025-06-15 18:07:10,517 INFO   use_dual_path_srl: True
2025-06-15 18:07:10,517 INFO   use_enhanced_srl: True
2025-06-15 18:07:10,518 INFO   use_g_bn: 0
2025-06-15 18:07:10,518 INFO   use_in_bn: 0
2025-06-15 18:07:10,518 INFO   use_noise_aware_loss: True
2025-06-15 18:07:10,518 INFO   use_o_bn: 0
2025-06-15 18:07:10,518 INFO   variant_type: hedge
2025-06-15 18:07:10,519 INFO   vmd_cell_type: gru
2025-06-15 18:07:10,519 INFO   vmd_rec: zh
2025-06-15 18:07:10,519 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:07:10,519 INFO   volatility_reg_weight: 0.05
2025-06-15 18:07:10,519 INFO   weight_init: xavier-uniform
2025-06-15 18:07:10,519 INFO   word_embed_size: 50
2025-06-15 18:07:10,521 INFO   word_embed_type: glove
2025-06-15 18:07:10,521 INFO   y_size: 2
2025-06-15 18:07:10,522 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:07:10,525 INFO Start graph assembling...
2025-06-15 18:07:12,294 INFO use_dual_path_srl: True
2025-06-15 18:07:12,295 INFO variant_type: hedge
2025-06-15 18:07:12,295 INFO use_enhanced_srl: True
2025-06-15 18:07:12,295 INFO Enhanced SRL enabled from config
2025-06-15 18:07:12,296 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:07:12,296 INFO SRL condition: True = True and True
2025-06-15 18:07:12,296 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:07:12,296 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:07:12,342 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:07:12,348 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:07:12,369 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:07:12,611 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:07:12,611 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:07:12,613 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:07:13,010 ERROR Error running test: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].
2025-06-15 18:07:13,015 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 34, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1501, in assemble_graph
    self._build_vmd()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1093, in _build_vmd
    self._create_vmd_with_zh_rec()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 972, in _create_vmd_with_zh_rec
    self.kl_t = tf.transpose(kl_t_stacked, perm=[1, 0, 2], name='kl_t_stacked_zh') # shape: [batch, days, z_size]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1336, in transpose
    ret = gen_array_ops.transpose(a, perm, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 5693, in transpose
    "Transpose", x=x, perm=perm, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 691, in _call_cpp_shape_fn_impl
    raise ValueError(err.message)
ValueError: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].

2025-06-15 18:15:18,148 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:15:18,149 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:15:18,149 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:15:18,149 INFO Configuration - use_ca_tsu: True
2025-06-15 18:15:18,149 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:15:18,149 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:15:18,150 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:15:18,150 INFO Configuration - variant_type: hedge
2025-06-15 18:15:18,150 INFO Full model configuration:
2025-06-15 18:15:18,150 INFO   alpha: 0.5
2025-06-15 18:15:18,150 INFO   batch_size: 32
2025-06-15 18:15:18,151 INFO   ca_tsu_weight: 0.3
2025-06-15 18:15:18,151 INFO   causal_loss_lambda: 0.3
2025-06-15 18:15:18,151 INFO   clip: 15.0
2025-06-15 18:15:18,151 INFO   consistency_loss_weight: 0.05
2025-06-15 18:15:18,152 INFO   constant_kl_lambda: 0.1
2025-06-15 18:15:18,152 INFO   daily_att: y
2025-06-15 18:15:18,152 INFO   decay_rate: 0.96
2025-06-15 18:15:18,152 INFO   decay_step: 100
2025-06-15 18:15:18,152 INFO   dropout_ce: 0.0
2025-06-15 18:15:18,153 INFO   dropout_mel: 0.0
2025-06-15 18:15:18,153 INFO   dropout_mel_in: 0.3
2025-06-15 18:15:18,153 INFO   dropout_vmd: 0.0
2025-06-15 18:15:18,153 INFO   dropout_vmd_in: 0.3
2025-06-15 18:15:18,154 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:15:18,154 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:15:18,154 INFO   g_size: 50
2025-06-15 18:15:18,155 INFO   h_size: 150
2025-06-15 18:15:18,155 INFO   init_stock_with_word: 0
2025-06-15 18:15:18,155 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:15:18,155 INFO   kl_lambda_start_step: 0
2025-06-15 18:15:18,155 INFO   lr: 0.001
2025-06-15 18:15:18,156 INFO   max_n_days: 5
2025-06-15 18:15:18,156 INFO   max_n_msgs: 20
2025-06-15 18:15:18,156 INFO   max_n_words: 30
2025-06-15 18:15:18,156 INFO   mel_cell_type: gru
2025-06-15 18:15:18,156 INFO   mel_h_size: 100
2025-06-15 18:15:18,157 INFO   mode: all
2025-06-15 18:15:18,157 INFO   momentum: 0.9
2025-06-15 18:15:18,157 INFO   msin_h_size: 100
2025-06-15 18:15:18,157 INFO   n_epochs: 10
2025-06-15 18:15:18,157 INFO   noise_aware_weight: 0.5
2025-06-15 18:15:18,157 INFO   opt: adam
2025-06-15 18:15:18,158 INFO   pathway_competition_type: dynamic
2025-06-15 18:15:18,158 INFO   prediction_loss_weight: 0.1
2025-06-15 18:15:18,158 INFO   residual_connection_weight: 0.1
2025-06-15 18:15:18,158 INFO   shuffle: 1
2025-06-15 18:15:18,158 INFO   stock_embed_size: 150
2025-06-15 18:15:18,159 INFO   td_temporal_attention: True
2025-06-15 18:15:18,159 INFO   use_ca_tsu: True
2025-06-15 18:15:18,159 INFO   use_constant_kl_lambda: 0
2025-06-15 18:15:18,160 INFO   use_dual_path_srl: True
2025-06-15 18:15:18,160 INFO   use_enhanced_srl: True
2025-06-15 18:15:18,160 INFO   use_g_bn: 0
2025-06-15 18:15:18,160 INFO   use_in_bn: 0
2025-06-15 18:15:18,160 INFO   use_noise_aware_loss: True
2025-06-15 18:15:18,161 INFO   use_o_bn: 0
2025-06-15 18:15:18,161 INFO   variant_type: hedge
2025-06-15 18:15:18,161 INFO   vmd_cell_type: gru
2025-06-15 18:15:18,161 INFO   vmd_rec: zh
2025-06-15 18:15:18,162 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:15:18,162 INFO   volatility_reg_weight: 0.05
2025-06-15 18:15:18,162 INFO   weight_init: xavier-uniform
2025-06-15 18:15:18,162 INFO   word_embed_size: 50
2025-06-15 18:15:18,162 INFO   word_embed_type: glove
2025-06-15 18:15:18,163 INFO   y_size: 2
2025-06-15 18:15:18,163 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:15:18,166 INFO Start graph assembling...
2025-06-15 18:15:20,195 INFO use_dual_path_srl: True
2025-06-15 18:15:20,196 INFO variant_type: hedge
2025-06-15 18:15:20,196 INFO use_enhanced_srl: True
2025-06-15 18:15:20,196 INFO Enhanced SRL enabled from config
2025-06-15 18:15:20,197 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:15:20,197 INFO SRL condition: True = True and True
2025-06-15 18:15:20,197 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:15:20,198 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:15:20,262 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:15:20,268 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:15:20,300 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:15:20,558 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:15:20,559 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:15:20,559 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:15:20,889 INFO Using Temporal Attention (TAP)
2025-06-15 18:15:20,938 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:15:20,939 INFO Ca-TSU enabled: True
2025-06-15 18:15:20,939 INFO Enhanced SRL enabled: True
2025-06-15 18:15:20,940 INFO Noise-Aware Loss enabled: True
2025-06-15 18:15:20,955 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:15:20,955 INFO Adding auxiliary enhancement losses...
2025-06-15 18:15:20,980 INFO Creating Noise-Aware Loss component...
2025-06-15 18:15:20,990 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:15:20,991 INFO Creating Causal Consistency Loss component...
2025-06-15 18:15:21,029 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:15:21,030 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:15:21,030 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:15:23,829 INFO Graph assembled successfully.
2025-06-15 18:15:24,134 INFO Verifying model configuration...
2025-06-15 18:15:24,135 INFO Ca-TSU enabled: True
2025-06-15 18:15:24,135 INFO Enhanced SRL enabled: True
2025-06-15 18:15:24,135 INFO Noise-Aware Loss enabled: True
2025-06-15 18:15:24,135 INFO Checking model components for noise-aware loss...
2025-06-15 18:15:24,136 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:15:24,136 INFO use_noise_aware_loss value: True
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_weight': True
2025-06-15 18:15:24,136 INFO noise_aware_weight value: 0.5
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_loss': False
2025-06-15 18:15:24,136 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:15:24,137 INFO Model has 'reliability_weights': True
2025-06-15 18:15:24,137 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:15:24,137 INFO use_enhanced_srl value: True
2025-06-15 18:15:24,137 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:15:24,137 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:15:24,137 INFO Model has 'use_ca_tsu': True
2025-06-15 18:15:24,138 INFO use_ca_tsu value: True
2025-06-15 18:15:24,138 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:15:24,138 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:15:24,138 INFO Model has 'loss_components': True
2025-06-15 18:15:24,138 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:15:24,139 INFO Manually activating loss components...
2025-06-15 18:15:24,139 INFO Components manually activated:
2025-06-15 18:15:24,139 INFO use_enhanced_srl: True
2025-06-15 18:15:24,139 INFO use_ca_tsu: True
2025-06-15 18:15:24,140 INFO use_noise_aware_loss: True
2025-06-15 18:15:24,140 INFO use_dual_path_srl: True
2025-06-15 18:15:24,140 INFO Running test_noise_aware_loss...
2025-06-15 18:15:44,718 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:22:50,330 INFO 	Eval, eval loss: 1.5247420072555542, acc: 0.519817
2025-06-15 18:22:50,575 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_182250.txt
2025-06-15 18:22:50,576 INFO Test completed successfully!
2025-06-15 18:33:13,971 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:33:13,971 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:33:13,971 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:33:13,972 INFO Configuration - use_ca_tsu: True
2025-06-15 18:33:13,972 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:33:13,972 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:33:13,972 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:33:13,972 INFO Configuration - variant_type: hedge
2025-06-15 18:33:13,973 INFO Full model configuration:
2025-06-15 18:33:13,973 INFO   alpha: 0.5
2025-06-15 18:33:13,973 INFO   batch_size: 32
2025-06-15 18:33:13,973 INFO   ca_tsu_weight: 0.3
2025-06-15 18:33:13,974 INFO   causal_loss_lambda: 0.3
2025-06-15 18:33:13,974 INFO   clip: 15.0
2025-06-15 18:33:13,974 INFO   consistency_loss_weight: 0.05
2025-06-15 18:33:13,974 INFO   constant_kl_lambda: 0.1
2025-06-15 18:33:13,974 INFO   daily_att: y
2025-06-15 18:33:13,974 INFO   decay_rate: 0.96
2025-06-15 18:33:13,975 INFO   decay_step: 100
2025-06-15 18:33:13,975 INFO   dropout_ce: 0.0
2025-06-15 18:33:13,975 INFO   dropout_mel: 0.0
2025-06-15 18:33:13,975 INFO   dropout_mel_in: 0.3
2025-06-15 18:33:13,975 INFO   dropout_vmd: 0.0
2025-06-15 18:33:13,976 INFO   dropout_vmd_in: 0.3
2025-06-15 18:33:13,976 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:33:13,976 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:33:13,976 INFO   g_size: 50
2025-06-15 18:33:13,976 INFO   h_size: 150
2025-06-15 18:33:13,977 INFO   init_stock_with_word: 0
2025-06-15 18:33:13,977 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:33:13,977 INFO   kl_lambda_start_step: 0
2025-06-15 18:33:13,977 INFO   lr: 0.001
2025-06-15 18:33:13,977 INFO   max_n_days: 5
2025-06-15 18:33:13,977 INFO   max_n_msgs: 20
2025-06-15 18:33:13,978 INFO   max_n_words: 30
2025-06-15 18:33:13,978 INFO   mel_cell_type: gru
2025-06-15 18:33:13,978 INFO   mel_h_size: 100
2025-06-15 18:33:13,978 INFO   mode: all
2025-06-15 18:33:13,978 INFO   momentum: 0.9
2025-06-15 18:33:13,978 INFO   msin_h_size: 100
2025-06-15 18:33:13,979 INFO   n_epochs: 10
2025-06-15 18:33:13,979 INFO   noise_aware_weight: 0.5
2025-06-15 18:33:13,979 INFO   opt: adam
2025-06-15 18:33:13,979 INFO   pathway_competition_type: dynamic
2025-06-15 18:33:13,979 INFO   prediction_loss_weight: 0.1
2025-06-15 18:33:13,979 INFO   residual_connection_weight: 0.1
2025-06-15 18:33:13,980 INFO   shuffle: 1
2025-06-15 18:33:13,980 INFO   stock_embed_size: 150
2025-06-15 18:33:13,980 INFO   td_temporal_attention: True
2025-06-15 18:33:13,980 INFO   use_ca_tsu: True
2025-06-15 18:33:13,980 INFO   use_constant_kl_lambda: 0
2025-06-15 18:33:13,981 INFO   use_dual_path_srl: True
2025-06-15 18:33:13,981 INFO   use_enhanced_srl: True
2025-06-15 18:33:13,981 INFO   use_g_bn: 0
2025-06-15 18:33:13,981 INFO   use_in_bn: 0
2025-06-15 18:33:13,981 INFO   use_noise_aware_loss: True
2025-06-15 18:33:13,981 INFO   use_o_bn: 0
2025-06-15 18:33:13,982 INFO   variant_type: hedge
2025-06-15 18:33:13,982 INFO   vmd_cell_type: gru
2025-06-15 18:33:13,982 INFO   vmd_rec: zh
2025-06-15 18:33:13,982 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:33:13,982 INFO   volatility_reg_weight: 0.05
2025-06-15 18:33:13,983 INFO   weight_init: xavier-uniform
2025-06-15 18:33:13,983 INFO   word_embed_size: 50
2025-06-15 18:33:13,983 INFO   word_embed_type: glove
2025-06-15 18:33:13,983 INFO   y_size: 2
2025-06-15 18:33:13,984 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:33:13,986 INFO Start graph assembling...
2025-06-15 18:33:15,866 INFO use_dual_path_srl: True
2025-06-15 18:33:15,867 INFO variant_type: hedge
2025-06-15 18:33:15,867 INFO use_enhanced_srl: True
2025-06-15 18:33:15,867 INFO Enhanced SRL enabled from config
2025-06-15 18:33:15,867 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:33:15,868 INFO SRL condition: True = True and True
2025-06-15 18:33:15,868 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:33:15,868 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:33:15,913 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:33:15,917 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:33:15,939 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:33:16,165 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:33:16,165 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:33:16,166 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:33:16,482 INFO Using Temporal Attention (TAP)
2025-06-15 18:33:16,532 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:33:16,533 INFO Ca-TSU enabled: True
2025-06-15 18:33:16,533 INFO Enhanced SRL enabled: True
2025-06-15 18:33:16,533 INFO Noise-Aware Loss enabled: True
2025-06-15 18:33:16,550 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:16,550 INFO Adding auxiliary enhancement losses...
2025-06-15 18:33:16,577 INFO Creating Noise-Aware Loss component...
2025-06-15 18:33:16,587 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:33:16,590 INFO Creating Causal Consistency Loss component...
2025-06-15 18:33:16,638 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:33:16,639 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:16,639 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:33:19,252 INFO Graph assembled successfully.
2025-06-15 18:33:19,253 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:33:19,254 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:33:19,565 INFO Verifying model configuration...
2025-06-15 18:33:19,566 INFO Ca-TSU enabled: True
2025-06-15 18:33:19,566 INFO Enhanced SRL enabled: True
2025-06-15 18:33:19,567 INFO Noise-Aware Loss enabled: True
2025-06-15 18:33:19,567 INFO Checking model components for noise-aware loss...
2025-06-15 18:33:19,567 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:33:19,567 INFO use_noise_aware_loss value: True
2025-06-15 18:33:19,567 INFO Model has 'noise_aware_weight': True
2025-06-15 18:33:19,567 INFO noise_aware_weight value: 0.5
2025-06-15 18:33:19,567 INFO Model has 'noise_aware_loss': False
2025-06-15 18:33:19,569 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:33:19,569 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:33:19,569 INFO Model has 'reliability_weights': True
2025-06-15 18:33:19,569 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:33:19,570 INFO use_enhanced_srl value: True
2025-06-15 18:33:19,570 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:33:19,570 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:33:19,570 INFO Model has 'use_ca_tsu': True
2025-06-15 18:33:19,570 INFO use_ca_tsu value: True
2025-06-15 18:33:19,571 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:33:19,571 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:33:19,571 INFO Model has 'loss_components': True
2025-06-15 18:33:19,571 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:33:19,571 INFO Manually activating loss components...
2025-06-15 18:33:19,572 INFO Components manually activated:
2025-06-15 18:33:19,572 INFO use_enhanced_srl: True
2025-06-15 18:33:19,572 INFO use_ca_tsu: True
2025-06-15 18:33:19,572 INFO use_noise_aware_loss: True
2025-06-15 18:33:19,572 INFO use_dual_path_srl: True
2025-06-15 18:33:19,573 INFO Running test_noise_aware_loss...
2025-06-15 18:33:38,860 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:33:41,108 INFO Word table initialized
2025-06-15 18:33:41,108 INFO Checking loss components in the model graph...
2025-06-15 18:33:41,109 WARNING Enhanced SRL loss not found in the model
2025-06-15 18:33:41,109 WARNING Causal consistency loss not found in the model
2025-06-15 18:33:41,109 WARNING Noise-aware loss not found in the model
2025-06-15 18:33:41,109 INFO Reliability weights found: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Sigmoid:0", shape=(?, 1), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,109 INFO Reliability weights name: enhanced_srl_loss_calculation/noise_aware_component/Sigmoid:0
2025-06-15 18:33:41,110 INFO Reliability weights shape: (?, 1)
2025-06-15 18:33:41,110 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:33:41,110 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,110 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,111 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,111 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 18:33:41,112 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 18:33:41,247 INFO Starting training test for 10 batches
2025-06-15 18:33:56,379 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:33:56,380 INFO n_msgs_batch shape: Not a list
2025-06-15 18:33:56,380 INFO Sample n_msgs values: [1 1 3]
2025-06-15 18:33:56,380 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,380 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,383 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,383 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,383 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,385 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,385 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 2: Setting 5 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,386 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 1: Setting 4 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 2: Setting 10 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,389 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 0: Setting 4 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,390 INFO Batch 5, Day 3: Setting 1 messages to True
2025-06-15 18:33:56,390 INFO Batch 5, Day 4: Setting 2 messages to True
2025-06-15 18:33:56,390 INFO Batch 6, Day 0: Setting 4 messages to True
2025-06-15 18:33:56,390 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 2: Setting 13 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 3: Setting 6 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,393 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,393 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,393 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,395 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,395 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,395 INFO Batch 9, Day 1: Setting 4 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 3: Setting 5 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 4: Setting 3 messages to True
2025-06-15 18:33:56,396 INFO Batch 10, Day 0: Setting 15 messages to True
2025-06-15 18:33:56,398 INFO Batch 10, Day 1: Setting 8 messages to True
2025-06-15 18:33:56,400 INFO Batch 10, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,401 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,401 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,401 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 3: Setting 1 messages to True
2025-06-15 18:33:56,404 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,405 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,405 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,405 INFO Batch 14, Day 0: Setting 3 messages to True
2025-06-15 18:33:56,405 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 3: Setting 2 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 4: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,408 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,408 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,408 INFO Batch 16, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,409 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,409 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,410 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,410 INFO Batch 17, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,410 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,411 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,412 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,412 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,413 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,413 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 3: Setting 2 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,415 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,415 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,416 INFO Batch 19, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,416 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,417 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,417 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,418 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,418 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,422 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,422 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,423 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,423 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,425 INFO Batch 22, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,425 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 0: Setting 3 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 0: Setting 5 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,431 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,432 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,432 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,432 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,435 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,438 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,438 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,438 INFO Batch 31, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,439 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,439 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,440 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,441 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,442 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:33:56,442 INFO Message mask non-zero count: 226 out of 3200
2025-06-15 18:33:56,443 INFO First batch, first day mask: [ True False False False False False False False False False False False
 False False False False False False False False]
2025-06-15 18:33:56,443 INFO n_msgs_batch structure: <class 'numpy.ndarray'>
2025-06-15 18:33:56,444 INFO n_msgs_batch first item: [1 1 3 0 0]
2025-06-15 18:33:56,444 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:34:13,488 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 18:34:13,488 INFO   PERFORMANCE: Loss=1.3106 | Acc=0.5938 | MCC=0.0380
2025-06-15 18:34:13,489 INFO   LOSS COMPONENTS:
2025-06-15 18:34:13,489 INFO     - Causal Consistency Loss: 0.191054
2025-06-15 18:34:13,489 INFO     - Noise-Aware SRL Loss: 0.568306
2025-06-15 18:34:13,490 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:34:13,490 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 18:34:13,490 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:34:13,492 INFO     Volatility: 0.6453, Text Weight: 0.3908, Price Weight: 0.6092
2025-06-15 18:34:22,422 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:34:22,423 INFO n_msgs_batch shape: Not a list
2025-06-15 18:34:22,423 INFO Sample n_msgs values: [1 2 5]
2025-06-15 18:34:22,423 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 4: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,426 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:34:22,427 INFO Batch 2, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,427 INFO Batch 2, Day 4: Setting 4 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 0: Setting 11 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 1: Setting 5 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 2: Setting 7 messages to True
2025-06-15 18:34:22,429 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,429 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,429 INFO Batch 5, Day 0: Setting 20 messages to True
2025-06-15 18:34:22,432 INFO Batch 5, Day 1: Setting 16 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,435 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,436 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,436 INFO Batch 6, Day 2: Setting 6 messages to True
2025-06-15 18:34:22,437 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,437 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,437 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,437 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,438 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 1: Setting 7 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 2: Setting 7 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,439 INFO Batch 9, Day 0: Setting 3 messages to True
2025-06-15 18:34:22,439 INFO Batch 9, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,442 INFO Batch 10, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,442 INFO Batch 10, Day 4: Setting 3 messages to True
2025-06-15 18:34:22,442 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,442 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,443 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,443 INFO Batch 12, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 3: Setting 8 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 4: Setting 2 messages to True
2025-06-15 18:34:22,444 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 3: Setting 2 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 4: Setting 14 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,447 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,447 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,447 INFO Batch 15, Day 1: Setting 4 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,448 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,448 INFO Batch 16, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,449 INFO Batch 17, Day 0: Setting 3 messages to True
2025-06-15 18:34:22,449 INFO Batch 17, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,450 INFO Batch 18, Day 0: Setting 10 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 2: Setting 2 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 4: Setting 1 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 0: Setting 4 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,454 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 0: Setting 6 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 2: Setting 6 messages to True
2025-06-15 18:34:22,455 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,455 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,456 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,456 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,456 INFO Batch 23, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,456 INFO Batch 23, Day 1: Setting 5 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,457 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,457 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 1: Setting 4 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 27, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,461 INFO Batch 27, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,462 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 0: Setting 5 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 1: Setting 9 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,465 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,465 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,465 INFO Batch 30, Day 0: Setting 15 messages to True
2025-06-15 18:34:22,465 INFO Batch 30, Day 1: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 2: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 3: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,466 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,467 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:34:22,468 INFO Message mask non-zero count: 409 out of 3200
2025-06-15 18:34:22,468 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:34:54,871 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:34:54,871 INFO n_msgs_batch shape: Not a list
2025-06-15 18:34:54,872 INFO Sample n_msgs values: [1 2 0]
2025-06-15 18:34:54,872 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,872 INFO Batch 0, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,873 INFO Batch 1, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,874 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,875 INFO Batch 3, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 2: Setting 20 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,876 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,877 INFO Batch 5, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,877 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 3: Setting 2 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 4: Setting 3 messages to True
2025-06-15 18:34:54,878 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,878 INFO Batch 6, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,880 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,881 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,882 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 3: Setting 8 messages to True
2025-06-15 18:34:54,883 INFO Batch 10, Day 4: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,884 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,884 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 0: Setting 4 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 0: Setting 4 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 2: Setting 18 messages to True
2025-06-15 18:34:54,887 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,887 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,888 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,888 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 2: Setting 12 messages to True
2025-06-15 18:34:54,889 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,889 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,889 INFO Batch 17, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,889 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,892 INFO Batch 18, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,892 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,893 INFO Batch 18, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,894 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,894 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,896 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,897 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,897 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,897 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 0: Setting 8 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 3: Setting 7 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 0: Setting 7 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,904 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,904 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,904 INFO Batch 27, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 3: Setting 3 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,905 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,905 INFO Batch 28, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 1: Setting 8 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,908 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,909 INFO Batch 31, Day 3: Setting 3 messages to True
2025-06-15 18:34:54,909 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,909 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:34:54,909 INFO Message mask non-zero count: 266 out of 3200
2025-06-15 18:34:54,910 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:17,296 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:17,297 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:17,297 INFO Sample n_msgs values: [1 1 4]
2025-06-15 18:35:17,297 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,301 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 3: Setting 2 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,303 INFO Batch 6, Day 0: Setting 6 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 2: Setting 5 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,304 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,305 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 3: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 4: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,309 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,309 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 13, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,312 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,315 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,316 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,316 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 0: Setting 6 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 1: Setting 8 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 2: Setting 7 messages to True
2025-06-15 18:35:17,317 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,317 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,317 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,317 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,318 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,318 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,319 INFO Batch 20, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,319 INFO Batch 20, Day 1: Setting 7 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,320 INFO Batch 21, Day 0: Setting 4 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 24, Day 0: Setting 4 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,324 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 1: Setting 5 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 26, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 1: Setting 11 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 1: Setting 7 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,328 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,328 INFO Batch 28, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,328 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,329 INFO Batch 29, Day 0: Setting 9 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 1: Setting 10 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,332 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,332 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,333 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,333 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,333 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:17,333 INFO Message mask non-zero count: 219 out of 3200
2025-06-15 18:35:17,333 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:42,147 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:42,147 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:42,147 INFO Sample n_msgs values: [2 5 3]
2025-06-15 18:35:42,148 INFO Batch 0, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 2: Setting 3 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 3: Setting 2 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,148 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,149 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 1: Setting 12 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,150 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,151 INFO Batch 4, Day 0: Setting 7 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,153 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 0: Setting 6 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 1: Setting 8 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,154 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,154 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 12, Day 0: Setting 3 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 1: Setting 9 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 2: Setting 8 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,160 INFO Batch 13, Day 0: Setting 5 messages to True
2025-06-15 18:35:42,160 INFO Batch 13, Day 1: Setting 8 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 0: Setting 6 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,166 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,166 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,167 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,167 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 0: Setting 5 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 1: Setting 7 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 2: Setting 10 messages to True
2025-06-15 18:35:42,168 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,168 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 0: Setting 16 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,169 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,169 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,170 INFO Batch 22, Day 3: Setting 5 messages to True
2025-06-15 18:35:42,170 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,170 INFO Batch 23, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,170 INFO Batch 23, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 2: Setting 5 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,171 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,171 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,172 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 3: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,173 INFO Batch 26, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,173 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,174 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,174 INFO Batch 27, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,175 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,175 INFO Batch 28, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,176 INFO Batch 29, Day 0: Setting 9 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 2: Setting 11 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,180 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:42,180 INFO Message mask non-zero count: 285 out of 3200
2025-06-15 18:35:42,180 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:54,370 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 18:35:54,371 INFO   PERFORMANCE: Loss=1.5446 | Acc=0.4688 | MCC=-0.0552
2025-06-15 18:35:54,371 INFO   LOSS COMPONENTS:
2025-06-15 18:35:54,371 INFO     - Causal Consistency Loss: -0.108177
2025-06-15 18:35:54,371 INFO     - Noise-Aware SRL Loss: 0.449558
2025-06-15 18:35:54,371 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:35:54,372 INFO     Alpha_i sample: 0.5767, Omega_i sample: 0.6401
2025-06-15 18:35:54,372 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:35:54,373 INFO     Volatility: 0.6441, Text Weight: 0.4702, Price Weight: 0.5298
2025-06-15 18:35:59,351 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:59,352 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:59,352 INFO Sample n_msgs values: [2 1 0]
2025-06-15 18:35:59,352 INFO Batch 0, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,352 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 2, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,354 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,356 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 0: Setting 4 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,359 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,360 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,360 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,361 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,362 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,363 INFO Batch 9, Day 3: Setting 3 messages to True
2025-06-15 18:35:59,363 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,364 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,365 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,365 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 1: Setting 9 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 13, Day 0: Setting 6 messages to True
2025-06-15 18:35:59,366 INFO Batch 13, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,367 INFO Batch 14, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 1: Setting 9 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,368 INFO Batch 15, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 3: Setting 20 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,369 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 3: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 18, Day 0: Setting 5 messages to True
2025-06-15 18:35:59,372 INFO Batch 18, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,373 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,373 INFO Batch 18, Day 3: Setting 4 messages to True
2025-06-15 18:35:59,374 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 0: Setting 10 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,375 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 1: Setting 5 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,376 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 0: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 1: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 2: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 3: Setting 19 messages to True
2025-06-15 18:35:59,377 INFO Batch 21, Day 4: Setting 9 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 3: Setting 2 messages to True
2025-06-15 18:35:59,379 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,380 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 1: Setting 3 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,381 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,382 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 1: Setting 5 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,383 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 0: Setting 5 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,384 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,384 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,384 INFO Batch 29, Day 0: Setting 20 messages to True
2025-06-15 18:35:59,384 INFO Batch 29, Day 1: Setting 3 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,385 INFO Batch 30, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,385 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,388 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,388 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:59,388 INFO Message mask non-zero count: 372 out of 3200
2025-06-15 18:35:59,388 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:21,205 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:21,206 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:21,206 INFO Sample n_msgs values: [5 3 1]
2025-06-15 18:36:21,206 INFO Batch 0, Day 0: Setting 5 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 1: Setting 16 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 2: Setting 7 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 0: Setting 8 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 0: Setting 5 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 1: Setting 7 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 3: Setting 4 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 6, Day 0: Setting 6 messages to True
2025-06-15 18:36:21,212 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,213 INFO Batch 7, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,213 INFO Batch 7, Day 1: Setting 12 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 2: Setting 8 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,214 INFO Batch 8, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,214 INFO Batch 8, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,215 INFO Batch 9, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 1: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 2: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 0: Setting 7 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 2: Setting 5 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 2: Setting 5 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,218 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,219 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,222 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,222 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,224 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,225 INFO Batch 17, Day 3: Setting 2 messages to True
2025-06-15 18:36:21,225 INFO Batch 17, Day 4: Setting 3 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,226 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,226 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,226 INFO Batch 19, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,226 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 2: Setting 11 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,227 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,230 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,230 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,230 INFO Batch 22, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 1: Setting 4 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,231 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,232 INFO Batch 24, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,232 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,233 INFO Batch 24, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,233 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,234 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,234 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,234 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 3: Setting 3 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,235 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,238 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 3: Setting 2 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,241 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,242 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,242 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,242 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:21,242 INFO Message mask non-zero count: 357 out of 3200
2025-06-15 18:36:21,243 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:37,759 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:37,759 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:37,760 INFO Sample n_msgs values: [1 3 4]
2025-06-15 18:36:37,760 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 2: Setting 4 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 3: Setting 3 messages to True
2025-06-15 18:36:37,763 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,764 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,765 INFO Batch 3, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 3, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,766 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 0: Setting 5 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 1: Setting 11 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 2: Setting 8 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 0: Setting 6 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 1: Setting 7 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,770 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,770 INFO Batch 8, Day 0: Setting 11 messages to True
2025-06-15 18:36:37,770 INFO Batch 8, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 9, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,772 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 2: Setting 4 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,774 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 2: Setting 5 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 3: Setting 6 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,775 INFO Batch 13, Day 0: Setting 10 messages to True
2025-06-15 18:36:37,775 INFO Batch 13, Day 1: Setting 13 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 2: Setting 10 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,776 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,776 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,777 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,785 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,785 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 1: Setting 18 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 2: Setting 8 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 1: Setting 20 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,790 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 25, Day 3: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 25, Day 4: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 0: Setting 9 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 1: Setting 7 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 27, Day 0: Setting 7 messages to True
2025-06-15 18:36:37,792 INFO Batch 27, Day 1: Setting 19 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,793 INFO Batch 28, Day 0: Setting 4 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 1: Setting 6 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 0: Setting 5 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 1: Setting 15 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 2: Setting 14 messages to True
2025-06-15 18:36:37,797 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,797 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,797 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,797 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,799 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:37,799 INFO Message mask non-zero count: 339 out of 3200
2025-06-15 18:36:37,799 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:58,041 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:58,041 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:58,042 INFO Sample n_msgs values: [3 4 1]
2025-06-15 18:36:58,042 INFO Batch 0, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,043 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,043 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,044 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 1: Setting 10 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 4: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,047 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,047 INFO Batch 4, Day 0: Setting 17 messages to True
2025-06-15 18:36:58,047 INFO Batch 4, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 2: Setting 17 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,048 INFO Batch 5, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,048 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 2: Setting 10 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,049 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,051 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,051 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,051 INFO Batch 7, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,052 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,053 INFO Batch 8, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,053 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 9, Day 0: Setting 5 messages to True
2025-06-15 18:36:58,054 INFO Batch 9, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,057 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,058 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,058 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,058 INFO Batch 12, Day 0: Setting 10 messages to True
2025-06-15 18:36:58,058 INFO Batch 12, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,059 INFO Batch 13, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 2: Setting 5 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 4: Setting 4 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 0: Setting 4 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,062 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,062 INFO Batch 15, Day 0: Setting 10 messages to True
2025-06-15 18:36:58,062 INFO Batch 15, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 2: Setting 19 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,063 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 2: Setting 4 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,066 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:36:58,067 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,067 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,067 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,067 INFO Batch 19, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,068 INFO Batch 20, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,070 INFO Batch 20, Day 4: Setting 4 messages to True
2025-06-15 18:36:58,070 INFO Batch 21, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 2: Setting 11 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,072 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,072 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,072 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,073 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,075 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,076 INFO Batch 24, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,076 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,076 INFO Batch 25, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,076 INFO Batch 25, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 2: Setting 3 messages to True
2025-06-15 18:36:58,079 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,079 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,079 INFO Batch 27, Day 0: Setting 9 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,082 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,083 INFO Batch 29, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,083 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,083 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 2: Setting 0 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 1: Setting 8 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,086 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,086 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:58,086 INFO Message mask non-zero count: 341 out of 3200
2025-06-15 18:36:58,087 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:37:16,922 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:37:16,922 INFO n_msgs_batch shape: Not a list
2025-06-15 18:37:16,923 INFO Sample n_msgs values: [4 9 0]
2025-06-15 18:37:16,923 INFO Batch 0, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,923 INFO Batch 0, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,923 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,924 INFO Batch 1, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 1: Setting 3 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,926 INFO Batch 3, Day 0: Setting 8 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 2: Setting 13 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 3: Setting 5 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,927 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,927 INFO Batch 4, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,928 INFO Batch 5, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,928 INFO Batch 5, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,929 INFO Batch 6, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,929 INFO Batch 6, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,930 INFO Batch 7, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 1: Setting 20 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 2: Setting 6 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 3: Setting 6 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 4: Setting 5 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 2: Setting 7 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 3: Setting 2 messages to True
2025-06-15 18:37:16,933 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 0: Setting 9 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 2: Setting 4 messages to True
2025-06-15 18:37:16,935 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,935 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,936 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 0: Setting 20 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 1: Setting 11 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 2: Setting 11 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 3: Setting 3 messages to True
2025-06-15 18:37:16,937 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,938 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,938 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 0: Setting 9 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 1: Setting 19 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,939 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,939 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,939 INFO Batch 15, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,939 INFO Batch 15, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 16, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 2: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 3: Setting 8 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 4: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 1: Setting 6 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,944 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,945 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 3: Setting 3 messages to True
2025-06-15 18:37:16,946 INFO Batch 20, Day 4: Setting 7 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,947 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 0: Setting 3 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 1: Setting 7 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 2: Setting 20 messages to True
2025-06-15 18:37:16,948 INFO Batch 22, Day 3: Setting 10 messages to True
2025-06-15 18:37:16,948 INFO Batch 22, Day 4: Setting 12 messages to True
2025-06-15 18:37:16,948 INFO Batch 23, Day 0: Setting 6 messages to True
2025-06-15 18:37:16,948 INFO Batch 23, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,949 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,949 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 2: Setting 4 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,950 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,952 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,953 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,953 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,953 INFO Batch 27, Day 0: Setting 3 messages to True
2025-06-15 18:37:16,953 INFO Batch 27, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 3: Setting 7 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,954 INFO Batch 28, Day 0: Setting 6 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 2: Setting 5 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 1: Setting 3 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,958 INFO Batch 30, Day 3: Setting 1 messages to True
2025-06-15 18:37:16,958 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,958 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 3: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,960 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:37:16,960 INFO Message mask non-zero count: 462 out of 3200
2025-06-15 18:37:16,960 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:37:29,030 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 18:37:29,030 INFO   PERFORMANCE: Loss=1.4322 | Acc=0.6875 | MCC=0.3968
2025-06-15 18:37:29,032 INFO   LOSS COMPONENTS:
2025-06-15 18:37:29,032 INFO     - Causal Consistency Loss: -0.303763
2025-06-15 18:37:29,032 INFO     - Noise-Aware SRL Loss: 0.325305
2025-06-15 18:37:29,033 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:37:29,033 INFO     Alpha_i sample: 0.1342, Omega_i sample: 0.2418
2025-06-15 18:37:29,033 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:37:29,033 INFO     Volatility: 0.6982, Text Weight: 0.5317, Price Weight: 0.4683
2025-06-15 18:37:29,034 INFO Generating diagnostic plots...
2025-06-15 18:37:31,308 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 18:37:31,308 INFO Saving final checkpoint for test run...
2025-06-15 18:37:31,459 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate2717010154151498949 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate2717010154151498949 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-15 18:37:31,465 INFO Start dev phase...
2025-06-15 18:37:33,539 INFO Created and added message mask to eval feed_dict with shape (32, 5, 20)
2025-06-15 18:37:33,540 INFO Message mask non-zero count: 1966 out of 3200
2025-06-15 18:37:37,389 INFO Evaluated batch for dev phase: size=32.0, acc=0.5000
2025-06-15 18:37:37,702 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:37:37,703 INFO Message mask non-zero count: 114 out of 900
2025-06-15 18:37:38,924 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:37:39,170 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:37:39,170 INFO Message mask non-zero count: 8 out of 100
2025-06-15 18:37:39,707 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 18:37:40,033 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:37:40,033 INFO Message mask non-zero count: 106 out of 900
2025-06-15 18:37:41,372 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:37:42,131 INFO Created and added message mask to eval feed_dict with shape (2, 5, 20)
2025-06-15 18:37:42,131 INFO Message mask non-zero count: 31 out of 200
2025-06-15 18:37:42,755 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 18:37:43,560 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:37:43,561 INFO Message mask non-zero count: 23 out of 300
2025-06-15 18:37:44,263 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:37:45,283 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:37:45,284 INFO Message mask non-zero count: 221 out of 1700
2025-06-15 18:37:47,268 INFO Evaluated batch for dev phase: size=17.0, acc=0.6471
2025-06-15 18:37:47,556 INFO Created and added message mask to eval feed_dict with shape (8, 5, 20)
2025-06-15 18:37:47,556 INFO Message mask non-zero count: 52 out of 800
2025-06-15 18:37:48,815 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 18:37:49,133 INFO Created and added message mask to eval feed_dict with shape (21, 5, 20)
2025-06-15 18:37:49,133 INFO Message mask non-zero count: 342 out of 2100
2025-06-15 18:37:52,062 INFO Evaluated batch for dev phase: size=21.0, acc=0.3810
2025-06-15 18:37:52,367 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:37:52,368 INFO Message mask non-zero count: 241 out of 2000
2025-06-15 18:37:54,908 INFO Evaluated batch for dev phase: size=20.0, acc=0.8000
2025-06-15 18:37:55,226 INFO Created and added message mask to eval feed_dict with shape (19, 5, 20)
2025-06-15 18:37:55,227 INFO Message mask non-zero count: 270 out of 1900
2025-06-15 18:37:57,636 INFO Evaluated batch for dev phase: size=19.0, acc=0.4737
2025-06-15 18:37:58,160 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:37:58,160 INFO Message mask non-zero count: 20 out of 400
2025-06-15 18:37:58,968 INFO Evaluated batch for dev phase: size=4.0, acc=0.0000
2025-06-15 18:37:59,269 INFO Created and added message mask to eval feed_dict with shape (15, 5, 20)
2025-06-15 18:37:59,270 INFO Message mask non-zero count: 193 out of 1500
2025-06-15 18:38:01,327 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 18:38:01,627 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:38:01,628 INFO Message mask non-zero count: 101 out of 1200
2025-06-15 18:38:03,174 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 18:38:03,710 INFO Created and added message mask to eval feed_dict with shape (7, 5, 20)
2025-06-15 18:38:03,711 INFO Message mask non-zero count: 47 out of 700
2025-06-15 18:38:04,715 INFO Evaluated batch for dev phase: size=7.0, acc=0.7143
2025-06-15 18:38:05,014 INFO Created and added message mask to eval feed_dict with shape (11, 5, 20)
2025-06-15 18:38:05,014 INFO Message mask non-zero count: 89 out of 1100
2025-06-15 18:38:06,475 INFO Evaluated batch for dev phase: size=11.0, acc=0.3636
2025-06-15 18:38:06,778 INFO Created and added message mask to eval feed_dict with shape (14, 5, 20)
2025-06-15 18:38:06,779 INFO Message mask non-zero count: 130 out of 1400
2025-06-15 18:38:08,552 INFO Evaluated batch for dev phase: size=14.0, acc=0.7143
2025-06-15 18:38:09,078 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:38:09,078 INFO Message mask non-zero count: 57 out of 900
2025-06-15 18:38:10,306 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:38:10,568 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:10,568 INFO Message mask non-zero count: 3 out of 100
2025-06-15 18:38:11,089 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:38:11,399 INFO Created and added message mask to eval feed_dict with shape (14, 5, 20)
2025-06-15 18:38:11,400 INFO Message mask non-zero count: 197 out of 1400
2025-06-15 18:38:13,533 INFO Evaluated batch for dev phase: size=14.0, acc=0.3571
2025-06-15 18:38:13,869 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:38:13,870 INFO Message mask non-zero count: 278 out of 2000
2025-06-15 18:38:16,483 INFO Evaluated batch for dev phase: size=20.0, acc=0.4000
2025-06-15 18:38:16,813 INFO Created and added message mask to eval feed_dict with shape (6, 5, 20)
2025-06-15 18:38:16,814 INFO Message mask non-zero count: 43 out of 600
2025-06-15 18:38:18,008 INFO Evaluated batch for dev phase: size=6.0, acc=0.3333
2025-06-15 18:38:18,331 INFO Created and added message mask to eval feed_dict with shape (11, 5, 20)
2025-06-15 18:38:18,332 INFO Message mask non-zero count: 83 out of 1100
2025-06-15 18:38:20,135 INFO Evaluated batch for dev phase: size=11.0, acc=0.5455
2025-06-15 18:38:20,709 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:38:20,710 INFO Message mask non-zero count: 22 out of 400
2025-06-15 18:38:21,751 INFO Evaluated batch for dev phase: size=4.0, acc=0.2500
2025-06-15 18:38:22,081 INFO Created and added message mask to eval feed_dict with shape (6, 5, 20)
2025-06-15 18:38:22,082 INFO Message mask non-zero count: 28 out of 600
2025-06-15 18:38:23,215 INFO Evaluated batch for dev phase: size=6.0, acc=0.5000
2025-06-15 18:38:23,568 INFO Created and added message mask to eval feed_dict with shape (16, 5, 20)
2025-06-15 18:38:23,568 INFO Message mask non-zero count: 266 out of 1600
2025-06-15 18:38:26,107 INFO Evaluated batch for dev phase: size=16.0, acc=0.5000
2025-06-15 18:38:26,887 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:26,888 INFO Message mask non-zero count: 10 out of 300
2025-06-15 18:38:27,618 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:38:27,953 INFO Created and added message mask to eval feed_dict with shape (16, 5, 20)
2025-06-15 18:38:27,954 INFO Message mask non-zero count: 245 out of 1600
2025-06-15 18:38:29,980 INFO Evaluated batch for dev phase: size=16.0, acc=0.5625
2025-06-15 18:38:30,860 INFO Created and added message mask to eval feed_dict with shape (13, 5, 20)
2025-06-15 18:38:30,860 INFO Message mask non-zero count: 162 out of 1300
2025-06-15 18:38:32,764 INFO Evaluated batch for dev phase: size=13.0, acc=0.6154
2025-06-15 18:38:33,014 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:33,014 INFO Message mask non-zero count: 5 out of 100
2025-06-15 18:38:33,576 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:38:33,867 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:33,867 INFO Message mask non-zero count: 21 out of 300
2025-06-15 18:38:34,693 INFO Evaluated batch for dev phase: size=3.0, acc=0.0000
2025-06-15 18:38:34,970 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:34,970 INFO Message mask non-zero count: 18 out of 300
2025-06-15 18:38:35,702 INFO Evaluated batch for dev phase: size=3.0, acc=0.6667
2025-06-15 18:38:36,202 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:38:36,202 INFO Message mask non-zero count: 39 out of 400
2025-06-15 18:38:37,095 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 18:38:37,336 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:37,337 INFO Message mask non-zero count: 3 out of 100
2025-06-15 18:38:37,885 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 18:38:38,255 INFO Created and added message mask to eval feed_dict with shape (28, 5, 20)
2025-06-15 18:38:38,255 INFO Message mask non-zero count: 922 out of 2800
2025-06-15 18:38:41,323 INFO Evaluated batch for dev phase: size=28.0, acc=0.4643
2025-06-15 18:38:41,665 INFO Created and added message mask to eval feed_dict with shape (28, 5, 20)
2025-06-15 18:38:41,666 INFO Message mask non-zero count: 795 out of 2800
2025-06-15 18:38:44,850 INFO Evaluated batch for dev phase: size=28.0, acc=0.4286
2025-06-15 18:38:45,165 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:38:45,165 INFO Message mask non-zero count: 226 out of 1700
2025-06-15 18:38:47,266 INFO Evaluated batch for dev phase: size=17.0, acc=0.5294
2025-06-15 18:38:47,537 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:47,537 INFO Message mask non-zero count: 11 out of 300
2025-06-15 18:38:48,357 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:38:48,704 INFO Created and added message mask to eval feed_dict with shape (13, 5, 20)
2025-06-15 18:38:48,705 INFO Message mask non-zero count: 181 out of 1300
2025-06-15 18:38:50,540 INFO Evaluated batch for dev phase: size=13.0, acc=0.5385
2025-06-15 18:38:50,875 INFO Created and added message mask to eval feed_dict with shape (26, 5, 20)
2025-06-15 18:38:50,876 INFO Message mask non-zero count: 591 out of 2600
2025-06-15 18:38:53,825 INFO Evaluated batch for dev phase: size=26.0, acc=0.6154
2025-06-15 18:38:54,136 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:38:54,136 INFO Message mask non-zero count: 180 out of 1200
2025-06-15 18:38:55,937 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 18:38:56,824 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:38:56,824 INFO Message mask non-zero count: 250 out of 1700
2025-06-15 18:38:58,960 INFO Evaluated batch for dev phase: size=17.0, acc=0.6471
2025-06-15 18:38:59,322 INFO Created and added message mask to eval feed_dict with shape (26, 5, 20)
2025-06-15 18:38:59,323 INFO Message mask non-zero count: 856 out of 2600
2025-06-15 18:39:02,503 INFO Evaluated batch for dev phase: size=26.0, acc=0.6923
2025-06-15 18:39:02,860 INFO Created and added message mask to eval feed_dict with shape (22, 5, 20)
2025-06-15 18:39:02,860 INFO Message mask non-zero count: 286 out of 2200
2025-06-15 18:39:05,353 INFO Evaluated batch for dev phase: size=22.0, acc=0.5455
2025-06-15 18:39:05,784 INFO Created and added message mask to eval feed_dict with shape (31, 5, 20)
2025-06-15 18:39:05,784 INFO Message mask non-zero count: 1658 out of 3100
2025-06-15 18:39:09,111 INFO Evaluated batch for dev phase: size=31.0, acc=0.7419
2025-06-15 18:39:09,445 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:39:09,445 INFO Message mask non-zero count: 495 out of 2000
2025-06-15 18:53:06,414 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:53:06,414 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:53:06,414 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:53:06,415 INFO Configuration - use_ca_tsu: True
2025-06-15 18:53:06,415 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:53:06,415 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:53:06,416 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:53:06,416 INFO Configuration - variant_type: hedge
2025-06-15 18:53:06,416 INFO Full model configuration:
2025-06-15 18:53:06,416 INFO   alpha: 0.5
2025-06-15 18:53:06,417 INFO   batch_size: 32
2025-06-15 18:53:06,417 INFO   ca_tsu_weight: 0.3
2025-06-15 18:53:06,417 INFO   causal_loss_lambda: 0.3
2025-06-15 18:53:06,418 INFO   clip: 15.0
2025-06-15 18:53:06,418 INFO   consistency_loss_weight: 0.05
2025-06-15 18:53:06,418 INFO   constant_kl_lambda: 0.1
2025-06-15 18:53:06,418 INFO   daily_att: y
2025-06-15 18:53:06,419 INFO   decay_rate: 0.96
2025-06-15 18:53:06,419 INFO   decay_step: 100
2025-06-15 18:53:06,419 INFO   dropout_ce: 0.0
2025-06-15 18:53:06,419 INFO   dropout_mel: 0.0
2025-06-15 18:53:06,420 INFO   dropout_mel_in: 0.3
2025-06-15 18:53:06,420 INFO   dropout_vmd: 0.0
2025-06-15 18:53:06,420 INFO   dropout_vmd_in: 0.3
2025-06-15 18:53:06,421 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:53:06,421 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:53:06,421 INFO   g_size: 50
2025-06-15 18:53:06,421 INFO   h_size: 150
2025-06-15 18:53:06,422 INFO   init_stock_with_word: 0
2025-06-15 18:53:06,422 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:53:06,422 INFO   kl_lambda_start_step: 0
2025-06-15 18:53:06,422 INFO   lr: 0.001
2025-06-15 18:53:06,423 INFO   max_n_days: 5
2025-06-15 18:53:06,423 INFO   max_n_msgs: 20
2025-06-15 18:53:06,424 INFO   max_n_words: 30
2025-06-15 18:53:06,424 INFO   mel_cell_type: gru
2025-06-15 18:53:06,424 INFO   mel_h_size: 100
2025-06-15 18:53:06,424 INFO   mode: all
2025-06-15 18:53:06,425 INFO   momentum: 0.9
2025-06-15 18:53:06,425 INFO   msin_h_size: 100
2025-06-15 18:53:06,425 INFO   n_epochs: 10
2025-06-15 18:53:06,425 INFO   noise_aware_weight: 0.5
2025-06-15 18:53:06,426 INFO   opt: adam
2025-06-15 18:53:06,426 INFO   pathway_competition_type: dynamic
2025-06-15 18:53:06,426 INFO   prediction_loss_weight: 0.1
2025-06-15 18:53:06,426 INFO   residual_connection_weight: 0.1
2025-06-15 18:53:06,427 INFO   shuffle: 1
2025-06-15 18:53:06,427 INFO   stock_embed_size: 150
2025-06-15 18:53:06,427 INFO   td_temporal_attention: True
2025-06-15 18:53:06,427 INFO   use_ca_tsu: True
2025-06-15 18:53:06,427 INFO   use_constant_kl_lambda: 0
2025-06-15 18:53:06,427 INFO   use_dual_path_srl: True
2025-06-15 18:53:06,428 INFO   use_enhanced_srl: True
2025-06-15 18:53:06,428 INFO   use_g_bn: 0
2025-06-15 18:53:06,428 INFO   use_in_bn: 0
2025-06-15 18:53:06,428 INFO   use_noise_aware_loss: True
2025-06-15 18:53:06,428 INFO   use_o_bn: 0
2025-06-15 18:53:06,429 INFO   variant_type: hedge
2025-06-15 18:53:06,429 INFO   vmd_cell_type: gru
2025-06-15 18:53:06,429 INFO   vmd_rec: zh
2025-06-15 18:53:06,430 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:53:06,430 INFO   volatility_reg_weight: 0.05
2025-06-15 18:53:06,430 INFO   weight_init: xavier-uniform
2025-06-15 18:53:06,430 INFO   word_embed_size: 50
2025-06-15 18:53:06,430 INFO   word_embed_type: glove
2025-06-15 18:53:06,431 INFO   y_size: 2
2025-06-15 18:53:06,431 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:53:06,434 INFO Start graph assembling...
2025-06-15 18:53:08,368 INFO use_dual_path_srl: True
2025-06-15 18:53:08,369 INFO variant_type: hedge
2025-06-15 18:53:08,370 INFO use_enhanced_srl: True
2025-06-15 18:53:08,370 INFO Enhanced SRL enabled from config
2025-06-15 18:53:08,370 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:53:08,370 INFO SRL condition: True = True and True
2025-06-15 18:53:08,371 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:53:08,371 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:53:08,423 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:53:08,428 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:53:08,461 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:53:08,702 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:53:08,702 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:53:08,703 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:53:09,030 INFO Using Temporal Attention (TAP)
2025-06-15 18:53:09,074 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:53:09,075 INFO Ca-TSU enabled: True
2025-06-15 18:53:09,075 INFO Enhanced SRL enabled: True
2025-06-15 18:53:09,075 INFO Noise-Aware Loss enabled: True
2025-06-15 18:53:09,090 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:09,091 INFO Adding auxiliary enhancement losses...
2025-06-15 18:53:09,112 INFO Creating Noise-Aware Loss component...
2025-06-15 18:53:09,119 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:53:09,120 INFO Creating Causal Consistency Loss component...
2025-06-15 18:53:09,150 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:53:09,151 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:09,151 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:53:11,718 INFO Graph assembled successfully.
2025-06-15 18:53:11,720 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:53:11,721 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:53:12,021 INFO Verifying model configuration...
2025-06-15 18:53:12,021 INFO Ca-TSU enabled: True
2025-06-15 18:53:12,022 INFO Enhanced SRL enabled: True
2025-06-15 18:53:12,022 INFO Noise-Aware Loss enabled: True
2025-06-15 18:53:12,022 INFO Checking model components for noise-aware loss...
2025-06-15 18:53:12,022 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:53:12,022 INFO use_noise_aware_loss value: True
2025-06-15 18:53:12,023 INFO Model has 'noise_aware_weight': True
2025-06-15 18:53:12,023 INFO noise_aware_weight value: 0.5
2025-06-15 18:53:12,023 INFO Model has 'noise_aware_loss': False
2025-06-15 18:53:12,023 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:53:12,024 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:53:12,024 INFO Model has 'reliability_weights': True
2025-06-15 18:53:12,024 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:53:12,024 INFO use_enhanced_srl value: True
2025-06-15 18:53:12,024 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:53:12,024 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:53:12,024 INFO Model has 'use_ca_tsu': True
2025-06-15 18:53:12,024 INFO use_ca_tsu value: True
2025-06-15 18:53:12,026 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:53:12,026 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:53:12,026 INFO Model has 'loss_components': True
2025-06-15 18:53:12,026 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:53:12,026 INFO Manually activating loss components...
2025-06-15 18:53:12,027 INFO Components manually activated:
2025-06-15 18:53:12,027 INFO use_enhanced_srl: True
2025-06-15 18:53:12,027 INFO use_ca_tsu: True
2025-06-15 18:53:12,027 INFO use_noise_aware_loss: True
2025-06-15 18:53:12,027 INFO use_dual_path_srl: True
2025-06-15 18:53:12,027 INFO Running test_noise_aware_loss...
2025-06-15 18:53:32,145 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:53:33,930 INFO Word table initialized
2025-06-15 18:53:33,931 INFO Checking loss components in the model graph...
2025-06-15 18:53:33,931 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:53:33,932 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,933 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,933 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,934 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 18:53:33,935 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 18:53:34,141 INFO Starting training test for 10 batches
2025-06-15 18:53:51,272 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:54:07,194 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 18:54:07,194 INFO   PERFORMANCE: Loss=1.3386 | Acc=0.5000 | MCC=0.0000
2025-06-15 18:54:07,194 INFO   LOSS COMPONENTS:
2025-06-15 18:54:07,195 INFO     - Causal Consistency Loss: 0.216385
2025-06-15 18:54:07,195 INFO     - Noise-Aware SRL Loss: 0.567857
2025-06-15 18:54:07,195 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:54:07,196 INFO     Alpha_i sample: 0.7870, Omega_i sample: 0.4769
2025-06-15 18:54:07,196 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:54:07,197 INFO     Volatility: 0.6493, Text Weight: 0.3604, Price Weight: 0.6396
2025-06-15 18:54:30,875 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:00,788 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:23,756 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:43,296 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:57,119 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 18:55:57,119 INFO   PERFORMANCE: Loss=1.5031 | Acc=0.5000 | MCC=-0.0120
2025-06-15 18:55:57,121 INFO   LOSS COMPONENTS:
2025-06-15 18:55:57,121 INFO     - Causal Consistency Loss: -0.081693
2025-06-15 18:55:57,121 INFO     - Noise-Aware SRL Loss: 0.447155
2025-06-15 18:55:57,122 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:55:57,122 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 18:55:57,123 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:55:57,124 INFO     Volatility: 0.6575, Text Weight: 0.4227, Price Weight: 0.5773
2025-06-15 18:56:05,402 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:21,387 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:36,885 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:54,854 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:57:15,822 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:57:30,814 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 18:57:30,816 INFO   PERFORMANCE: Loss=1.5266 | Acc=0.5625 | MCC=0.1291
2025-06-15 18:57:30,816 INFO   LOSS COMPONENTS:
2025-06-15 18:57:30,817 INFO     - Causal Consistency Loss: -0.132024
2025-06-15 18:57:30,818 INFO     - Noise-Aware SRL Loss: 0.259278
2025-06-15 18:57:30,818 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:57:30,819 INFO     Alpha_i sample: 0.0392, Omega_i sample: 0.1166
2025-06-15 18:57:30,819 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:57:30,821 INFO     Volatility: 0.6588, Text Weight: 0.5611, Price Weight: 0.4389
2025-06-15 18:57:30,821 INFO Generating diagnostic plots...
2025-06-15 18:57:34,019 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 18:57:34,020 INFO Saving final checkpoint for test run...
2025-06-15 18:57:34,287 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate16299212146189351773 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2209, MSIN_RNN/market_projection/kernel/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2213, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2215, MSIN_RNN/text_price_cross_attention/dense/bias/_2217, MSIN_RNN/text_price_cross_attention/dense/kernel/_2219, MSIN_RNN/text_self_attention/LayerNorm/beta/_2221, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2223, MSIN_RNN/text_self_attention/dense/bias/_2225, MSIN_RNN/text_self_attention/dense/kernel/_2227, W_f/_2229, W_ha/_2231, W_hf/_2233, W_hk/_2235, W_ho/_2237, W_hs/_2239, W_ht/_2241, W_hv/_2243, W_k/_2245, W_o/_2247, W_price_pred/_2249, W_price_pred/Adam/_2251, W_price_pred/Adam_1/_2253, W_reliability/_2255, W_reliability/Adam/_2257, W_reliability/Adam_1/_2259, W_s/_2261, W_sa/_2263, W_t/_2265, W_v/_2267, W_vk/_2269, b_price_pred/_2271, b_price_pred/Adam/_2273, b_price_pred/Adam_1/_2275, b_reliability/_2277, b_reliability/Adam/_2279, b_reliability/Adam_1/_2281, ca_tsu/W_K/_2283, ca_tsu/W_K/Adam/_2285, ca_tsu/W_K/Adam_1/_2287, ca_tsu/W_Q/_2289, ca_tsu/W_Q/Adam/_2291, ca_tsu/W_Q/Adam_1/_2293, ca_tsu/b_causal/_2295, ca_tsu/b_causal/Adam/_2297, ca_tsu/b_causal/Adam_1/_2299, embeds/word_table/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2311, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2347, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2419, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2421, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2443, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2467, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2469, mie/Variable/_2471, mie/Variable_1/_2473, mie/Variable_2/_2475, mie/Variable_3/_2477, mie/Variable_4/_2479, mie/Variable_5/_2481, mie/Variable_6/_2483, mie/Variable_7/_2485, optimizer/beta1_power/_2487, optimizer/beta2_power/_2489, tda/pred_from_gT_att_logits/bias/_2491, tda/pred_from_gT_att_logits/bias/Adam/_2493, tda/pred_from_gT_att_logits/bias/Adam_1/_2495, tda/pred_from_gT_att_logits/kernel/_2497, tda/pred_from_gT_att_logits/kernel/Adam/_2499, tda/pred_from_gT_att_logits/kernel/Adam_1/_2501, tda/v_i/g_projection_att/kernel/_2503, tda/v_i/g_projection_att/kernel/Adam/_2505, tda/v_i/g_projection_att/kernel/Adam_1/_2507, tda/v_i/w_i_temporal_att/_2509, tda/v_i/w_i_temporal_att/Adam/_2511, tda/v_i/w_i_temporal_att/Adam_1/_2513, text_diff_projection/bias/_2515, text_diff_projection/bias/Adam/_2517, text_diff_projection/bias/Adam_1/_2519, text_diff_projection/kernel/_2521, text_diff_projection/kernel/Adam/_2523, text_diff_projection/kernel/Adam_1/_2525, text_price_cross_attention/dense/_2527, text_price_cross_attention/wk/_2529, text_price_cross_attention/wq/_2531, text_price_cross_attention/wv/_2533, text_self_attention/dense/_2535, text_self_attention/wk/_2537, text_self_attention/wq/_2539, text_self_attention/wv/_2541, u_t/linear_layer/W/_2543, u_t/linear_layer/W/Adam/_2545, u_t/linear_layer/W/Adam_1/_2547, u_t/w_u_original/_2549, u_t/w_u_original/Adam/_2551, u_t/w_u_original/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2563, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2575, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2587, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2599, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2623, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2635, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2647, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2659, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2661)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate16299212146189351773 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2209, MSIN_RNN/market_projection/kernel/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2213, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2215, MSIN_RNN/text_price_cross_attention/dense/bias/_2217, MSIN_RNN/text_price_cross_attention/dense/kernel/_2219, MSIN_RNN/text_self_attention/LayerNorm/beta/_2221, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2223, MSIN_RNN/text_self_attention/dense/bias/_2225, MSIN_RNN/text_self_attention/dense/kernel/_2227, W_f/_2229, W_ha/_2231, W_hf/_2233, W_hk/_2235, W_ho/_2237, W_hs/_2239, W_ht/_2241, W_hv/_2243, W_k/_2245, W_o/_2247, W_price_pred/_2249, W_price_pred/Adam/_2251, W_price_pred/Adam_1/_2253, W_reliability/_2255, W_reliability/Adam/_2257, W_reliability/Adam_1/_2259, W_s/_2261, W_sa/_2263, W_t/_2265, W_v/_2267, W_vk/_2269, b_price_pred/_2271, b_price_pred/Adam/_2273, b_price_pred/Adam_1/_2275, b_reliability/_2277, b_reliability/Adam/_2279, b_reliability/Adam_1/_2281, ca_tsu/W_K/_2283, ca_tsu/W_K/Adam/_2285, ca_tsu/W_K/Adam_1/_2287, ca_tsu/W_Q/_2289, ca_tsu/W_Q/Adam/_2291, ca_tsu/W_Q/Adam_1/_2293, ca_tsu/b_causal/_2295, ca_tsu/b_causal/Adam/_2297, ca_tsu/b_causal/Adam_1/_2299, embeds/word_table/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2311, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2347, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2419, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2421, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2443, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2467, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2469, mie/Variable/_2471, mie/Variable_1/_2473, mie/Variable_2/_2475, mie/Variable_3/_2477, mie/Variable_4/_2479, mie/Variable_5/_2481, mie/Variable_6/_2483, mie/Variable_7/_2485, optimizer/beta1_power/_2487, optimizer/beta2_power/_2489, tda/pred_from_gT_att_logits/bias/_2491, tda/pred_from_gT_att_logits/bias/Adam/_2493, tda/pred_from_gT_att_logits/bias/Adam_1/_2495, tda/pred_from_gT_att_logits/kernel/_2497, tda/pred_from_gT_att_logits/kernel/Adam/_2499, tda/pred_from_gT_att_logits/kernel/Adam_1/_2501, tda/v_i/g_projection_att/kernel/_2503, tda/v_i/g_projection_att/kernel/Adam/_2505, tda/v_i/g_projection_att/kernel/Adam_1/_2507, tda/v_i/w_i_temporal_att/_2509, tda/v_i/w_i_temporal_att/Adam/_2511, tda/v_i/w_i_temporal_att/Adam_1/_2513, text_diff_projection/bias/_2515, text_diff_projection/bias/Adam/_2517, text_diff_projection/bias/Adam_1/_2519, text_diff_projection/kernel/_2521, text_diff_projection/kernel/Adam/_2523, text_diff_projection/kernel/Adam_1/_2525, text_price_cross_attention/dense/_2527, text_price_cross_attention/wk/_2529, text_price_cross_attention/wq/_2531, text_price_cross_attention/wv/_2533, text_self_attention/dense/_2535, text_self_attention/wk/_2537, text_self_attention/wq/_2539, text_self_attention/wv/_2541, u_t/linear_layer/W/_2543, u_t/linear_layer/W/Adam/_2545, u_t/linear_layer/W/Adam_1/_2547, u_t/w_u_original/_2549, u_t/w_u_original/Adam/_2551, u_t/w_u_original/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2563, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2575, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2587, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2599, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2623, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2635, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2647, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2659, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2661)]]

2025-06-15 18:57:34,290 INFO Start dev phase...
2025-06-15 18:57:36,805 INFO Created and added message mask to eval feed_dict with shape (32, 5, 20)
2025-06-15 18:57:36,806 INFO Message mask non-zero count: 1966 out of 3200
2025-06-15 18:57:41,276 INFO Evaluated batch for dev phase: size=32.0, acc=0.4375
2025-06-15 18:57:41,620 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:57:41,621 INFO Message mask non-zero count: 114 out of 900
2025-06-15 18:57:43,182 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:57:43,448 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:57:43,448 INFO Message mask non-zero count: 8 out of 100
2025-06-15 18:57:44,011 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:57:44,367 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:57:44,367 INFO Message mask non-zero count: 106 out of 900
2025-06-15 18:57:45,868 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:57:46,674 INFO Created and added message mask to eval feed_dict with shape (2, 5, 20)
2025-06-15 18:57:46,675 INFO Message mask non-zero count: 31 out of 200
2025-06-15 18:57:47,285 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 18:57:48,061 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:57:48,061 INFO Message mask non-zero count: 23 out of 300
2025-06-15 18:57:48,793 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:57:49,813 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:57:49,815 INFO Message mask non-zero count: 221 out of 1700
2025-06-15 18:57:52,040 INFO Evaluated batch for dev phase: size=17.0, acc=0.3529
2025-06-15 18:57:52,334 INFO Created and added message mask to eval feed_dict with shape (8, 5, 20)
2025-06-15 18:57:52,335 INFO Message mask non-zero count: 52 out of 800
2025-06-15 18:57:53,623 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 18:57:53,939 INFO Created and added message mask to eval feed_dict with shape (21, 5, 20)
2025-06-15 18:57:53,940 INFO Message mask non-zero count: 342 out of 2100
2025-06-15 18:57:56,949 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 18:57:57,281 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:57:57,282 INFO Message mask non-zero count: 241 out of 2000
2025-06-15 18:57:59,933 INFO Evaluated batch for dev phase: size=20.0, acc=0.6000
2025-06-15 18:58:00,276 INFO Created and added message mask to eval feed_dict with shape (19, 5, 20)
2025-06-15 18:58:00,277 INFO Message mask non-zero count: 270 out of 1900
2025-06-15 18:58:02,773 INFO Evaluated batch for dev phase: size=19.0, acc=0.5789
2025-06-15 18:58:03,302 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:58:03,303 INFO Message mask non-zero count: 20 out of 400
2025-06-15 18:58:04,110 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 18:58:04,453 INFO Created and added message mask to eval feed_dict with shape (15, 5, 20)
2025-06-15 18:58:04,453 INFO Message mask non-zero count: 193 out of 1500
2025-06-15 18:58:06,376 INFO Evaluated batch for dev phase: size=15.0, acc=0.7333
2025-06-15 18:58:06,679 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:58:06,680 INFO Message mask non-zero count: 101 out of 1200
2025-06-15 18:58:08,466 INFO Evaluated batch for dev phase: size=12.0, acc=0.5000
2025-06-15 18:58:08,999 INFO Created and added message mask to eval feed_dict with shape (7, 5, 20)
2025-06-15 18:58:08,999 INFO Message mask non-zero count: 47 out of 700
2025-06-15 18:58:10,315 INFO Evaluated batch for dev phase: size=7.0, acc=0.2857
2025-06-15 19:30:39,939 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 19:30:39,940 INFO Configuration - use_dual_path_srl: True
2025-06-15 19:30:39,940 INFO Configuration - use_enhanced_srl: True
2025-06-15 19:30:39,940 INFO Configuration - use_ca_tsu: True
2025-06-15 19:30:39,940 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 19:30:39,940 INFO Configuration - use_noise_aware_loss: True
2025-06-15 19:30:39,941 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 19:30:39,941 INFO Configuration - variant_type: hedge
2025-06-15 19:30:39,941 INFO Full model configuration:
2025-06-15 19:30:39,941 INFO   alpha: 0.5
2025-06-15 19:30:39,941 INFO   batch_size: 32
2025-06-15 19:30:39,941 INFO   ca_tsu_weight: 0.3
2025-06-15 19:30:39,941 INFO   causal_loss_lambda: 0.3
2025-06-15 19:30:39,941 INFO   clip: 15.0
2025-06-15 19:30:39,943 INFO   consistency_loss_weight: 0.05
2025-06-15 19:30:39,943 INFO   constant_kl_lambda: 0.1
2025-06-15 19:30:39,943 INFO   daily_att: y
2025-06-15 19:30:39,943 INFO   decay_rate: 0.96
2025-06-15 19:30:39,943 INFO   decay_step: 100
2025-06-15 19:30:39,944 INFO   dropout_ce: 0.0
2025-06-15 19:30:39,944 INFO   dropout_mel: 0.0
2025-06-15 19:30:39,944 INFO   dropout_mel_in: 0.3
2025-06-15 19:30:39,944 INFO   dropout_vmd: 0.0
2025-06-15 19:30:39,944 INFO   dropout_vmd_in: 0.3
2025-06-15 19:30:39,945 INFO   enhanced_srl_weight: 0.1
2025-06-15 19:30:39,945 INFO   entropy_regularization_lambda: 0.001
2025-06-15 19:30:39,945 INFO   g_size: 50
2025-06-15 19:30:39,945 INFO   h_size: 150
2025-06-15 19:30:39,945 INFO   init_stock_with_word: 0
2025-06-15 19:30:39,946 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 19:30:39,946 INFO   kl_lambda_start_step: 0
2025-06-15 19:30:39,946 INFO   lr: 0.001
2025-06-15 19:30:39,946 INFO   max_n_days: 5
2025-06-15 19:30:39,946 INFO   max_n_msgs: 20
2025-06-15 19:30:39,946 INFO   max_n_words: 30
2025-06-15 19:30:39,947 INFO   mel_cell_type: gru
2025-06-15 19:30:39,947 INFO   mel_h_size: 100
2025-06-15 19:30:39,947 INFO   mode: all
2025-06-15 19:30:39,947 INFO   momentum: 0.9
2025-06-15 19:30:39,947 INFO   msin_h_size: 100
2025-06-15 19:30:39,947 INFO   n_epochs: 10
2025-06-15 19:30:39,947 INFO   noise_aware_weight: 0.5
2025-06-15 19:30:39,948 INFO   opt: adam
2025-06-15 19:30:39,948 INFO   pathway_competition_type: dynamic
2025-06-15 19:30:39,948 INFO   prediction_loss_weight: 0.1
2025-06-15 19:30:39,948 INFO   residual_connection_weight: 0.1
2025-06-15 19:30:39,949 INFO   shuffle: 1
2025-06-15 19:30:39,949 INFO   stock_embed_size: 150
2025-06-15 19:30:39,949 INFO   td_temporal_attention: True
2025-06-15 19:30:39,949 INFO   use_ca_tsu: True
2025-06-15 19:30:39,949 INFO   use_constant_kl_lambda: 0
2025-06-15 19:30:39,949 INFO   use_dual_path_srl: True
2025-06-15 19:30:39,950 INFO   use_enhanced_srl: True
2025-06-15 19:30:39,950 INFO   use_g_bn: 0
2025-06-15 19:30:39,950 INFO   use_in_bn: 0
2025-06-15 19:30:39,950 INFO   use_noise_aware_loss: True
2025-06-15 19:30:39,950 INFO   use_o_bn: 0
2025-06-15 19:30:39,951 INFO   variant_type: hedge
2025-06-15 19:30:39,951 INFO   vmd_cell_type: gru
2025-06-15 19:30:39,951 INFO   vmd_rec: zh
2025-06-15 19:30:39,951 INFO   volatility_adaptation_factor: 0.3
2025-06-15 19:30:39,951 INFO   volatility_reg_weight: 0.05
2025-06-15 19:30:39,951 INFO   weight_init: xavier-uniform
2025-06-15 19:30:39,952 INFO   word_embed_size: 50
2025-06-15 19:30:39,952 INFO   word_embed_type: glove
2025-06-15 19:30:39,952 INFO   y_size: 2
2025-06-15 19:30:39,953 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 19:30:39,955 INFO Start graph assembling...
2025-06-15 19:30:42,011 INFO use_dual_path_srl: True
2025-06-15 19:30:42,011 INFO variant_type: hedge
2025-06-15 19:30:42,013 INFO use_enhanced_srl: True
2025-06-15 19:30:42,013 INFO Enhanced SRL enabled from config
2025-06-15 19:30:42,013 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 19:30:42,014 INFO SRL condition: True = True and True
2025-06-15 19:30:42,014 INFO Using enhanced dual-path SRL architecture
2025-06-15 19:30:42,014 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 19:30:42,066 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 19:30:42,071 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 19:30:42,092 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 19:30:42,361 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 19:30:42,362 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 19:30:42,362 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 19:30:42,727 INFO Using Temporal Attention (TAP)
2025-06-15 19:30:42,783 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 19:30:42,783 INFO Ca-TSU enabled: True
2025-06-15 19:30:42,784 INFO Enhanced SRL enabled: True
2025-06-15 19:30:42,784 INFO Noise-Aware Loss enabled: True
2025-06-15 19:30:42,802 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:30:42,803 INFO Adding auxiliary enhancement losses...
2025-06-15 19:30:42,830 INFO Creating Noise-Aware Loss component...
2025-06-15 19:30:42,844 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 19:30:42,847 INFO Creating Causal Consistency Loss component...
2025-06-15 19:30:42,884 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 19:30:42,884 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:30:42,885 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:30:45,743 INFO Graph assembled successfully.
2025-06-15 19:30:45,745 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:30:45,745 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:30:46,031 INFO Verifying model configuration...
2025-06-15 19:30:46,031 INFO Ca-TSU enabled: True
2025-06-15 19:30:46,031 INFO Enhanced SRL enabled: True
2025-06-15 19:30:46,031 INFO Noise-Aware Loss enabled: True
2025-06-15 19:30:46,033 INFO Checking model components for noise-aware loss...
2025-06-15 19:30:46,033 INFO Model has 'use_noise_aware_loss': True
2025-06-15 19:30:46,033 INFO use_noise_aware_loss value: True
2025-06-15 19:30:46,033 INFO Model has 'noise_aware_weight': True
2025-06-15 19:30:46,033 INFO noise_aware_weight value: 0.5
2025-06-15 19:30:46,033 INFO Model has 'noise_aware_loss': False
2025-06-15 19:30:46,034 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 19:30:46,034 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 19:30:46,034 INFO Model has 'reliability_weights': True
2025-06-15 19:30:46,034 INFO Model has 'use_enhanced_srl': True
2025-06-15 19:30:46,034 INFO use_enhanced_srl value: True
2025-06-15 19:30:46,035 INFO Model has 'enhanced_srl_loss': False
2025-06-15 19:30:46,035 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 19:30:46,035 INFO Model has 'use_ca_tsu': True
2025-06-15 19:30:46,035 INFO use_ca_tsu value: True
2025-06-15 19:30:46,035 INFO Model has 'causal_consistency_loss': False
2025-06-15 19:30:46,035 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 19:30:46,036 INFO Model has 'loss_components': True
2025-06-15 19:30:46,036 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 19:30:46,036 INFO Manually activating loss components...
2025-06-15 19:30:46,036 INFO Components manually activated:
2025-06-15 19:30:46,036 INFO use_enhanced_srl: True
2025-06-15 19:30:46,036 INFO use_ca_tsu: True
2025-06-15 19:30:46,037 INFO use_noise_aware_loss: True
2025-06-15 19:30:46,037 INFO use_dual_path_srl: True
2025-06-15 19:30:46,037 INFO Running test_noise_aware_loss...
2025-06-15 19:31:04,787 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 19:31:06,864 INFO Word table initialized
2025-06-15 19:31:06,865 INFO Checking loss components in the model graph...
2025-06-15 19:31:06,865 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:31:06,866 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,866 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,866 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,867 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 19:31:06,868 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 19:31:06,982 INFO Starting training test for 10 batches
2025-06-15 19:31:34,559 ERROR Error during test_noise_aware_loss: list indices must be integers or slices, not str
2025-06-15 19:31:34,560 ERROR Traceback (most recent call last):
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 761, in test_noise_aware_loss
    ops_to_run[tensor_name] = getattr(self.model, tensor_name)
TypeError: list indices must be integers or slices, not str

2025-06-15 19:31:34,570 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_193134.txt
2025-06-15 19:31:34,571 INFO Test completed successfully!
2025-06-15 19:42:28,578 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 19:42:28,579 INFO Configuration - use_dual_path_srl: True
2025-06-15 19:42:28,579 INFO Configuration - use_enhanced_srl: True
2025-06-15 19:42:28,579 INFO Configuration - use_ca_tsu: True
2025-06-15 19:42:28,580 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 19:42:28,580 INFO Configuration - use_noise_aware_loss: True
2025-06-15 19:42:28,580 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 19:42:28,580 INFO Configuration - variant_type: hedge
2025-06-15 19:42:28,581 INFO Full model configuration:
2025-06-15 19:42:28,581 INFO   alpha: 0.5
2025-06-15 19:42:28,581 INFO   batch_size: 32
2025-06-15 19:42:28,581 INFO   ca_tsu_weight: 0.3
2025-06-15 19:42:28,581 INFO   causal_loss_lambda: 0.3
2025-06-15 19:42:28,582 INFO   clip: 15.0
2025-06-15 19:42:28,582 INFO   consistency_loss_weight: 0.05
2025-06-15 19:42:28,582 INFO   constant_kl_lambda: 0.1
2025-06-15 19:42:28,582 INFO   daily_att: y
2025-06-15 19:42:28,582 INFO   decay_rate: 0.96
2025-06-15 19:42:28,582 INFO   decay_step: 100
2025-06-15 19:42:28,583 INFO   dropout_ce: 0.0
2025-06-15 19:42:28,583 INFO   dropout_mel: 0.0
2025-06-15 19:42:28,583 INFO   dropout_mel_in: 0.3
2025-06-15 19:42:28,583 INFO   dropout_vmd: 0.0
2025-06-15 19:42:28,584 INFO   dropout_vmd_in: 0.3
2025-06-15 19:42:28,584 INFO   enhanced_srl_weight: 0.1
2025-06-15 19:42:28,584 INFO   entropy_regularization_lambda: 0.001
2025-06-15 19:42:28,584 INFO   g_size: 50
2025-06-15 19:42:28,585 INFO   h_size: 150
2025-06-15 19:42:28,585 INFO   init_stock_with_word: 0
2025-06-15 19:42:28,585 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 19:42:28,585 INFO   kl_lambda_start_step: 0
2025-06-15 19:42:28,586 INFO   lr: 0.001
2025-06-15 19:42:28,586 INFO   max_n_days: 5
2025-06-15 19:42:28,586 INFO   max_n_msgs: 20
2025-06-15 19:42:28,586 INFO   max_n_words: 30
2025-06-15 19:42:28,587 INFO   mel_cell_type: gru
2025-06-15 19:42:28,587 INFO   mel_h_size: 100
2025-06-15 19:42:28,587 INFO   mode: all
2025-06-15 19:42:28,587 INFO   momentum: 0.9
2025-06-15 19:42:28,587 INFO   msin_h_size: 100
2025-06-15 19:42:28,588 INFO   n_epochs: 10
2025-06-15 19:42:28,588 INFO   noise_aware_weight: 0.5
2025-06-15 19:42:28,588 INFO   opt: adam
2025-06-15 19:42:28,588 INFO   pathway_competition_type: dynamic
2025-06-15 19:42:28,589 INFO   prediction_loss_weight: 0.1
2025-06-15 19:42:28,589 INFO   residual_connection_weight: 0.1
2025-06-15 19:42:28,589 INFO   shuffle: 1
2025-06-15 19:42:28,589 INFO   stock_embed_size: 150
2025-06-15 19:42:28,590 INFO   td_temporal_attention: True
2025-06-15 19:42:28,590 INFO   use_ca_tsu: True
2025-06-15 19:42:28,590 INFO   use_constant_kl_lambda: 0
2025-06-15 19:42:28,590 INFO   use_dual_path_srl: True
2025-06-15 19:42:28,590 INFO   use_enhanced_srl: True
2025-06-15 19:42:28,591 INFO   use_g_bn: 0
2025-06-15 19:42:28,591 INFO   use_in_bn: 0
2025-06-15 19:42:28,591 INFO   use_noise_aware_loss: True
2025-06-15 19:42:28,591 INFO   use_o_bn: 0
2025-06-15 19:42:28,592 INFO   variant_type: hedge
2025-06-15 19:42:28,592 INFO   vmd_cell_type: gru
2025-06-15 19:42:28,592 INFO   vmd_rec: zh
2025-06-15 19:42:28,592 INFO   volatility_adaptation_factor: 0.3
2025-06-15 19:42:28,592 INFO   volatility_reg_weight: 0.05
2025-06-15 19:42:28,593 INFO   weight_init: xavier-uniform
2025-06-15 19:42:28,593 INFO   word_embed_size: 50
2025-06-15 19:42:28,593 INFO   word_embed_type: glove
2025-06-15 19:42:28,593 INFO   y_size: 2
2025-06-15 19:42:28,594 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 19:42:28,597 INFO Start graph assembling...
2025-06-15 19:42:30,453 INFO use_dual_path_srl: True
2025-06-15 19:42:30,454 INFO variant_type: hedge
2025-06-15 19:42:30,454 INFO use_enhanced_srl: True
2025-06-15 19:42:30,454 INFO Enhanced SRL enabled from config
2025-06-15 19:42:30,455 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 19:42:30,455 INFO SRL condition: True = True and True
2025-06-15 19:42:30,455 INFO Using enhanced dual-path SRL architecture
2025-06-15 19:42:30,455 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 19:42:30,503 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 19:42:30,508 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 19:42:30,530 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 19:42:30,767 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 19:42:30,768 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 19:42:30,768 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 19:42:31,066 INFO Using Temporal Attention (TAP)
2025-06-15 19:42:31,111 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 19:42:31,111 INFO Ca-TSU enabled: True
2025-06-15 19:42:31,111 INFO Enhanced SRL enabled: True
2025-06-15 19:42:31,111 INFO Noise-Aware Loss enabled: True
2025-06-15 19:42:31,126 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:31,127 INFO Adding auxiliary enhancement losses...
2025-06-15 19:42:31,152 INFO Creating Noise-Aware Loss component...
2025-06-15 19:42:31,161 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 19:42:31,162 INFO Creating Causal Consistency Loss component...
2025-06-15 19:42:31,197 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 19:42:31,197 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:31,198 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:42:33,706 INFO Graph assembled successfully.
2025-06-15 19:42:33,707 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:42:33,708 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:42:34,002 INFO Verifying model configuration...
2025-06-15 19:42:34,003 INFO Ca-TSU enabled: True
2025-06-15 19:42:34,003 INFO Enhanced SRL enabled: True
2025-06-15 19:42:34,003 INFO Noise-Aware Loss enabled: True
2025-06-15 19:42:34,004 INFO Checking model components for noise-aware loss...
2025-06-15 19:42:34,004 INFO Model has 'use_noise_aware_loss': True
2025-06-15 19:42:34,004 INFO use_noise_aware_loss value: True
2025-06-15 19:42:34,004 INFO Model has 'noise_aware_weight': True
2025-06-15 19:42:34,004 INFO noise_aware_weight value: 0.5
2025-06-15 19:42:34,005 INFO Model has 'noise_aware_loss': False
2025-06-15 19:42:34,005 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 19:42:34,005 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 19:42:34,005 INFO Model has 'reliability_weights': True
2025-06-15 19:42:34,005 INFO Model has 'use_enhanced_srl': True
2025-06-15 19:42:34,006 INFO use_enhanced_srl value: True
2025-06-15 19:42:34,006 INFO Model has 'enhanced_srl_loss': False
2025-06-15 19:42:34,006 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 19:42:34,006 INFO Model has 'use_ca_tsu': True
2025-06-15 19:42:34,006 INFO use_ca_tsu value: True
2025-06-15 19:42:34,007 INFO Model has 'causal_consistency_loss': False
2025-06-15 19:42:34,007 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 19:42:34,007 INFO Model has 'loss_components': True
2025-06-15 19:42:34,007 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 19:42:34,008 INFO Manually activating loss components...
2025-06-15 19:42:34,008 INFO Components manually activated:
2025-06-15 19:42:34,008 INFO use_enhanced_srl: True
2025-06-15 19:42:34,008 INFO use_ca_tsu: True
2025-06-15 19:42:34,009 INFO use_noise_aware_loss: True
2025-06-15 19:42:34,009 INFO use_dual_path_srl: True
2025-06-15 19:42:34,009 INFO Running test_noise_aware_loss...
2025-06-15 19:42:52,295 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 19:42:53,672 INFO Word table initialized
2025-06-15 19:42:53,672 INFO Checking loss components in the model graph...
2025-06-15 19:42:53,673 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:42:53,673 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,673 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,673 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,674 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 19:42:53,674 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 19:42:53,765 INFO Starting training test for 10 batches
2025-06-15 19:43:32,546 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 19:43:32,546 INFO   PERFORMANCE: Loss=1.3541 | Acc=0.5000 | MCC=0.0667
2025-06-15 19:43:32,547 INFO   LOSS COMPONENTS:
2025-06-15 19:43:32,547 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:43:32,548 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:43:32,549 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:43:32,549 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 19:43:32,550 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:43:32,551 INFO     Volatility: 0.6823, Text Weight: 0.4486, Price Weight: 0.5514
2025-06-15 19:45:08,788 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 19:45:08,788 INFO   PERFORMANCE: Loss=1.5291 | Acc=0.4375 | MCC=-0.1524
2025-06-15 19:45:08,789 INFO   LOSS COMPONENTS:
2025-06-15 19:45:08,789 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:45:08,789 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:45:08,790 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:45:08,790 INFO     Alpha_i sample: 0.5267, Omega_i sample: 0.4717
2025-06-15 19:45:08,791 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:45:08,792 INFO     Volatility: 0.6630, Text Weight: 0.5136, Price Weight: 0.4864
2025-06-15 19:46:40,909 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 19:46:40,909 INFO   PERFORMANCE: Loss=1.4441 | Acc=0.5312 | MCC=-0.1556
2025-06-15 19:46:40,909 INFO   LOSS COMPONENTS:
2025-06-15 19:46:40,910 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:46:40,910 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:46:40,910 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:46:40,911 INFO     Alpha_i sample: 0.0256, Omega_i sample: 0.1006
2025-06-15 19:46:40,911 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:46:40,915 INFO     Volatility: 0.6656, Text Weight: 0.4793, Price Weight: 0.5207
2025-06-15 19:46:40,916 INFO Generating diagnostic plots...
2025-06-15 19:46:43,379 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 19:46:43,379 INFO Saving final checkpoint for test run...
2025-06-15 19:46:43,586 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate11164020777254175702 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2203, MSIN_RNN/market_projection/kernel/_2205, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2207, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2209, MSIN_RNN/text_price_cross_attention/dense/bias/_2211, MSIN_RNN/text_price_cross_attention/dense/kernel/_2213, MSIN_RNN/text_self_attention/LayerNorm/beta/_2215, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2217, MSIN_RNN/text_self_attention/dense/bias/_2219, MSIN_RNN/text_self_attention/dense/kernel/_2221, W_f/_2223, W_ha/_2225, W_hf/_2227, W_hk/_2229, W_ho/_2231, W_hs/_2233, W_ht/_2235, W_hv/_2237, W_k/_2239, W_o/_2241, W_price_pred/_2243, W_price_pred/Adam/_2245, W_price_pred/Adam_1/_2247, W_reliability/_2249, W_reliability/Adam/_2251, W_reliability/Adam_1/_2253, W_s/_2255, W_sa/_2257, W_t/_2259, W_v/_2261, W_vk/_2263, b_price_pred/_2265, b_price_pred/Adam/_2267, b_price_pred/Adam_1/_2269, b_reliability/_2271, b_reliability/Adam/_2273, b_reliability/Adam_1/_2275, ca_tsu/W_K/_2277, ca_tsu/W_K/Adam/_2279, ca_tsu/W_K/Adam_1/_2281, ca_tsu/W_Q/_2283, ca_tsu/W_Q/Adam/_2285, ca_tsu/W_Q/Adam_1/_2287, ca_tsu/b_causal/_2289, ca_tsu/b_causal/Adam/_2291, ca_tsu/b_causal/Adam_1/_2293, embeds/word_table/_2295, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2297, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2343, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2345, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2415, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2419, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2463, mie/Variable/_2465, mie/Variable_1/_2467, mie/Variable_2/_2469, mie/Variable_3/_2471, mie/Variable_4/_2473, mie/Variable_5/_2475, mie/Variable_6/_2477, mie/Variable_7/_2479, optimizer/beta1_power/_2481, optimizer/beta2_power/_2483, tda/pred_from_gT_att_logits/bias/_2485, tda/pred_from_gT_att_logits/bias/Adam/_2487, tda/pred_from_gT_att_logits/bias/Adam_1/_2489, tda/pred_from_gT_att_logits/kernel/_2491, tda/pred_from_gT_att_logits/kernel/Adam/_2493, tda/pred_from_gT_att_logits/kernel/Adam_1/_2495, tda/v_i/g_projection_att/kernel/_2497, tda/v_i/g_projection_att/kernel/Adam/_2499, tda/v_i/g_projection_att/kernel/Adam_1/_2501, tda/v_i/w_i_temporal_att/_2503, tda/v_i/w_i_temporal_att/Adam/_2505, tda/v_i/w_i_temporal_att/Adam_1/_2507, text_diff_projection/bias/_2509, text_diff_projection/bias/Adam/_2511, text_diff_projection/bias/Adam_1/_2513, text_diff_projection/kernel/_2515, text_diff_projection/kernel/Adam/_2517, text_diff_projection/kernel/Adam_1/_2519, text_price_cross_attention/dense/_2521, text_price_cross_attention/wk/_2523, text_price_cross_attention/wq/_2525, text_price_cross_attention/wv/_2527, text_self_attention/dense/_2529, text_self_attention/wk/_2531, text_self_attention/wq/_2533, text_self_attention/wv/_2535, u_t/linear_layer/W/_2537, u_t/linear_layer/W/Adam/_2539, u_t/linear_layer/W/Adam_1/_2541, u_t/w_u_original/_2543, u_t/w_u_original/Adam/_2545, u_t/w_u_original/Adam_1/_2547, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2549, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2559, vmd_zh_rec_iter/gru_cell/candidate/bias/_2561, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2567, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/gates/bias/_2573, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/kernel/_2579, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2583, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2585, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2597, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_mu/W/_2609, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/b/_2615, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2619, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2621, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2631, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2633, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_mu/W/_2645, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/b/_2651, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2655)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate11164020777254175702 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2203, MSIN_RNN/market_projection/kernel/_2205, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2207, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2209, MSIN_RNN/text_price_cross_attention/dense/bias/_2211, MSIN_RNN/text_price_cross_attention/dense/kernel/_2213, MSIN_RNN/text_self_attention/LayerNorm/beta/_2215, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2217, MSIN_RNN/text_self_attention/dense/bias/_2219, MSIN_RNN/text_self_attention/dense/kernel/_2221, W_f/_2223, W_ha/_2225, W_hf/_2227, W_hk/_2229, W_ho/_2231, W_hs/_2233, W_ht/_2235, W_hv/_2237, W_k/_2239, W_o/_2241, W_price_pred/_2243, W_price_pred/Adam/_2245, W_price_pred/Adam_1/_2247, W_reliability/_2249, W_reliability/Adam/_2251, W_reliability/Adam_1/_2253, W_s/_2255, W_sa/_2257, W_t/_2259, W_v/_2261, W_vk/_2263, b_price_pred/_2265, b_price_pred/Adam/_2267, b_price_pred/Adam_1/_2269, b_reliability/_2271, b_reliability/Adam/_2273, b_reliability/Adam_1/_2275, ca_tsu/W_K/_2277, ca_tsu/W_K/Adam/_2279, ca_tsu/W_K/Adam_1/_2281, ca_tsu/W_Q/_2283, ca_tsu/W_Q/Adam/_2285, ca_tsu/W_Q/Adam_1/_2287, ca_tsu/b_causal/_2289, ca_tsu/b_causal/Adam/_2291, ca_tsu/b_causal/Adam_1/_2293, embeds/word_table/_2295, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2297, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2343, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2345, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2415, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2419, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2463, mie/Variable/_2465, mie/Variable_1/_2467, mie/Variable_2/_2469, mie/Variable_3/_2471, mie/Variable_4/_2473, mie/Variable_5/_2475, mie/Variable_6/_2477, mie/Variable_7/_2479, optimizer/beta1_power/_2481, optimizer/beta2_power/_2483, tda/pred_from_gT_att_logits/bias/_2485, tda/pred_from_gT_att_logits/bias/Adam/_2487, tda/pred_from_gT_att_logits/bias/Adam_1/_2489, tda/pred_from_gT_att_logits/kernel/_2491, tda/pred_from_gT_att_logits/kernel/Adam/_2493, tda/pred_from_gT_att_logits/kernel/Adam_1/_2495, tda/v_i/g_projection_att/kernel/_2497, tda/v_i/g_projection_att/kernel/Adam/_2499, tda/v_i/g_projection_att/kernel/Adam_1/_2501, tda/v_i/w_i_temporal_att/_2503, tda/v_i/w_i_temporal_att/Adam/_2505, tda/v_i/w_i_temporal_att/Adam_1/_2507, text_diff_projection/bias/_2509, text_diff_projection/bias/Adam/_2511, text_diff_projection/bias/Adam_1/_2513, text_diff_projection/kernel/_2515, text_diff_projection/kernel/Adam/_2517, text_diff_projection/kernel/Adam_1/_2519, text_price_cross_attention/dense/_2521, text_price_cross_attention/wk/_2523, text_price_cross_attention/wq/_2525, text_price_cross_attention/wv/_2527, text_self_attention/dense/_2529, text_self_attention/wk/_2531, text_self_attention/wq/_2533, text_self_attention/wv/_2535, u_t/linear_layer/W/_2537, u_t/linear_layer/W/Adam/_2539, u_t/linear_layer/W/Adam_1/_2541, u_t/w_u_original/_2543, u_t/w_u_original/Adam/_2545, u_t/w_u_original/Adam_1/_2547, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2549, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2559, vmd_zh_rec_iter/gru_cell/candidate/bias/_2561, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2567, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/gates/bias/_2573, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/kernel/_2579, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2583, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2585, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2597, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_mu/W/_2609, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/b/_2615, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2619, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2621, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2631, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2633, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_mu/W/_2645, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/b/_2651, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2655)]]

2025-06-15 19:46:43,589 INFO Start dev phase...
2025-06-15 19:46:50,484 INFO Evaluated batch for dev phase: size=32.0, acc=0.5625
2025-06-15 19:46:52,177 INFO Evaluated batch for dev phase: size=9.0, acc=0.3333
2025-06-15 19:46:53,090 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:46:54,901 INFO Evaluated batch for dev phase: size=9.0, acc=0.3333
2025-06-15 19:46:56,469 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 19:46:58,005 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:01,645 INFO Evaluated batch for dev phase: size=17.0, acc=0.3529
2025-06-15 19:47:03,338 INFO Evaluated batch for dev phase: size=8.0, acc=0.6250
2025-06-15 19:47:06,419 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 19:47:09,359 INFO Evaluated batch for dev phase: size=20.0, acc=0.5500
2025-06-15 19:47:12,083 INFO Evaluated batch for dev phase: size=19.0, acc=0.4737
2025-06-15 19:47:13,729 INFO Evaluated batch for dev phase: size=4.0, acc=0.7500
2025-06-15 19:47:16,278 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 19:47:18,495 INFO Evaluated batch for dev phase: size=12.0, acc=0.5000
2025-06-15 19:47:20,510 INFO Evaluated batch for dev phase: size=7.0, acc=0.7143
2025-06-15 19:47:22,478 INFO Evaluated batch for dev phase: size=11.0, acc=0.1818
2025-06-15 19:47:24,781 INFO Evaluated batch for dev phase: size=14.0, acc=0.5000
2025-06-15 19:47:26,839 INFO Evaluated batch for dev phase: size=9.0, acc=0.1111
2025-06-15 19:47:27,618 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:29,726 INFO Evaluated batch for dev phase: size=14.0, acc=0.5000
2025-06-15 19:47:32,548 INFO Evaluated batch for dev phase: size=20.0, acc=0.5500
2025-06-15 19:47:33,944 INFO Evaluated batch for dev phase: size=6.0, acc=0.6667
2025-06-15 19:47:35,781 INFO Evaluated batch for dev phase: size=11.0, acc=0.2727
2025-06-15 19:47:37,105 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 19:47:38,476 INFO Evaluated batch for dev phase: size=6.0, acc=0.5000
2025-06-15 19:47:40,820 INFO Evaluated batch for dev phase: size=16.0, acc=0.4375
2025-06-15 19:47:42,327 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:44,769 INFO Evaluated batch for dev phase: size=16.0, acc=0.5000
2025-06-15 19:47:47,294 INFO Evaluated batch for dev phase: size=13.0, acc=0.4615
2025-06-15 19:47:48,088 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:49,291 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:50,341 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:51,638 INFO Evaluated batch for dev phase: size=4.0, acc=0.2500
2025-06-15 19:47:52,439 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:55,976 INFO Evaluated batch for dev phase: size=28.0, acc=0.4286
2025-06-15 19:47:59,590 INFO Evaluated batch for dev phase: size=28.0, acc=0.3214
2025-06-15 19:48:02,202 INFO Evaluated batch for dev phase: size=17.0, acc=0.4706
2025-06-15 19:48:03,296 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:48:05,729 INFO Evaluated batch for dev phase: size=13.0, acc=0.3846
2025-06-15 19:48:09,394 INFO Evaluated batch for dev phase: size=26.0, acc=0.4615
2025-06-15 19:48:11,294 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 19:48:14,305 INFO Evaluated batch for dev phase: size=17.0, acc=0.7059
2025-06-15 19:48:17,575 INFO Evaluated batch for dev phase: size=26.0, acc=0.4231
2025-06-15 19:48:20,759 INFO Evaluated batch for dev phase: size=22.0, acc=0.5909
2025-06-15 19:48:24,865 INFO Evaluated batch for dev phase: size=31.0, acc=0.6129
2025-06-15 19:48:28,080 INFO Evaluated batch for dev phase: size=20.0, acc=0.5000
2025-06-15 19:48:29,741 INFO Evaluated batch for dev phase: size=6.0, acc=0.6667
2025-06-15 19:48:31,645 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 19:48:34,502 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 19:48:36,644 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 19:48:40,391 INFO Evaluated batch for dev phase: size=24.0, acc=0.6250
2025-06-15 19:48:41,252 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 19:48:42,279 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:48:43,285 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:48:43,760 INFO Completed dev evaluation: size=656.0, acc=0.4787
2025-06-15 19:48:43,761 INFO 	Eval, eval loss: 1.4466718435287476, acc: 0.478659
2025-06-15 19:48:43,920 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_194843.txt
2025-06-15 19:48:43,921 INFO Test completed successfully!
2025-06-16 00:07:53,649 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 00:07:53,650 INFO Configuration - use_dual_path_srl: True
2025-06-16 00:07:53,650 INFO Configuration - use_enhanced_srl: True
2025-06-16 00:07:53,651 INFO Configuration - use_ca_tsu: True
2025-06-16 00:07:53,651 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 00:07:53,651 INFO Configuration - use_noise_aware_loss: True
2025-06-16 00:07:53,652 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 00:07:53,652 INFO Configuration - variant_type: hedge
2025-06-16 00:07:53,652 INFO Full model configuration:
2025-06-16 00:07:53,653 INFO   alpha: 0.5
2025-06-16 00:07:53,653 INFO   batch_size: 32
2025-06-16 00:07:53,653 INFO   ca_tsu_weight: 0.3
2025-06-16 00:07:53,653 INFO   causal_loss_lambda: 0.3
2025-06-16 00:07:53,654 INFO   clip: 15.0
2025-06-16 00:07:53,654 INFO   consistency_loss_weight: 0.05
2025-06-16 00:07:53,654 INFO   constant_kl_lambda: 0.1
2025-06-16 00:07:53,655 INFO   daily_att: y
2025-06-16 00:07:53,655 INFO   decay_rate: 0.96
2025-06-16 00:07:53,655 INFO   decay_step: 100
2025-06-16 00:07:53,655 INFO   dropout_ce: 0.0
2025-06-16 00:07:53,656 INFO   dropout_mel: 0.0
2025-06-16 00:07:53,656 INFO   dropout_mel_in: 0.3
2025-06-16 00:07:53,656 INFO   dropout_vmd: 0.0
2025-06-16 00:07:53,656 INFO   dropout_vmd_in: 0.3
2025-06-16 00:07:53,657 INFO   enhanced_srl_weight: 0.1
2025-06-16 00:07:53,657 INFO   entropy_regularization_lambda: 0.001
2025-06-16 00:07:53,657 INFO   g_size: 50
2025-06-16 00:07:53,658 INFO   h_size: 150
2025-06-16 00:07:53,658 INFO   init_stock_with_word: 0
2025-06-16 00:07:53,658 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 00:07:53,658 INFO   kl_lambda_start_step: 0
2025-06-16 00:07:53,659 INFO   lr: 0.001
2025-06-16 00:07:53,659 INFO   max_n_days: 5
2025-06-16 00:07:53,659 INFO   max_n_msgs: 20
2025-06-16 00:07:53,660 INFO   max_n_words: 30
2025-06-16 00:07:53,660 INFO   mel_cell_type: gru
2025-06-16 00:07:53,660 INFO   mel_h_size: 100
2025-06-16 00:07:53,660 INFO   mode: all
2025-06-16 00:07:53,661 INFO   momentum: 0.9
2025-06-16 00:07:53,661 INFO   msin_h_size: 100
2025-06-16 00:07:53,661 INFO   n_epochs: 10
2025-06-16 00:07:53,661 INFO   noise_aware_weight: 0.5
2025-06-16 00:07:53,662 INFO   opt: adam
2025-06-16 00:07:53,662 INFO   pathway_competition_type: dynamic
2025-06-16 00:07:53,662 INFO   prediction_loss_weight: 0.1
2025-06-16 00:07:53,662 INFO   residual_connection_weight: 0.1
2025-06-16 00:07:53,663 INFO   shuffle: 1
2025-06-16 00:07:53,663 INFO   stock_embed_size: 150
2025-06-16 00:07:53,663 INFO   td_temporal_attention: True
2025-06-16 00:07:53,663 INFO   use_ca_tsu: True
2025-06-16 00:07:53,663 INFO   use_constant_kl_lambda: 0
2025-06-16 00:07:53,664 INFO   use_dual_path_srl: True
2025-06-16 00:07:53,664 INFO   use_enhanced_srl: True
2025-06-16 00:07:53,664 INFO   use_g_bn: 0
2025-06-16 00:07:53,664 INFO   use_in_bn: 0
2025-06-16 00:07:53,665 INFO   use_noise_aware_loss: True
2025-06-16 00:07:53,665 INFO   use_o_bn: 0
2025-06-16 00:07:53,666 INFO   variant_type: hedge
2025-06-16 00:07:53,666 INFO   vmd_cell_type: gru
2025-06-16 00:07:53,666 INFO   vmd_rec: zh
2025-06-16 00:07:53,666 INFO   volatility_adaptation_factor: 0.3
2025-06-16 00:07:53,667 INFO   volatility_reg_weight: 0.05
2025-06-16 00:07:53,667 INFO   weight_init: xavier-uniform
2025-06-16 00:07:53,667 INFO   word_embed_size: 50
2025-06-16 00:07:53,667 INFO   word_embed_type: glove
2025-06-16 00:07:53,668 INFO   y_size: 2
2025-06-16 00:07:53,669 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 00:07:53,679 INFO Start graph assembling...
2025-06-16 00:07:55,559 INFO use_dual_path_srl: True
2025-06-16 00:07:55,559 INFO variant_type: hedge
2025-06-16 00:07:55,560 INFO use_enhanced_srl: True
2025-06-16 00:07:55,560 INFO Enhanced SRL enabled from config
2025-06-16 00:07:55,560 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 00:07:55,561 INFO SRL condition: True = True and True
2025-06-16 00:07:55,561 INFO Using enhanced dual-path SRL architecture
2025-06-16 00:07:55,561 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 00:07:55,621 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 00:07:55,627 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 00:07:55,651 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 00:07:55,898 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 00:07:55,899 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 00:07:55,899 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 00:07:56,233 INFO Using Temporal Attention (TAP)
2025-06-16 00:07:56,280 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 00:07:56,280 INFO Ca-TSU enabled: True
2025-06-16 00:07:56,280 INFO Enhanced SRL enabled: True
2025-06-16 00:07:56,281 INFO Noise-Aware Loss enabled: True
2025-06-16 00:07:56,298 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:07:56,298 INFO Adding auxiliary enhancement losses...
2025-06-16 00:07:56,321 INFO Creating Noise-Aware Loss component...
2025-06-16 00:07:56,331 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 00:07:56,332 INFO Creating Causal Consistency Loss component...
2025-06-16 00:07:56,365 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 00:07:56,366 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:07:56,367 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:07:59,111 INFO Graph assembled successfully.
2025-06-16 00:07:59,114 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:07:59,114 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:07:59,449 INFO Verifying model configuration...
2025-06-16 00:07:59,449 INFO Ca-TSU enabled: True
2025-06-16 00:07:59,450 INFO Enhanced SRL enabled: True
2025-06-16 00:07:59,450 INFO Noise-Aware Loss enabled: True
2025-06-16 00:07:59,450 INFO Checking model components for noise-aware loss...
2025-06-16 00:07:59,450 INFO Model has 'use_noise_aware_loss': True
2025-06-16 00:07:59,451 INFO use_noise_aware_loss value: True
2025-06-16 00:07:59,451 INFO Model has 'noise_aware_weight': True
2025-06-16 00:07:59,451 INFO noise_aware_weight value: 0.5
2025-06-16 00:07:59,451 INFO Model has 'noise_aware_loss': False
2025-06-16 00:07:59,452 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 00:07:59,452 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 00:07:59,452 INFO Model has 'reliability_weights': True
2025-06-16 00:07:59,452 INFO Model has 'use_enhanced_srl': True
2025-06-16 00:07:59,452 INFO use_enhanced_srl value: True
2025-06-16 00:07:59,453 INFO Model has 'enhanced_srl_loss': False
2025-06-16 00:07:59,453 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 00:07:59,453 INFO Model has 'use_ca_tsu': True
2025-06-16 00:07:59,453 INFO use_ca_tsu value: True
2025-06-16 00:07:59,454 INFO Model has 'causal_consistency_loss': False
2025-06-16 00:07:59,454 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 00:07:59,454 INFO Model has 'loss_components': True
2025-06-16 00:07:59,454 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 00:07:59,455 INFO Manually activating loss components...
2025-06-16 00:07:59,455 INFO Components manually activated:
2025-06-16 00:07:59,455 INFO use_enhanced_srl: True
2025-06-16 00:07:59,455 INFO use_ca_tsu: True
2025-06-16 00:07:59,456 INFO use_noise_aware_loss: True
2025-06-16 00:07:59,456 INFO use_dual_path_srl: True
2025-06-16 00:07:59,456 INFO Running test_noise_aware_loss...
2025-06-16 00:08:18,239 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 00:08:20,168 INFO Word table initialized
2025-06-16 00:08:20,168 INFO Checking loss components in the model graph...
2025-06-16 00:08:20,168 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:08:20,169 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,169 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,169 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,170 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 00:08:20,170 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 00:08:20,276 INFO Starting training test for 10 batches
2025-06-16 00:08:56,121 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 00:08:56,121 INFO   PERFORMANCE: Loss=1.2272 | Acc=0.4688 | MCC=-0.0658
2025-06-16 00:08:56,122 INFO   LOSS COMPONENTS:
2025-06-16 00:08:56,122 INFO     - Causal Consistency Loss: -0.104554
2025-06-16 00:08:56,122 INFO     - Noise-Aware SRL Loss: 0.567192
2025-06-16 00:08:56,122 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:08:56,123 INFO     Alpha_i sample: 0.7313, Omega_i sample: 0.4296
2025-06-16 00:08:56,123 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:08:56,125 INFO     Volatility: 0.6336, Text Weight: 0.3901, Price Weight: 0.6099
2025-06-16 00:10:28,050 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 00:10:28,051 INFO   PERFORMANCE: Loss=1.4263 | Acc=0.4688 | MCC=0.0170
2025-06-16 00:10:28,052 INFO   LOSS COMPONENTS:
2025-06-16 00:10:28,052 INFO     - Causal Consistency Loss: -0.438606
2025-06-16 00:10:28,052 INFO     - Noise-Aware SRL Loss: 0.478382
2025-06-16 00:10:28,053 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:10:28,053 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:10:28,054 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:10:28,055 INFO     Volatility: 0.6410, Text Weight: 0.3082, Price Weight: 0.6918
2025-06-16 00:12:10,773 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 00:12:10,773 INFO   PERFORMANCE: Loss=1.4287 | Acc=0.6250 | MCC=0.2277
2025-06-16 00:12:10,773 INFO   LOSS COMPONENTS:
2025-06-16 00:12:10,774 INFO     - Causal Consistency Loss: -0.539270
2025-06-16 00:12:10,774 INFO     - Noise-Aware SRL Loss: 0.379341
2025-06-16 00:12:10,774 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:12:10,775 INFO     Alpha_i sample: 0.5108, Omega_i sample: 0.5182
2025-06-16 00:12:10,775 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:12:10,776 INFO     Volatility: 0.6672, Text Weight: 0.3045, Price Weight: 0.6955
2025-06-16 00:12:10,776 INFO Generating diagnostic plots...
2025-06-16 00:12:13,050 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 00:12:13,050 INFO Saving final checkpoint for test run...
2025-06-16 00:12:13,202 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate10565111754745538991 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate10565111754745538991 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 00:12:13,205 INFO Start dev phase...
2025-06-16 00:14:08,732 INFO Completed dev evaluation: size=656.0, acc=0.5015
2025-06-16 00:14:08,733 INFO 	Eval, eval loss: 1.4639867544174194, acc: 0.501524
2025-06-16 00:14:08,913 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_001408.txt
2025-06-16 00:14:08,915 INFO Test completed successfully!
2025-06-16 00:18:27,177 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 00:18:27,178 INFO Configuration - use_dual_path_srl: True
2025-06-16 00:18:27,178 INFO Configuration - use_enhanced_srl: True
2025-06-16 00:18:27,179 INFO Configuration - use_ca_tsu: True
2025-06-16 00:18:27,179 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 00:18:27,179 INFO Configuration - use_noise_aware_loss: True
2025-06-16 00:18:27,179 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 00:18:27,179 INFO Configuration - variant_type: hedge
2025-06-16 00:18:27,180 INFO Full model configuration:
2025-06-16 00:18:27,180 INFO   alpha: 0.5
2025-06-16 00:18:27,180 INFO   batch_size: 32
2025-06-16 00:18:27,180 INFO   ca_tsu_weight: 0.3
2025-06-16 00:18:27,181 INFO   causal_loss_lambda: 0.3
2025-06-16 00:18:27,181 INFO   clip: 15.0
2025-06-16 00:18:27,181 INFO   consistency_loss_weight: 0.05
2025-06-16 00:18:27,181 INFO   constant_kl_lambda: 0.1
2025-06-16 00:18:27,181 INFO   daily_att: y
2025-06-16 00:18:27,182 INFO   decay_rate: 0.96
2025-06-16 00:18:27,182 INFO   decay_step: 100
2025-06-16 00:18:27,182 INFO   dropout_ce: 0.0
2025-06-16 00:18:27,182 INFO   dropout_mel: 0.0
2025-06-16 00:18:27,182 INFO   dropout_mel_in: 0.3
2025-06-16 00:18:27,182 INFO   dropout_vmd: 0.0
2025-06-16 00:18:27,182 INFO   dropout_vmd_in: 0.3
2025-06-16 00:18:27,184 INFO   enhanced_srl_weight: 0.1
2025-06-16 00:18:27,184 INFO   entropy_regularization_lambda: 0.001
2025-06-16 00:18:27,184 INFO   g_size: 50
2025-06-16 00:18:27,184 INFO   h_size: 150
2025-06-16 00:18:27,185 INFO   init_stock_with_word: 0
2025-06-16 00:18:27,185 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 00:18:27,185 INFO   kl_lambda_start_step: 0
2025-06-16 00:18:27,185 INFO   lr: 0.001
2025-06-16 00:18:27,185 INFO   max_n_days: 5
2025-06-16 00:18:27,186 INFO   max_n_msgs: 20
2025-06-16 00:18:27,186 INFO   max_n_words: 30
2025-06-16 00:18:27,186 INFO   mel_cell_type: gru
2025-06-16 00:18:27,186 INFO   mel_h_size: 100
2025-06-16 00:18:27,187 INFO   mode: all
2025-06-16 00:18:27,187 INFO   momentum: 0.9
2025-06-16 00:18:27,187 INFO   msin_h_size: 100
2025-06-16 00:18:27,187 INFO   n_epochs: 10
2025-06-16 00:18:27,188 INFO   noise_aware_weight: 0.5
2025-06-16 00:18:27,188 INFO   opt: adam
2025-06-16 00:18:27,188 INFO   pathway_competition_type: dynamic
2025-06-16 00:18:27,188 INFO   prediction_loss_weight: 0.1
2025-06-16 00:18:27,188 INFO   residual_connection_weight: 0.1
2025-06-16 00:18:27,189 INFO   shuffle: 1
2025-06-16 00:18:27,189 INFO   stock_embed_size: 150
2025-06-16 00:18:27,189 INFO   td_temporal_attention: True
2025-06-16 00:18:27,189 INFO   use_ca_tsu: True
2025-06-16 00:18:27,189 INFO   use_constant_kl_lambda: 0
2025-06-16 00:18:27,190 INFO   use_dual_path_srl: True
2025-06-16 00:18:27,190 INFO   use_enhanced_srl: True
2025-06-16 00:18:27,190 INFO   use_g_bn: 0
2025-06-16 00:18:27,190 INFO   use_in_bn: 0
2025-06-16 00:18:27,190 INFO   use_noise_aware_loss: True
2025-06-16 00:18:27,191 INFO   use_o_bn: 0
2025-06-16 00:18:27,191 INFO   variant_type: hedge
2025-06-16 00:18:27,191 INFO   vmd_cell_type: gru
2025-06-16 00:18:27,192 INFO   vmd_rec: zh
2025-06-16 00:18:27,192 INFO   volatility_adaptation_factor: 0.3
2025-06-16 00:18:27,192 INFO   volatility_reg_weight: 0.05
2025-06-16 00:18:27,192 INFO   weight_init: xavier-uniform
2025-06-16 00:18:27,193 INFO   word_embed_size: 50
2025-06-16 00:18:27,193 INFO   word_embed_type: glove
2025-06-16 00:18:27,194 INFO   y_size: 2
2025-06-16 00:18:27,195 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 00:18:27,198 INFO Start graph assembling...
2025-06-16 00:18:29,037 INFO use_dual_path_srl: True
2025-06-16 00:18:29,038 INFO variant_type: hedge
2025-06-16 00:18:29,038 INFO use_enhanced_srl: True
2025-06-16 00:18:29,038 INFO Enhanced SRL enabled from config
2025-06-16 00:18:29,039 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 00:18:29,039 INFO SRL condition: True = True and True
2025-06-16 00:18:29,039 INFO Using enhanced dual-path SRL architecture
2025-06-16 00:18:29,039 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 00:18:29,086 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 00:18:29,091 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 00:18:29,112 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 00:18:29,343 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 00:18:29,343 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 00:18:29,343 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 00:18:29,632 INFO Using Temporal Attention (TAP)
2025-06-16 00:18:29,684 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 00:18:29,685 INFO Ca-TSU enabled: True
2025-06-16 00:18:29,685 INFO Enhanced SRL enabled: True
2025-06-16 00:18:29,685 INFO Noise-Aware Loss enabled: True
2025-06-16 00:18:29,705 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:29,706 INFO Adding auxiliary enhancement losses...
2025-06-16 00:18:29,728 INFO Creating Noise-Aware Loss component...
2025-06-16 00:18:29,737 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 00:18:29,738 INFO Creating Causal Consistency Loss component...
2025-06-16 00:18:29,774 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 00:18:29,775 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:29,775 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:18:32,387 INFO Graph assembled successfully.
2025-06-16 00:18:32,389 INFO Ensured checkpoint directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:18:32,389 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:18:32,760 INFO Verifying model configuration...
2025-06-16 00:18:32,761 INFO Ca-TSU enabled: True
2025-06-16 00:18:32,761 INFO Enhanced SRL enabled: True
2025-06-16 00:18:32,761 INFO Noise-Aware Loss enabled: True
2025-06-16 00:18:32,762 INFO Checking model components for noise-aware loss...
2025-06-16 00:18:32,762 INFO Model has 'use_noise_aware_loss': True
2025-06-16 00:18:32,762 INFO use_noise_aware_loss value: True
2025-06-16 00:18:32,762 INFO Model has 'noise_aware_weight': True
2025-06-16 00:18:32,762 INFO noise_aware_weight value: 0.5
2025-06-16 00:18:32,763 INFO Model has 'noise_aware_loss': False
2025-06-16 00:18:32,763 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 00:18:32,763 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 00:18:32,763 INFO Model has 'reliability_weights': True
2025-06-16 00:18:32,763 INFO Model has 'use_enhanced_srl': True
2025-06-16 00:18:32,764 INFO use_enhanced_srl value: True
2025-06-16 00:18:32,764 INFO Model has 'enhanced_srl_loss': False
2025-06-16 00:18:32,764 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 00:18:32,764 INFO Model has 'use_ca_tsu': True
2025-06-16 00:18:32,764 INFO use_ca_tsu value: True
2025-06-16 00:18:32,765 INFO Model has 'causal_consistency_loss': False
2025-06-16 00:18:32,765 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 00:18:32,765 INFO Model has 'loss_components': True
2025-06-16 00:18:32,765 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 00:18:32,766 INFO Manually activating loss components...
2025-06-16 00:18:32,766 INFO Components manually activated:
2025-06-16 00:18:32,766 INFO use_enhanced_srl: True
2025-06-16 00:18:32,766 INFO use_ca_tsu: True
2025-06-16 00:18:32,767 INFO use_noise_aware_loss: True
2025-06-16 00:18:32,767 INFO use_dual_path_srl: True
2025-06-16 00:18:32,767 INFO Running test_noise_aware_loss...
2025-06-16 00:18:52,267 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 00:18:53,782 INFO Word table initialized
2025-06-16 00:18:53,782 INFO Checking loss components in the model graph...
2025-06-16 00:18:53,783 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:18:53,783 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,783 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,783 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,784 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 00:18:53,784 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 00:18:53,884 INFO Starting training test for 10 batches
2025-06-16 00:19:33,795 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 00:19:33,796 INFO   PERFORMANCE: Loss=1.2826 | Acc=0.6875 | MCC=0.3968
2025-06-16 00:19:33,796 INFO   LOSS COMPONENTS:
2025-06-16 00:19:33,797 INFO     - Causal Consistency Loss: 0.362965
2025-06-16 00:19:33,797 INFO     - Noise-Aware SRL Loss: 0.544637
2025-06-16 00:19:33,798 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:19:33,798 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:19:33,798 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:19:33,799 INFO     Volatility: 0.6333, Text Weight: 0.3961, Price Weight: 0.6039
2025-06-16 00:21:07,349 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 00:21:07,349 INFO   PERFORMANCE: Loss=1.5202 | Acc=0.5000 | MCC=0.0159
2025-06-16 00:21:07,350 INFO   LOSS COMPONENTS:
2025-06-16 00:21:07,350 INFO     - Causal Consistency Loss: 0.117333
2025-06-16 00:21:07,350 INFO     - Noise-Aware SRL Loss: 0.412208
2025-06-16 00:21:07,351 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:21:07,351 INFO     Alpha_i sample: 0.3309, Omega_i sample: 0.5388
2025-06-16 00:21:07,351 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:21:07,352 INFO     Volatility: 0.6566, Text Weight: 0.5679, Price Weight: 0.4321
2025-06-16 00:22:40,762 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 00:22:40,763 INFO   PERFORMANCE: Loss=1.4503 | Acc=0.6250 | MCC=0.3830
2025-06-16 00:22:40,763 INFO   LOSS COMPONENTS:
2025-06-16 00:22:40,764 INFO     - Causal Consistency Loss: -0.069837
2025-06-16 00:22:40,764 INFO     - Noise-Aware SRL Loss: 0.224927
2025-06-16 00:22:40,765 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:22:40,766 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:22:40,766 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:22:40,768 INFO     Volatility: 0.6415, Text Weight: 0.7446, Price Weight: 0.2554
2025-06-16 00:22:40,769 INFO Generating diagnostic plots...
2025-06-16 00:22:43,474 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 00:22:43,474 INFO Saving final checkpoint for test run...
2025-06-16 00:22:43,764 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate12414907740630760731 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate12414907740630760731 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 00:22:43,768 INFO Start dev phase...
2025-06-16 00:24:43,184 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-16 00:24:43,185 INFO 	Eval, eval loss: 1.473867654800415, acc: 0.504573
2025-06-16 00:24:43,503 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_002443.txt
2025-06-16 00:24:43,503 INFO Test completed successfully!
2025-06-16 01:54:53,715 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 01:54:53,715 INFO Configuration - use_dual_path_srl: True
2025-06-16 01:54:53,715 INFO Configuration - use_enhanced_srl: True
2025-06-16 01:54:53,716 INFO Configuration - use_ca_tsu: True
2025-06-16 01:54:53,716 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 01:54:53,716 INFO Configuration - use_noise_aware_loss: True
2025-06-16 01:54:53,716 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 01:54:53,716 INFO Configuration - variant_type: hedge
2025-06-16 01:54:53,716 INFO Full model configuration:
2025-06-16 01:54:53,717 INFO   alpha: 0.5
2025-06-16 01:54:53,717 INFO   batch_size: 32
2025-06-16 01:54:53,717 INFO   ca_tsu_weight: 0.3
2025-06-16 01:54:53,717 INFO   causal_loss_lambda: 0.3
2025-06-16 01:54:53,717 INFO   clip: 15.0
2025-06-16 01:54:53,718 INFO   consistency_loss_weight: 0.05
2025-06-16 01:54:53,718 INFO   constant_kl_lambda: 0.1
2025-06-16 01:54:53,718 INFO   daily_att: y
2025-06-16 01:54:53,718 INFO   decay_rate: 0.96
2025-06-16 01:54:53,718 INFO   decay_step: 100
2025-06-16 01:54:53,718 INFO   dropout_ce: 0.0
2025-06-16 01:54:53,719 INFO   dropout_mel: 0.0
2025-06-16 01:54:53,719 INFO   dropout_mel_in: 0.3
2025-06-16 01:54:53,719 INFO   dropout_vmd: 0.0
2025-06-16 01:54:53,719 INFO   dropout_vmd_in: 0.3
2025-06-16 01:54:53,719 INFO   enhanced_srl_weight: 0.1
2025-06-16 01:54:53,720 INFO   entropy_regularization_lambda: 0.001
2025-06-16 01:54:53,720 INFO   g_size: 50
2025-06-16 01:54:53,720 INFO   h_size: 150
2025-06-16 01:54:53,720 INFO   init_stock_with_word: 0
2025-06-16 01:54:53,720 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 01:54:53,722 INFO   kl_lambda_start_step: 0
2025-06-16 01:54:53,722 INFO   lr: 0.001
2025-06-16 01:54:53,722 INFO   max_n_days: 5
2025-06-16 01:54:53,722 INFO   max_n_msgs: 20
2025-06-16 01:54:53,722 INFO   max_n_words: 30
2025-06-16 01:54:53,723 INFO   mel_cell_type: gru
2025-06-16 01:54:53,723 INFO   mel_h_size: 100
2025-06-16 01:54:53,723 INFO   mode: all
2025-06-16 01:54:53,723 INFO   momentum: 0.9
2025-06-16 01:54:53,723 INFO   msin_h_size: 100
2025-06-16 01:54:53,724 INFO   n_epochs: 10
2025-06-16 01:54:53,724 INFO   noise_aware_weight: 0.5
2025-06-16 01:54:53,724 INFO   opt: adam
2025-06-16 01:54:53,724 INFO   pathway_competition_type: dynamic
2025-06-16 01:54:53,724 INFO   prediction_loss_weight: 0.1
2025-06-16 01:54:53,725 INFO   residual_connection_weight: 0.1
2025-06-16 01:54:53,725 INFO   shuffle: 1
2025-06-16 01:54:53,725 INFO   stock_embed_size: 150
2025-06-16 01:54:53,725 INFO   td_temporal_attention: True
2025-06-16 01:54:53,725 INFO   use_ca_tsu: True
2025-06-16 01:54:53,726 INFO   use_constant_kl_lambda: 0
2025-06-16 01:54:53,726 INFO   use_dual_path_srl: True
2025-06-16 01:54:53,726 INFO   use_enhanced_srl: True
2025-06-16 01:54:53,726 INFO   use_g_bn: 0
2025-06-16 01:54:53,726 INFO   use_in_bn: 0
2025-06-16 01:54:53,727 INFO   use_noise_aware_loss: True
2025-06-16 01:54:53,727 INFO   use_o_bn: 0
2025-06-16 01:54:53,727 INFO   variant_type: hedge
2025-06-16 01:54:53,727 INFO   vmd_cell_type: gru
2025-06-16 01:54:53,727 INFO   vmd_rec: zh
2025-06-16 01:54:53,728 INFO   volatility_adaptation_factor: 0.3
2025-06-16 01:54:53,728 INFO   volatility_reg_weight: 0.05
2025-06-16 01:54:53,728 INFO   weight_init: xavier-uniform
2025-06-16 01:54:53,728 INFO   word_embed_size: 50
2025-06-16 01:54:53,728 INFO   word_embed_type: glove
2025-06-16 01:54:53,728 INFO   y_size: 2
2025-06-16 01:54:53,729 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 01:54:53,746 INFO Start graph assembling...
2025-06-16 01:54:55,805 INFO use_dual_path_srl: True
2025-06-16 01:54:55,806 INFO variant_type: hedge
2025-06-16 01:54:55,806 INFO use_enhanced_srl: True
2025-06-16 01:54:55,806 INFO Enhanced SRL enabled from config
2025-06-16 01:54:55,806 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 01:54:55,807 INFO SRL condition: True = True and True
2025-06-16 01:54:55,807 INFO Using enhanced dual-path SRL architecture
2025-06-16 01:54:55,807 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 01:54:55,853 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 01:54:55,857 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 01:54:55,877 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 01:54:56,099 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 01:54:56,101 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 01:54:56,101 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 01:54:56,377 INFO Using Temporal Attention (TAP)
2025-06-16 01:54:56,424 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 01:54:56,424 INFO Ca-TSU enabled: True
2025-06-16 01:54:56,425 INFO Enhanced SRL enabled: True
2025-06-16 01:54:56,425 INFO Noise-Aware Loss enabled: True
2025-06-16 01:54:56,442 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:54:56,443 INFO Adding auxiliary enhancement losses...
2025-06-16 01:54:56,469 INFO Creating Noise-Aware Loss component...
2025-06-16 01:54:56,479 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 01:54:56,481 INFO Creating Causal Consistency Loss component...
2025-06-16 01:54:56,512 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 01:54:56,513 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:54:56,513 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 01:54:59,044 INFO Graph assembled successfully.
2025-06-16 01:54:59,045 INFO Ensured checkpoint directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 01:54:59,045 INFO Updated saver path: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess
2025-06-16 01:54:59,046 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 01:54:59,333 INFO Verifying model configuration...
2025-06-16 01:54:59,334 INFO Ca-TSU enabled: True
2025-06-16 01:54:59,334 INFO Enhanced SRL enabled: True
2025-06-16 01:54:59,334 INFO Noise-Aware Loss enabled: True
2025-06-16 01:54:59,334 INFO Checking model components for noise-aware loss...
2025-06-16 01:54:59,335 INFO Model has 'use_noise_aware_loss': True
2025-06-16 01:54:59,335 INFO use_noise_aware_loss value: True
2025-06-16 01:54:59,335 INFO Model has 'noise_aware_weight': True
2025-06-16 01:54:59,335 INFO noise_aware_weight value: 0.5
2025-06-16 01:54:59,335 INFO Model has 'noise_aware_loss': False
2025-06-16 01:54:59,336 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 01:54:59,336 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 01:54:59,336 INFO Model has 'reliability_weights': True
2025-06-16 01:54:59,336 INFO Model has 'use_enhanced_srl': True
2025-06-16 01:54:59,336 INFO use_enhanced_srl value: True
2025-06-16 01:54:59,336 INFO Model has 'enhanced_srl_loss': False
2025-06-16 01:54:59,337 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 01:54:59,337 INFO Model has 'use_ca_tsu': True
2025-06-16 01:54:59,337 INFO use_ca_tsu value: True
2025-06-16 01:54:59,337 INFO Model has 'causal_consistency_loss': False
2025-06-16 01:54:59,337 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 01:54:59,338 INFO Model has 'loss_components': True
2025-06-16 01:54:59,338 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 01:54:59,338 INFO Manually activating loss components...
2025-06-16 01:54:59,338 INFO Components manually activated:
2025-06-16 01:54:59,338 INFO use_enhanced_srl: True
2025-06-16 01:54:59,339 INFO use_ca_tsu: True
2025-06-16 01:54:59,339 INFO use_noise_aware_loss: True
2025-06-16 01:54:59,339 INFO use_dual_path_srl: True
2025-06-16 01:54:59,339 INFO Running test_noise_aware_loss...
2025-06-16 01:55:17,287 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 01:55:18,994 INFO Word table initialized
2025-06-16 01:55:18,995 INFO Checking loss components in the model graph...
2025-06-16 01:55:18,995 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 01:55:18,995 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,996 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,996 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,997 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 01:55:18,997 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 01:55:19,090 INFO Starting training test for 10 batches
2025-06-16 01:55:48,644 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 01:55:48,645 INFO   PERFORMANCE: Loss=1.2215 | Acc=0.5938 | MCC=0.1683
2025-06-16 01:55:48,645 INFO   LOSS COMPONENTS:
2025-06-16 01:55:48,645 INFO     - Causal Consistency Loss: -0.001870
2025-06-16 01:55:48,646 INFO     - Noise-Aware SRL Loss: 0.564380
2025-06-16 01:55:48,646 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:55:48,646 INFO     Alpha_i sample: 0.4893, Omega_i sample: 0.5857
2025-06-16 01:55:48,647 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:55:48,647 INFO     Volatility: 0.6509, Text Weight: 0.4045, Price Weight: 0.5955
2025-06-16 01:57:24,359 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 01:57:24,360 INFO   PERFORMANCE: Loss=1.5011 | Acc=0.5625 | MCC=0.1156
2025-06-16 01:57:24,360 INFO   LOSS COMPONENTS:
2025-06-16 01:57:24,360 INFO     - Causal Consistency Loss: -0.209621
2025-06-16 01:57:24,361 INFO     - Noise-Aware SRL Loss: 0.438760
2025-06-16 01:57:24,361 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:57:24,361 INFO     Alpha_i sample: 0.0619, Omega_i sample: 0.0756
2025-06-16 01:57:24,362 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:57:24,363 INFO     Volatility: 0.6682, Text Weight: 0.3983, Price Weight: 0.6017
2025-06-16 01:58:51,088 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 01:58:51,088 INFO   PERFORMANCE: Loss=1.4671 | Acc=0.6562 | MCC=0.3730
2025-06-16 01:58:51,089 INFO   LOSS COMPONENTS:
2025-06-16 01:58:51,089 INFO     - Causal Consistency Loss: -0.397442
2025-06-16 01:58:51,089 INFO     - Noise-Aware SRL Loss: 0.314393
2025-06-16 01:58:51,090 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:58:51,090 INFO     Alpha_i sample: 0.2372, Omega_i sample: 0.1722
2025-06-16 01:58:51,090 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:58:51,091 INFO     Volatility: 0.6815, Text Weight: 0.3715, Price Weight: 0.6285
2025-06-16 01:58:51,091 INFO Generating diagnostic plots...
2025-06-16 01:58:53,459 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 01:58:53,460 INFO Saving final checkpoint for test run...
2025-06-16 01:58:53,614 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate17819015953694519701 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 66, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate17819015953694519701 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 01:58:53,616 INFO Start dev phase...
2025-06-16 02:00:46,733 INFO Completed dev evaluation: size=656.0, acc=0.5412
2025-06-16 02:00:46,734 INFO 	Eval, eval loss: 1.4631372690200806, acc: 0.541159
2025-06-16 02:00:46,910 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_020046.txt
2025-06-16 02:00:46,910 INFO Test completed successfully!
2025-06-16 02:06:41,885 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 02:06:41,885 INFO Configuration - use_dual_path_srl: True
2025-06-16 02:06:41,886 INFO Configuration - use_enhanced_srl: True
2025-06-16 02:06:41,886 INFO Configuration - use_ca_tsu: True
2025-06-16 02:06:41,886 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 02:06:41,886 INFO Configuration - use_noise_aware_loss: True
2025-06-16 02:06:41,886 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 02:06:41,886 INFO Configuration - variant_type: hedge
2025-06-16 02:06:41,887 INFO Full model configuration:
2025-06-16 02:06:41,887 INFO   alpha: 0.5
2025-06-16 02:06:41,887 INFO   batch_size: 32
2025-06-16 02:06:41,887 INFO   ca_tsu_weight: 0.3
2025-06-16 02:06:41,887 INFO   causal_loss_lambda: 0.3
2025-06-16 02:06:41,888 INFO   clip: 15.0
2025-06-16 02:06:41,888 INFO   consistency_loss_weight: 0.05
2025-06-16 02:06:41,888 INFO   constant_kl_lambda: 0.1
2025-06-16 02:06:41,888 INFO   daily_att: y
2025-06-16 02:06:41,888 INFO   decay_rate: 0.96
2025-06-16 02:06:41,889 INFO   decay_step: 100
2025-06-16 02:06:41,889 INFO   dropout_ce: 0.0
2025-06-16 02:06:41,889 INFO   dropout_mel: 0.0
2025-06-16 02:06:41,889 INFO   dropout_mel_in: 0.3
2025-06-16 02:06:41,889 INFO   dropout_vmd: 0.0
2025-06-16 02:06:41,890 INFO   dropout_vmd_in: 0.3
2025-06-16 02:06:41,890 INFO   enhanced_srl_weight: 0.1
2025-06-16 02:06:41,890 INFO   entropy_regularization_lambda: 0.001
2025-06-16 02:06:41,890 INFO   g_size: 50
2025-06-16 02:06:41,890 INFO   h_size: 150
2025-06-16 02:06:41,891 INFO   init_stock_with_word: 0
2025-06-16 02:06:41,891 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 02:06:41,891 INFO   kl_lambda_start_step: 0
2025-06-16 02:06:41,891 INFO   lr: 0.001
2025-06-16 02:06:41,891 INFO   max_n_days: 5
2025-06-16 02:06:41,892 INFO   max_n_msgs: 20
2025-06-16 02:06:41,892 INFO   max_n_words: 30
2025-06-16 02:06:41,892 INFO   mel_cell_type: gru
2025-06-16 02:06:41,892 INFO   mel_h_size: 100
2025-06-16 02:06:41,892 INFO   mode: all
2025-06-16 02:06:41,892 INFO   momentum: 0.9
2025-06-16 02:06:41,893 INFO   msin_h_size: 100
2025-06-16 02:06:41,893 INFO   n_epochs: 10
2025-06-16 02:06:41,893 INFO   noise_aware_weight: 0.5
2025-06-16 02:06:41,893 INFO   opt: adam
2025-06-16 02:06:41,893 INFO   pathway_competition_type: dynamic
2025-06-16 02:06:41,894 INFO   prediction_loss_weight: 0.1
2025-06-16 02:06:41,894 INFO   residual_connection_weight: 0.1
2025-06-16 02:06:41,894 INFO   shuffle: 1
2025-06-16 02:06:41,894 INFO   stock_embed_size: 150
2025-06-16 02:06:41,894 INFO   td_temporal_attention: True
2025-06-16 02:06:41,894 INFO   use_ca_tsu: True
2025-06-16 02:06:41,895 INFO   use_constant_kl_lambda: 0
2025-06-16 02:06:41,895 INFO   use_dual_path_srl: True
2025-06-16 02:06:41,895 INFO   use_enhanced_srl: True
2025-06-16 02:06:41,895 INFO   use_g_bn: 0
2025-06-16 02:06:41,895 INFO   use_in_bn: 0
2025-06-16 02:06:41,896 INFO   use_noise_aware_loss: True
2025-06-16 02:06:41,896 INFO   use_o_bn: 0
2025-06-16 02:06:41,896 INFO   variant_type: hedge
2025-06-16 02:06:41,897 INFO   vmd_cell_type: gru
2025-06-16 02:06:41,897 INFO   vmd_rec: zh
2025-06-16 02:06:41,897 INFO   volatility_adaptation_factor: 0.3
2025-06-16 02:06:41,897 INFO   volatility_reg_weight: 0.05
2025-06-16 02:06:41,897 INFO   weight_init: xavier-uniform
2025-06-16 02:06:41,898 INFO   word_embed_size: 50
2025-06-16 02:06:41,898 INFO   word_embed_type: glove
2025-06-16 02:06:41,898 INFO   y_size: 2
2025-06-16 02:06:41,899 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 02:06:41,901 INFO Start graph assembling...
2025-06-16 02:06:43,622 INFO use_dual_path_srl: True
2025-06-16 02:06:43,622 INFO variant_type: hedge
2025-06-16 02:06:43,623 INFO use_enhanced_srl: True
2025-06-16 02:06:43,623 INFO Enhanced SRL enabled from config
2025-06-16 02:06:43,623 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 02:06:43,623 INFO SRL condition: True = True and True
2025-06-16 02:06:43,623 INFO Using enhanced dual-path SRL architecture
2025-06-16 02:06:43,624 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 02:06:43,669 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 02:06:43,676 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 02:06:43,705 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 02:06:43,939 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 02:06:43,939 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 02:06:43,939 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 02:06:44,218 INFO Using Temporal Attention (TAP)
2025-06-16 02:06:44,265 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 02:06:44,266 INFO Ca-TSU enabled: True
2025-06-16 02:06:44,266 INFO Enhanced SRL enabled: True
2025-06-16 02:06:44,266 INFO Noise-Aware Loss enabled: True
2025-06-16 02:06:44,279 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:06:44,280 INFO Adding auxiliary enhancement losses...
2025-06-16 02:06:44,301 INFO Creating Noise-Aware Loss component...
2025-06-16 02:06:44,310 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 02:06:44,312 INFO Creating Causal Consistency Loss component...
2025-06-16 02:06:44,344 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 02:06:44,344 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:06:44,345 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:06:46,741 INFO Graph assembled successfully.
2025-06-16 02:06:46,742 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 02:06:47,022 INFO Verifying model configuration...
2025-06-16 02:06:47,023 INFO Ca-TSU enabled: True
2025-06-16 02:06:47,023 INFO Enhanced SRL enabled: True
2025-06-16 02:06:47,023 INFO Noise-Aware Loss enabled: True
2025-06-16 02:06:47,023 INFO Checking model components for noise-aware loss...
2025-06-16 02:06:47,024 INFO Model has 'use_noise_aware_loss': True
2025-06-16 02:06:47,024 INFO use_noise_aware_loss value: True
2025-06-16 02:06:47,024 INFO Model has 'noise_aware_weight': True
2025-06-16 02:06:47,024 INFO noise_aware_weight value: 0.5
2025-06-16 02:06:47,024 INFO Model has 'noise_aware_loss': False
2025-06-16 02:06:47,024 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 02:06:47,025 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 02:06:47,025 INFO Model has 'reliability_weights': True
2025-06-16 02:06:47,025 INFO Model has 'use_enhanced_srl': True
2025-06-16 02:06:47,025 INFO use_enhanced_srl value: True
2025-06-16 02:06:47,025 INFO Model has 'enhanced_srl_loss': False
2025-06-16 02:06:47,026 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 02:06:47,026 INFO Model has 'use_ca_tsu': True
2025-06-16 02:06:47,026 INFO use_ca_tsu value: True
2025-06-16 02:06:47,026 INFO Model has 'causal_consistency_loss': False
2025-06-16 02:06:47,026 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 02:06:47,027 INFO Model has 'loss_components': True
2025-06-16 02:06:47,027 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 02:06:47,027 INFO Manually activating loss components...
2025-06-16 02:06:47,027 INFO Components manually activated:
2025-06-16 02:06:47,027 INFO use_enhanced_srl: True
2025-06-16 02:06:47,027 INFO use_ca_tsu: True
2025-06-16 02:06:47,028 INFO use_noise_aware_loss: True
2025-06-16 02:06:47,028 INFO use_dual_path_srl: True
2025-06-16 02:06:47,028 INFO Running test_noise_aware_loss...
2025-06-16 02:07:05,356 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 02:07:06,863 INFO Word table initialized
2025-06-16 02:07:06,864 INFO Checking loss components in the model graph...
2025-06-16 02:07:06,864 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:07:06,864 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 02:07:06,866 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 02:07:06,979 INFO Starting training test for 10 batches
2025-06-16 02:07:37,314 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 02:07:37,315 INFO   PERFORMANCE: Loss=1.2741 | Acc=0.4688 | MCC=-0.0636
2025-06-16 02:07:37,315 INFO   LOSS COMPONENTS:
2025-06-16 02:07:37,316 INFO     - Causal Consistency Loss: -0.027083
2025-06-16 02:07:37,316 INFO     - Noise-Aware SRL Loss: 0.582821
2025-06-16 02:07:37,316 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:07:37,316 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:07:37,316 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:07:37,317 INFO     Volatility: 0.6657, Text Weight: 0.3620, Price Weight: 0.6380
2025-06-16 02:09:18,432 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 02:09:18,433 INFO   PERFORMANCE: Loss=1.3136 | Acc=0.6562 | MCC=0.3235
2025-06-16 02:09:18,434 INFO   LOSS COMPONENTS:
2025-06-16 02:09:18,434 INFO     - Causal Consistency Loss: -0.276444
2025-06-16 02:09:18,435 INFO     - Noise-Aware SRL Loss: 0.449430
2025-06-16 02:09:18,435 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:09:18,436 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:09:18,436 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:09:18,437 INFO     Volatility: 0.6584, Text Weight: 0.3784, Price Weight: 0.6216
2025-06-16 02:10:45,241 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 02:10:45,241 INFO   PERFORMANCE: Loss=1.5016 | Acc=0.5000 | MCC=-0.0120
2025-06-16 02:10:45,242 INFO   LOSS COMPONENTS:
2025-06-16 02:10:45,242 INFO     - Causal Consistency Loss: -0.486508
2025-06-16 02:10:45,243 INFO     - Noise-Aware SRL Loss: 0.343409
2025-06-16 02:10:45,243 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:10:45,244 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:10:45,244 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:10:45,245 INFO     Volatility: 0.6844, Text Weight: 0.3521, Price Weight: 0.6479
2025-06-16 02:10:45,245 INFO Generating diagnostic plots...
2025-06-16 02:10:47,485 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 02:10:47,486 INFO Saving final checkpoint for test run...
2025-06-16 02:10:47,682 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate7345179497305110221 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 66, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate7345179497305110221 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 02:10:47,684 INFO Start dev phase...
2025-06-16 02:12:35,359 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-16 02:12:35,360 INFO 	Eval, eval loss: 1.4525160789489746, acc: 0.518293
2025-06-16 02:12:35,530 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_021235.txt
2025-06-16 02:12:35,531 INFO Test completed successfully!
2025-06-16 02:24:29,372 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 02:24:29,372 INFO Configuration - use_dual_path_srl: True
2025-06-16 02:24:29,372 INFO Configuration - use_enhanced_srl: True
2025-06-16 02:24:29,372 INFO Configuration - use_ca_tsu: True
2025-06-16 02:24:29,372 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 02:24:29,372 INFO Configuration - use_noise_aware_loss: True
2025-06-16 02:24:29,373 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 02:24:29,373 INFO Configuration - variant_type: hedge
2025-06-16 02:24:29,373 INFO Full model configuration:
2025-06-16 02:24:29,373 INFO   alpha: 0.5
2025-06-16 02:24:29,373 INFO   batch_size: 32
2025-06-16 02:24:29,374 INFO   ca_tsu_weight: 0.3
2025-06-16 02:24:29,374 INFO   causal_loss_lambda: 0.3
2025-06-16 02:24:29,374 INFO   clip: 15.0
2025-06-16 02:24:29,374 INFO   consistency_loss_weight: 0.05
2025-06-16 02:24:29,374 INFO   constant_kl_lambda: 0.1
2025-06-16 02:24:29,374 INFO   daily_att: y
2025-06-16 02:24:29,375 INFO   decay_rate: 0.96
2025-06-16 02:24:29,375 INFO   decay_step: 100
2025-06-16 02:24:29,375 INFO   dropout_ce: 0.0
2025-06-16 02:24:29,375 INFO   dropout_mel: 0.0
2025-06-16 02:24:29,376 INFO   dropout_mel_in: 0.3
2025-06-16 02:24:29,376 INFO   dropout_vmd: 0.0
2025-06-16 02:24:29,376 INFO   dropout_vmd_in: 0.3
2025-06-16 02:24:29,376 INFO   enhanced_srl_weight: 0.1
2025-06-16 02:24:29,376 INFO   entropy_regularization_lambda: 0.001
2025-06-16 02:24:29,377 INFO   g_size: 50
2025-06-16 02:24:29,377 INFO   h_size: 150
2025-06-16 02:24:29,377 INFO   init_stock_with_word: 0
2025-06-16 02:24:29,377 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 02:24:29,378 INFO   kl_lambda_start_step: 0
2025-06-16 02:24:29,378 INFO   lr: 0.001
2025-06-16 02:24:29,378 INFO   max_n_days: 5
2025-06-16 02:24:29,378 INFO   max_n_msgs: 20
2025-06-16 02:24:29,378 INFO   max_n_words: 30
2025-06-16 02:24:29,378 INFO   mel_cell_type: gru
2025-06-16 02:24:29,379 INFO   mel_h_size: 100
2025-06-16 02:24:29,379 INFO   mode: all
2025-06-16 02:24:29,379 INFO   momentum: 0.9
2025-06-16 02:24:29,379 INFO   msin_h_size: 100
2025-06-16 02:24:29,379 INFO   n_epochs: 10
2025-06-16 02:24:29,380 INFO   noise_aware_weight: 0.5
2025-06-16 02:24:29,380 INFO   opt: adam
2025-06-16 02:24:29,380 INFO   pathway_competition_type: dynamic
2025-06-16 02:24:29,380 INFO   prediction_loss_weight: 0.1
2025-06-16 02:24:29,380 INFO   residual_connection_weight: 0.1
2025-06-16 02:24:29,381 INFO   shuffle: 1
2025-06-16 02:24:29,381 INFO   stock_embed_size: 150
2025-06-16 02:24:29,381 INFO   td_temporal_attention: True
2025-06-16 02:24:29,381 INFO   use_ca_tsu: True
2025-06-16 02:24:29,381 INFO   use_constant_kl_lambda: 0
2025-06-16 02:24:29,381 INFO   use_dual_path_srl: True
2025-06-16 02:24:29,382 INFO   use_enhanced_srl: True
2025-06-16 02:24:29,382 INFO   use_g_bn: 0
2025-06-16 02:24:29,382 INFO   use_in_bn: 0
2025-06-16 02:24:29,382 INFO   use_noise_aware_loss: True
2025-06-16 02:24:29,382 INFO   use_o_bn: 0
2025-06-16 02:24:29,382 INFO   variant_type: hedge
2025-06-16 02:24:29,383 INFO   vmd_cell_type: gru
2025-06-16 02:24:29,383 INFO   vmd_rec: zh
2025-06-16 02:24:29,383 INFO   volatility_adaptation_factor: 0.3
2025-06-16 02:24:29,383 INFO   volatility_reg_weight: 0.05
2025-06-16 02:24:29,384 INFO   weight_init: xavier-uniform
2025-06-16 02:24:29,384 INFO   word_embed_size: 50
2025-06-16 02:24:29,384 INFO   word_embed_type: glove
2025-06-16 02:24:29,384 INFO   y_size: 2
2025-06-16 02:24:29,385 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 02:24:29,392 INFO Start graph assembling...
2025-06-16 02:24:31,118 INFO use_dual_path_srl: True
2025-06-16 02:24:31,118 INFO variant_type: hedge
2025-06-16 02:24:31,118 INFO use_enhanced_srl: True
2025-06-16 02:24:31,119 INFO Enhanced SRL enabled from config
2025-06-16 02:24:31,119 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 02:24:31,119 INFO SRL condition: True = True and True
2025-06-16 02:24:31,119 INFO Using enhanced dual-path SRL architecture
2025-06-16 02:24:31,120 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 02:24:31,165 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 02:24:31,169 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 02:24:31,189 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 02:24:31,414 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 02:24:31,414 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 02:24:31,414 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 02:24:31,684 INFO Using Temporal Attention (TAP)
2025-06-16 02:24:31,728 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 02:24:31,728 INFO Ca-TSU enabled: True
2025-06-16 02:24:31,728 INFO Enhanced SRL enabled: True
2025-06-16 02:24:31,729 INFO Noise-Aware Loss enabled: True
2025-06-16 02:24:31,743 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:31,743 INFO Adding auxiliary enhancement losses...
2025-06-16 02:24:31,765 INFO Creating Noise-Aware Loss component...
2025-06-16 02:24:31,773 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 02:24:31,774 INFO Creating Causal Consistency Loss component...
2025-06-16 02:24:31,808 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 02:24:31,809 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:31,809 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:24:34,200 INFO Graph assembled successfully.
2025-06-16 02:24:34,201 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all-hedge-gru_6a582145
2025-06-16 02:24:34,531 INFO Verifying model configuration...
2025-06-16 02:24:34,531 INFO Ca-TSU enabled: True
2025-06-16 02:24:34,531 INFO Enhanced SRL enabled: True
2025-06-16 02:24:34,532 INFO Noise-Aware Loss enabled: True
2025-06-16 02:24:34,532 INFO Checking model components for noise-aware loss...
2025-06-16 02:24:34,532 INFO Model has 'use_noise_aware_loss': True
2025-06-16 02:24:34,532 INFO use_noise_aware_loss value: True
2025-06-16 02:24:34,532 INFO Model has 'noise_aware_weight': True
2025-06-16 02:24:34,532 INFO noise_aware_weight value: 0.5
2025-06-16 02:24:34,533 INFO Model has 'noise_aware_loss': False
2025-06-16 02:24:34,533 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 02:24:34,533 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 02:24:34,533 INFO Model has 'reliability_weights': True
2025-06-16 02:24:34,533 INFO Model has 'use_enhanced_srl': True
2025-06-16 02:24:34,534 INFO use_enhanced_srl value: True
2025-06-16 02:24:34,534 INFO Model has 'enhanced_srl_loss': False
2025-06-16 02:24:34,534 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 02:24:34,534 INFO Model has 'use_ca_tsu': True
2025-06-16 02:24:34,534 INFO use_ca_tsu value: True
2025-06-16 02:24:34,534 INFO Model has 'causal_consistency_loss': False
2025-06-16 02:24:34,535 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 02:24:34,535 INFO Model has 'loss_components': True
2025-06-16 02:24:34,535 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 02:24:34,535 INFO Manually activating loss components...
2025-06-16 02:24:34,536 INFO Components manually activated:
2025-06-16 02:24:34,536 INFO use_enhanced_srl: True
2025-06-16 02:24:34,536 INFO use_ca_tsu: True
2025-06-16 02:24:34,536 INFO use_noise_aware_loss: True
2025-06-16 02:24:34,536 INFO use_dual_path_srl: True
2025-06-16 02:24:34,537 INFO Running test_noise_aware_loss...
2025-06-16 02:24:52,873 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 02:24:54,686 INFO Word table initialized
2025-06-16 02:24:54,687 INFO Checking loss components in the model graph...
2025-06-16 02:24:54,687 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:24:54,688 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,688 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,688 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,689 INFO Model: all-hedge-gru_6a582145, starting new session
2025-06-16 02:24:54,690 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 02:24:54,803 INFO Starting training test for 10 batches
2025-06-16 02:25:40,898 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 02:25:40,899 INFO   PERFORMANCE: Loss=1.3204 | Acc=0.5625 | MCC=0.1156
2025-06-16 02:25:40,899 INFO   LOSS COMPONENTS:
2025-06-16 02:25:40,900 INFO     - Causal Consistency Loss: 0.296538
2025-06-16 02:25:40,900 INFO     - Noise-Aware SRL Loss: 0.555084
2025-06-16 02:25:40,900 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:25:40,901 INFO     Alpha_i sample: 0.2989, Omega_i sample: 0.4712
2025-06-16 02:25:40,901 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:25:40,902 INFO     Volatility: 0.6680, Text Weight: 0.4298, Price Weight: 0.5702
2025-06-16 02:27:01,135 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 02:27:01,136 INFO   PERFORMANCE: Loss=1.4199 | Acc=0.5938 | MCC=0.1773
2025-06-16 02:27:01,136 INFO   LOSS COMPONENTS:
2025-06-16 02:27:01,137 INFO     - Causal Consistency Loss: -0.144180
2025-06-16 02:27:01,137 INFO     - Noise-Aware SRL Loss: 0.394152
2025-06-16 02:27:01,137 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:27:01,137 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:27:01,138 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:27:01,139 INFO     Volatility: 0.6467, Text Weight: 0.4941, Price Weight: 0.5059
2025-06-16 02:28:29,376 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 02:28:29,378 INFO   PERFORMANCE: Loss=1.5198 | Acc=0.5938 | MCC=0.2085
2025-06-16 02:28:29,378 INFO   LOSS COMPONENTS:
2025-06-16 02:28:29,378 INFO     - Causal Consistency Loss: -0.163450
2025-06-16 02:28:29,379 INFO     - Noise-Aware SRL Loss: 0.223226
2025-06-16 02:28:29,379 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:28:29,379 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:28:29,380 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:28:29,381 INFO     Volatility: 0.6569, Text Weight: 0.6088, Price Weight: 0.3912
2025-06-16 02:28:29,381 INFO Generating diagnostic plots...
2025-06-16 02:28:31,589 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 02:28:31,589 INFO Saving final checkpoint for test run...
2025-06-16 02:28:32,448 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_6a582145\sess-10
2025-06-16 02:28:32,449 INFO Start dev phase...
2025-06-16 02:30:24,448 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-16 02:30:24,449 INFO 	Eval, eval loss: 1.472795844078064, acc: 0.489329
2025-06-16 02:30:24,633 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_023024.txt
2025-06-16 02:30:24,633 INFO Test completed successfully!
2025-06-16 03:56:50,419 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 03:56:50,421 INFO Configuration - use_dual_path_srl: True
2025-06-16 03:56:50,421 INFO Configuration - use_enhanced_srl: True
2025-06-16 03:56:50,421 INFO Configuration - use_ca_tsu: True
2025-06-16 03:56:50,421 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 03:56:50,422 INFO Configuration - use_noise_aware_loss: True
2025-06-16 03:56:50,422 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 03:56:50,422 INFO Configuration - variant_type: hedge
2025-06-16 03:56:50,422 INFO Full model configuration:
2025-06-16 03:56:50,422 INFO   alpha: 0.5
2025-06-16 03:56:50,422 INFO   batch_size: 32
2025-06-16 03:56:50,423 INFO   ca_tsu_weight: 0.3
2025-06-16 03:56:50,423 INFO   causal_loss_lambda: 0.3
2025-06-16 03:56:50,423 INFO   clip: 15.0
2025-06-16 03:56:50,423 INFO   consistency_loss_weight: 0.05
2025-06-16 03:56:50,423 INFO   constant_kl_lambda: 0.1
2025-06-16 03:56:50,424 INFO   daily_att: y
2025-06-16 03:56:50,424 INFO   decay_rate: 0.96
2025-06-16 03:56:50,424 INFO   decay_step: 100
2025-06-16 03:56:50,424 INFO   dropout_ce: 0.0
2025-06-16 03:56:50,424 INFO   dropout_mel: 0.0
2025-06-16 03:56:50,424 INFO   dropout_mel_in: 0.3
2025-06-16 03:56:50,425 INFO   dropout_vmd: 0.0
2025-06-16 03:56:50,425 INFO   dropout_vmd_in: 0.3
2025-06-16 03:56:50,425 INFO   enhanced_srl_weight: 0.1
2025-06-16 03:56:50,425 INFO   entropy_regularization_lambda: 0.001
2025-06-16 03:56:50,426 INFO   g_size: 50
2025-06-16 03:56:50,426 INFO   h_size: 150
2025-06-16 03:56:50,426 INFO   init_stock_with_word: 0
2025-06-16 03:56:50,426 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 03:56:50,426 INFO   kl_lambda_start_step: 0
2025-06-16 03:56:50,427 INFO   lr: 0.001
2025-06-16 03:56:50,427 INFO   max_n_days: 5
2025-06-16 03:56:50,427 INFO   max_n_msgs: 20
2025-06-16 03:56:50,427 INFO   max_n_words: 30
2025-06-16 03:56:50,427 INFO   mel_cell_type: gru
2025-06-16 03:56:50,427 INFO   mel_h_size: 100
2025-06-16 03:56:50,427 INFO   mode: all
2025-06-16 03:56:50,428 INFO   momentum: 0.9
2025-06-16 03:56:50,428 INFO   msin_h_size: 100
2025-06-16 03:56:50,428 INFO   n_epochs: 10
2025-06-16 03:56:50,428 INFO   noise_aware_weight: 0.5
2025-06-16 03:56:50,428 INFO   opt: adam
2025-06-16 03:56:50,428 INFO   pathway_competition_type: dynamic
2025-06-16 03:56:50,429 INFO   prediction_loss_weight: 0.1
2025-06-16 03:56:50,429 INFO   residual_connection_weight: 0.1
2025-06-16 03:56:50,429 INFO   shuffle: 1
2025-06-16 03:56:50,429 INFO   stock_embed_size: 150
2025-06-16 03:56:50,429 INFO   td_temporal_attention: True
2025-06-16 03:56:50,430 INFO   use_ca_tsu: True
2025-06-16 03:56:50,430 INFO   use_constant_kl_lambda: 0
2025-06-16 03:56:50,430 INFO   use_dual_path_srl: True
2025-06-16 03:56:50,430 INFO   use_enhanced_srl: True
2025-06-16 03:56:50,430 INFO   use_g_bn: 0
2025-06-16 03:56:50,431 INFO   use_in_bn: 0
2025-06-16 03:56:50,431 INFO   use_noise_aware_loss: True
2025-06-16 03:56:50,431 INFO   use_o_bn: 0
2025-06-16 03:56:50,431 INFO   variant_type: hedge
2025-06-16 03:56:50,431 INFO   vmd_cell_type: gru
2025-06-16 03:56:50,432 INFO   vmd_rec: zh
2025-06-16 03:56:50,432 INFO   volatility_adaptation_factor: 0.3
2025-06-16 03:56:50,432 INFO   volatility_reg_weight: 0.05
2025-06-16 03:56:50,432 INFO   weight_init: xavier-uniform
2025-06-16 03:56:50,432 INFO   word_embed_size: 50
2025-06-16 03:56:50,433 INFO   word_embed_type: glove
2025-06-16 03:56:50,433 INFO   y_size: 2
2025-06-16 03:56:50,433 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 03:56:50,439 INFO Start graph assembling...
2025-06-16 03:56:52,157 INFO use_dual_path_srl: True
2025-06-16 03:56:52,157 INFO variant_type: hedge
2025-06-16 03:56:52,157 INFO use_enhanced_srl: True
2025-06-16 03:56:52,158 INFO Enhanced SRL enabled from config
2025-06-16 03:56:52,158 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 03:56:52,158 INFO SRL condition: True = True and True
2025-06-16 03:56:52,158 INFO Using enhanced dual-path SRL architecture
2025-06-16 03:56:52,158 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 03:56:52,203 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 03:56:52,208 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 03:56:52,227 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 03:56:52,451 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 03:56:52,452 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 03:56:52,452 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 03:56:52,717 INFO Using Temporal Attention (TAP)
2025-06-16 03:56:52,762 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 03:56:52,762 INFO Ca-TSU enabled: True
2025-06-16 03:56:52,763 INFO Enhanced SRL enabled: True
2025-06-16 03:56:52,763 INFO Noise-Aware Loss enabled: True
2025-06-16 03:56:52,778 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:56:52,778 INFO Adding auxiliary enhancement losses...
2025-06-16 03:56:52,800 INFO Creating Noise-Aware Loss component...
2025-06-16 03:56:52,808 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 03:56:52,809 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 03:56:52,809 INFO Causal Loss KL Divergence: P shape=(?, 5, 20), Q shape=(?, 5, 20)
2025-06-16 03:56:52,817 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 03:56:52,817 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:56:52,817 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 03:56:55,123 INFO Graph assembled successfully.
2025-06-16 03:56:55,415 INFO Verifying model configuration...
2025-06-16 03:56:55,415 INFO Ca-TSU enabled: True
2025-06-16 03:56:55,415 INFO Enhanced SRL enabled: True
2025-06-16 03:56:55,416 INFO Noise-Aware Loss enabled: True
2025-06-16 03:56:55,416 INFO Checking model components for noise-aware loss...
2025-06-16 03:56:55,416 INFO Model has 'use_noise_aware_loss': True
2025-06-16 03:56:55,416 INFO use_noise_aware_loss value: True
2025-06-16 03:56:55,416 INFO Model has 'noise_aware_weight': True
2025-06-16 03:56:55,417 INFO noise_aware_weight value: 0.5
2025-06-16 03:56:55,417 INFO Model has 'noise_aware_loss': False
2025-06-16 03:56:55,417 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 03:56:55,418 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 03:56:55,418 INFO Model has 'reliability_weights': True
2025-06-16 03:56:55,418 INFO Model has 'use_enhanced_srl': True
2025-06-16 03:56:55,418 INFO use_enhanced_srl value: True
2025-06-16 03:56:55,419 INFO Model has 'enhanced_srl_loss': False
2025-06-16 03:56:55,419 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 03:56:55,419 INFO Model has 'use_ca_tsu': True
2025-06-16 03:56:55,419 INFO use_ca_tsu value: True
2025-06-16 03:56:55,419 INFO Model has 'causal_consistency_loss': False
2025-06-16 03:56:55,420 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 03:56:55,420 INFO Model has 'loss_components': True
2025-06-16 03:56:55,420 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 03:56:55,420 INFO Manually activating loss components...
2025-06-16 03:56:55,420 INFO Components manually activated:
2025-06-16 03:56:55,420 INFO use_enhanced_srl: True
2025-06-16 03:56:55,421 INFO use_ca_tsu: True
2025-06-16 03:56:55,421 INFO use_noise_aware_loss: True
2025-06-16 03:56:55,421 INFO use_dual_path_srl: True
2025-06-16 03:56:55,422 INFO Running test_noise_aware_loss...
2025-06-16 03:57:13,676 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 03:57:15,317 INFO Word table initialized
2025-06-16 03:57:15,318 INFO Checking loss components in the model graph...
2025-06-16 03:57:15,318 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 03:57:15,318 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 03:57:15,320 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 03:57:15,402 INFO Starting training test for 10 batches
2025-06-16 03:57:49,206 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 03:57:49,207 INFO   PERFORMANCE: Loss=1.3116 | Acc=0.5312 | MCC=0.0485
2025-06-16 03:57:49,207 INFO   LOSS COMPONENTS:
2025-06-16 03:57:49,207 INFO     - Causal Consistency Loss: 0.287717
2025-06-16 03:57:49,208 INFO     - Noise-Aware SRL Loss: 0.535706
2025-06-16 03:57:49,208 INFO   Ca-TSU (Attention on Messages):
2025-06-16 03:57:49,208 INFO     Alpha_i sample: 0.1212, Omega_i sample: 0.1440
2025-06-16 03:57:49,209 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 03:57:49,209 INFO     Volatility: 0.6707, Text Weight: 0.4400, Price Weight: 0.5600
2025-06-16 03:59:16,690 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 03:59:16,690 INFO   PERFORMANCE: Loss=1.4679 | Acc=0.6562 | MCC=0.3131
2025-06-16 03:59:16,691 INFO   LOSS COMPONENTS:
2025-06-16 03:59:16,692 INFO     - Causal Consistency Loss: 0.274589
2025-06-16 03:59:16,692 INFO     - Noise-Aware SRL Loss: 0.322688
2025-06-16 03:59:16,692 INFO   Ca-TSU (Attention on Messages):
2025-06-16 03:59:16,692 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 03:59:16,692 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 03:59:16,693 INFO     Volatility: 0.6658, Text Weight: 0.5208, Price Weight: 0.4792
2025-06-16 04:00:43,059 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 04:00:43,059 INFO   PERFORMANCE: Loss=1.5917 | Acc=0.5312 | MCC=-0.0367
2025-06-16 04:00:43,059 INFO   LOSS COMPONENTS:
2025-06-16 04:00:43,060 INFO     - Causal Consistency Loss: 0.260981
2025-06-16 04:00:43,060 INFO     - Noise-Aware SRL Loss: 0.128287
2025-06-16 04:00:43,060 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:00:43,060 INFO     Alpha_i sample: 0.1815, Omega_i sample: 0.4871
2025-06-16 04:00:43,061 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:00:43,062 INFO     Volatility: 0.6444, Text Weight: 0.7108, Price Weight: 0.2892
2025-06-16 04:00:43,062 INFO Generating diagnostic plots...
2025-06-16 04:00:45,230 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:00:45,230 INFO Saving final checkpoint for test run...
2025-06-16 04:00:45,382 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate15857935528832320232 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2183, MSIN_RNN/market_projection/kernel/_2185, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2187, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2189, MSIN_RNN/text_price_cross_attention/dense/bias/_2191, MSIN_RNN/text_price_cross_attention/dense/kernel/_2193, MSIN_RNN/text_self_attention/LayerNorm/beta/_2195, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2197, MSIN_RNN/text_self_attention/dense/bias/_2199, MSIN_RNN/text_self_attention/dense/kernel/_2201, W_f/_2203, W_ha/_2205, W_hf/_2207, W_hk/_2209, W_ho/_2211, W_hs/_2213, W_ht/_2215, W_hv/_2217, W_k/_2219, W_o/_2221, W_price_pred/_2223, W_price_pred/Adam/_2225, W_price_pred/Adam_1/_2227, W_reliability/_2229, W_reliability/Adam/_2231, W_reliability/Adam_1/_2233, W_s/_2235, W_sa/_2237, W_t/_2239, W_v/_2241, W_vk/_2243, b_price_pred/_2245, b_price_pred/Adam/_2247, b_price_pred/Adam_1/_2249, b_reliability/_2251, b_reliability/Adam/_2253, b_reliability/Adam_1/_2255, ca_tsu/W_K/_2257, ca_tsu/W_K/Adam/_2259, ca_tsu/W_K/Adam_1/_2261, ca_tsu/W_Q/_2263, ca_tsu/W_Q/Adam/_2265, ca_tsu/W_Q/Adam_1/_2267, ca_tsu/b_causal/_2269, ca_tsu/b_causal/Adam/_2271, ca_tsu/b_causal/Adam_1/_2273, embeds/word_table/_2275, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2277, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2279, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2281, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2283, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2285, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2287, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2289, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2291, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2293, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2295, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2297, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2299, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2301, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2303, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2305, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2323, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2325, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2327, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2331, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2333, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2337, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2339, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2341, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2343, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2345, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2395, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2397, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2399, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2401, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2403, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2405, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2407, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2409, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2411, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2413, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2415, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2419, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2443, mie/Variable/_2445, mie/Variable_1/_2447, mie/Variable_2/_2449, mie/Variable_3/_2451, mie/Variable_4/_2453, mie/Variable_5/_2455, mie/Variable_6/_2457, mie/Variable_7/_2459, optimizer/beta1_power/_2461, optimizer/beta2_power/_2463, tda/pred_from_gT_att_logits/bias/_2465, tda/pred_from_gT_att_logits/bias/Adam/_2467, tda/pred_from_gT_att_logits/bias/Adam_1/_2469, tda/pred_from_gT_att_logits/kernel/_2471, tda/pred_from_gT_att_logits/kernel/Adam/_2473, tda/pred_from_gT_att_logits/kernel/Adam_1/_2475, tda/v_i/g_projection_att/kernel/_2477, tda/v_i/g_projection_att/kernel/Adam/_2479, tda/v_i/g_projection_att/kernel/Adam_1/_2481, tda/v_i/w_i_temporal_att/_2483, tda/v_i/w_i_temporal_att/Adam/_2485, tda/v_i/w_i_temporal_att/Adam_1/_2487, text_price_cross_attention/dense/_2489, text_price_cross_attention/wk/_2491, text_price_cross_attention/wq/_2493, text_price_cross_attention/wv/_2495, text_self_attention/dense/_2497, text_self_attention/wk/_2499, text_self_attention/wq/_2501, text_self_attention/wv/_2503, u_t/linear_layer/W/_2505, u_t/linear_layer/W/Adam/_2507, u_t/linear_layer/W/Adam_1/_2509, u_t/w_u_original/_2511, u_t/w_u_original/Adam/_2513, u_t/w_u_original/Adam_1/_2515, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2517, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2519, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2521, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2523, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2525, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2527, vmd_zh_rec_iter/gru_cell/candidate/bias/_2529, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2531, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2533, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2535, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2537, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2539, vmd_zh_rec_iter/gru_cell/gates/bias/_2541, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2543, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2545, vmd_zh_rec_iter/gru_cell/gates/kernel/_2547, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2549, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2551, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2553, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2555, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2557, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2559, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2561, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2563, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2565, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2567, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2569, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2571, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2573, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2575, vmd_zh_rec_iter/z_posterior/z_mu/W/_2577, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2579, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2581, vmd_zh_rec_iter/z_posterior/z_mu/b/_2583, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2585, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2587, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_prior/z_mu/W/_2613, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_prior/z_mu/b/_2619, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2623)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate15857935528832320232 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2183, MSIN_RNN/market_projection/kernel/_2185, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2187, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2189, MSIN_RNN/text_price_cross_attention/dense/bias/_2191, MSIN_RNN/text_price_cross_attention/dense/kernel/_2193, MSIN_RNN/text_self_attention/LayerNorm/beta/_2195, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2197, MSIN_RNN/text_self_attention/dense/bias/_2199, MSIN_RNN/text_self_attention/dense/kernel/_2201, W_f/_2203, W_ha/_2205, W_hf/_2207, W_hk/_2209, W_ho/_2211, W_hs/_2213, W_ht/_2215, W_hv/_2217, W_k/_2219, W_o/_2221, W_price_pred/_2223, W_price_pred/Adam/_2225, W_price_pred/Adam_1/_2227, W_reliability/_2229, W_reliability/Adam/_2231, W_reliability/Adam_1/_2233, W_s/_2235, W_sa/_2237, W_t/_2239, W_v/_2241, W_vk/_2243, b_price_pred/_2245, b_price_pred/Adam/_2247, b_price_pred/Adam_1/_2249, b_reliability/_2251, b_reliability/Adam/_2253, b_reliability/Adam_1/_2255, ca_tsu/W_K/_2257, ca_tsu/W_K/Adam/_2259, ca_tsu/W_K/Adam_1/_2261, ca_tsu/W_Q/_2263, ca_tsu/W_Q/Adam/_2265, ca_tsu/W_Q/Adam_1/_2267, ca_tsu/b_causal/_2269, ca_tsu/b_causal/Adam/_2271, ca_tsu/b_causal/Adam_1/_2273, embeds/word_table/_2275, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2277, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2279, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2281, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2283, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2285, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2287, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2289, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2291, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2293, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2295, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2297, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2299, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2301, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2303, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2305, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2323, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2325, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2327, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2331, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2333, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2337, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2339, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2341, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2343, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2345, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2395, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2397, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2399, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2401, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2403, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2405, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2407, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2409, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2411, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2413, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2415, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2419, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2443, mie/Variable/_2445, mie/Variable_1/_2447, mie/Variable_2/_2449, mie/Variable_3/_2451, mie/Variable_4/_2453, mie/Variable_5/_2455, mie/Variable_6/_2457, mie/Variable_7/_2459, optimizer/beta1_power/_2461, optimizer/beta2_power/_2463, tda/pred_from_gT_att_logits/bias/_2465, tda/pred_from_gT_att_logits/bias/Adam/_2467, tda/pred_from_gT_att_logits/bias/Adam_1/_2469, tda/pred_from_gT_att_logits/kernel/_2471, tda/pred_from_gT_att_logits/kernel/Adam/_2473, tda/pred_from_gT_att_logits/kernel/Adam_1/_2475, tda/v_i/g_projection_att/kernel/_2477, tda/v_i/g_projection_att/kernel/Adam/_2479, tda/v_i/g_projection_att/kernel/Adam_1/_2481, tda/v_i/w_i_temporal_att/_2483, tda/v_i/w_i_temporal_att/Adam/_2485, tda/v_i/w_i_temporal_att/Adam_1/_2487, text_price_cross_attention/dense/_2489, text_price_cross_attention/wk/_2491, text_price_cross_attention/wq/_2493, text_price_cross_attention/wv/_2495, text_self_attention/dense/_2497, text_self_attention/wk/_2499, text_self_attention/wq/_2501, text_self_attention/wv/_2503, u_t/linear_layer/W/_2505, u_t/linear_layer/W/Adam/_2507, u_t/linear_layer/W/Adam_1/_2509, u_t/w_u_original/_2511, u_t/w_u_original/Adam/_2513, u_t/w_u_original/Adam_1/_2515, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2517, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2519, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2521, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2523, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2525, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2527, vmd_zh_rec_iter/gru_cell/candidate/bias/_2529, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2531, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2533, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2535, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2537, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2539, vmd_zh_rec_iter/gru_cell/gates/bias/_2541, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2543, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2545, vmd_zh_rec_iter/gru_cell/gates/kernel/_2547, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2549, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2551, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2553, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2555, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2557, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2559, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2561, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2563, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2565, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2567, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2569, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2571, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2573, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2575, vmd_zh_rec_iter/z_posterior/z_mu/W/_2577, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2579, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2581, vmd_zh_rec_iter/z_posterior/z_mu/b/_2583, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2585, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2587, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_prior/z_mu/W/_2613, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_prior/z_mu/b/_2619, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2623)]]

2025-06-16 04:00:45,384 INFO Start dev phase...
2025-06-16 04:02:30,245 INFO Completed dev evaluation: size=656.0, acc=0.4604
2025-06-16 04:02:30,246 INFO 	Eval, eval loss: 2.3676211833953857, acc: 0.460366
2025-06-16 04:02:30,401 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_040230.txt
2025-06-16 04:02:30,402 INFO Test completed successfully!
2025-06-16 04:05:38,001 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 04:05:38,001 INFO Configuration - use_dual_path_srl: True
2025-06-16 04:05:38,001 INFO Configuration - use_enhanced_srl: True
2025-06-16 04:05:38,001 INFO Configuration - use_ca_tsu: True
2025-06-16 04:05:38,002 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 04:05:38,002 INFO Configuration - use_noise_aware_loss: True
2025-06-16 04:05:38,002 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 04:05:38,002 INFO Configuration - variant_type: hedge
2025-06-16 04:05:38,003 INFO Full model configuration:
2025-06-16 04:05:38,003 INFO   alpha: 0.5
2025-06-16 04:05:38,003 INFO   batch_size: 32
2025-06-16 04:05:38,003 INFO   ca_tsu_weight: 0.3
2025-06-16 04:05:38,004 INFO   causal_loss_lambda: 0.3
2025-06-16 04:05:38,004 INFO   clip: 15.0
2025-06-16 04:05:38,004 INFO   consistency_loss_weight: 0.05
2025-06-16 04:05:38,004 INFO   constant_kl_lambda: 0.1
2025-06-16 04:05:38,005 INFO   daily_att: y
2025-06-16 04:05:38,005 INFO   decay_rate: 0.96
2025-06-16 04:05:38,005 INFO   decay_step: 100
2025-06-16 04:05:38,005 INFO   dropout_ce: 0.0
2025-06-16 04:05:38,005 INFO   dropout_mel: 0.0
2025-06-16 04:05:38,006 INFO   dropout_mel_in: 0.3
2025-06-16 04:05:38,006 INFO   dropout_vmd: 0.0
2025-06-16 04:05:38,006 INFO   dropout_vmd_in: 0.3
2025-06-16 04:05:38,006 INFO   enhanced_srl_weight: 0.1
2025-06-16 04:05:38,007 INFO   entropy_regularization_lambda: 0.001
2025-06-16 04:05:38,007 INFO   g_size: 50
2025-06-16 04:05:38,007 INFO   h_size: 150
2025-06-16 04:05:38,008 INFO   init_stock_with_word: 0
2025-06-16 04:05:38,008 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 04:05:38,008 INFO   kl_lambda_start_step: 0
2025-06-16 04:05:38,008 INFO   lr: 0.001
2025-06-16 04:05:38,009 INFO   max_n_days: 5
2025-06-16 04:05:38,009 INFO   max_n_msgs: 20
2025-06-16 04:05:38,009 INFO   max_n_words: 30
2025-06-16 04:05:38,009 INFO   mel_cell_type: gru
2025-06-16 04:05:38,009 INFO   mel_h_size: 100
2025-06-16 04:05:38,010 INFO   mode: all
2025-06-16 04:05:38,010 INFO   momentum: 0.9
2025-06-16 04:05:38,010 INFO   msin_h_size: 100
2025-06-16 04:05:38,010 INFO   n_epochs: 10
2025-06-16 04:05:38,011 INFO   noise_aware_weight: 0.5
2025-06-16 04:05:38,011 INFO   opt: adam
2025-06-16 04:05:38,011 INFO   pathway_competition_type: dynamic
2025-06-16 04:05:38,011 INFO   prediction_loss_weight: 0.1
2025-06-16 04:05:38,012 INFO   residual_connection_weight: 0.1
2025-06-16 04:05:38,012 INFO   shuffle: 1
2025-06-16 04:05:38,012 INFO   stock_embed_size: 150
2025-06-16 04:05:38,012 INFO   td_temporal_attention: True
2025-06-16 04:05:38,012 INFO   use_ca_tsu: True
2025-06-16 04:05:38,013 INFO   use_constant_kl_lambda: 0
2025-06-16 04:05:38,013 INFO   use_dual_path_srl: True
2025-06-16 04:05:38,013 INFO   use_enhanced_srl: True
2025-06-16 04:05:38,013 INFO   use_g_bn: 0
2025-06-16 04:05:38,013 INFO   use_in_bn: 0
2025-06-16 04:05:38,014 INFO   use_noise_aware_loss: True
2025-06-16 04:05:38,014 INFO   use_o_bn: 0
2025-06-16 04:05:38,014 INFO   variant_type: hedge
2025-06-16 04:05:38,014 INFO   vmd_cell_type: gru
2025-06-16 04:05:38,014 INFO   vmd_rec: zh
2025-06-16 04:05:38,015 INFO   volatility_adaptation_factor: 0.3
2025-06-16 04:05:38,015 INFO   volatility_reg_weight: 0.05
2025-06-16 04:05:38,015 INFO   weight_init: xavier-uniform
2025-06-16 04:05:38,015 INFO   word_embed_size: 50
2025-06-16 04:05:38,016 INFO   word_embed_type: glove
2025-06-16 04:05:38,016 INFO   y_size: 2
2025-06-16 04:05:38,016 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 04:05:38,018 INFO Start graph assembling...
2025-06-16 04:05:39,720 INFO use_dual_path_srl: True
2025-06-16 04:05:39,721 INFO variant_type: hedge
2025-06-16 04:05:39,721 INFO use_enhanced_srl: True
2025-06-16 04:05:39,722 INFO Enhanced SRL enabled from config
2025-06-16 04:05:39,722 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 04:05:39,723 INFO SRL condition: True = True and True
2025-06-16 04:05:39,723 INFO Using enhanced dual-path SRL architecture
2025-06-16 04:05:39,723 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 04:05:39,766 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 04:05:39,770 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 04:05:39,789 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 04:05:40,012 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 04:05:40,012 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 04:05:40,012 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 04:05:40,276 INFO Using Temporal Attention (TAP)
2025-06-16 04:05:40,319 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 04:05:40,319 INFO Ca-TSU enabled: True
2025-06-16 04:05:40,320 INFO Enhanced SRL enabled: True
2025-06-16 04:05:40,320 INFO Noise-Aware Loss enabled: True
2025-06-16 04:05:40,333 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:05:40,334 INFO Adding auxiliary enhancement losses...
2025-06-16 04:05:40,354 INFO Creating Noise-Aware Loss component...
2025-06-16 04:05:40,361 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 04:05:40,362 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 04:05:40,363 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 04:05:40,372 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 04:05:40,372 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:05:40,372 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:05:42,667 INFO Graph assembled successfully.
2025-06-16 04:05:42,941 INFO Verifying model configuration...
2025-06-16 04:05:42,941 INFO Ca-TSU enabled: True
2025-06-16 04:05:42,942 INFO Enhanced SRL enabled: True
2025-06-16 04:05:42,942 INFO Noise-Aware Loss enabled: True
2025-06-16 04:05:42,942 INFO Checking model components for noise-aware loss...
2025-06-16 04:05:42,943 INFO Model has 'use_noise_aware_loss': True
2025-06-16 04:05:42,943 INFO use_noise_aware_loss value: True
2025-06-16 04:05:42,943 INFO Model has 'noise_aware_weight': True
2025-06-16 04:05:42,943 INFO noise_aware_weight value: 0.5
2025-06-16 04:05:42,944 INFO Model has 'noise_aware_loss': False
2025-06-16 04:05:42,944 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 04:05:42,944 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 04:05:42,944 INFO Model has 'reliability_weights': True
2025-06-16 04:05:42,944 INFO Model has 'use_enhanced_srl': True
2025-06-16 04:05:42,944 INFO use_enhanced_srl value: True
2025-06-16 04:05:42,944 INFO Model has 'enhanced_srl_loss': False
2025-06-16 04:05:42,944 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 04:05:42,945 INFO Model has 'use_ca_tsu': True
2025-06-16 04:05:42,945 INFO use_ca_tsu value: True
2025-06-16 04:05:42,945 INFO Model has 'causal_consistency_loss': False
2025-06-16 04:05:42,945 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 04:05:42,945 INFO Model has 'loss_components': True
2025-06-16 04:05:42,945 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 04:05:42,946 INFO Manually activating loss components...
2025-06-16 04:05:42,946 INFO Components manually activated:
2025-06-16 04:05:42,946 INFO use_enhanced_srl: True
2025-06-16 04:05:42,946 INFO use_ca_tsu: True
2025-06-16 04:05:42,946 INFO use_noise_aware_loss: True
2025-06-16 04:05:42,947 INFO use_dual_path_srl: True
2025-06-16 04:05:42,947 INFO Running test_noise_aware_loss...
2025-06-16 04:06:01,030 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 04:06:02,323 INFO Word table initialized
2025-06-16 04:06:02,324 INFO Checking loss components in the model graph...
2025-06-16 04:06:02,324 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:06:02,324 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:02,324 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:02,325 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:03,182 INFO Model: all-hedge-gru_6a582145, session restored from checkpoint
2025-06-16 04:06:03,183 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 04:06:03,274 INFO Starting training test for 10 batches
2025-06-16 04:06:29,314 INFO --- Batch 1/10 (Step 11) ---
2025-06-16 04:06:29,315 INFO   PERFORMANCE: Loss=1.5852 | Acc=0.5312 | MCC=0.1459
2025-06-16 04:06:29,316 INFO   LOSS COMPONENTS:
2025-06-16 04:06:29,316 INFO     - Causal Consistency Loss: 0.121544
2025-06-16 04:06:29,316 INFO     - Noise-Aware SRL Loss: 0.218777
2025-06-16 04:06:29,316 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:06:29,317 INFO     Alpha_i sample: 0.3071, Omega_i sample: 0.4636
2025-06-16 04:06:29,317 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:06:29,318 INFO     Volatility: 0.6789, Text Weight: 0.6124, Price Weight: 0.3876
2025-06-16 04:07:49,321 INFO --- Batch 5/10 (Step 15) ---
2025-06-16 04:07:49,321 INFO   PERFORMANCE: Loss=1.5153 | Acc=0.5625 | MCC=0.1291
2025-06-16 04:07:49,321 INFO   LOSS COMPONENTS:
2025-06-16 04:07:49,322 INFO     - Causal Consistency Loss: 0.038750
2025-06-16 04:07:49,322 INFO     - Noise-Aware SRL Loss: 0.133969
2025-06-16 04:07:49,322 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:07:49,323 INFO     Alpha_i sample: 0.1037, Omega_i sample: 0.0856
2025-06-16 04:07:49,323 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:07:49,324 INFO     Volatility: 0.6606, Text Weight: 0.7166, Price Weight: 0.2834
2025-06-16 04:09:21,196 INFO --- Batch 10/10 (Step 20) ---
2025-06-16 04:09:21,197 INFO   PERFORMANCE: Loss=1.2709 | Acc=0.6250 | MCC=0.2431
2025-06-16 04:09:21,197 INFO   LOSS COMPONENTS:
2025-06-16 04:09:21,197 INFO     - Causal Consistency Loss: 0.046813
2025-06-16 04:09:21,198 INFO     - Noise-Aware SRL Loss: 0.059435
2025-06-16 04:09:21,198 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:09:21,198 INFO     Alpha_i sample: 0.6734, Omega_i sample: 0.4123
2025-06-16 04:09:21,200 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:09:21,201 INFO     Volatility: 0.6641, Text Weight: 0.8599, Price Weight: 0.1401
2025-06-16 04:09:21,201 INFO Generating diagnostic plots...
2025-06-16 04:09:23,359 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:09:23,359 INFO Saving final checkpoint for test run...
2025-06-16 04:09:24,241 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_6a582145\sess-20
2025-06-16 04:09:24,241 INFO Start dev phase...
2025-06-16 04:11:11,407 INFO Completed dev evaluation: size=656.0, acc=0.5229
2025-06-16 04:11:11,408 INFO 	Eval, eval loss: 1.2733991146087646, acc: 0.522866
2025-06-16 04:11:11,599 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_041111.txt
2025-06-16 04:11:11,600 INFO Test completed successfully!
2025-06-16 04:24:36,272 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 04:24:36,272 INFO Configuration - use_dual_path_srl: True
2025-06-16 04:24:36,273 INFO Configuration - use_enhanced_srl: True
2025-06-16 04:24:36,273 INFO Configuration - use_ca_tsu: True
2025-06-16 04:24:36,273 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 04:24:36,273 INFO Configuration - use_noise_aware_loss: True
2025-06-16 04:24:36,274 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 04:24:36,274 INFO Configuration - variant_type: hedge
2025-06-16 04:24:36,274 INFO Full model configuration:
2025-06-16 04:24:36,274 INFO   alpha: 0.5
2025-06-16 04:24:36,275 INFO   batch_size: 32
2025-06-16 04:24:36,276 INFO   ca_tsu_weight: 0.3
2025-06-16 04:24:36,276 INFO   causal_loss_lambda: 0.3
2025-06-16 04:24:36,277 INFO   clip: 15.0
2025-06-16 04:24:36,277 INFO   consistency_loss_weight: 0.05
2025-06-16 04:24:36,277 INFO   constant_kl_lambda: 0.1
2025-06-16 04:24:36,278 INFO   daily_att: y
2025-06-16 04:24:36,278 INFO   decay_rate: 0.96
2025-06-16 04:24:36,278 INFO   decay_step: 100
2025-06-16 04:24:36,279 INFO   dropout_ce: 0.0
2025-06-16 04:24:36,279 INFO   dropout_mel: 0.0
2025-06-16 04:24:36,279 INFO   dropout_mel_in: 0.3
2025-06-16 04:24:36,279 INFO   dropout_vmd: 0.0
2025-06-16 04:24:36,279 INFO   dropout_vmd_in: 0.3
2025-06-16 04:24:36,280 INFO   enhanced_srl_weight: 0.1
2025-06-16 04:24:36,280 INFO   entropy_regularization_lambda: 0.001
2025-06-16 04:24:36,280 INFO   g_size: 50
2025-06-16 04:24:36,280 INFO   h_size: 150
2025-06-16 04:24:36,281 INFO   init_stock_with_word: 0
2025-06-16 04:24:36,281 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 04:24:36,281 INFO   kl_lambda_start_step: 0
2025-06-16 04:24:36,281 INFO   lr: 0.001
2025-06-16 04:24:36,281 INFO   max_n_days: 5
2025-06-16 04:24:36,282 INFO   max_n_msgs: 20
2025-06-16 04:24:36,282 INFO   max_n_words: 30
2025-06-16 04:24:36,282 INFO   mel_cell_type: gru
2025-06-16 04:24:36,282 INFO   mel_h_size: 100
2025-06-16 04:24:36,283 INFO   mode: all
2025-06-16 04:24:36,283 INFO   momentum: 0.9
2025-06-16 04:24:36,283 INFO   msin_h_size: 100
2025-06-16 04:24:36,283 INFO   n_epochs: 10
2025-06-16 04:24:36,283 INFO   noise_aware_weight: 0.5
2025-06-16 04:24:36,284 INFO   opt: adam
2025-06-16 04:24:36,284 INFO   pathway_competition_type: dynamic
2025-06-16 04:24:36,284 INFO   prediction_loss_weight: 0.1
2025-06-16 04:24:36,284 INFO   residual_connection_weight: 0.1
2025-06-16 04:24:36,284 INFO   shuffle: 1
2025-06-16 04:24:36,285 INFO   stock_embed_size: 150
2025-06-16 04:24:36,285 INFO   td_temporal_attention: True
2025-06-16 04:24:36,285 INFO   use_ca_tsu: True
2025-06-16 04:24:36,285 INFO   use_constant_kl_lambda: 0
2025-06-16 04:24:36,285 INFO   use_dual_path_srl: True
2025-06-16 04:24:36,286 INFO   use_enhanced_srl: True
2025-06-16 04:24:36,286 INFO   path_separation_margin: 0.8
2025-06-16 04:24:36,286 INFO   use_g_bn: 0
2025-06-16 04:24:36,286 INFO   use_in_bn: 0
2025-06-16 04:24:36,287 INFO   use_noise_aware_loss: True
2025-06-16 04:24:36,287 INFO   use_o_bn: 0
2025-06-16 04:24:36,287 INFO   variant_type: hedge
2025-06-16 04:24:36,287 INFO   vmd_cell_type: gru
2025-06-16 04:24:36,288 INFO   vmd_rec: zh
2025-06-16 04:24:36,288 INFO   volatility_adaptation_factor: 0.3
2025-06-16 04:24:36,288 INFO   volatility_reg_weight: 0.05
2025-06-16 04:24:36,288 INFO   weight_init: xavier-uniform
2025-06-16 04:24:36,288 INFO   word_embed_size: 50
2025-06-16 04:24:36,289 INFO   word_embed_type: glove
2025-06-16 04:24:36,289 INFO   y_size: 2
2025-06-16 04:24:36,289 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 04:24:36,292 INFO Start graph assembling...
2025-06-16 04:24:38,056 INFO use_dual_path_srl: True
2025-06-16 04:24:38,058 INFO variant_type: hedge
2025-06-16 04:24:38,058 INFO use_enhanced_srl: True
2025-06-16 04:24:38,058 INFO Enhanced SRL enabled from config
2025-06-16 04:24:38,058 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 04:24:38,059 INFO SRL condition: True = True and True
2025-06-16 04:24:38,059 INFO Using enhanced dual-path SRL architecture
2025-06-16 04:24:38,059 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 04:24:38,103 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 04:24:38,107 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 04:24:38,127 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 04:24:38,349 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 04:24:38,349 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 04:24:38,349 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 04:24:38,618 INFO Using Temporal Attention (TAP)
2025-06-16 04:24:38,662 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 04:24:38,662 INFO Ca-TSU enabled: True
2025-06-16 04:24:38,663 INFO Enhanced SRL enabled: True
2025-06-16 04:24:38,663 INFO Noise-Aware Loss enabled: True
2025-06-16 04:24:38,679 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:24:38,679 INFO Adding auxiliary enhancement losses...
2025-06-16 04:24:38,683 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 04:24:38,695 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5
2025-06-16 04:24:38,696 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 04:24:38,696 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 04:24:38,706 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 04:24:38,706 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:24:38,706 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:24:41,097 INFO Graph assembled successfully.
2025-06-16 04:24:41,363 INFO Verifying model configuration...
2025-06-16 04:24:41,363 INFO Ca-TSU enabled: True
2025-06-16 04:24:41,363 INFO Enhanced SRL enabled: True
2025-06-16 04:24:41,364 INFO Noise-Aware Loss enabled: True
2025-06-16 04:24:41,364 INFO Checking model components for noise-aware loss...
2025-06-16 04:24:41,364 INFO Model has 'use_noise_aware_loss': True
2025-06-16 04:24:41,364 INFO use_noise_aware_loss value: True
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_weight': True
2025-06-16 04:24:41,365 INFO noise_aware_weight value: 0.5
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_loss': False
2025-06-16 04:24:41,365 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 04:24:41,365 INFO Model has 'reliability_weights': True
2025-06-16 04:24:41,366 INFO Model has 'use_enhanced_srl': True
2025-06-16 04:24:41,366 INFO use_enhanced_srl value: True
2025-06-16 04:24:41,366 INFO Model has 'enhanced_srl_loss': False
2025-06-16 04:24:41,366 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 04:24:41,366 INFO Model has 'use_ca_tsu': True
2025-06-16 04:24:41,366 INFO use_ca_tsu value: True
2025-06-16 04:24:41,367 INFO Model has 'causal_consistency_loss': False
2025-06-16 04:24:41,367 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 04:24:41,367 INFO Model has 'loss_components': True
2025-06-16 04:24:41,367 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 04:24:41,367 INFO Manually activating loss components...
2025-06-16 04:24:41,368 INFO Components manually activated:
2025-06-16 04:24:41,368 INFO use_enhanced_srl: True
2025-06-16 04:24:41,368 INFO use_ca_tsu: True
2025-06-16 04:24:41,368 INFO use_noise_aware_loss: True
2025-06-16 04:24:41,368 INFO use_dual_path_srl: True
2025-06-16 04:24:41,369 INFO Running test_noise_aware_loss...
2025-06-16 04:24:59,335 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 04:25:00,611 INFO Word table initialized
2025-06-16 04:25:00,611 INFO Checking loss components in the model graph...
2025-06-16 04:25:00,612 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:25:00,612 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,612 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_contrastive_loss/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,613 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,613 INFO Model: all-hedge-gru_683ac293, starting new session
2025-06-16 04:25:00,613 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 04:25:00,732 INFO Starting training test for 10 batches
2025-06-16 04:25:34,932 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 04:25:34,933 INFO   PERFORMANCE: Loss=1.0826 | Acc=0.3438 | MCC=-0.3181
2025-06-16 04:25:34,933 INFO   LOSS COMPONENTS:
2025-06-16 04:25:34,934 INFO     - Causal Consistency Loss: 0.028141
2025-06-16 04:25:34,934 INFO     - Noise-Aware SRL Loss: 0.051800
2025-06-16 04:25:34,934 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:25:34,935 INFO     Alpha_i sample: 0.3222, Omega_i sample: 0.3128
2025-06-16 04:25:34,935 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:25:34,936 INFO     Volatility: 0.6807, Text Weight: 0.4060, Price Weight: 0.5940
2025-06-16 04:27:07,150 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 04:27:07,151 INFO   PERFORMANCE: Loss=1.1927 | Acc=0.6562 | MCC=0.2901
2025-06-16 04:27:07,151 INFO   LOSS COMPONENTS:
2025-06-16 04:27:07,151 INFO     - Causal Consistency Loss: 0.017319
2025-06-16 04:27:07,152 INFO     - Noise-Aware SRL Loss: 0.004696
2025-06-16 04:27:07,152 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:27:07,152 INFO     Alpha_i sample: 0.0987, Omega_i sample: 0.1133
2025-06-16 04:27:07,152 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:27:07,153 INFO     Volatility: 0.6683, Text Weight: 0.3898, Price Weight: 0.6102
2025-06-16 04:28:27,820 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 04:28:27,820 INFO   PERFORMANCE: Loss=1.4480 | Acc=0.4688 | MCC=-0.0485
2025-06-16 04:28:27,821 INFO   LOSS COMPONENTS:
2025-06-16 04:28:27,821 INFO     - Causal Consistency Loss: 0.015376
2025-06-16 04:28:27,821 INFO     - Noise-Aware SRL Loss: 0.000090
2025-06-16 04:28:27,822 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:28:27,822 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 04:28:27,822 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:28:27,823 INFO     Volatility: 0.6785, Text Weight: 0.4115, Price Weight: 0.5885
2025-06-16 04:28:27,824 INFO Generating diagnostic plots...
2025-06-16 04:28:29,871 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:28:29,872 INFO Saving final checkpoint for test run...
2025-06-16 04:28:30,699 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_683ac293\sess-10
2025-06-16 04:28:30,700 INFO Start dev phase...
2025-06-16 04:30:15,163 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-16 04:30:15,164 INFO 	Eval, eval loss: 1.4004164934158325, acc: 0.509146
2025-06-16 04:30:15,314 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_043015.txt
2025-06-16 04:30:15,315 INFO Test completed successfully!
2025-06-16 05:01:34,823 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:01:34,826 INFO Start graph assembling...
2025-06-16 05:01:36,553 INFO use_dual_path_srl: True
2025-06-16 05:01:36,554 INFO variant_type: hedge
2025-06-16 05:01:36,556 INFO use_enhanced_srl: True
2025-06-16 05:01:36,556 INFO Enhanced SRL enabled from config
2025-06-16 05:01:36,557 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:01:36,557 INFO SRL condition: True = True and True
2025-06-16 05:01:36,558 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:01:36,558 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:01:36,602 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:01:36,607 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:01:36,627 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:01:36,933 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:01:36,935 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:01:36,935 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:01:37,128 INFO Using Temporal Attention (TAP)
2025-06-16 05:01:37,172 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:01:37,173 INFO Ca-TSU enabled: True
2025-06-16 05:01:37,173 INFO Enhanced SRL enabled: True
2025-06-16 05:01:37,174 INFO Noise-Aware Loss enabled: True
2025-06-16 05:01:37,188 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:01:37,189 INFO Adding auxiliary enhancement losses...
2025-06-16 05:01:37,193 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:01:37,204 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.14678259732696614
2025-06-16 05:01:37,206 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:01:37,206 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:01:37,216 INFO Using KL-based Causal Consistency Loss with weight: 0.14149911285154604
2025-06-16 05:01:37,217 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:01:37,218 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:01:39,562 INFO Graph assembled successfully.
2025-06-16 05:01:57,783 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:01:59,079 INFO Word table initialized.
2025-06-16 05:01:59,080 INFO Model: all-hedge-gru_c3d38f61, starting new session.
2025-06-16 05:06:40,440 INFO 	iter: 20, batch loss: 1.2097033262252808, batch acc: 0.020508
2025-06-16 05:07:30,318 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:11:20,660 INFO 	iter: 40, batch loss: 0.9644396901130676, batch acc: 0.013672
2025-06-16 05:13:01,740 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:16:01,430 INFO 	iter: 60, batch loss: 0.8074793219566345, batch acc: 0.020508
2025-06-16 05:18:29,104 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 05:18:29,105 INFO Generating diagnostic plots...
2025-06-16 05:18:31,342 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 05:19:50,699 INFO Completed dev evaluation: size=420.0, acc=0.4548
2025-06-16 05:19:50,701 INFO 	Eval, eval loss: 0.8074036836624146, acc: 0.454762, mcc: -0.032582
2025-06-16 05:19:50,892 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,895 INFO Start graph assembling...
2025-06-16 05:19:50,934 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,937 INFO Start graph assembling...
2025-06-16 05:19:50,966 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,971 INFO Start graph assembling...
2025-06-16 05:19:50,994 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,997 INFO Start graph assembling...
2025-06-16 05:19:51,026 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,029 INFO Start graph assembling...
2025-06-16 05:19:51,054 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,059 INFO Start graph assembling...
2025-06-16 05:19:51,085 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,089 INFO Start graph assembling...
2025-06-16 05:19:51,116 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,120 INFO Start graph assembling...
2025-06-16 05:19:51,150 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,155 INFO Start graph assembling...
2025-06-16 05:19:51,189 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,194 INFO Start graph assembling...
2025-06-16 05:19:51,218 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,222 INFO Start graph assembling...
2025-06-16 05:19:51,245 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,248 INFO Start graph assembling...
2025-06-16 05:19:51,273 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,276 INFO Start graph assembling...
2025-06-16 05:19:51,299 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,302 INFO Start graph assembling...
2025-06-16 05:19:51,328 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,332 INFO Start graph assembling...
2025-06-16 05:19:51,356 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,359 INFO Start graph assembling...
2025-06-16 05:19:51,381 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,384 INFO Start graph assembling...
2025-06-16 05:19:51,405 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,408 INFO Start graph assembling...
2025-06-16 05:19:51,432 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,435 INFO Start graph assembling...
2025-06-16 05:19:51,456 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,459 INFO Start graph assembling...
2025-06-16 05:19:51,479 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,481 INFO Start graph assembling...
2025-06-16 05:19:51,501 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,504 INFO Start graph assembling...
2025-06-16 05:19:51,524 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,527 INFO Start graph assembling...
2025-06-16 05:19:51,545 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,548 INFO Start graph assembling...
2025-06-16 05:19:51,568 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,570 INFO Start graph assembling...
2025-06-16 05:19:51,590 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,593 INFO Start graph assembling...
2025-06-16 05:19:51,772 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,773 INFO Start graph assembling...
2025-06-16 05:19:51,791 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,793 INFO Start graph assembling...
2025-06-16 05:19:51,812 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,814 INFO Start graph assembling...
2025-06-16 05:19:51,833 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,835 INFO Start graph assembling...
2025-06-16 05:19:51,854 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,856 INFO Start graph assembling...
2025-06-16 05:19:51,874 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,876 INFO Start graph assembling...
2025-06-16 05:19:51,894 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,897 INFO Start graph assembling...
2025-06-16 05:19:51,918 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,921 INFO Start graph assembling...
2025-06-16 05:19:51,945 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,948 INFO Start graph assembling...
2025-06-16 05:19:51,969 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,973 INFO Start graph assembling...
2025-06-16 05:19:51,993 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,996 INFO Start graph assembling...
2025-06-16 05:19:52,018 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,020 INFO Start graph assembling...
2025-06-16 05:19:52,040 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,043 INFO Start graph assembling...
2025-06-16 05:19:52,066 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,070 INFO Start graph assembling...
2025-06-16 05:19:52,094 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,097 INFO Start graph assembling...
2025-06-16 05:19:52,122 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,127 INFO Start graph assembling...
2025-06-16 05:19:52,152 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,156 INFO Start graph assembling...
2025-06-16 05:19:52,176 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,179 INFO Start graph assembling...
2025-06-16 05:19:52,200 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,203 INFO Start graph assembling...
2025-06-16 05:19:52,222 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,225 INFO Start graph assembling...
2025-06-16 05:19:52,244 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,246 INFO Start graph assembling...
2025-06-16 05:19:52,266 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,269 INFO Start graph assembling...
2025-06-16 05:19:52,288 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,290 INFO Start graph assembling...
2025-06-16 05:25:36,858 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:25:36,861 INFO Start graph assembling...
2025-06-16 05:25:38,741 INFO use_dual_path_srl: True
2025-06-16 05:25:38,742 INFO variant_type: hedge
2025-06-16 05:25:38,742 INFO use_enhanced_srl: True
2025-06-16 05:25:38,743 INFO Enhanced SRL enabled from config
2025-06-16 05:25:38,744 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:25:38,744 INFO SRL condition: True = True and True
2025-06-16 05:25:38,744 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:25:38,745 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:25:38,790 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:25:38,795 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:25:38,815 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:25:39,131 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:25:39,132 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:25:39,132 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:25:39,343 INFO Using Temporal Attention (TAP)
2025-06-16 05:25:39,387 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:25:39,388 INFO Ca-TSU enabled: True
2025-06-16 05:25:39,389 INFO Enhanced SRL enabled: True
2025-06-16 05:25:39,389 INFO Noise-Aware Loss enabled: True
2025-06-16 05:25:39,404 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:25:39,405 INFO Adding auxiliary enhancement losses...
2025-06-16 05:25:39,409 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:25:39,420 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.15315703994294622
2025-06-16 05:25:39,422 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:25:39,423 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:25:39,433 INFO Using KL-based Causal Consistency Loss with weight: 0.6183063804607332
2025-06-16 05:25:39,434 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:25:39,435 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:25:41,891 INFO Graph assembled successfully.
2025-06-16 05:25:59,978 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:26:01,424 INFO Word table initialized.
2025-06-16 05:26:01,426 INFO Model: all-hedge-gru_6852cc19, starting new session.
2025-06-16 05:30:44,198 INFO 	iter: 20, batch loss: 1.3794220685958862, batch acc: 0.656250
2025-06-16 05:31:34,108 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:35:24,454 INFO 	iter: 40, batch loss: 0.994213879108429, batch acc: 0.593750
2025-06-16 05:37:05,056 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:40:03,707 INFO 	iter: 60, batch loss: 0.7729192972183228, batch acc: 0.656250
2025-06-16 05:42:34,220 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 05:42:34,221 INFO Generating diagnostic plots...
2025-06-16 05:42:36,469 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 05:43:59,223 INFO Completed dev evaluation: size=420.0, acc=0.5310
2025-06-16 05:43:59,224 INFO 	Eval, eval loss: 0.7507549524307251, acc: 0.530952, mcc: 0.022574
2025-06-16 05:43:59,417 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:43:59,419 INFO Start graph assembling...
2025-06-16 05:44:01,657 INFO use_dual_path_srl: True
2025-06-16 05:44:01,658 INFO variant_type: hedge
2025-06-16 05:44:01,658 INFO use_enhanced_srl: True
2025-06-16 05:44:01,659 INFO Enhanced SRL enabled from config
2025-06-16 05:44:01,659 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:44:01,660 INFO SRL condition: True = True and True
2025-06-16 05:44:01,660 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:44:01,660 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:44:01,704 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:44:01,710 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:44:01,732 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:44:02,060 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:44:02,061 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:44:02,062 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:44:02,267 INFO Using Temporal Attention (TAP)
2025-06-16 05:44:02,314 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:44:02,314 INFO Ca-TSU enabled: True
2025-06-16 05:44:02,315 INFO Enhanced SRL enabled: True
2025-06-16 05:44:02,316 INFO Noise-Aware Loss enabled: True
2025-06-16 05:44:02,330 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:44:02,331 INFO Adding auxiliary enhancement losses...
2025-06-16 05:44:02,336 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:44:02,348 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.4038800300098692
2025-06-16 05:44:02,349 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:44:02,350 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:44:02,360 INFO Using KL-based Causal Consistency Loss with weight: 0.4025476029891924
2025-06-16 05:44:02,360 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:44:02,361 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:44:04,844 INFO Graph assembled successfully.
2025-06-16 05:44:23,057 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:44:23,843 INFO Word table initialized.
2025-06-16 05:44:23,844 INFO Model: all-hedge-gru_20194b07, starting new session.
2025-06-16 05:49:08,535 INFO 	iter: 20, batch loss: 1.300557255744934, batch acc: 0.625000
2025-06-16 05:50:00,058 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:53:49,041 INFO 	iter: 40, batch loss: 1.0455877780914307, batch acc: 0.468750
2025-06-16 05:55:28,965 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:58:26,438 INFO 	iter: 60, batch loss: 0.8638330698013306, batch acc: 0.593750
2025-06-16 06:00:57,608 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 06:00:57,609 INFO Generating diagnostic plots...
2025-06-16 06:00:59,816 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 06:02:20,955 INFO Completed dev evaluation: size=420.0, acc=0.4833
2025-06-16 06:02:20,957 INFO 	Eval, eval loss: 0.8231965899467468, acc: 0.483333, mcc: -0.026428
2025-06-16 06:02:21,141 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 06:02:21,143 INFO Start graph assembling...
2025-06-16 06:02:23,291 INFO use_dual_path_srl: True
2025-06-16 06:02:23,292 INFO variant_type: hedge
2025-06-16 06:02:23,292 INFO use_enhanced_srl: True
2025-06-16 06:02:23,293 INFO Enhanced SRL enabled from config
2025-06-16 06:02:23,293 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 06:02:23,293 INFO SRL condition: True = True and True
2025-06-16 06:02:23,294 INFO Using enhanced dual-path SRL architecture
2025-06-16 06:02:23,294 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 06:02:23,340 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 06:02:23,345 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 06:02:23,368 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 06:02:23,696 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 06:02:23,697 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 06:02:23,698 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 06:02:23,901 INFO Using Temporal Attention (TAP)
2025-06-16 06:02:23,947 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 06:02:23,948 INFO Ca-TSU enabled: True
2025-06-16 06:02:23,948 INFO Enhanced SRL enabled: True
2025-06-16 06:02:23,949 INFO Noise-Aware Loss enabled: True
2025-06-16 06:02:23,964 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 06:02:23,964 INFO Adding auxiliary enhancement losses...
2025-06-16 06:02:23,968 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 06:02:23,980 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.18082405748438934
2025-06-16 06:02:23,982 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 06:02:23,983 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 06:02:23,993 INFO Using KL-based Causal Consistency Loss with weight: 0.24237599698962034
2025-06-16 06:02:23,994 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 06:02:23,994 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 06:02:26,506 INFO Graph assembled successfully.
2025-06-16 06:02:44,465 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 06:02:45,222 INFO Word table initialized.
2025-06-16 06:02:45,223 INFO Model: all-hedge-gru_a52b0337, starting new session.
