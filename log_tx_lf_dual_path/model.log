2025-06-10 14:13:44,779 INFO Starting noise-aware loss test...
2025-06-10 14:13:44,779 INFO Configuration check - use_dual_path_srl: True
2025-06-10 14:13:44,780 INFO Configuration check - variant_type: hedge
2025-06-10 14:13:44,780 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-10 14:13:44,782 INFO Start graph assembling...
2025-06-10 14:13:46,549 INFO Creating Dual-Path SRL module...
2025-06-10 14:13:46,679 INFO Dual-Pathway SRL module created.
2025-06-10 14:13:47,085 INFO Using Temporal Attention (TAP)
2025-06-10 14:13:49,372 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:13:49,374 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:14:07,893 INFO ASSEMBLE: word table #replacement: 19482
2025-06-10 14:14:09,158 INFO Word table init: done!
2025-06-10 14:14:09,159 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-10 14:14:09,159 INFO Starting Epoch 1/10...
2025-06-10 14:14:40,235 INFO --- Epoch 1, Batch 1 (Overall batch 1) ---
2025-06-10 14:14:40,235 INFO Total Loss: 0.6912632584571838
2025-06-10 14:14:40,236 INFO Accuracy: 0.6250
2025-06-10 14:14:40,236 INFO MCC: 0.3759
2025-06-10 14:14:40,236 INFO Ca-TSU - Causal Consistency Loss: 0.04498511180281639
2025-06-10 14:14:40,237 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.6449003  0.35509968 0.         0.         0.        ]
2025-06-10 14:14:40,237 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.55744624 0.4425538  0.         0.         0.        ]
2025-06-10 14:14:40,237 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01169321 0.01534439 0.         0.         0.        ]
2025-06-10 14:15:11,097 INFO --- Epoch 1, Batch 2 (Overall batch 2) ---
2025-06-10 14:15:11,097 INFO Total Loss: 1.0464383363723755
2025-06-10 14:15:11,097 INFO Accuracy: 0.4375
2025-06-10 14:15:11,098 INFO MCC: -0.1395
2025-06-10 14:15:11,098 INFO Ca-TSU - Causal Consistency Loss: 0.028707250952720642
2025-06-10 14:15:11,098 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:15:11,099 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:15:11,099 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00263523 0.         0.         0.         0.        ]
2025-06-10 14:15:39,121 INFO --- Epoch 1, Batch 3 (Overall batch 3) ---
2025-06-10 14:15:39,121 INFO Total Loss: 1.2853204011917114
2025-06-10 14:15:39,121 INFO Accuracy: 0.5000
2025-06-10 14:15:39,122 INFO MCC: -0.0628
2025-06-10 14:15:39,122 INFO Ca-TSU - Causal Consistency Loss: 0.03536881133913994
2025-06-10 14:15:39,123 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15546286 0.19893855 0.4395371  0.2060614  0.        ]
2025-06-10 14:15:39,123 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.31503522 0.18859586 0.2929918  0.20337716 0.        ]
2025-06-10 14:15:39,123 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00748545 0.00658077 0.00891795 0.00788024 0.        ]
2025-06-10 14:16:04,354 INFO --- Epoch 1, Batch 4 (Overall batch 4) ---
2025-06-10 14:16:04,354 INFO Total Loss: 1.5416841506958008
2025-06-10 14:16:04,355 INFO Accuracy: 0.5312
2025-06-10 14:16:04,355 INFO MCC: 0.0422
2025-06-10 14:16:04,355 INFO Ca-TSU - Causal Consistency Loss: 0.028559666126966476
2025-06-10 14:16:04,355 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.37672082 0.2636828  0.17186199 0.18773444 0.        ]
2025-06-10 14:16:04,357 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.3343261  0.16278246 0.33880192 0.16408956 0.        ]
2025-06-10 14:16:04,358 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0097892  0.01023125 0.00934129 0.01030768 0.        ]
2025-06-10 14:16:22,292 INFO --- Epoch 1, Batch 5 (Overall batch 5) ---
2025-06-10 14:16:22,292 INFO Total Loss: 1.6710668802261353
2025-06-10 14:16:22,293 INFO Accuracy: 0.5000
2025-06-10 14:16:22,293 INFO MCC: 0.0510
2025-06-10 14:16:22,293 INFO Ca-TSU - Causal Consistency Loss: 0.025421924889087677
2025-06-10 14:16:22,294 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.27264237 0.14777061 0.3467819  0.23280509 0.        ]
2025-06-10 14:16:22,294 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.23028292 0.30409425 0.21412393 0.25149882 0.        ]
2025-06-10 14:16:22,295 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [5.7057297e-09 5.5026264e-09 5.0915347e-09 5.2632667e-09 0.0000000e+00]
2025-06-10 14:16:38,083 INFO --- Epoch 1, Batch 6 (Overall batch 6) ---
2025-06-10 14:16:38,083 INFO Total Loss: 1.8861353397369385
2025-06-10 14:16:38,084 INFO Accuracy: 0.4375
2025-06-10 14:16:38,084 INFO MCC: -0.0976
2025-06-10 14:16:38,084 INFO Ca-TSU - Causal Consistency Loss: 0.023700367659330368
2025-06-10 14:16:38,085 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:16:38,085 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:16:38,085 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00684654 0.         0.         0.         0.        ]
2025-06-10 14:16:57,476 INFO --- Epoch 1, Batch 7 (Overall batch 7) ---
2025-06-10 14:16:57,476 INFO Total Loss: 1.920729160308838
2025-06-10 14:16:57,476 INFO Accuracy: 0.5000
2025-06-10 14:16:57,476 INFO MCC: -0.0159
2025-06-10 14:16:57,478 INFO Ca-TSU - Causal Consistency Loss: 0.01820702664554119
2025-06-10 14:16:57,478 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04138479 0.09374519 0.07650205 0.04063914 0.02940851]
2025-06-10 14:16:57,479 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.05865964 0.06658319 0.07233801 0.05367438 0.06087347]
2025-06-10 14:16:57,479 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01141262 0.02014875 0.01388341 0.00726372 0.00546423]
2025-06-10 14:17:14,790 INFO --- Epoch 1, Batch 8 (Overall batch 8) ---
2025-06-10 14:17:14,791 INFO Total Loss: 1.9291067123413086
2025-06-10 14:17:14,791 INFO Accuracy: 0.5312
2025-06-10 14:17:14,792 INFO MCC: 0.1619
2025-06-10 14:17:14,792 INFO Ca-TSU - Causal Consistency Loss: 0.016138244420289993
2025-06-10 14:17:14,792 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5448925  0.45510754 0.         0.         0.        ]
2025-06-10 14:17:14,793 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.49508578 0.5049142  0.         0.         0.        ]
2025-06-10 14:17:14,793 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00993281 0.0111551  0.         0.         0.        ]
2025-06-10 14:17:32,795 INFO --- Epoch 1, Batch 9 (Overall batch 9) ---
2025-06-10 14:17:32,796 INFO Total Loss: 1.904154896736145
2025-06-10 14:17:32,796 INFO Accuracy: 0.4688
2025-06-10 14:17:32,796 INFO MCC: 0.0086
2025-06-10 14:17:32,796 INFO Ca-TSU - Causal Consistency Loss: 0.016583256423473358
2025-06-10 14:17:32,797 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04128702 0.04088296 0.05719009 0.04497521 0.05436123]
2025-06-10 14:17:32,797 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.04604235 0.05286306 0.04585924 0.04265636 0.05874721]
2025-06-10 14:17:32,797 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0125032  0.01126993 0.01173906 0.01169738 0.01207342]
2025-06-10 14:17:50,796 INFO --- Epoch 1, Batch 10 (Overall batch 10) ---
2025-06-10 14:17:50,797 INFO Total Loss: 1.9829416275024414
2025-06-10 14:17:50,797 INFO Accuracy: 0.5312
2025-06-10 14:17:50,797 INFO MCC: 0.1459
2025-06-10 14:17:50,798 INFO Ca-TSU - Causal Consistency Loss: 0.014230865053832531
2025-06-10 14:17:50,798 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:17:50,798 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:17:50,799 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01344965 0.         0.         0.         0.        ]
2025-06-10 14:18:07,502 INFO --- Epoch 1, Batch 11 (Overall batch 11) ---
2025-06-10 14:18:07,503 INFO Total Loss: 1.9538975954055786
2025-06-10 14:18:07,503 INFO Accuracy: 0.5000
2025-06-10 14:18:07,503 INFO MCC: 0.1491
2025-06-10 14:18:07,503 INFO Ca-TSU - Causal Consistency Loss: 0.01201130636036396
2025-06-10 14:18:07,504 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.2410987  0.23201895 0.16425963 0.15646915 0.12775062]
2025-06-10 14:18:07,504 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.20900942 0.17469798 0.16278839 0.14806424 0.17862998]
2025-06-10 14:18:07,504 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00735499 0.00614406 0.00695054 0.00913037 0.00823336]
2025-06-10 14:18:23,980 INFO --- Epoch 1, Batch 12 (Overall batch 12) ---
2025-06-10 14:18:23,981 INFO Total Loss: 1.940817952156067
2025-06-10 14:18:23,981 INFO Accuracy: 0.4688
2025-06-10 14:18:23,981 INFO MCC: -0.0882
2025-06-10 14:18:23,982 INFO Ca-TSU - Causal Consistency Loss: 0.014133270829916
2025-06-10 14:18:23,982 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.04416995 0.05392295 0.05199429 0.04824588 0.04147683]
2025-06-10 14:18:23,983 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.0446592  0.06314727 0.06222966 0.05061837 0.06206336]
2025-06-10 14:18:23,983 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00623262 0.01004959 0.00538365 0.00668617 0.00929299]
2025-06-10 14:18:40,252 INFO --- Epoch 1, Batch 13 (Overall batch 13) ---
2025-06-10 14:18:40,253 INFO Total Loss: 1.7363024950027466
2025-06-10 14:18:40,253 INFO Accuracy: 0.5938
2025-06-10 14:18:40,253 INFO MCC: 0.1779
2025-06-10 14:18:40,254 INFO Ca-TSU - Causal Consistency Loss: 0.016451749950647354
2025-06-10 14:18:40,254 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.64527315 0.35472688 0.         0.         0.        ]
2025-06-10 14:18:40,254 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.48835686 0.5116431  0.         0.         0.        ]
2025-06-10 14:18:40,255 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00693596 0.00725002 0.         0.         0.        ]
2025-06-10 14:18:57,909 INFO --- Epoch 1, Batch 14 (Overall batch 14) ---
2025-06-10 14:18:57,909 INFO Total Loss: 1.8305370807647705
2025-06-10 14:18:57,909 INFO Accuracy: 0.4375
2025-06-10 14:18:57,911 INFO MCC: -0.1260
2025-06-10 14:18:57,911 INFO Ca-TSU - Causal Consistency Loss: 0.016603318974375725
2025-06-10 14:18:57,911 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:18:57,912 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:18:57,912 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00613976 0.         0.         0.         0.        ]
2025-06-10 14:19:13,141 INFO --- Epoch 1, Batch 15 (Overall batch 15) ---
2025-06-10 14:19:13,141 INFO Total Loss: 1.7783586978912354
2025-06-10 14:19:13,142 INFO Accuracy: 0.5000
2025-06-10 14:19:13,142 INFO MCC: 0.0000
2025-06-10 14:19:13,142 INFO Ca-TSU - Causal Consistency Loss: 0.009403243660926819
2025-06-10 14:19:13,143 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:13,143 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:13,143 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01412474 0.         0.         0.         0.        ]
2025-06-10 14:19:28,480 INFO --- Epoch 1, Batch 16 (Overall batch 16) ---
2025-06-10 14:19:28,480 INFO Total Loss: 1.6955759525299072
2025-06-10 14:19:28,482 INFO Accuracy: 0.4375
2025-06-10 14:19:28,482 INFO MCC: -0.1395
2025-06-10 14:19:28,482 INFO Ca-TSU - Causal Consistency Loss: 0.01037558913230896
2025-06-10 14:19:28,482 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:28,483 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:19:28,483 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [4.782615e-05 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
2025-06-10 14:19:46,203 INFO --- Epoch 1, Batch 17 (Overall batch 17) ---
2025-06-10 14:19:46,204 INFO Total Loss: 1.6293549537658691
2025-06-10 14:19:46,204 INFO Accuracy: 0.5000
2025-06-10 14:19:46,204 INFO MCC: -0.0039
2025-06-10 14:19:46,204 INFO Ca-TSU - Causal Consistency Loss: 0.010351749137043953
2025-06-10 14:19:46,205 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.24851768 0.35949397 0.39198837 0.         0.        ]
2025-06-10 14:19:46,205 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.36277807 0.27283084 0.3643911  0.         0.        ]
2025-06-10 14:19:46,205 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00054518 0.00053618 0.00057082 0.         0.        ]
2025-06-10 14:20:01,870 INFO --- Epoch 1, Batch 18 (Overall batch 18) ---
2025-06-10 14:20:01,871 INFO Total Loss: 1.4807223081588745
2025-06-10 14:20:01,872 INFO Accuracy: 0.5625
2025-06-10 14:20:01,872 INFO MCC: 0.1348
2025-06-10 14:20:01,872 INFO Ca-TSU - Causal Consistency Loss: 0.0102686807513237
2025-06-10 14:20:01,873 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:01,873 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:01,873 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01178216 0.         0.         0.         0.        ]
2025-06-10 14:20:15,955 INFO --- Epoch 1, Batch 19 (Overall batch 19) ---
2025-06-10 14:20:15,955 INFO Total Loss: 1.3848131895065308
2025-06-10 14:20:15,956 INFO Accuracy: 0.5312
2025-06-10 14:20:15,956 INFO MCC: 0.0636
2025-06-10 14:20:15,956 INFO Ca-TSU - Causal Consistency Loss: 0.015332534909248352
2025-06-10 14:20:15,956 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:15,957 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:15,957 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00340907 0.         0.         0.         0.        ]
2025-06-10 14:20:33,401 INFO --- Epoch 1, Batch 20 (Overall batch 20) ---
2025-06-10 14:20:33,401 INFO Total Loss: 1.3456878662109375
2025-06-10 14:20:33,401 INFO Accuracy: 0.5000
2025-06-10 14:20:33,401 INFO MCC: 0.0000
2025-06-10 14:20:33,402 INFO Ca-TSU - Causal Consistency Loss: 0.012012497521936893
2025-06-10 14:20:33,402 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:33,402 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:20:33,403 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0082539 0.        0.        0.        0.       ]
2025-06-10 14:20:36,092 INFO Reached max_batches_to_test (20). Stopping training for test.
2025-06-10 14:20:36,573 INFO Saved training metrics plot to results\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp_training_metrics.png
2025-06-10 14:28:31,730 INFO Starting noise-aware loss test...
2025-06-10 14:28:31,730 INFO Configuration check - use_dual_path_srl: True
2025-06-10 14:28:31,731 INFO Configuration check - variant_type: hedge
2025-06-10 14:28:31,731 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-10 14:28:31,733 INFO Start graph assembling...
2025-06-10 14:28:33,558 INFO Creating Dual-Path SRL module...
2025-06-10 14:28:33,684 INFO Dual-Pathway SRL module created.
2025-06-10 14:28:34,111 INFO Using Temporal Attention (TAP)
2025-06-10 14:28:36,547 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:28:36,548 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-10 14:28:55,322 INFO ASSEMBLE: word table #replacement: 19482
2025-06-10 14:28:56,599 INFO Word table init: done!
2025-06-10 14:28:56,600 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-10 14:28:56,600 INFO Starting Epoch 1/10...
2025-06-10 14:29:33,083 INFO --- Epoch 1, Batch 1 (Overall batch 1) ---
2025-06-10 14:29:33,084 INFO Total Loss: 0.8427320718765259
2025-06-10 14:29:33,084 INFO Accuracy: 0.4688
2025-06-10 14:29:33,085 INFO MCC: -0.0401
2025-06-10 14:29:33,085 INFO Ca-TSU - Causal Consistency Loss: 0.036219898611307144
2025-06-10 14:29:33,086 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.3537426 0.6462574 0.        0.        0.       ]
2025-06-10 14:29:33,086 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.5357624  0.46423754 0.         0.         0.        ]
2025-06-10 14:29:33,086 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00690266 0.00597948 0.         0.         0.        ]
2025-06-10 14:29:33,247 ERROR Failed to save checkpoint at step 1: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-1.data-00000-of-00001.tempstate11299603582367476804 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-1.data-00000-of-00001.tempstate11299603582367476804 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:30:01,651 INFO --- Epoch 1, Batch 2 (Overall batch 2) ---
2025-06-10 14:30:01,652 INFO Total Loss: 1.1517069339752197
2025-06-10 14:30:01,652 INFO Accuracy: 0.3125
2025-06-10 14:30:01,652 INFO MCC: -0.3637
2025-06-10 14:30:01,652 INFO Ca-TSU - Causal Consistency Loss: 0.033610567450523376
2025-06-10 14:30:01,653 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:01,653 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:01,654 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0071842 0.        0.        0.        0.       ]
2025-06-10 14:30:33,692 INFO --- Epoch 1, Batch 3 (Overall batch 3) ---
2025-06-10 14:30:33,693 INFO Total Loss: 1.3257668018341064
2025-06-10 14:30:33,693 INFO Accuracy: 0.4375
2025-06-10 14:30:33,693 INFO MCC: -0.1260
2025-06-10 14:30:33,693 INFO Ca-TSU - Causal Consistency Loss: 0.02857900969684124
2025-06-10 14:30:33,694 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:33,694 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:33,695 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0108463 0.        0.        0.        0.       ]
2025-06-10 14:30:51,998 INFO --- Epoch 1, Batch 4 (Overall batch 4) ---
2025-06-10 14:30:51,999 INFO Total Loss: 1.4439176321029663
2025-06-10 14:30:51,999 INFO Accuracy: 0.5625
2025-06-10 14:30:52,000 INFO MCC: 0.1869
2025-06-10 14:30:52,000 INFO Ca-TSU - Causal Consistency Loss: 0.01361310575157404
2025-06-10 14:30:52,000 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:52,001 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:30:52,001 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.01437455 0.         0.         0.         0.        ]
2025-06-10 14:31:08,251 INFO --- Epoch 1, Batch 5 (Overall batch 5) ---
2025-06-10 14:31:08,252 INFO Total Loss: 1.590864658355713
2025-06-10 14:31:08,252 INFO Accuracy: 0.5938
2025-06-10 14:31:08,252 INFO MCC: 0.1879
2025-06-10 14:31:08,253 INFO Ca-TSU - Causal Consistency Loss: 0.021592147648334503
2025-06-10 14:31:08,253 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:08,253 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:08,254 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.0124786 0.        0.        0.        0.       ]
2025-06-10 14:31:27,017 INFO --- Epoch 1, Batch 6 (Overall batch 6) ---
2025-06-10 14:31:27,018 INFO Total Loss: 1.8875336647033691
2025-06-10 14:31:27,018 INFO Accuracy: 0.4375
2025-06-10 14:31:27,019 INFO MCC: -0.0931
2025-06-10 14:31:27,019 INFO Ca-TSU - Causal Consistency Loss: 0.02220180071890354
2025-06-10 14:31:27,021 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.10557188 0.14514366 0.15680319 0.17895603 0.19979197]
2025-06-10 14:31:27,022 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.1831847  0.15235725 0.15619075 0.18146072 0.15409678]
2025-06-10 14:31:27,022 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00194862 0.00137531 0.0018897  0.00419468 0.00297176]
2025-06-10 14:31:27,058 ERROR Failed to save checkpoint at step 6: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-6.data-00000-of-00001.tempstate2327753616084797176 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-6.data-00000-of-00001.tempstate2327753616084797176 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:31:42,877 INFO --- Epoch 1, Batch 7 (Overall batch 7) ---
2025-06-10 14:31:42,878 INFO Total Loss: 1.9436997175216675
2025-06-10 14:31:42,878 INFO Accuracy: 0.3125
2025-06-10 14:31:42,878 INFO MCC: -0.3945
2025-06-10 14:31:42,878 INFO Ca-TSU - Causal Consistency Loss: 0.01890394277870655
2025-06-10 14:31:42,878 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.09475238 0.09518866 0.17558682 0.11018278 0.13540033]
2025-06-10 14:31:42,880 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.14125422 0.10523706 0.13944611 0.13651392 0.10535693]
2025-06-10 14:31:42,880 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00758685 0.00936174 0.00868807 0.0097725  0.00851275]
2025-06-10 14:31:57,859 INFO --- Epoch 1, Batch 8 (Overall batch 8) ---
2025-06-10 14:31:57,860 INFO Total Loss: 1.932431697845459
2025-06-10 14:31:57,860 INFO Accuracy: 0.5625
2025-06-10 14:31:57,861 INFO MCC: 0.1112
2025-06-10 14:31:57,861 INFO Ca-TSU - Causal Consistency Loss: 0.020756317302584648
2025-06-10 14:31:57,861 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:57,862 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:31:57,862 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [9.993352e-07 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00]
2025-06-10 14:32:13,427 INFO --- Epoch 1, Batch 9 (Overall batch 9) ---
2025-06-10 14:32:13,427 INFO Total Loss: 1.8604029417037964
2025-06-10 14:32:13,428 INFO Accuracy: 0.6875
2025-06-10 14:32:13,428 INFO MCC: 0.3780
2025-06-10 14:32:13,428 INFO Ca-TSU - Causal Consistency Loss: 0.016269303858280182
2025-06-10 14:32:13,429 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.4902626  0.50973743 0.         0.         0.        ]
2025-06-10 14:32:13,429 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.52795994 0.47204006 0.         0.         0.        ]
2025-06-10 14:32:13,429 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [8.7390088e-11 1.5307074e-10 0.0000000e+00 0.0000000e+00 0.0000000e+00]
2025-06-10 14:32:31,688 INFO --- Epoch 1, Batch 10 (Overall batch 10) ---
2025-06-10 14:32:31,689 INFO Total Loss: 1.8636600971221924
2025-06-10 14:32:31,689 INFO Accuracy: 0.6250
2025-06-10 14:32:31,689 INFO MCC: 0.2582
2025-06-10 14:32:31,690 INFO Ca-TSU - Causal Consistency Loss: 0.01746019907295704
2025-06-10 14:32:31,690 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:32:31,690 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:32:31,691 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00344196 0.         0.         0.         0.        ]
2025-06-10 14:32:45,555 INFO --- Epoch 1, Batch 11 (Overall batch 11) ---
2025-06-10 14:32:45,556 INFO Total Loss: 1.880403757095337
2025-06-10 14:32:45,556 INFO Accuracy: 0.5938
2025-06-10 14:32:45,556 INFO MCC: 0.1479
2025-06-10 14:32:45,557 INFO Ca-TSU - Causal Consistency Loss: 0.01897585019469261
2025-06-10 14:32:45,557 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15054497 0.17803632 0.3400595  0.1903544  0.14100482]
2025-06-10 14:32:45,558 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.18822972 0.17102672 0.24173748 0.20728675 0.19171937]
2025-06-10 14:32:45,558 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00126056 0.00195729 0.01647661 0.00132098 0.00079475]
2025-06-10 14:32:45,581 ERROR Failed to save checkpoint at step 11: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-11.data-00000-of-00001.tempstate16834503337397851289 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-11.data-00000-of-00001.tempstate16834503337397851289 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:33:00,191 INFO --- Epoch 1, Batch 12 (Overall batch 12) ---
2025-06-10 14:33:00,192 INFO Total Loss: 1.832196831703186
2025-06-10 14:33:00,192 INFO Accuracy: 0.6250
2025-06-10 14:33:00,192 INFO MCC: 0.2582
2025-06-10 14:33:00,192 INFO Ca-TSU - Causal Consistency Loss: 0.013793786987662315
2025-06-10 14:33:00,193 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.38965675 0.6103433  0.         0.         0.        ]
2025-06-10 14:33:00,193 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.4101287 0.5898713 0.        0.        0.       ]
2025-06-10 14:33:00,194 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00751075 0.00572139 0.         0.         0.        ]
2025-06-10 14:33:15,834 INFO --- Epoch 1, Batch 13 (Overall batch 13) ---
2025-06-10 14:33:15,835 INFO Total Loss: 1.8053133487701416
2025-06-10 14:33:15,835 INFO Accuracy: 0.5312
2025-06-10 14:33:15,835 INFO MCC: 0.0710
2025-06-10 14:33:15,836 INFO Ca-TSU - Causal Consistency Loss: 0.011693351902067661
2025-06-10 14:33:15,836 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.15058275 0.1532625  0.14927688 0.37802517 0.1688527 ]
2025-06-10 14:33:15,836 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.20051017 0.18505283 0.16825156 0.2969915  0.14919388]
2025-06-10 14:33:15,837 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.05884494 0.03266201 0.00388337 0.36279082 0.00289302]
2025-06-10 14:33:32,379 INFO --- Epoch 1, Batch 14 (Overall batch 14) ---
2025-06-10 14:33:32,380 INFO Total Loss: 1.7795695066452026
2025-06-10 14:33:32,380 INFO Accuracy: 0.4375
2025-06-10 14:33:32,381 INFO MCC: -0.0712
2025-06-10 14:33:32,381 INFO Ca-TSU - Causal Consistency Loss: 0.009554932825267315
2025-06-10 14:33:32,381 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.32679352 0.3467344  0.32647204 0.         0.        ]
2025-06-10 14:33:32,382 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.3615828  0.31316608 0.32525113 0.         0.        ]
2025-06-10 14:33:32,382 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [3.9781452e-07 3.7304127e-07 3.6401735e-07 0.0000000e+00 0.0000000e+00]
2025-06-10 14:33:46,585 INFO --- Epoch 1, Batch 15 (Overall batch 15) ---
2025-06-10 14:33:46,585 INFO Total Loss: 1.7312123775482178
2025-06-10 14:33:46,585 INFO Accuracy: 0.5000
2025-06-10 14:33:46,586 INFO MCC: 0.0039
2025-06-10 14:33:46,586 INFO Ca-TSU - Causal Consistency Loss: 0.012392021715641022
2025-06-10 14:33:46,586 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5877599 0.4122401 0.        0.        0.       ]
2025-06-10 14:33:46,586 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.57553285 0.4244671  0.         0.         0.        ]
2025-06-10 14:33:46,587 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00699067 0.00821034 0.         0.         0.        ]
2025-06-10 14:34:00,483 INFO --- Epoch 1, Batch 16 (Overall batch 16) ---
2025-06-10 14:34:00,484 INFO Total Loss: 1.5935499668121338
2025-06-10 14:34:00,484 INFO Accuracy: 0.5938
2025-06-10 14:34:00,484 INFO MCC: 0.1683
2025-06-10 14:34:00,485 INFO Ca-TSU - Causal Consistency Loss: 0.012732548639178276
2025-06-10 14:34:00,485 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:00,486 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:00,486 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00371759 0.         0.         0.         0.        ]
2025-06-10 14:34:00,520 ERROR Failed to save checkpoint at step 16: Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-16.data-00000-of-00001.tempstate12571900181829409298 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 30, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 20, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 45, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-16.data-00000-of-00001.tempstate12571900181829409298 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_1995, MSIN_RNN/market_projection/kernel/_1997, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_1999, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2001, MSIN_RNN/text_price_cross_attention/dense/bias/_2003, MSIN_RNN/text_price_cross_attention/dense/kernel/_2005, MSIN_RNN/text_self_attention/LayerNorm/beta/_2007, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2009, MSIN_RNN/text_self_attention/dense/bias/_2011, MSIN_RNN/text_self_attention/dense/kernel/_2013, W_f/_2015, W_ha/_2017, W_hf/_2019, W_hk/_2021, W_ho/_2023, W_hs/_2025, W_ht/_2027, W_hv/_2029, W_k/_2031, W_o/_2033, W_s/_2035, W_sa/_2037, W_t/_2039, W_v/_2041, W_vk/_2043, ca_tsu/W_K/_2045, ca_tsu/W_K/Adam/_2047, ca_tsu/W_K/Adam_1/_2049, ca_tsu/W_Q/_2051, ca_tsu/W_Q/Adam/_2053, ca_tsu/W_Q/Adam_1/_2055, ca_tsu/b_causal/_2057, ca_tsu/b_causal/Adam/_2059, ca_tsu/b_causal/Adam_1/_2061, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/_2063, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam/_2065, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/bias/Adam_1/_2067, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/_2069, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam/_2071, dual_path_srl/daily_srl_processing/pd_pathway/h_PD_t_dense/kernel/Adam_1/_2073, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/_2075, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam/_2077, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/bias/Adam_1/_2079, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/_2081, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam/_2083, dual_path_srl/daily_srl_processing/pd_pathway/pd_price_query_projection/kernel/Adam_1/_2085, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/_2087, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam/_2089, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/bias/Adam_1/_2091, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/_2093, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam/_2095, dual_path_srl/daily_srl_processing/td_pathway/h_TD_t_dense/kernel/Adam_1/_2097, dual_path_srl/fusion_module/fusion_gate_sigma/bias/_2099, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam/_2101, dual_path_srl/fusion_module/fusion_gate_sigma/bias/Adam_1/_2103, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/_2105, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam/_2107, dual_path_srl/fusion_module/fusion_gate_sigma/kernel/Adam_1/_2109, embeds/word_table/_2111, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2113, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2115, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2117, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2119, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2121, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2123, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2125, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2127, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2129, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2131, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2133, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2135, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2137, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2139, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2141, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2143, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2145, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2147, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2149, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2151, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2153, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2155, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2157, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2159, mie/Variable/_2161, mie/Variable_1/_2163, mie/Variable_2/_2165, mie/Variable_3/_2167, mie/Variable_4/_2169, mie/Variable_5/_2171, mie/Variable_6/_2173, mie/Variable_7/_2175, optimizer/beta1_power/_2177, optimizer/beta2_power/_2179, tda/pred_from_gT_att_logits/bias/_2181, tda/pred_from_gT_att_logits/bias/Adam/_2183, tda/pred_from_gT_att_logits/bias/Adam_1/_2185, tda/pred_from_gT_att_logits/kernel/_2187, tda/pred_from_gT_att_logits/kernel/Adam/_2189, tda/pred_from_gT_att_logits/kernel/Adam_1/_2191, tda/v_i/g_projection_att/kernel/_2193, tda/v_i/g_projection_att/kernel/Adam/_2195, tda/v_i/g_projection_att/kernel/Adam_1/_2197, tda/v_i/w_i_temporal_att/_2199, tda/v_i/w_i_temporal_att/Adam/_2201, tda/v_i/w_i_temporal_att/Adam_1/_2203, text_price_cross_attention/dense/_2205, text_price_cross_attention/wk/_2207, text_price_cross_attention/wq/_2209, text_price_cross_attention/wv/_2211, text_self_attention/dense/_2213, text_self_attention/wk/_2215, text_self_attention/wq/_2217, text_self_attention/wv/_2219, u_t/linear_layer/W/_2221, u_t/linear_layer/W/Adam/_2223, u_t/linear_layer/W/Adam_1/_2225, u_t/w_u_original/_2227, u_t/w_u_original/Adam/_2229, u_t/w_u_original/Adam_1/_2231, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2233, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2235, vmd_zh_rec_iter/gru_cell/candidate/bias/_2237, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2239, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2241, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2243, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2245, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2247, vmd_zh_rec_iter/gru_cell/gates/bias/_2249, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2251, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2253, vmd_zh_rec_iter/gru_cell/gates/kernel/_2255, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2257, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2259, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2261, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2263, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2265, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2267, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2269, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2271, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2273, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2275, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2277, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2279, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2281, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2283, vmd_zh_rec_iter/z_posterior/z_mu/W/_2285, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2287, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2289, vmd_zh_rec_iter/z_posterior/z_mu/b/_2291, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2293, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2295, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2297, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2299, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2301, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2303, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2305, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2307, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2309, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2311, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2313, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2315, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2317, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2319, vmd_zh_rec_iter/z_prior/z_mu/W/_2321, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2323, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2325, vmd_zh_rec_iter/z_prior/z_mu/b/_2327, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2329, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2331)]]

2025-06-10 14:34:16,123 INFO --- Epoch 1, Batch 17 (Overall batch 17) ---
2025-06-10 14:34:16,125 INFO Total Loss: 1.5651130676269531
2025-06-10 14:34:16,126 INFO Accuracy: 0.5000
2025-06-10 14:34:16,126 INFO MCC: -0.0120
2025-06-10 14:34:16,126 INFO Ca-TSU - Causal Consistency Loss: 0.012104494497179985
2025-06-10 14:34:16,127 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:16,127 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [1. 0. 0. 0. 0.]
2025-06-10 14:34:16,128 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00787563 0.         0.         0.         0.        ]
2025-06-10 14:34:32,726 INFO --- Epoch 1, Batch 18 (Overall batch 18) ---
2025-06-10 14:34:32,727 INFO Total Loss: 1.4784307479858398
2025-06-10 14:34:32,727 INFO Accuracy: 0.5312
2025-06-10 14:34:32,727 INFO MCC: 0.1078
2025-06-10 14:34:32,727 INFO Ca-TSU - Causal Consistency Loss: 0.012060520239174366
2025-06-10 14:34:32,728 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.20480542 0.29533973 0.19460708 0.3052478  0.        ]
2025-06-10 14:34:32,728 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.21395637 0.25814566 0.24928778 0.2786102  0.        ]
2025-06-10 14:34:32,728 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [1.3279214e-09 1.2969722e-09 1.2777368e-09 1.3407484e-09 0.0000000e+00]
2025-06-10 14:34:47,840 INFO --- Epoch 1, Batch 19 (Overall batch 19) ---
2025-06-10 14:34:47,841 INFO Total Loss: 1.4162315130233765
2025-06-10 14:34:47,841 INFO Accuracy: 0.5000
2025-06-10 14:34:47,841 INFO MCC: 0.0000
2025-06-10 14:34:47,842 INFO Ca-TSU - Causal Consistency Loss: 0.00846626702696085
2025-06-10 14:34:47,842 INFO Ca-TSU - Alpha_i (sample 0, day 0, first 5 msgs): [0.5775047  0.42249534 0.         0.         0.        ]
2025-06-10 14:34:47,843 INFO Ca-TSU - Omega_i (sample 0, day 0, first 5 msgs): [0.49347252 0.5065275  0.         0.         0.        ]
2025-06-10 14:34:47,843 INFO Attention Weights (Dual-Path SRL PD Beta Attention): Shape (32, 5, 20), Snippet: First item, first slice, first 5 elements: [0.00539553 0.00667245 0.         0.         0.        ]
2025-06-11 16:41:54,251 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 16:41:54,251 INFO Configuration - use_dual_path_srl: True
2025-06-11 16:41:54,252 INFO Configuration - use_enhanced_srl: True
2025-06-11 16:41:54,252 INFO Configuration - use_noise_aware_loss: True
2025-06-11 16:41:54,252 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 16:41:54,253 INFO Configuration - variant_type: hedge
2025-06-11 16:41:54,253 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 16:41:54,259 INFO Start graph assembling...
2025-06-11 16:41:55,981 INFO Using enhanced dual-path SRL architecture
2025-06-11 16:41:55,981 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 16:41:56,382 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 16:41:56,726 INFO Using Temporal Attention (TAP)
2025-06-11 16:52:43,423 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 16:52:43,423 INFO Configuration - use_dual_path_srl: True
2025-06-11 16:52:43,423 INFO Configuration - use_enhanced_srl: True
2025-06-11 16:52:43,424 INFO Configuration - use_ca_tsu: True
2025-06-11 16:52:43,424 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 16:52:43,424 INFO Configuration - use_noise_aware_loss: True
2025-06-11 16:52:43,424 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 16:52:43,425 INFO Configuration - variant_type: hedge
2025-06-11 16:52:43,425 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 16:52:43,427 INFO Start graph assembling...
2025-06-11 16:52:45,226 INFO Using enhanced dual-path SRL architecture
2025-06-11 16:52:45,226 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 16:52:45,635 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 16:52:45,972 INFO Using Temporal Attention (TAP)
2025-06-11 16:52:46,024 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 16:52:46,057 INFO Creating enhanced SRL loss...
2025-06-11 16:52:46,057 WARNING h_t_dual_path not found, using x as text representation
2025-06-11 16:52:46,116 INFO Added enhanced SRL loss
2025-06-11 16:52:48,737 INFO Graph assembled successfully.
2025-06-11 16:52:48,738 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 16:52:48,738 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 16:53:07,073 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 16:53:08,964 INFO Word table initialized
2025-06-11 16:53:08,965 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 16:53:08,965 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 16:53:08,965 INFO Setting default noise_aware_weight to 0.5
2025-06-11 16:53:08,965 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 16:53:08,965 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 16:53:08,966 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 16:53:08,966 INFO Evaluation will be performed every 10 steps
2025-06-11 16:53:09,064 INFO Starting training test for 50 batches
2025-06-11 16:53:27,141 ERROR Error during testing: Fetch argument None has invalid type <class 'NoneType'>
2025-06-11 16:53:27,144 ERROR Traceback (most recent call last):
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 655, in test_noise_aware_loss
    results = sess.run(ops_to_run, feed_dict=feed_dict)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 889, in run
    run_metadata_ptr)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1105, in _run
    self._graph, fetches, feed_dict_tensor, feed_handles=feed_handles)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 414, in __init__
    self._fetch_mapper = _FetchMapper.for_fetch(fetches)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 234, in for_fetch
    return _ListFetchMapper(fetch)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 341, in __init__
    self._mappers = [_FetchMapper.for_fetch(fetch) for fetch in fetches]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 341, in <listcomp>
    self._mappers = [_FetchMapper.for_fetch(fetch) for fetch in fetches]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 231, in for_fetch
    (fetch, type(fetch)))
TypeError: Fetch argument None has invalid type <class 'NoneType'>

2025-06-11 16:53:27,144 INFO Completed test on 1 batches
2025-06-11 16:53:27,214 INFO Test completed successfully!
2025-06-11 17:00:11,305 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 17:00:11,305 INFO Configuration - use_dual_path_srl: True
2025-06-11 17:00:11,306 INFO Configuration - use_enhanced_srl: True
2025-06-11 17:00:11,306 INFO Configuration - use_ca_tsu: True
2025-06-11 17:00:11,306 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 17:00:11,306 INFO Configuration - use_noise_aware_loss: True
2025-06-11 17:00:11,306 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 17:00:11,306 INFO Configuration - variant_type: hedge
2025-06-11 17:00:11,307 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 17:00:11,309 INFO Start graph assembling...
2025-06-11 17:00:13,053 INFO Using enhanced dual-path SRL architecture
2025-06-11 17:00:13,053 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 17:00:13,465 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 17:00:13,801 INFO Using Temporal Attention (TAP)
2025-06-11 17:00:13,845 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 17:00:13,878 INFO Creating enhanced SRL loss...
2025-06-11 17:00:13,878 WARNING h_t_dual_path not found, using x as text representation
2025-06-11 17:00:13,937 INFO Added enhanced SRL loss
2025-06-11 17:00:16,557 INFO Graph assembled successfully.
2025-06-11 17:00:16,558 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 17:00:16,559 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 17:00:34,805 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 17:00:36,188 INFO Word table initialized
2025-06-11 17:00:36,188 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 17:00:36,189 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 17:00:36,189 INFO Setting default noise_aware_weight to 0.5
2025-06-11 17:00:36,189 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 17:00:36,189 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 17:00:36,189 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 17:00:36,189 INFO Evaluation will be performed every 10 steps
2025-06-11 17:00:36,304 INFO Starting training test for 50 batches
2025-06-11 17:01:11,537 INFO Batch 1/50 (Step 1):
2025-06-11 17:01:11,538 INFO   Total Loss: 0.7275
2025-06-11 17:01:11,538 INFO   Accuracy: 0.4688
2025-06-11 17:01:11,538 INFO   MCC: -0.0626
2025-06-11 17:01:11,538 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:01:11,540 INFO   MSIN Cross-Attention sample: [0.05629849 0.05552643 0.04454555 0.04444347 0.04463113]
2025-06-11 17:02:59,215 INFO Batch 5/50 (Step 5):
2025-06-11 17:02:59,215 INFO   Total Loss: 1.7372
2025-06-11 17:02:59,216 INFO   Accuracy: 0.5312
2025-06-11 17:02:59,216 INFO   MCC: 0.0401
2025-06-11 17:02:59,216 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:02:59,217 INFO   MSIN Cross-Attention sample: [0.03328626 0.04436834 0.05564114 0.05531683 0.04462983]
2025-06-11 17:04:26,926 INFO Batch 10/50 (Step 10):
2025-06-11 17:04:26,927 INFO   Total Loss: 1.9956
2025-06-11 17:04:26,927 INFO   Accuracy: 0.5625
2025-06-11 17:04:26,927 INFO   MCC: 0.0976
2025-06-11 17:04:26,927 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:04:26,928 INFO   MSIN Cross-Attention sample: [0.05532703 0.04454517 0.05571126 0.05555197 0.04439992]
2025-06-11 17:04:26,928 INFO Evaluating on dev set at batch 10/50...
2025-06-11 17:06:17,587 INFO Dev evaluation results:
2025-06-11 17:06:17,587 INFO 	Eval, eval loss: 2.232137441635132, acc: 0.469512
2025-06-11 17:07:38,756 INFO Batch 15/50 (Step 15):
2025-06-11 17:07:38,757 INFO   Total Loss: 1.7618
2025-06-11 17:07:38,757 INFO   Accuracy: 0.3750
2025-06-11 17:07:38,758 INFO   MCC: -0.2381
2025-06-11 17:07:38,758 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:07:38,758 INFO   MSIN Cross-Attention sample: [0.05587037 0.05587744 0.04440376 0.05539591 0.05571232]
2025-06-11 17:09:00,089 INFO Batch 20/50 (Step 20):
2025-06-11 17:09:00,090 INFO   Total Loss: 1.4490
2025-06-11 17:09:00,090 INFO   Accuracy: 0.5625
2025-06-11 17:09:00,091 INFO   MCC: 0.1260
2025-06-11 17:09:00,091 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:09:00,092 INFO   MSIN Cross-Attention sample: [0.04274248 0.05436801 0.05544857 0.05658913 0.05558465]
2025-06-11 17:09:00,092 INFO Evaluating on dev set at batch 20/50...
2025-06-11 17:10:44,176 INFO Dev evaluation results:
2025-06-11 17:10:44,177 INFO 	Eval, eval loss: 1.5737576484680176, acc: 0.513720
2025-06-11 17:12:04,477 INFO Batch 25/50 (Step 25):
2025-06-11 17:12:04,477 INFO   Total Loss: 1.1947
2025-06-11 17:12:04,478 INFO   Accuracy: 0.5625
2025-06-11 17:12:04,478 INFO   MCC: 0.1291
2025-06-11 17:12:04,478 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:12:04,478 INFO   MSIN Cross-Attention sample: [0.04452675 0.04428817 0.04446664 0.05561009 0.05553747]
2025-06-11 17:13:22,094 INFO Batch 30/50 (Step 30):
2025-06-11 17:13:22,094 INFO   Total Loss: 0.9324
2025-06-11 17:13:22,094 INFO   Accuracy: 0.5625
2025-06-11 17:13:22,095 INFO   MCC: 0.3021
2025-06-11 17:13:22,095 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:13:22,095 INFO   MSIN Cross-Attention sample: [0.04366367 0.04424892 0.04386728 0.0476025  0.05713603]
2025-06-11 17:13:22,096 INFO Evaluating on dev set at batch 30/50...
2025-06-11 17:15:13,876 INFO Dev evaluation results:
2025-06-11 17:15:13,876 INFO 	Eval, eval loss: 1.2468117475509644, acc: 0.483232
2025-06-11 17:16:27,219 INFO Batch 35/50 (Step 35):
2025-06-11 17:16:27,220 INFO   Total Loss: 2.7134
2025-06-11 17:16:27,220 INFO   Accuracy: 0.4375
2025-06-11 17:16:27,220 INFO   MCC: 0.0413
2025-06-11 17:16:27,220 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:16:27,221 INFO   MSIN Cross-Attention sample: [0.05532048 0.05547402 0.05547402 0.05547402 0.05547402]
2025-06-11 17:17:44,016 INFO Batch 40/50 (Step 40):
2025-06-11 17:17:44,017 INFO   Total Loss: 0.8641
2025-06-11 17:17:44,017 INFO   Accuracy: 0.3750
2025-06-11 17:17:44,017 INFO   MCC: -0.2431
2025-06-11 17:17:44,018 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:17:44,018 INFO   MSIN Cross-Attention sample: [0.05601314 0.03333925 0.04479375 0.03383328 0.04452918]
2025-06-11 17:17:44,018 INFO Evaluating on dev set at batch 40/50...
2025-06-11 17:19:33,713 INFO Dev evaluation results:
2025-06-11 17:19:33,714 INFO 	Eval, eval loss: 1.0767498016357422, acc: 0.541159
2025-06-11 17:20:47,460 INFO Batch 45/50 (Step 45):
2025-06-11 17:20:47,460 INFO   Total Loss: 1.2128
2025-06-11 17:20:47,461 INFO   Accuracy: 0.5625
2025-06-11 17:20:47,461 INFO   MCC: 0.0976
2025-06-11 17:20:47,461 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:20:47,462 INFO   MSIN Cross-Attention sample: [0.05177472 0.01906194 0.0914574  0.103177   0.05437533]
2025-06-11 17:22:03,089 INFO Batch 50/50 (Step 50):
2025-06-11 17:22:03,090 INFO   Total Loss: 0.8023
2025-06-11 17:22:03,090 INFO   Accuracy: 0.4375
2025-06-11 17:22:03,090 INFO   MCC: -0.1348
2025-06-11 17:22:03,090 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 17:22:03,091 INFO   MSIN Cross-Attention sample: [0.03354196 0.04419372 0.05555586 0.04450319 0.05525457]
2025-06-11 17:22:03,091 INFO Evaluating on dev set at batch 50/50...
2025-06-11 17:23:53,197 INFO Dev evaluation results:
2025-06-11 17:23:53,197 INFO 	Eval, eval loss: 1.0000360012054443, acc: 0.524390
2025-06-11 17:23:53,197 INFO Final evaluation on dev set:
2025-06-11 17:25:43,750 INFO 	Eval, eval loss: 0.9873076677322388, acc: 0.548780
2025-06-11 17:25:43,750 ERROR Failed to save checkpoint: 'latest_filename' collides with 'save_path': 'checkpoint' and './checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\checkpoint'
2025-06-11 17:25:44,616 INFO Training metrics plots saved to results/model_test
2025-06-11 17:25:44,617 INFO Evaluating on test set:
2025-06-11 17:28:21,714 INFO 	Eval, eval loss: 1.0687851905822754, acc: 0.504960
2025-06-11 17:28:21,726 INFO Test summary saved to results/model_test\test_summary_20250611_172821.json
2025-06-11 17:28:21,726 INFO Completed test on 50 batches
2025-06-11 17:28:27,514 INFO Test completed successfully!
2025-06-11 18:09:45,200 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:09:45,200 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:09:45,200 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:09:45,201 INFO Configuration - use_ca_tsu: True
2025-06-11 18:09:45,201 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:09:45,201 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:09:45,202 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:09:45,202 INFO Configuration - variant_type: hedge
2025-06-11 18:09:45,203 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:09:45,205 INFO Start graph assembling...
2025-06-11 18:09:45,520 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:09:46,901 INFO use_dual_path_srl: True
2025-06-11 18:09:46,901 INFO variant_type: hedge
2025-06-11 18:09:46,901 INFO use_enhanced_srl: True
2025-06-11 18:09:46,902 INFO Enhanced SRL enabled from config
2025-06-11 18:09:46,902 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:09:46,902 INFO SRL condition: True = True and True
2025-06-11 18:09:46,902 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:09:46,902 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:09:47,294 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:09:47,294 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:09:47,295 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:09:47,622 INFO Using Temporal Attention (TAP)
2025-06-11 18:09:47,666 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:09:47,699 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:09:47,700 INFO Creating enhanced SRL loss...
2025-06-11 18:09:47,700 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:09:47,755 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:09:47,757 INFO Base prediction loss created: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:09:47,758 INFO Final enhanced SRL loss created with weight 0.1: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:09:47,759 INFO Added enhanced SRL loss to generative ATA
2025-06-11 18:09:50,231 INFO Graph assembled successfully.
2025-06-11 18:09:50,232 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:09:50,233 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:10:08,589 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:10:10,177 INFO Word table initialized
2025-06-11 18:10:10,178 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:10:10,178 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:10:10,178 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:10:10,179 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:10:10,179 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:10:10,179 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:10:10,179 INFO Evaluation will be performed every 10 steps
2025-06-11 18:10:10,270 INFO Starting training test for 50 batches
2025-06-11 18:13:28,283 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:13:28,284 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:13:28,284 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:13:28,284 INFO Configuration - use_ca_tsu: True
2025-06-11 18:13:28,284 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:13:28,284 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:13:28,285 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:13:28,285 INFO Configuration - variant_type: hedge
2025-06-11 18:13:28,286 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:13:28,288 INFO Start graph assembling...
2025-06-11 18:13:28,603 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:13:30,117 INFO use_dual_path_srl: True
2025-06-11 18:13:30,117 INFO variant_type: hedge
2025-06-11 18:13:30,117 INFO use_enhanced_srl: True
2025-06-11 18:13:30,118 INFO Enhanced SRL enabled from config
2025-06-11 18:13:30,118 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:13:30,118 INFO SRL condition: True = True and True
2025-06-11 18:13:30,118 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:13:30,119 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:13:30,510 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:13:30,511 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:13:30,511 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:13:30,848 INFO Using Temporal Attention (TAP)
2025-06-11 18:13:30,891 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:13:30,924 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:13:30,925 INFO Creating enhanced SRL loss...
2025-06-11 18:13:30,926 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:13:30,982 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:13:30,984 INFO Base prediction loss created: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:13:30,985 INFO Final enhanced SRL loss created with weight 0.1: generative_ata_loss/enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:13:30,987 INFO Added enhanced SRL loss to generative ATA
2025-06-11 18:13:33,589 INFO Graph assembled successfully.
2025-06-11 18:13:33,590 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:13:33,591 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:13:52,257 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:13:53,679 INFO Word table initialized
2025-06-11 18:13:53,680 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:13:53,680 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:13:53,680 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:13:53,680 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:13:53,681 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:13:53,681 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:13:53,681 INFO Evaluation will be performed every 10 steps
2025-06-11 18:13:53,783 INFO Starting training test for 50 batches
2025-06-11 18:14:04,168 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:14:19,000 INFO Batch 1/50 (Step 1):
2025-06-11 18:14:19,000 INFO   Total Loss: 1.3315
2025-06-11 18:14:19,001 INFO   Accuracy: 0.4375
2025-06-11 18:14:19,001 INFO   MCC: -0.1395
2025-06-11 18:14:19,001 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 18:14:19,001 INFO   MSIN Cross-Attention sample: [0.04442088 0.05547361 0.04451589 0.05576415 0.0444136 ]
2025-06-11 18:14:34,068 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:08,846 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:32,415 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:15:53,436 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:08,428 INFO Batch 5/50 (Step 5):
2025-06-11 18:16:08,428 INFO   Total Loss: 1.6109
2025-06-11 18:16:08,429 INFO   Accuracy: 0.5625
2025-06-11 18:16:08,430 INFO   MCC: 0.1260
2025-06-11 18:16:08,430 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 18:16:08,430 INFO   MSIN Cross-Attention sample: [0.04460614 0.05561072 0.05560695 0.05552963 0.04423304]
2025-06-11 18:16:17,684 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:33,236 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:16:49,993 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:17:08,564 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 18:52:00,969 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 18:52:00,969 INFO Configuration - use_dual_path_srl: True
2025-06-11 18:52:00,969 INFO Configuration - use_enhanced_srl: True
2025-06-11 18:52:00,969 INFO Configuration - use_ca_tsu: True
2025-06-11 18:52:00,970 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 18:52:00,970 INFO Configuration - use_noise_aware_loss: True
2025-06-11 18:52:00,970 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 18:52:00,970 INFO Configuration - variant_type: hedge
2025-06-11 18:52:00,970 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 18:52:00,973 INFO Start graph assembling...
2025-06-11 18:52:01,302 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 18:52:02,713 INFO use_dual_path_srl: True
2025-06-11 18:52:02,713 INFO variant_type: hedge
2025-06-11 18:52:02,713 INFO use_enhanced_srl: True
2025-06-11 18:52:02,713 INFO Enhanced SRL enabled from config
2025-06-11 18:52:02,714 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 18:52:02,714 INFO SRL condition: True = True and True
2025-06-11 18:52:02,714 INFO Using enhanced dual-path SRL architecture
2025-06-11 18:52:02,714 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 18:52:03,110 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 18:52:03,111 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 18:52:03,111 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:52:03,450 INFO Using Temporal Attention (TAP)
2025-06-11 18:52:03,493 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 18:52:03,514 INFO Creating enhanced SRL loss...
2025-06-11 18:52:03,515 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 18:52:03,568 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 18:52:03,569 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 18:52:03,570 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 18:52:03,572 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 18:52:03,583 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 18:52:06,158 INFO Graph assembled successfully.
2025-06-11 18:52:06,160 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:52:06,160 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 18:52:24,332 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 18:52:25,770 INFO Word table initialized
2025-06-11 18:52:25,771 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 18:52:25,771 WARNING Noise-aware loss not enabled in config. Enabling it for testing.
2025-06-11 18:52:25,771 INFO Setting default noise_aware_weight to 0.5
2025-06-11 18:52:25,771 WARNING Ca-TSU not enabled in config. Enabling it for testing.
2025-06-11 18:52:25,772 INFO Setting default ca_tsu_weight to 0.3
2025-06-11 18:52:25,772 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 18:52:25,772 INFO Evaluation will be performed every 10 steps
2025-06-11 18:52:25,860 INFO Starting training test for 50 batches
2025-06-11 18:52:50,568 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:00:09,715 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:00:09,716 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:00:09,716 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:00:09,716 INFO Configuration - use_ca_tsu: True
2025-06-11 19:00:09,716 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:00:09,717 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:00:09,717 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:00:09,717 INFO Configuration - variant_type: hedge
2025-06-11 19:00:09,718 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:00:09,720 INFO Start graph assembling...
2025-06-11 19:00:10,088 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:00:11,512 INFO use_dual_path_srl: True
2025-06-11 19:00:11,512 INFO variant_type: hedge
2025-06-11 19:00:11,513 INFO use_enhanced_srl: True
2025-06-11 19:00:11,513 INFO Enhanced SRL enabled from config
2025-06-11 19:00:11,513 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:00:11,513 INFO SRL condition: True = True and True
2025-06-11 19:00:11,513 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:00:11,513 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:00:11,897 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:00:11,898 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:00:11,898 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:00:12,237 INFO Using Temporal Attention (TAP)
2025-06-11 19:00:12,279 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:00:12,279 INFO Ca-TSU enabled: True
2025-06-11 19:00:12,280 INFO Ca-TSU weight: 0.3
2025-06-11 19:00:12,280 INFO Causal loss lambda: 0.3
2025-06-11 19:00:12,280 INFO Enhanced SRL enabled: True
2025-06-11 19:00:12,280 INFO Noise-Aware Loss enabled: True
2025-06-11 19:00:12,280 INFO Noise-Aware weight: 0.5
2025-06-11 19:00:12,301 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:00:12,301 INFO Creating enhanced SRL loss...
2025-06-11 19:00:12,301 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:00:12,355 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:00:12,356 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:00:12,357 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:00:12,375 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:00:12,394 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:00:12,397 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:00:12,399 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:00:12,400 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:00:12,401 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:00:12,413 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:00:15,062 INFO Graph assembled successfully.
2025-06-11 19:00:15,065 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:00:15,065 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:00:33,493 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:00:35,016 INFO Word table initialized
2025-06-11 19:00:35,017 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:00:35,017 INFO Enhanced SRL is already enabled.
2025-06-11 19:00:35,017 INFO Noise-aware loss is already enabled.
2025-06-11 19:00:35,018 INFO Ca-TSU is already enabled.
2025-06-11 19:00:35,018 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:00:35,018 INFO Evaluation will be performed every 10 steps
2025-06-11 19:00:35,144 INFO Starting training test for 50 batches
2025-06-11 19:00:48,772 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:01:03,838 INFO Batch 1/50 (Step 1):
2025-06-11 19:01:03,839 INFO   Total Loss: 0.7869
2025-06-11 19:01:03,839 INFO   Accuracy: 0.5312
2025-06-11 19:01:03,840 INFO   MCC: 0.0626
2025-06-11 19:01:03,840 INFO   Avg Reliability Weight: 0.4886
2025-06-11 19:01:03,840 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:01:03,841 INFO   MSIN Cross-Attention sample: [0.05513986 0.04466706 0.05578171 0.04466706 0.05375522]
2025-06-11 19:01:12,969 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:01:43,988 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:03,117 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:23,945 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:02:35,658 INFO Batch 5/50 (Step 5):
2025-06-11 19:02:35,658 INFO   Total Loss: 1.7067
2025-06-11 19:02:35,659 INFO   Accuracy: 0.5000
2025-06-11 19:02:35,659 INFO   MCC: -0.0120
2025-06-11 19:02:35,659 INFO   Avg Reliability Weight: 0.4937
2025-06-11 19:02:35,659 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:02:35,660 INFO   MSIN Cross-Attention sample: [0.03331814 0.04452743 0.05562393 0.04441233 0.05562393]
2025-06-11 19:02:40,190 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:03:02,005 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:14:00,421 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:14:00,421 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:14:00,422 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:14:00,422 INFO Configuration - use_ca_tsu: True
2025-06-11 19:14:00,422 INFO Configuration - causal_loss_lambda: 1.0
2025-06-11 19:14:00,422 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:14:00,423 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:14:00,423 INFO Configuration - variant_type: hedge
2025-06-11 19:14:00,424 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:14:00,427 INFO Start graph assembling...
2025-06-11 19:14:00,766 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:14:02,228 INFO use_dual_path_srl: True
2025-06-11 19:14:02,229 INFO variant_type: hedge
2025-06-11 19:14:02,229 INFO use_enhanced_srl: True
2025-06-11 19:14:02,229 INFO Enhanced SRL enabled from config
2025-06-11 19:14:02,229 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:14:02,230 INFO SRL condition: True = True and True
2025-06-11 19:14:02,230 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:14:02,230 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:14:02,552 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:14:02,553 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:14:02,553 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:14:02,964 INFO Using Temporal Attention (TAP)
2025-06-11 19:14:03,008 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:14:03,008 INFO Ca-TSU enabled: True
2025-06-11 19:14:03,009 INFO Ca-TSU weight: 0.3
2025-06-11 19:14:03,009 INFO Causal loss lambda: 1.0
2025-06-11 19:14:03,009 INFO Enhanced SRL enabled: True
2025-06-11 19:14:03,009 INFO Noise-Aware Loss enabled: True
2025-06-11 19:14:03,010 INFO Noise-Aware weight: 0.5
2025-06-11 19:14:03,031 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:14:03,031 INFO Creating enhanced SRL loss...
2025-06-11 19:14:03,032 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:14:03,086 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:14:03,088 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:14:03,088 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:14:03,107 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:14:03,126 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:14:03,130 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:14:03,131 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:14:03,132 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:14:03,133 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:14:03,147 INFO Adding causal consistency loss with lambda: 1.0
2025-06-11 19:14:05,762 INFO Graph assembled successfully.
2025-06-11 19:14:05,764 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:14:05,764 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:14:06,055 INFO Verifying model configuration...
2025-06-11 19:14:06,055 INFO Ca-TSU enabled: True
2025-06-11 19:14:06,056 INFO Enhanced SRL enabled: True
2025-06-11 19:14:06,056 INFO Noise-Aware Loss enabled: True
2025-06-11 19:14:06,056 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:14:06,056 INFO Evaluation will be performed every 10 steps
2025-06-11 19:14:06,056 ERROR Error running test: test_noise_aware_loss() got an unexpected keyword argument 'max_test_steps'
2025-06-11 19:15:44,496 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:15:44,496 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:15:44,496 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:15:44,497 INFO Configuration - use_ca_tsu: True
2025-06-11 19:15:44,497 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:15:44,497 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:15:44,497 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:15:44,497 INFO Configuration - variant_type: hedge
2025-06-11 19:15:44,498 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:15:44,500 INFO Start graph assembling...
2025-06-11 19:15:44,815 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:15:46,265 INFO use_dual_path_srl: True
2025-06-11 19:15:46,265 INFO variant_type: hedge
2025-06-11 19:15:46,265 INFO use_enhanced_srl: True
2025-06-11 19:15:46,265 INFO Enhanced SRL enabled from config
2025-06-11 19:15:46,266 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:15:46,266 INFO SRL condition: True = True and True
2025-06-11 19:15:46,266 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:15:46,266 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:15:46,586 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:15:46,586 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:15:46,587 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:15:46,998 INFO Using Temporal Attention (TAP)
2025-06-11 19:15:47,041 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:15:47,041 INFO Ca-TSU enabled: True
2025-06-11 19:15:47,042 INFO Ca-TSU weight: 0.3
2025-06-11 19:15:47,042 INFO Causal loss lambda: 0.3
2025-06-11 19:15:47,042 INFO Enhanced SRL enabled: True
2025-06-11 19:15:47,042 INFO Noise-Aware Loss enabled: True
2025-06-11 19:15:47,043 INFO Noise-Aware weight: 0.5
2025-06-11 19:15:47,066 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:15:47,066 INFO Creating enhanced SRL loss...
2025-06-11 19:15:47,067 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:15:47,122 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:15:47,124 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:15:47,125 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:15:47,143 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:15:47,164 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:15:47,167 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:15:47,169 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:15:47,170 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:15:47,171 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:15:47,184 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:15:49,846 INFO Graph assembled successfully.
2025-06-11 19:15:49,847 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:15:49,848 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:15:50,143 INFO Verifying model configuration...
2025-06-11 19:15:50,144 INFO Ca-TSU enabled: True
2025-06-11 19:15:50,144 INFO Enhanced SRL enabled: True
2025-06-11 19:15:50,144 INFO Noise-Aware Loss enabled: True
2025-06-11 19:15:50,145 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:15:50,145 INFO Evaluation will be performed every 10 steps
2025-06-11 19:16:08,512 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:16:10,085 INFO Word table initialized
2025-06-11 19:16:10,087 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:16:10,087 INFO Enhanced SRL is already enabled.
2025-06-11 19:16:10,087 INFO Noise-aware loss is already enabled.
2025-06-11 19:16:10,087 INFO Ca-TSU is already enabled.
2025-06-11 19:16:10,087 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:16:10,087 INFO Evaluation will be performed every 10 steps
2025-06-11 19:16:10,186 INFO Starting training test for 50 batches
2025-06-11 19:16:28,073 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:16:42,336 INFO Batch 1/50 (Step 1):
2025-06-11 19:16:42,337 INFO   Total Loss: 0.8279
2025-06-11 19:16:42,338 INFO   Accuracy: 0.4688
2025-06-11 19:16:42,338 INFO   MCC: -0.0552
2025-06-11 19:16:42,338 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:16:42,338 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:16:42,339 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:16:42,339 INFO   Avg Reliability Weight: 0.5167
2025-06-11 19:16:42,339 INFO   Ca-TSU - Alpha_i sample: [0.04039568 0.07477292 0.05826773 0.02485894 0.06349684]
2025-06-11 19:16:42,340 INFO   Ca-TSU - Omega_i sample: [0.03566391 0.02657074 0.03793029 0.0486159  0.08013925]
2025-06-11 19:16:42,340 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:16:42,340 INFO   MSIN Cross-Attention sample: [0.03433576 0.03388414 0.04425747 0.05547943 0.05668126]
2025-06-11 19:16:56,490 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:17:21,883 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:17:45,619 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:01,094 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:12,158 INFO Batch 5/50 (Step 5):
2025-06-11 19:18:12,158 INFO   Total Loss: 2.0284
2025-06-11 19:18:12,159 INFO   Accuracy: 0.5625
2025-06-11 19:18:12,159 INFO   MCC: 0.1111
2025-06-11 19:18:12,159 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:18:12,159 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:18:12,159 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:18:12,160 INFO   Avg Reliability Weight: 0.5149
2025-06-11 19:18:12,160 INFO   Ca-TSU - Alpha_i sample: [0.3131488 0.6868512 0.        0.        0.       ]
2025-06-11 19:18:12,160 INFO   Ca-TSU - Omega_i sample: [0.45779496 0.54220504 0.         0.         0.        ]
2025-06-11 19:18:12,161 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:18:12,161 INFO   MSIN Cross-Attention sample: [0.05564253 0.04403903 0.05546587 0.05550609 0.02254248]
2025-06-11 19:18:20,105 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:37,971 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:18:53,432 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:08,851 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:23,260 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:19:35,156 INFO Batch 10/50 (Step 10):
2025-06-11 19:19:35,157 INFO   Total Loss: 2.8623
2025-06-11 19:19:35,157 INFO   Accuracy: 0.6250
2025-06-11 19:19:35,158 INFO   MCC: 0.2431
2025-06-11 19:19:35,158 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:19:35,158 INFO   Avg Reliability Weight: 0.5050
2025-06-11 19:19:35,159 INFO   Ca-TSU - Alpha_i sample: [0.50195    0.49804994 0.         0.         0.        ]
2025-06-11 19:19:35,159 INFO   Ca-TSU - Omega_i sample: [0.3619579 0.6380421 0.        0.        0.       ]
2025-06-11 19:19:35,159 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:19:35,159 INFO   MSIN Cross-Attention sample: [0.05535481 0.05531765 0.04428756 0.03305654 0.05557296]
2025-06-11 19:19:35,159 INFO Evaluating on dev set at batch 10/50...
2025-06-11 19:19:36,562 ERROR Error during testing: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

Caused by op 'dual_path_placeholders/msg_mask_ph', defined at:
  File "src/test_noise_aware_loss.py", line 121, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 82, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "src\..\src\Executor_tx_lf_dual_path.py", line 22, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "src\..\src\Model_tx_lf_dual_path.py", line 1390, in assemble_graph
    name='msg_mask_ph'
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1599, in placeholder
    return gen_array_ops._placeholder(dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 3090, in _placeholder
    "Placeholder", dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

2025-06-11 19:19:36,567 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1323, in _do_call
    return fn(*args)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1302, in _run_fn
    status, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 817, in test_noise_aware_loss
    dev_results = self.generation(sess, 'dev')
  File "src\..\src\Executor_tx_lf_dual_path.py", line 131, in generation
    feed_dict=feed_dict)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 889, in run
    run_metadata_ptr)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1317, in _do_run
    options, run_metadata)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\client\session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]

Caused by op 'dual_path_placeholders/msg_mask_ph', defined at:
  File "src/test_noise_aware_loss.py", line 121, in <module>
    run_test()
  File "src/test_noise_aware_loss.py", line 82, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "src\..\src\Executor_tx_lf_dual_path.py", line 22, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "src\..\src\Model_tx_lf_dual_path.py", line 1390, in assemble_graph
    name='msg_mask_ph'
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1599, in placeholder
    return gen_array_ops._placeholder(dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 3090, in _placeholder
    "Placeholder", dtype=dtype, shape=shape, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): You must feed a value for placeholder tensor 'dual_path_placeholders/msg_mask_ph' with dtype bool and shape [?,5,20]
	 [[Node: dual_path_placeholders/msg_mask_ph = Placeholder[dtype=DT_BOOL, shape=[?,5,20], _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
	 [[Node: tda/tda/v_i/Tensordot/Shape/_3413 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device_incarnation=1, tensor_name="edge_2199_tda/tda/v_i/Tensordot/Shape", tensor_type=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"]()]]


2025-06-11 19:19:36,569 INFO Completed test on 10 batches
2025-06-11 19:19:36,717 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_191936.txt
2025-06-11 19:22:39,087 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 19:22:39,087 INFO Configuration - use_dual_path_srl: True
2025-06-11 19:22:39,087 INFO Configuration - use_enhanced_srl: True
2025-06-11 19:22:39,087 INFO Configuration - use_ca_tsu: True
2025-06-11 19:22:39,087 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 19:22:39,087 INFO Configuration - use_noise_aware_loss: True
2025-06-11 19:22:39,088 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 19:22:39,088 INFO Configuration - variant_type: hedge
2025-06-11 19:22:39,088 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 19:22:39,090 INFO Start graph assembling...
2025-06-11 19:22:39,409 INFO Created msg_mask_ph placeholder with shape: (?, 5, 20)
2025-06-11 19:22:40,881 INFO use_dual_path_srl: True
2025-06-11 19:22:40,881 INFO variant_type: hedge
2025-06-11 19:22:40,882 INFO use_enhanced_srl: True
2025-06-11 19:22:40,882 INFO Enhanced SRL enabled from config
2025-06-11 19:22:40,882 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 19:22:40,882 INFO SRL condition: True = True and True
2025-06-11 19:22:40,882 INFO Using enhanced dual-path SRL architecture
2025-06-11 19:22:40,883 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 19:22:41,221 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 19:22:41,222 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 19:22:41,222 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:22:41,670 INFO Using Temporal Attention (TAP)
2025-06-11 19:22:41,718 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 19:22:41,718 INFO Ca-TSU enabled: True
2025-06-11 19:22:41,719 INFO Ca-TSU weight: 0.3
2025-06-11 19:22:41,719 INFO Causal loss lambda: 0.3
2025-06-11 19:22:41,719 INFO Enhanced SRL enabled: True
2025-06-11 19:22:41,719 INFO Noise-Aware Loss enabled: True
2025-06-11 19:22:41,719 INFO Noise-Aware weight: 0.5
2025-06-11 19:22:41,743 INFO Base loss (before additional components): generative_ata_loss/explainability_loss_L2/add_1:0
2025-06-11 19:22:41,743 INFO Creating enhanced SRL loss...
2025-06-11 19:22:41,744 INFO Using h_t_dual_path for enhanced SRL loss: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 19:22:41,805 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5, 3)
2025-06-11 19:22:41,807 INFO Base prediction loss created: enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0
2025-06-11 19:22:41,807 INFO Creating reliability weights for noise-aware loss
2025-06-11 19:22:41,829 INFO Created text_influence_scores: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:22:41,852 INFO Created reliability_weights: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Sigmoid:0 with shape (?, 5, 1)
2025-06-11 19:22:41,856 INFO Created noise_aware_loss: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/truediv:0
2025-06-11 19:22:41,858 INFO Combined prediction loss with noise-aware loss using weight: 0.5
2025-06-11 19:22:41,859 INFO Final enhanced SRL loss created with weight 0.1: enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0
2025-06-11 19:22:41,860 INFO Added enhanced SRL loss to overall loss: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/mul:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 19:22:41,875 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 19:22:44,635 INFO Graph assembled successfully.
2025-06-11 19:22:44,636 INFO Ensured checkpoint directory exists: ./checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:22:44,637 INFO Ensured graph directory exists: ./graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-11 19:22:44,941 INFO Verifying model configuration...
2025-06-11 19:22:44,941 INFO Ca-TSU enabled: True
2025-06-11 19:22:44,941 INFO Enhanced SRL enabled: True
2025-06-11 19:22:44,942 INFO Noise-Aware Loss enabled: True
2025-06-11 19:22:44,942 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:22:44,942 INFO Evaluation will be performed every 10 steps
2025-06-11 19:23:03,470 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 19:23:04,891 INFO Word table initialized
2025-06-11 19:23:04,892 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-11 19:23:04,892 INFO Enhanced SRL is already enabled.
2025-06-11 19:23:04,892 INFO Noise-aware loss is already enabled.
2025-06-11 19:23:04,893 INFO Ca-TSU is already enabled.
2025-06-11 19:23:04,893 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 19:23:04,893 INFO Evaluation will be performed every 10 steps
2025-06-11 19:23:04,993 INFO Starting training test for 50 batches
2025-06-11 19:23:19,641 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:23:33,455 INFO Batch 1/50 (Step 1):
2025-06-11 19:23:33,456 INFO   Total Loss: 0.8296
2025-06-11 19:23:33,456 INFO   Accuracy: 0.5312
2025-06-11 19:23:33,457 INFO   MCC: 0.0710
2025-06-11 19:23:33,457 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:23:33,457 INFO   Avg Reliability Weight: 0.5138
2025-06-11 19:23:33,458 INFO   Ca-TSU - Alpha_i sample: [1. 0. 0. 0. 0.]
2025-06-11 19:23:33,458 INFO   Ca-TSU - Omega_i sample: [1. 0. 0. 0. 0.]
2025-06-11 19:23:33,458 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:23:33,459 INFO   MSIN Cross-Attention sample: [0.05526636 0.05572525 0.05552258 0.05534501 0.04480899]
2025-06-11 19:23:48,723 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:15,727 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:32,510 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:24:55,099 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:06,957 INFO Batch 5/50 (Step 5):
2025-06-11 19:25:06,958 INFO   Total Loss: 2.1663
2025-06-11 19:25:06,958 INFO   Accuracy: 0.5938
2025-06-11 19:25:06,958 INFO   MCC: 0.1189
2025-06-11 19:25:06,958 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:25:06,958 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:25:06,959 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:25:06,959 INFO   Avg Reliability Weight: 0.5198
2025-06-11 19:25:06,959 INFO   Ca-TSU - Alpha_i sample: [0.41033483 0.5896652  0.         0.         0.        ]
2025-06-11 19:25:06,960 INFO   Ca-TSU - Omega_i sample: [0.4440763  0.55592364 0.         0.         0.        ]
2025-06-11 19:25:06,960 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:25:06,960 INFO   MSIN Cross-Attention sample: [0.0536579  0.05461273 0.05562618 0.0574426  0.05558947]
2025-06-11 19:25:12,331 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:31,966 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:25:50,288 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:07,109 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:22,799 INFO Created and added message mask to feed_dict with shape (32, 5, 20)
2025-06-11 19:26:34,525 INFO Batch 10/50 (Step 10):
2025-06-11 19:26:34,525 INFO   Total Loss: 1.9956
2025-06-11 19:26:34,525 INFO   Accuracy: 0.5312
2025-06-11 19:26:34,526 INFO   MCC: 0.0658
2025-06-11 19:26:34,526 INFO   Enhanced SRL Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Ca-TSU - Causal Consistency Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Noise-Aware Loss: 0.0000
2025-06-11 19:26:34,526 INFO   Avg Reliability Weight: 0.5367
2025-06-11 19:26:34,527 INFO   Ca-TSU - Alpha_i sample: [0.13459796 0.24689054 0.21098895 0.14978819 0.10822627]
2025-06-11 19:26:34,527 INFO   Ca-TSU - Omega_i sample: [0.18274665 0.2262676  0.14796993 0.1835611  0.1195037 ]
2025-06-11 19:26:34,527 INFO   MSIN Cross-Attention shape: (32, 5, 20)
2025-06-11 19:26:34,528 INFO   MSIN Cross-Attention sample: [0.05554115 0.05573942 0.0443105  0.05564027 0.04452428]
2025-06-11 19:26:34,528 INFO Evaluating on dev set at batch 10/50...
2025-06-11 19:26:34,528 ERROR Error during testing: 'DataPipe' object has no attribute 'size'
2025-06-11 19:26:34,530 ERROR Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 122, in generation
    for _ in range(self.pipe.size[phase] // 32 + 1):
AttributeError: 'DataPipe' object has no attribute 'size'

2025-06-11 19:26:34,530 INFO Dev evaluation results:
2025-06-11 19:26:34,531 ERROR Error during testing: 'loss'
2025-06-11 19:26:34,535 ERROR Traceback (most recent call last):
  File "src\..\src\Executor_tx_lf_dual_path.py", line 884, in test_noise_aware_loss
    stat_logger.print_eval_res(dev_results)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\stat_logger.py", line 20, in print_eval_res
    eval_loss, eval_acc = result_dict['loss'], result_dict['acc']
KeyError: 'loss'

2025-06-11 19:26:34,535 INFO Completed test on 10 batches
2025-06-11 19:26:34,700 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_192634.txt
2025-06-11 23:42:00,134 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:42:00,135 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:42:00,135 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:42:00,135 INFO Configuration - use_ca_tsu: True
2025-06-11 23:42:00,135 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:42:00,136 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:42:00,136 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:42:00,136 INFO Configuration - variant_type: hedge
2025-06-11 23:42:00,136 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:42:00,149 INFO Start graph assembling...
2025-06-11 23:42:01,973 INFO use_dual_path_srl: True
2025-06-11 23:42:01,974 INFO variant_type: hedge
2025-06-11 23:42:01,974 INFO use_enhanced_srl: True
2025-06-11 23:42:01,975 INFO Enhanced SRL enabled from config
2025-06-11 23:42:01,975 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:42:01,975 INFO SRL condition: True = True and True
2025-06-11 23:42:01,975 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:42:01,975 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:42:02,299 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:42:02,299 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:42:02,300 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:42:02,711 INFO Using Temporal Attention (TAP)
2025-06-11 23:42:02,756 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:42:02,756 INFO Ca-TSU enabled: True
2025-06-11 23:42:02,756 INFO Ca-TSU weight: 0.3
2025-06-11 23:42:02,757 INFO Causal loss lambda: 0.3
2025-06-11 23:42:02,757 INFO Enhanced SRL enabled: True
2025-06-11 23:42:02,757 INFO Noise-Aware Loss enabled: True
2025-06-11 23:42:02,757 INFO Noise-Aware weight: 0.5
2025-06-11 23:42:02,768 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:42:02,768 INFO Creating enhanced SRL loss...
2025-06-11 23:42:02,769 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:42:02,776 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:42:02,778 ERROR Error running test: module 'tensorflow.python.ops.nn' has no attribute 'softmax_cross_entropy_with_logits_v2'
2025-06-11 23:43:04,479 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:43:04,480 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:43:04,480 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:43:04,480 INFO Configuration - use_ca_tsu: True
2025-06-11 23:43:04,481 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:43:04,481 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:43:04,481 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:43:04,481 INFO Configuration - variant_type: hedge
2025-06-11 23:43:04,482 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:43:04,484 INFO Start graph assembling...
2025-06-11 23:43:06,209 INFO use_dual_path_srl: True
2025-06-11 23:43:06,209 INFO variant_type: hedge
2025-06-11 23:43:06,210 INFO use_enhanced_srl: True
2025-06-11 23:43:06,210 INFO Enhanced SRL enabled from config
2025-06-11 23:43:06,210 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:43:06,210 INFO SRL condition: True = True and True
2025-06-11 23:43:06,210 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:43:06,210 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:43:06,533 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:43:06,533 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:43:06,533 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:43:06,943 INFO Using Temporal Attention (TAP)
2025-06-11 23:43:06,987 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:43:06,988 INFO Ca-TSU enabled: True
2025-06-11 23:43:06,988 INFO Ca-TSU weight: 0.3
2025-06-11 23:43:06,988 INFO Causal loss lambda: 0.3
2025-06-11 23:43:06,988 INFO Enhanced SRL enabled: True
2025-06-11 23:43:06,988 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:06,989 INFO Noise-Aware weight: 0.5
2025-06-11 23:43:06,999 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:06,999 INFO Creating enhanced SRL loss...
2025-06-11 23:43:06,999 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:43:07,008 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:43:07,021 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:07,022 INFO Creating reliability weights for noise-aware loss
2025-06-11 23:43:07,028 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:07,036 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:07,036 ERROR Error running test: module 'tensorflow.python.ops.nn' has no attribute 'softmax_cross_entropy_with_logits_v2'
2025-06-11 23:43:38,154 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-11 23:43:38,155 INFO Configuration - use_dual_path_srl: True
2025-06-11 23:43:38,155 INFO Configuration - use_enhanced_srl: True
2025-06-11 23:43:38,155 INFO Configuration - use_ca_tsu: True
2025-06-11 23:43:38,155 INFO Configuration - causal_loss_lambda: 0.3
2025-06-11 23:43:38,155 INFO Configuration - use_noise_aware_loss: True
2025-06-11 23:43:38,156 INFO Configuration - noise_aware_weight: 0.5
2025-06-11 23:43:38,156 INFO Configuration - variant_type: hedge
2025-06-11 23:43:38,157 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-11 23:43:38,159 INFO Start graph assembling...
2025-06-11 23:43:39,852 INFO use_dual_path_srl: True
2025-06-11 23:43:39,852 INFO variant_type: hedge
2025-06-11 23:43:39,852 INFO use_enhanced_srl: True
2025-06-11 23:43:39,853 INFO Enhanced SRL enabled from config
2025-06-11 23:43:39,853 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-11 23:43:39,853 INFO SRL condition: True = True and True
2025-06-11 23:43:39,853 INFO Using enhanced dual-path SRL architecture
2025-06-11 23:43:39,854 INFO Creating Enhanced Dual-Path SRL module...
2025-06-11 23:43:40,166 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-11 23:43:40,166 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-11 23:43:40,166 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-11 23:43:40,565 INFO Using Temporal Attention (TAP)
2025-06-11 23:43:40,608 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-11 23:43:40,608 INFO Ca-TSU enabled: True
2025-06-11 23:43:40,609 INFO Ca-TSU weight: 0.3
2025-06-11 23:43:40,609 INFO Causal loss lambda: 0.3
2025-06-11 23:43:40,609 INFO Enhanced SRL enabled: True
2025-06-11 23:43:40,609 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:40,609 INFO Noise-Aware weight: 0.5
2025-06-11 23:43:40,619 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:40,619 INFO Creating enhanced SRL loss...
2025-06-11 23:43:40,620 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-11 23:43:40,628 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-11 23:43:40,639 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:40,639 INFO Creating reliability weights for noise-aware loss
2025-06-11 23:43:40,647 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:40,655 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-11 23:43:40,669 INFO Adding causal consistency loss with lambda: 0.3
2025-06-11 23:43:40,679 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-11 23:43:44,287 INFO Graph assembled successfully.
2025-06-11 23:43:44,601 INFO Verifying model configuration...
2025-06-11 23:43:44,602 INFO Ca-TSU enabled: True
2025-06-11 23:43:44,602 INFO Enhanced SRL enabled: True
2025-06-11 23:43:44,602 INFO Noise-Aware Loss enabled: True
2025-06-11 23:43:44,602 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-11 23:43:44,602 INFO Evaluation will be performed every 10 steps
2025-06-11 23:44:02,718 INFO ASSEMBLE: word table #replacement: 19482
2025-06-11 23:44:38,972 INFO Test summary saved to results/model_test/enhancement_test_summary_20250611_234438.txt
2025-06-12 00:04:17,828 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:04:17,828 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:04:17,828 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:04:17,828 INFO Configuration - use_ca_tsu: True
2025-06-12 00:04:17,829 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:04:17,829 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:04:17,829 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:04:17,829 INFO Configuration - variant_type: hedge
2025-06-12 00:04:17,831 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:04:17,833 INFO Start graph assembling...
2025-06-12 00:04:19,763 INFO use_dual_path_srl: True
2025-06-12 00:04:19,764 INFO variant_type: hedge
2025-06-12 00:04:19,764 INFO use_enhanced_srl: True
2025-06-12 00:04:19,764 INFO Enhanced SRL enabled from config
2025-06-12 00:04:19,765 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:04:19,765 INFO SRL condition: True = True and True
2025-06-12 00:04:19,765 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:04:19,765 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:04:20,146 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:04:20,146 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:04:20,147 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:04:20,598 INFO Using Temporal Attention (TAP)
2025-06-12 00:04:20,646 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:04:20,646 INFO Ca-TSU enabled: True
2025-06-12 00:04:20,647 INFO Ca-TSU weight: 0.3
2025-06-12 00:04:20,647 INFO Causal loss lambda: 0.3
2025-06-12 00:04:20,647 INFO Enhanced SRL enabled: True
2025-06-12 00:04:20,647 INFO Noise-Aware Loss enabled: True
2025-06-12 00:04:20,648 INFO Noise-Aware weight: 0.5
2025-06-12 00:04:20,658 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:20,659 INFO Creating enhanced SRL loss...
2025-06-12 00:04:20,660 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:04:20,669 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:04:20,680 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:20,681 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:04:20,687 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:04:20,694 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:04:20,711 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:04:20,720 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:04:24,949 INFO Graph assembled successfully.
2025-06-12 00:04:25,291 INFO Verifying model configuration...
2025-06-12 00:04:25,292 INFO Ca-TSU enabled: True
2025-06-12 00:04:25,292 INFO Enhanced SRL enabled: True
2025-06-12 00:04:25,292 INFO Noise-Aware Loss enabled: True
2025-06-12 00:04:25,293 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:04:25,293 INFO Evaluation will be performed every 10 steps
2025-06-12 00:04:43,500 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:09:34,293 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:09:34,293 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:09:34,293 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:09:34,293 INFO Configuration - use_ca_tsu: True
2025-06-12 00:09:34,294 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:09:34,294 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:09:34,294 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:09:34,294 INFO Configuration - variant_type: hedge
2025-06-12 00:09:34,296 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:09:34,298 INFO Start graph assembling...
2025-06-12 00:09:35,994 INFO use_dual_path_srl: True
2025-06-12 00:09:35,994 INFO variant_type: hedge
2025-06-12 00:09:35,995 INFO use_enhanced_srl: True
2025-06-12 00:09:35,995 INFO Enhanced SRL enabled from config
2025-06-12 00:09:35,995 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:09:35,995 INFO SRL condition: True = True and True
2025-06-12 00:09:35,995 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:09:35,996 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:09:36,040 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:09:36,044 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:09:36,064 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:09:36,293 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:09:36,293 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:09:36,294 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:09:36,692 INFO Using Temporal Attention (TAP)
2025-06-12 00:09:36,737 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:09:36,737 INFO Ca-TSU enabled: True
2025-06-12 00:09:36,737 INFO Ca-TSU weight: 0.3
2025-06-12 00:09:36,738 INFO Causal loss lambda: 0.3
2025-06-12 00:09:36,738 INFO Enhanced SRL enabled: True
2025-06-12 00:09:36,738 INFO Noise-Aware Loss enabled: True
2025-06-12 00:09:36,738 INFO Noise-Aware weight: 0.5
2025-06-12 00:09:36,748 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:36,748 INFO Creating enhanced SRL loss...
2025-06-12 00:09:36,749 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:09:36,757 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:09:36,769 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:36,769 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:09:36,777 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:09:36,783 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:09:36,797 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:09:36,807 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:09:40,465 INFO Graph assembled successfully.
2025-06-12 00:09:40,779 INFO Verifying model configuration...
2025-06-12 00:09:40,779 INFO Ca-TSU enabled: True
2025-06-12 00:09:40,779 INFO Enhanced SRL enabled: True
2025-06-12 00:09:40,780 INFO Noise-Aware Loss enabled: True
2025-06-12 00:09:40,780 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:09:40,780 INFO Evaluation will be performed every 10 steps
2025-06-12 00:09:58,753 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:16:10,637 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:16:10,638 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:16:10,638 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:16:10,638 INFO Configuration - use_ca_tsu: True
2025-06-12 00:16:10,639 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:16:10,639 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:16:10,639 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:16:10,639 INFO Configuration - variant_type: hedge
2025-06-12 00:16:10,640 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:16:10,642 INFO Start graph assembling...
2025-06-12 00:16:12,393 INFO use_dual_path_srl: True
2025-06-12 00:16:12,393 INFO variant_type: hedge
2025-06-12 00:16:12,394 INFO use_enhanced_srl: True
2025-06-12 00:16:12,394 INFO Enhanced SRL enabled from config
2025-06-12 00:16:12,394 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:16:12,394 INFO SRL condition: True = True and True
2025-06-12 00:16:12,394 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:16:12,395 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:16:12,440 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:16:12,444 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:16:12,468 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:16:12,694 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:16:12,695 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:16:12,695 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:16:13,125 INFO Using Temporal Attention (TAP)
2025-06-12 00:16:13,176 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:16:13,177 INFO Ca-TSU enabled: True
2025-06-12 00:16:13,177 INFO Ca-TSU weight: 0.3
2025-06-12 00:16:13,177 INFO Causal loss lambda: 0.3
2025-06-12 00:16:13,177 INFO Enhanced SRL enabled: True
2025-06-12 00:16:13,178 INFO Noise-Aware Loss enabled: True
2025-06-12 00:16:13,178 INFO Noise-Aware weight: 0.5
2025-06-12 00:16:13,189 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:13,190 INFO Creating enhanced SRL loss...
2025-06-12 00:16:13,190 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:16:13,197 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:16:13,209 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:13,210 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:16:13,216 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:16:13,224 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:16:13,238 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:16:13,248 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:16:16,915 INFO Graph assembled successfully.
2025-06-12 00:16:17,224 INFO Verifying model configuration...
2025-06-12 00:16:17,224 INFO Ca-TSU enabled: True
2025-06-12 00:16:17,224 INFO Enhanced SRL enabled: True
2025-06-12 00:16:17,224 INFO Noise-Aware Loss enabled: True
2025-06-12 00:16:17,224 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:16:17,225 INFO Evaluation will be performed every 10 steps
2025-06-12 00:16:35,906 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:17:11,956 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_001711.txt
2025-06-12 00:17:17,247 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:17:17,250 INFO Start graph assembling...
2025-06-12 00:17:19,061 INFO use_dual_path_srl: True
2025-06-12 00:17:19,061 INFO variant_type: hedge
2025-06-12 00:17:19,062 INFO use_enhanced_srl: True
2025-06-12 00:17:19,062 INFO Enhanced SRL enabled from config
2025-06-12 00:17:19,062 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:17:19,062 INFO SRL condition: True = True and True
2025-06-12 00:17:19,063 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:17:19,063 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:17:19,111 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:17:19,116 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:17:19,141 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:17:19,379 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:17:19,379 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:17:19,379 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:17:19,806 INFO Using Temporal Attention (TAP)
2025-06-12 00:17:19,854 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:17:19,855 INFO Ca-TSU enabled: True
2025-06-12 00:17:19,855 INFO Ca-TSU weight: 0.3
2025-06-12 00:17:19,855 INFO Causal loss lambda: 0.3
2025-06-12 00:17:19,855 INFO Enhanced SRL enabled: True
2025-06-12 00:17:19,856 INFO Noise-Aware Loss enabled: True
2025-06-12 00:17:19,856 INFO Noise-Aware weight: 0.5
2025-06-12 00:17:19,866 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:19,868 INFO Creating enhanced SRL loss...
2025-06-12 00:17:19,868 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:17:19,876 INFO Price predictions shape: (?, 5, 3), Actual price shape: (?, 5)
2025-06-12 00:17:19,886 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:19,887 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:17:19,894 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:17:19,902 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:17:19,920 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:17:19,930 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:17:23,687 INFO Graph assembled successfully.
2025-06-12 00:19:46,160 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:19:46,160 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:19:46,161 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:19:46,161 INFO Configuration - use_ca_tsu: True
2025-06-12 00:19:46,161 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:19:46,161 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:19:46,162 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:19:46,162 INFO Configuration - variant_type: hedge
2025-06-12 00:19:46,162 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:19:46,164 INFO Start graph assembling...
2025-06-12 00:19:47,969 INFO use_dual_path_srl: True
2025-06-12 00:19:47,969 INFO variant_type: hedge
2025-06-12 00:19:47,969 INFO use_enhanced_srl: True
2025-06-12 00:19:47,970 INFO Enhanced SRL enabled from config
2025-06-12 00:19:47,970 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:19:47,970 INFO SRL condition: True = True and True
2025-06-12 00:19:47,970 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:19:47,970 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:19:48,014 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:19:48,019 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:19:48,038 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:19:48,258 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:19:48,259 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:19:48,259 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:19:48,664 INFO Using Temporal Attention (TAP)
2025-06-12 00:19:48,714 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:19:48,714 INFO Ca-TSU enabled: True
2025-06-12 00:19:48,715 INFO Ca-TSU weight: 0.3
2025-06-12 00:19:48,715 INFO Causal loss lambda: 0.3
2025-06-12 00:19:48,715 INFO Enhanced SRL enabled: True
2025-06-12 00:19:48,716 INFO Noise-Aware Loss enabled: True
2025-06-12 00:19:48,716 INFO Noise-Aware weight: 0.5
2025-06-12 00:19:48,728 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:48,729 INFO Creating enhanced SRL loss...
2025-06-12 00:19:48,729 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:19:48,749 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:19:48,762 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:48,762 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:19:48,769 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:19:48,777 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:19:48,794 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:19:48,803 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:19:52,703 INFO Graph assembled successfully.
2025-06-12 00:19:53,016 INFO Verifying model configuration...
2025-06-12 00:19:53,017 INFO Ca-TSU enabled: True
2025-06-12 00:19:53,017 INFO Enhanced SRL enabled: True
2025-06-12 00:19:53,017 INFO Noise-Aware Loss enabled: True
2025-06-12 00:19:53,017 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:19:53,017 INFO Evaluation will be performed every 10 steps
2025-06-12 00:20:11,913 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:24:46,572 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:24:46,572 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:24:46,573 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:24:46,573 INFO Configuration - use_ca_tsu: True
2025-06-12 00:24:46,573 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:24:46,573 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:24:46,573 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:24:46,573 INFO Configuration - variant_type: hedge
2025-06-12 00:24:46,574 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:24:46,576 INFO Start graph assembling...
2025-06-12 00:24:48,428 INFO use_dual_path_srl: True
2025-06-12 00:24:48,428 INFO variant_type: hedge
2025-06-12 00:24:48,430 INFO use_enhanced_srl: True
2025-06-12 00:24:48,430 INFO Enhanced SRL enabled from config
2025-06-12 00:24:48,430 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:24:48,430 INFO SRL condition: True = True and True
2025-06-12 00:24:48,430 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:24:48,430 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:24:48,484 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:24:48,489 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:24:48,508 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:24:48,747 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:24:48,748 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:24:48,748 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:24:49,186 INFO Using Temporal Attention (TAP)
2025-06-12 00:24:49,239 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:24:49,239 INFO Ca-TSU enabled: True
2025-06-12 00:24:49,239 INFO Ca-TSU weight: 0.3
2025-06-12 00:24:49,240 INFO Causal loss lambda: 0.3
2025-06-12 00:24:49,240 INFO Enhanced SRL enabled: True
2025-06-12 00:24:49,240 INFO Noise-Aware Loss enabled: True
2025-06-12 00:24:49,240 INFO Noise-Aware weight: 0.5
2025-06-12 00:24:49,254 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:49,254 INFO Creating enhanced SRL loss...
2025-06-12 00:24:49,254 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:24:49,268 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:24:49,280 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:49,281 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:24:49,288 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:24:49,296 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:24:49,312 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:24:49,321 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:24:53,133 INFO Graph assembled successfully.
2025-06-12 00:24:53,455 INFO Verifying model configuration...
2025-06-12 00:24:53,456 INFO Ca-TSU enabled: True
2025-06-12 00:24:53,456 INFO Enhanced SRL enabled: True
2025-06-12 00:24:53,456 INFO Noise-Aware Loss enabled: True
2025-06-12 00:24:53,456 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:24:53,457 INFO Evaluation will be performed every 10 steps
2025-06-12 00:25:11,933 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:25:48,929 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_002548.txt
2025-06-12 00:27:42,702 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:27:42,702 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:27:42,703 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:27:42,703 INFO Configuration - use_ca_tsu: True
2025-06-12 00:27:42,703 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:27:42,703 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:27:42,704 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:27:42,704 INFO Configuration - variant_type: hedge
2025-06-12 00:27:42,704 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:27:42,706 INFO Start graph assembling...
2025-06-12 00:27:44,579 INFO use_dual_path_srl: True
2025-06-12 00:27:44,580 INFO variant_type: hedge
2025-06-12 00:27:44,580 INFO use_enhanced_srl: True
2025-06-12 00:27:44,581 INFO Enhanced SRL enabled from config
2025-06-12 00:27:44,581 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:27:44,581 INFO SRL condition: True = True and True
2025-06-12 00:27:44,581 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:27:44,582 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:27:44,627 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:27:44,632 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:27:44,652 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:27:44,885 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:27:44,885 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:27:44,886 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:27:45,329 INFO Using Temporal Attention (TAP)
2025-06-12 00:27:45,373 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:27:45,373 INFO Ca-TSU enabled: True
2025-06-12 00:27:45,374 INFO Ca-TSU weight: 0.3
2025-06-12 00:27:45,374 INFO Causal loss lambda: 0.3
2025-06-12 00:27:45,374 INFO Enhanced SRL enabled: True
2025-06-12 00:27:45,374 INFO Noise-Aware Loss enabled: True
2025-06-12 00:27:45,374 INFO Noise-Aware weight: 0.5
2025-06-12 00:27:45,385 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:27:45,385 INFO Creating enhanced SRL loss...
2025-06-12 00:27:45,385 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:27:45,385 ERROR Error running test: local variable 'static_h_size' referenced before assignment
2025-06-12 00:28:42,205 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 00:28:42,206 INFO Configuration - use_dual_path_srl: True
2025-06-12 00:28:42,206 INFO Configuration - use_enhanced_srl: True
2025-06-12 00:28:42,207 INFO Configuration - use_ca_tsu: True
2025-06-12 00:28:42,207 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 00:28:42,207 INFO Configuration - use_noise_aware_loss: True
2025-06-12 00:28:42,207 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 00:28:42,207 INFO Configuration - variant_type: hedge
2025-06-12 00:28:42,208 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 00:28:42,210 INFO Start graph assembling...
2025-06-12 00:28:44,159 INFO use_dual_path_srl: True
2025-06-12 00:28:44,160 INFO variant_type: hedge
2025-06-12 00:28:44,160 INFO use_enhanced_srl: True
2025-06-12 00:28:44,160 INFO Enhanced SRL enabled from config
2025-06-12 00:28:44,160 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 00:28:44,161 INFO SRL condition: True = True and True
2025-06-12 00:28:44,161 INFO Using enhanced dual-path SRL architecture
2025-06-12 00:28:44,161 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 00:28:44,207 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 00:28:44,212 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 00:28:44,231 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 00:28:44,463 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 00:28:44,463 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 00:28:44,464 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 00:28:44,926 INFO Using Temporal Attention (TAP)
2025-06-12 00:28:44,978 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 00:28:44,978 INFO Ca-TSU enabled: True
2025-06-12 00:28:44,978 INFO Ca-TSU weight: 0.3
2025-06-12 00:28:44,979 INFO Causal loss lambda: 0.3
2025-06-12 00:28:44,979 INFO Enhanced SRL enabled: True
2025-06-12 00:28:44,979 INFO Noise-Aware Loss enabled: True
2025-06-12 00:28:44,979 INFO Noise-Aware weight: 0.5
2025-06-12 00:28:44,992 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:44,992 INFO Creating enhanced SRL loss...
2025-06-12 00:28:44,992 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 00:28:44,998 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 00:28:45,012 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 00:28:45,028 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:45,028 INFO Creating reliability weights for noise-aware loss
2025-06-12 00:28:45,036 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:28:45,037 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 00:28:45,042 INFO Created W_reliability with shape: (100, 1)
2025-06-12 00:28:45,047 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 00:28:45,069 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 00:28:45,080 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 00:28:48,728 INFO Graph assembled successfully.
2025-06-12 00:28:49,039 INFO Verifying model configuration...
2025-06-12 00:28:49,039 INFO Ca-TSU enabled: True
2025-06-12 00:28:49,039 INFO Enhanced SRL enabled: True
2025-06-12 00:28:49,040 INFO Noise-Aware Loss enabled: True
2025-06-12 00:28:49,040 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 00:28:49,040 INFO Evaluation will be performed every 10 steps
2025-06-12 00:29:07,836 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 00:34:47,151 INFO 	Eval, eval loss: 0.892702579498291, acc: 0.490854
2025-06-12 00:39:40,962 INFO 	Eval, eval loss: 0.8282244205474854, acc: 0.513720
2025-06-12 00:44:27,642 INFO 	Eval, eval loss: 0.7621829509735107, acc: 0.518293
2025-06-12 00:49:01,225 INFO 	Eval, eval loss: 0.7787623405456543, acc: 0.495427
2025-06-12 17:47:16,091 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 17:47:16,092 INFO Configuration - use_dual_path_srl: True
2025-06-12 17:47:16,092 INFO Configuration - use_enhanced_srl: True
2025-06-12 17:47:16,092 INFO Configuration - use_ca_tsu: True
2025-06-12 17:47:16,093 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 17:47:16,093 INFO Configuration - use_noise_aware_loss: True
2025-06-12 17:47:16,093 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 17:47:16,093 INFO Configuration - variant_type: hedge
2025-06-12 17:47:16,094 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 17:47:16,101 INFO Start graph assembling...
2025-06-12 17:47:17,836 INFO use_dual_path_srl: True
2025-06-12 17:47:17,836 INFO variant_type: hedge
2025-06-12 17:47:17,836 INFO use_enhanced_srl: True
2025-06-12 17:47:17,836 INFO Enhanced SRL enabled from config
2025-06-12 17:47:17,837 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 17:47:17,837 INFO SRL condition: True = True and True
2025-06-12 17:47:17,837 INFO Using enhanced dual-path SRL architecture
2025-06-12 17:47:17,837 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 17:47:17,882 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 17:47:17,887 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 17:47:17,906 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 17:47:18,128 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 17:47:18,129 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 17:47:18,129 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 17:47:18,527 INFO Using Temporal Attention (TAP)
2025-06-12 17:47:18,571 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 17:47:18,572 INFO Ca-TSU enabled: True
2025-06-12 17:47:18,572 INFO Ca-TSU weight: 0.3
2025-06-12 17:47:18,572 INFO Causal loss lambda: 0.3
2025-06-12 17:47:18,572 INFO Enhanced SRL enabled: True
2025-06-12 17:47:18,573 INFO Noise-Aware Loss enabled: True
2025-06-12 17:47:18,573 INFO Noise-Aware weight: 0.5
2025-06-12 17:47:18,584 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:18,585 INFO Creating enhanced SRL loss...
2025-06-12 17:47:18,585 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 17:47:18,589 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 17:47:18,597 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 17:47:18,608 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:18,609 INFO Creating reliability weights for noise-aware loss
2025-06-12 17:47:18,615 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 17:47:18,615 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 17:47:18,621 INFO Created W_reliability with shape: (100, 1)
2025-06-12 17:47:18,623 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 17:47:18,639 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 17:47:18,648 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 17:47:22,217 INFO Graph assembled successfully.
2025-06-12 17:47:22,528 INFO Verifying model configuration...
2025-06-12 17:47:22,528 INFO Ca-TSU enabled: True
2025-06-12 17:47:22,529 INFO Enhanced SRL enabled: True
2025-06-12 17:47:22,529 INFO Noise-Aware Loss enabled: True
2025-06-12 17:47:22,529 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 17:47:22,529 INFO Evaluation will be performed every 10 steps
2025-06-12 17:47:40,928 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 17:53:10,537 INFO 	Eval, eval loss: 0.8751025795936584, acc: 0.493902
2025-06-12 17:57:41,763 INFO 	Eval, eval loss: 0.8034499883651733, acc: 0.521341
2025-06-12 18:02:08,203 INFO 	Eval, eval loss: 0.8108055591583252, acc: 0.481707
2025-06-12 18:06:17,690 INFO 	Eval, eval loss: 0.7536460757255554, acc: 0.524390
2025-06-12 18:10:33,877 INFO 	Eval, eval loss: 0.7572818994522095, acc: 0.525915
2025-06-12 18:12:34,971 INFO 	Eval, eval loss: 0.7903890013694763, acc: 0.519817
2025-06-12 18:12:36,650 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_181236.txt
2025-06-12 19:31:09,521 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 19:31:09,522 INFO Configuration - use_dual_path_srl: True
2025-06-12 19:31:09,522 INFO Configuration - use_enhanced_srl: True
2025-06-12 19:31:09,522 INFO Configuration - use_ca_tsu: True
2025-06-12 19:31:09,522 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 19:31:09,523 INFO Configuration - use_noise_aware_loss: True
2025-06-12 19:31:09,523 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 19:31:09,523 INFO Configuration - variant_type: hedge
2025-06-12 19:31:09,524 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 19:31:09,525 INFO Start graph assembling...
2025-06-12 19:31:11,305 INFO use_dual_path_srl: True
2025-06-12 19:31:11,305 INFO variant_type: hedge
2025-06-12 19:31:11,306 INFO use_enhanced_srl: True
2025-06-12 19:31:11,306 INFO Enhanced SRL enabled from config
2025-06-12 19:31:11,306 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 19:31:11,306 INFO SRL condition: True = True and True
2025-06-12 19:31:11,307 INFO Using enhanced dual-path SRL architecture
2025-06-12 19:31:11,307 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 19:31:11,352 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 19:31:11,357 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 19:31:11,375 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 19:31:11,597 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 19:31:11,597 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 19:31:11,598 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 19:31:11,994 INFO Using Temporal Attention (TAP)
2025-06-12 19:31:12,040 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 19:31:12,040 INFO Ca-TSU enabled: True
2025-06-12 19:31:12,041 INFO Ca-TSU weight: 0.3
2025-06-12 19:31:12,041 INFO Causal loss lambda: 0.3
2025-06-12 19:31:12,041 INFO Enhanced SRL enabled: True
2025-06-12 19:31:12,041 INFO Noise-Aware Loss enabled: True
2025-06-12 19:31:12,042 INFO Noise-Aware weight: 0.5
2025-06-12 19:31:12,052 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:12,052 INFO Creating enhanced SRL loss...
2025-06-12 19:31:12,052 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 19:31:12,059 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 19:31:12,067 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 19:31:12,078 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:12,079 INFO Creating reliability weights for noise-aware loss
2025-06-12 19:31:12,085 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 19:31:12,085 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 19:31:12,090 INFO Created W_reliability with shape: (100, 1)
2025-06-12 19:31:12,093 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 19:31:12,108 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 19:31:12,119 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 19:31:15,819 INFO Graph assembled successfully.
2025-06-12 19:31:16,173 INFO Verifying model configuration...
2025-06-12 19:31:16,173 INFO Ca-TSU enabled: True
2025-06-12 19:31:16,173 INFO Enhanced SRL enabled: True
2025-06-12 19:31:16,174 INFO Noise-Aware Loss enabled: True
2025-06-12 19:31:16,174 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 19:31:16,174 INFO Evaluation will be performed every 10 steps
2025-06-12 19:31:35,695 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 19:37:02,153 INFO 	Eval, eval loss: 0.8321214318275452, acc: 0.527439
2025-06-12 19:41:31,135 INFO 	Eval, eval loss: 0.8202773928642273, acc: 0.515244
2025-06-12 19:45:45,279 INFO 	Eval, eval loss: 0.7907822728157043, acc: 0.498476
2025-06-12 19:49:54,894 INFO 	Eval, eval loss: 0.7974898219108582, acc: 0.506098
2025-06-12 19:54:07,346 INFO 	Eval, eval loss: 0.7508732080459595, acc: 0.535061
2025-06-12 19:56:00,125 INFO 	Eval, eval loss: 0.8410829901695251, acc: 0.509146
2025-06-12 19:58:41,110 INFO 	Eval, eval loss: 0.8626457452774048, acc: 0.481151
2025-06-12 19:58:41,392 INFO Test summary saved to results/model_test/enhancement_test_summary_20250612_195841.txt
2025-06-12 19:58:41,392 INFO Test completed successfully!
2025-06-12 23:27:25,344 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 23:27:25,346 INFO Configuration - use_dual_path_srl: True
2025-06-12 23:27:25,346 INFO Configuration - use_enhanced_srl: True
2025-06-12 23:27:25,346 INFO Configuration - use_ca_tsu: True
2025-06-12 23:27:25,346 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 23:27:25,347 INFO Configuration - use_noise_aware_loss: True
2025-06-12 23:27:25,347 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 23:27:25,347 INFO Configuration - variant_type: hedge
2025-06-12 23:27:25,348 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 23:27:25,359 INFO Start graph assembling...
2025-06-12 23:27:27,363 INFO use_dual_path_srl: True
2025-06-12 23:27:27,363 INFO variant_type: hedge
2025-06-12 23:27:27,364 INFO use_enhanced_srl: True
2025-06-12 23:27:27,364 INFO Enhanced SRL enabled from config
2025-06-12 23:27:27,364 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 23:27:27,364 INFO SRL condition: True = True and True
2025-06-12 23:27:27,365 INFO Using enhanced dual-path SRL architecture
2025-06-12 23:27:27,365 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 23:27:27,432 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 23:27:27,439 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 23:27:27,468 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 23:27:27,772 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 23:27:27,773 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 23:27:27,773 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 23:27:28,252 INFO Using Temporal Attention (TAP)
2025-06-12 23:27:28,303 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 23:27:28,304 INFO Ca-TSU enabled: True
2025-06-12 23:27:28,304 INFO Ca-TSU weight: 0.3
2025-06-12 23:27:28,304 INFO Causal loss lambda: 0.3
2025-06-12 23:27:28,304 INFO Enhanced SRL enabled: True
2025-06-12 23:27:28,305 INFO Noise-Aware Loss enabled: True
2025-06-12 23:27:28,305 INFO Noise-Aware weight: 0.5
2025-06-12 23:27:28,316 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:28,316 INFO Creating enhanced SRL loss...
2025-06-12 23:27:28,317 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 23:27:28,322 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 23:27:28,334 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 23:27:28,346 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:28,347 INFO Creating reliability weights for noise-aware loss
2025-06-12 23:27:28,354 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:27:28,355 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 23:27:28,359 INFO Created W_reliability with shape: (100, 1)
2025-06-12 23:27:28,362 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:27:28,377 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 23:27:28,387 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:27:32,102 INFO Graph assembled successfully.
2025-06-12 23:27:32,423 INFO Verifying model configuration...
2025-06-12 23:27:32,424 INFO Ca-TSU enabled: True
2025-06-12 23:27:32,424 INFO Enhanced SRL enabled: True
2025-06-12 23:27:32,424 INFO Noise-Aware Loss enabled: True
2025-06-12 23:27:32,424 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 23:27:32,425 INFO Evaluation will be performed every 10 steps
2025-06-12 23:27:50,640 INFO ASSEMBLE: word table #replacement: 19482
2025-06-12 23:50:31,636 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-12 23:50:31,636 INFO Configuration - use_dual_path_srl: True
2025-06-12 23:50:31,636 INFO Configuration - use_enhanced_srl: True
2025-06-12 23:50:31,637 INFO Configuration - use_ca_tsu: True
2025-06-12 23:50:31,637 INFO Configuration - causal_loss_lambda: 0.3
2025-06-12 23:50:31,637 INFO Configuration - use_noise_aware_loss: True
2025-06-12 23:50:31,637 INFO Configuration - noise_aware_weight: 0.5
2025-06-12 23:50:31,637 INFO Configuration - variant_type: hedge
2025-06-12 23:50:31,638 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-12 23:50:31,640 INFO Start graph assembling...
2025-06-12 23:50:33,462 INFO use_dual_path_srl: True
2025-06-12 23:50:33,462 INFO variant_type: hedge
2025-06-12 23:50:33,463 INFO use_enhanced_srl: True
2025-06-12 23:50:33,463 INFO Enhanced SRL enabled from config
2025-06-12 23:50:33,463 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-12 23:50:33,463 INFO SRL condition: True = True and True
2025-06-12 23:50:33,463 INFO Using enhanced dual-path SRL architecture
2025-06-12 23:50:33,464 INFO Creating Enhanced Dual-Path SRL module...
2025-06-12 23:50:33,513 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-12 23:50:33,517 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-12 23:50:33,541 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-12 23:50:33,784 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-12 23:50:33,784 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-12 23:50:33,785 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-12 23:50:34,247 INFO Using Temporal Attention (TAP)
2025-06-12 23:50:34,298 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-12 23:50:34,299 INFO Ca-TSU enabled: True
2025-06-12 23:50:34,299 INFO Ca-TSU weight: 0.3
2025-06-12 23:50:34,299 INFO Causal loss lambda: 0.3
2025-06-12 23:50:34,299 INFO Enhanced SRL enabled: True
2025-06-12 23:50:34,299 INFO Noise-Aware Loss enabled: True
2025-06-12 23:50:34,300 INFO Noise-Aware weight: 0.5
2025-06-12 23:50:34,312 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:34,313 INFO Creating enhanced SRL loss...
2025-06-12 23:50:34,313 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-12 23:50:34,318 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-12 23:50:34,329 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-12 23:50:34,343 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:34,343 INFO Creating reliability weights for noise-aware loss
2025-06-12 23:50:34,355 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:50:34,356 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-12 23:50:34,363 INFO Created W_reliability with shape: (100, 1)
2025-06-12 23:50:34,365 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-12 23:50:34,393 INFO Adding causal consistency loss with lambda: 0.3
2025-06-12 23:50:34,406 INFO Final loss after all components: Tensor("causal_consistency_loss/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-12 23:50:38,214 INFO Graph assembled successfully.
2025-06-12 23:50:38,542 INFO Verifying model configuration...
2025-06-12 23:50:38,542 INFO Ca-TSU enabled: True
2025-06-12 23:50:38,542 INFO Enhanced SRL enabled: True
2025-06-12 23:50:38,543 INFO Noise-Aware Loss enabled: True
2025-06-12 23:50:38,543 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-12 23:50:38,543 INFO Evaluation will be performed every 10 steps
2025-06-12 23:50:57,360 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:04:09,685 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:04:09,700 INFO Start graph assembling...
2025-06-13 18:04:12,086 INFO use_dual_path_srl: True
2025-06-13 18:04:12,086 INFO variant_type: hedge
2025-06-13 18:04:12,086 INFO use_enhanced_srl: True
2025-06-13 18:04:12,086 INFO Enhanced SRL enabled from config
2025-06-13 18:04:12,087 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:04:12,087 INFO SRL condition: True = True and True
2025-06-13 18:04:12,087 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:04:12,087 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:04:12,143 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:04:12,149 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:04:12,170 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:04:12,435 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:04:12,436 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:04:12,436 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:04:12,910 INFO Using Temporal Attention (TAP)
2025-06-13 18:04:12,957 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:04:12,957 INFO Ca-TSU enabled: True
2025-06-13 18:04:12,957 INFO Ca-TSU weight: 0.3
2025-06-13 18:04:12,958 INFO Causal loss lambda: 0.3
2025-06-13 18:04:12,958 INFO Enhanced SRL enabled: True
2025-06-13 18:04:12,958 INFO Noise-Aware Loss enabled: True
2025-06-13 18:04:12,958 INFO Noise-Aware weight: 0.5
2025-06-13 18:04:12,969 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:04:12,970 INFO Creating enhanced SRL loss...
2025-06-13 18:04:12,970 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:04:12,973 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:04:12,982 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:04:12,993 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:04:12,994 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:04:13,001 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:04:13,001 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:04:13,006 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:04:13,008 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:04:13,026 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:05:11,803 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:05:11,807 INFO Start graph assembling...
2025-06-13 18:05:13,627 INFO use_dual_path_srl: True
2025-06-13 18:05:13,627 INFO variant_type: hedge
2025-06-13 18:05:13,627 INFO use_enhanced_srl: True
2025-06-13 18:05:13,627 INFO Enhanced SRL enabled from config
2025-06-13 18:05:13,628 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:05:13,628 INFO SRL condition: True = True and True
2025-06-13 18:05:13,628 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:05:13,628 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:05:13,674 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:05:13,678 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:05:13,697 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:05:13,922 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:05:13,922 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:05:13,923 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:05:14,325 INFO Using Temporal Attention (TAP)
2025-06-13 18:05:14,369 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:05:14,370 INFO Ca-TSU enabled: True
2025-06-13 18:05:14,370 INFO Ca-TSU weight: 0.3
2025-06-13 18:05:14,370 INFO Causal loss lambda: 0.3
2025-06-13 18:05:14,370 INFO Enhanced SRL enabled: True
2025-06-13 18:05:14,371 INFO Noise-Aware Loss enabled: True
2025-06-13 18:05:14,371 INFO Noise-Aware weight: 0.5
2025-06-13 18:05:14,381 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:05:14,382 INFO Creating enhanced SRL loss...
2025-06-13 18:05:14,382 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:05:14,387 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:05:14,395 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:05:14,406 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:05:14,406 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:05:14,413 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:05:14,413 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:05:14,420 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:05:14,422 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:05:14,437 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:07:26,716 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:07:26,719 INFO Start graph assembling...
2025-06-13 18:07:28,457 INFO use_dual_path_srl: True
2025-06-13 18:07:28,457 INFO variant_type: hedge
2025-06-13 18:07:28,457 INFO use_enhanced_srl: True
2025-06-13 18:07:28,457 INFO Enhanced SRL enabled from config
2025-06-13 18:07:28,457 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:07:28,458 INFO SRL condition: True = True and True
2025-06-13 18:07:28,458 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:07:28,458 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:07:28,511 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:07:28,518 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:07:28,543 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:07:28,780 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:07:28,780 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:07:28,781 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:07:29,185 INFO Using Temporal Attention (TAP)
2025-06-13 18:07:29,229 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:07:29,229 INFO Ca-TSU enabled: True
2025-06-13 18:07:29,229 INFO Ca-TSU weight: 0.3
2025-06-13 18:07:29,230 INFO Causal loss lambda: 0.3
2025-06-13 18:07:29,230 INFO Enhanced SRL enabled: True
2025-06-13 18:07:29,230 INFO Noise-Aware Loss enabled: True
2025-06-13 18:07:29,230 INFO Noise-Aware weight: 0.5
2025-06-13 18:07:29,241 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,241 INFO Creating enhanced SRL loss...
2025-06-13 18:07:29,241 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:07:29,245 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:07:29,253 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:07:29,264 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,264 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:07:29,271 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:07:29,272 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:07:29,276 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:07:29,278 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:07:29,293 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:07:29,342 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:07:29,347 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:07:29,347 INFO Loss component verification:
2025-06-13 18:07:29,374 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:07:33,042 INFO Graph assembled successfully.
2025-06-13 18:16:02,825 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 18:16:02,825 INFO Configuration - use_dual_path_srl: True
2025-06-13 18:16:02,825 INFO Configuration - use_enhanced_srl: True
2025-06-13 18:16:02,825 INFO Configuration - use_ca_tsu: True
2025-06-13 18:16:02,825 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 18:16:02,826 INFO Configuration - use_noise_aware_loss: True
2025-06-13 18:16:02,826 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 18:16:02,826 INFO Configuration - variant_type: hedge
2025-06-13 18:16:02,826 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:16:02,828 INFO Start graph assembling...
2025-06-13 18:16:04,554 INFO use_dual_path_srl: True
2025-06-13 18:16:04,555 INFO variant_type: hedge
2025-06-13 18:16:04,555 INFO use_enhanced_srl: True
2025-06-13 18:16:04,555 INFO Enhanced SRL enabled from config
2025-06-13 18:16:04,555 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:16:04,555 INFO SRL condition: True = True and True
2025-06-13 18:16:04,556 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:16:04,556 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:16:04,605 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:16:04,609 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:16:04,629 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:16:04,858 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:16:04,858 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:16:04,858 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:16:05,314 INFO Using Temporal Attention (TAP)
2025-06-13 18:16:05,359 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:16:05,359 INFO Ca-TSU enabled: True
2025-06-13 18:16:05,360 INFO Ca-TSU weight: 0.3
2025-06-13 18:16:05,360 INFO Causal loss lambda: 0.3
2025-06-13 18:16:05,360 INFO Enhanced SRL enabled: True
2025-06-13 18:16:05,360 INFO Noise-Aware Loss enabled: True
2025-06-13 18:16:05,361 INFO Noise-Aware weight: 0.5
2025-06-13 18:16:05,379 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,379 INFO Creating enhanced SRL loss...
2025-06-13 18:16:05,380 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:16:05,384 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:16:05,393 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:16:05,404 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,405 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:16:05,412 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:16:05,412 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:16:05,417 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:16:05,419 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:16:05,436 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:16:05,487 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:16:05,493 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:16:05,494 INFO Loss component verification:
2025-06-13 18:16:05,494 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 18:16:05,494 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 18:16:05,494 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 18:16:05,495 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 18:16:05,495 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:16:09,221 INFO Graph assembled successfully.
2025-06-13 18:16:09,548 INFO Verifying model configuration...
2025-06-13 18:16:09,548 INFO Ca-TSU enabled: True
2025-06-13 18:16:09,549 INFO Enhanced SRL enabled: True
2025-06-13 18:16:09,549 INFO Noise-Aware Loss enabled: True
2025-06-13 18:16:09,549 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 18:16:09,549 INFO Evaluation will be performed every 10 steps
2025-06-13 18:16:27,957 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:22:22,631 INFO 	Eval, eval loss: 0.8802575469017029, acc: 0.489329
2025-06-13 18:50:19,329 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 18:50:19,329 INFO Configuration - use_dual_path_srl: True
2025-06-13 18:50:19,330 INFO Configuration - use_enhanced_srl: True
2025-06-13 18:50:19,330 INFO Configuration - use_ca_tsu: True
2025-06-13 18:50:19,330 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 18:50:19,330 INFO Configuration - use_noise_aware_loss: True
2025-06-13 18:50:19,330 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 18:50:19,330 INFO Configuration - variant_type: hedge
2025-06-13 18:50:19,331 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 18:50:19,334 INFO Start graph assembling...
2025-06-13 18:50:21,128 INFO use_dual_path_srl: True
2025-06-13 18:50:21,128 INFO variant_type: hedge
2025-06-13 18:50:21,128 INFO use_enhanced_srl: True
2025-06-13 18:50:21,129 INFO Enhanced SRL enabled from config
2025-06-13 18:50:21,129 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 18:50:21,129 INFO SRL condition: True = True and True
2025-06-13 18:50:21,129 INFO Using enhanced dual-path SRL architecture
2025-06-13 18:50:21,130 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 18:50:21,183 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 18:50:21,190 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 18:50:21,218 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 18:50:21,472 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 18:50:21,473 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 18:50:21,473 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 18:50:21,898 INFO Using Temporal Attention (TAP)
2025-06-13 18:50:21,942 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 18:50:21,943 INFO Ca-TSU enabled: True
2025-06-13 18:50:21,943 INFO Ca-TSU weight: 0.3
2025-06-13 18:50:21,943 INFO Causal loss lambda: 0.3
2025-06-13 18:50:21,944 INFO Enhanced SRL enabled: True
2025-06-13 18:50:21,944 INFO Noise-Aware Loss enabled: True
2025-06-13 18:50:21,944 INFO Noise-Aware weight: 0.5
2025-06-13 18:50:21,955 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:21,955 INFO Creating enhanced SRL loss...
2025-06-13 18:50:21,956 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 18:50:21,958 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 18:50:21,968 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 18:50:21,979 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:21,980 INFO Creating reliability weights for noise-aware loss
2025-06-13 18:50:21,987 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:50:21,987 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 18:50:21,993 INFO Created W_reliability with shape: (100, 1)
2025-06-13 18:50:21,995 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 18:50:22,013 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 18:50:22,066 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 18:50:22,070 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 18:50:22,070 INFO Loss component verification:
2025-06-13 18:50:22,071 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 18:50:22,071 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 18:50:22,071 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 18:50:22,071 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 18:50:22,072 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'enhanced_srl_loss', 'causal_consistency_loss']
2025-06-13 18:50:26,086 INFO Graph assembled successfully.
2025-06-13 18:50:26,431 INFO Verifying model configuration...
2025-06-13 18:50:26,432 INFO Ca-TSU enabled: True
2025-06-13 18:50:26,432 INFO Enhanced SRL enabled: True
2025-06-13 18:50:26,432 INFO Noise-Aware Loss enabled: True
2025-06-13 18:50:26,432 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 18:50:26,433 INFO Evaluation will be performed every 10 steps
2025-06-13 18:50:45,093 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 18:54:17,121 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_185417.txt
2025-06-13 18:54:17,122 INFO Test completed successfully!
2025-06-13 20:32:25,345 INFO Starting component loss verification...
2025-06-13 20:32:25,345 INFO Configuration - use_dual_path_srl: True
2025-06-13 20:32:25,346 INFO Configuration - use_enhanced_srl: True
2025-06-13 20:32:25,346 INFO Configuration - use_ca_tsu: True
2025-06-13 20:32:25,346 INFO Configuration - use_noise_aware_loss: True
2025-06-13 20:32:25,346 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 20:32:25,352 ERROR Missing components: enhanced_srl_loss_raw, causal_consistency_loss_raw, noise_aware_loss_raw
2025-06-13 20:32:59,218 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 20:32:59,218 INFO Configuration - use_dual_path_srl: True
2025-06-13 20:32:59,218 INFO Configuration - use_enhanced_srl: True
2025-06-13 20:32:59,218 INFO Configuration - use_ca_tsu: True
2025-06-13 20:32:59,219 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 20:32:59,219 INFO Configuration - use_noise_aware_loss: True
2025-06-13 20:32:59,219 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 20:32:59,219 INFO Configuration - variant_type: hedge
2025-06-13 20:32:59,220 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 20:32:59,222 INFO Start graph assembling...
2025-06-13 20:33:01,094 INFO use_dual_path_srl: True
2025-06-13 20:33:01,094 INFO variant_type: hedge
2025-06-13 20:33:01,094 INFO use_enhanced_srl: True
2025-06-13 20:33:01,094 INFO Enhanced SRL enabled from config
2025-06-13 20:33:01,095 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 20:33:01,095 INFO SRL condition: True = True and True
2025-06-13 20:33:01,095 INFO Using enhanced dual-path SRL architecture
2025-06-13 20:33:01,095 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 20:33:01,147 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 20:33:01,152 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 20:33:01,175 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 20:33:01,416 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 20:33:01,417 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 20:33:01,418 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 20:33:01,846 INFO Using Temporal Attention (TAP)
2025-06-13 20:33:01,890 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 20:33:01,891 INFO Ca-TSU enabled: True
2025-06-13 20:33:01,891 INFO Ca-TSU weight: 0.3
2025-06-13 20:33:01,892 INFO Causal loss lambda: 0.3
2025-06-13 20:33:01,892 INFO Enhanced SRL enabled: True
2025-06-13 20:33:01,892 INFO Noise-Aware Loss enabled: True
2025-06-13 20:33:01,892 INFO Noise-Aware weight: 0.5
2025-06-13 20:33:01,903 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:01,904 INFO Creating enhanced SRL loss...
2025-06-13 20:33:01,904 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 20:33:01,907 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 20:33:01,916 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 20:33:01,926 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:01,927 INFO Creating reliability weights for noise-aware loss
2025-06-13 20:33:01,933 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 20:33:01,934 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 20:33:01,938 INFO Created W_reliability with shape: (100, 1)
2025-06-13 20:33:01,941 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 20:33:01,956 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 20:33:02,005 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 20:33:02,006 INFO Loss component verification:
2025-06-13 20:33:02,006 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 20:33:02,006 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 20:33:02,006 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 20:33:02,007 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 20:33:02,007 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 20:33:02,014 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 20:33:02,015 INFO Loss component verification:
2025-06-13 20:33:02,015 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 20:33:02,016 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 20:33:02,016 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 20:33:02,016 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 20:33:02,016 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 20:33:05,666 INFO Graph assembled successfully.
2025-06-13 20:33:05,992 INFO Verifying model configuration...
2025-06-13 20:33:05,992 INFO Ca-TSU enabled: True
2025-06-13 20:33:05,992 INFO Enhanced SRL enabled: True
2025-06-13 20:33:05,993 INFO Noise-Aware Loss enabled: True
2025-06-13 20:33:05,993 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 20:33:05,993 INFO Evaluation will be performed every 10 steps
2025-06-13 20:33:24,320 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:13:26,405 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:13:26,406 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:13:26,406 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:13:26,406 INFO Configuration - use_ca_tsu: True
2025-06-13 23:13:26,406 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:13:26,407 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:13:26,407 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:13:26,407 INFO Configuration - variant_type: hedge
2025-06-13 23:13:26,408 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:13:26,410 INFO Start graph assembling...
2025-06-13 23:13:28,109 INFO use_dual_path_srl: True
2025-06-13 23:13:28,109 INFO variant_type: hedge
2025-06-13 23:13:28,110 INFO use_enhanced_srl: True
2025-06-13 23:13:28,110 INFO Enhanced SRL enabled from config
2025-06-13 23:13:28,110 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:13:28,111 INFO SRL condition: True = True and True
2025-06-13 23:13:28,111 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:13:28,111 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:13:28,154 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:13:28,159 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:13:28,177 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:13:28,396 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:13:28,397 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:13:28,397 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:13:28,787 INFO Using Temporal Attention (TAP)
2025-06-13 23:13:28,830 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:13:28,831 INFO Ca-TSU enabled: True
2025-06-13 23:13:28,831 INFO Ca-TSU weight: 0.3
2025-06-13 23:13:28,831 INFO Causal loss lambda: 0.3
2025-06-13 23:13:28,831 INFO Enhanced SRL enabled: True
2025-06-13 23:13:28,832 INFO Noise-Aware Loss enabled: True
2025-06-13 23:13:28,832 INFO Noise-Aware weight: 0.5
2025-06-13 23:13:28,843 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,843 INFO Creating enhanced SRL loss...
2025-06-13 23:13:28,843 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:13:28,847 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:13:28,856 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:13:28,866 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,866 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:13:28,873 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:13:28,874 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:13:28,879 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:13:28,882 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:13:28,900 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:13:28,951 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:13:28,951 INFO Loss component verification:
2025-06-13 23:13:28,952 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:13:28,952 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:13:28,952 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:13:28,952 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:13:28,952 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:13:28,960 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:13:28,960 INFO Loss component verification:
2025-06-13 23:13:28,960 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:13:28,961 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:13:28,961 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:13:28,961 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:13:28,962 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:13:32,487 INFO Graph assembled successfully.
2025-06-13 23:13:32,807 INFO Verifying model configuration...
2025-06-13 23:13:32,808 INFO Ca-TSU enabled: True
2025-06-13 23:13:32,808 INFO Enhanced SRL enabled: True
2025-06-13 23:13:32,809 INFO Noise-Aware Loss enabled: True
2025-06-13 23:13:32,809 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:13:32,809 INFO Evaluation will be performed every 10 steps
2025-06-13 23:14:52,028 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:14:52,030 INFO Start graph assembling...
2025-06-13 23:14:53,705 INFO use_dual_path_srl: True
2025-06-13 23:14:53,706 INFO variant_type: hedge
2025-06-13 23:14:53,706 INFO use_enhanced_srl: True
2025-06-13 23:14:53,706 INFO Enhanced SRL enabled from config
2025-06-13 23:14:53,707 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:14:53,707 INFO SRL condition: True = True and True
2025-06-13 23:14:53,707 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:14:53,708 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:14:53,750 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:14:53,755 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:14:53,773 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:14:53,988 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:14:53,989 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:14:53,989 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:14:54,378 INFO Using Temporal Attention (TAP)
2025-06-13 23:14:54,422 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:14:54,422 INFO Ca-TSU enabled: True
2025-06-13 23:14:54,423 INFO Ca-TSU weight: 0.3
2025-06-13 23:14:54,423 INFO Causal loss lambda: 0.3
2025-06-13 23:14:54,423 INFO Enhanced SRL enabled: True
2025-06-13 23:14:54,424 INFO Noise-Aware Loss enabled: True
2025-06-13 23:14:54,424 INFO Noise-Aware weight: 0.5
2025-06-13 23:14:54,435 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,435 INFO Creating enhanced SRL loss...
2025-06-13 23:14:54,436 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:14:54,439 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:14:54,447 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:14:54,458 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,458 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:14:54,465 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:14:54,465 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:14:54,470 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:14:54,473 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:14:54,487 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:14:54,538 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:14:54,539 INFO Loss component verification:
2025-06-13 23:14:54,539 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:14:54,539 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:14:54,539 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:14:54,540 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:14:54,540 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:14:54,548 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:14:54,548 INFO Loss component verification:
2025-06-13 23:14:54,548 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:14:54,548 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:14:54,549 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:14:54,549 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:14:54,549 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:14:58,081 INFO Graph assembled successfully.
2025-06-13 23:14:58,402 INFO Verifying model configuration...
2025-06-13 23:14:58,402 INFO Ca-TSU enabled: True
2025-06-13 23:14:58,402 INFO Enhanced SRL enabled: True
2025-06-13 23:14:58,403 INFO Noise-Aware Loss enabled: True
2025-06-13 23:14:58,403 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:14:58,403 INFO Evaluation will be performed every 10 steps
2025-06-13 23:15:16,473 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:29:03,586 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:29:03,586 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:29:03,586 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:29:03,586 INFO Configuration - use_ca_tsu: True
2025-06-13 23:29:03,587 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:29:03,587 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:29:03,587 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:29:03,587 INFO Configuration - variant_type: hedge
2025-06-13 23:29:03,588 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:29:03,589 INFO Start graph assembling...
2025-06-13 23:29:05,368 INFO use_dual_path_srl: True
2025-06-13 23:29:05,368 INFO variant_type: hedge
2025-06-13 23:29:05,369 INFO use_enhanced_srl: True
2025-06-13 23:29:05,369 INFO Enhanced SRL enabled from config
2025-06-13 23:29:05,369 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:29:05,370 INFO SRL condition: True = True and True
2025-06-13 23:29:05,370 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:29:05,370 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:29:05,418 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:29:05,422 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:29:05,442 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:29:05,666 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:29:05,666 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:29:05,666 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:29:06,076 INFO Using Temporal Attention (TAP)
2025-06-13 23:29:06,120 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:29:06,121 INFO Ca-TSU enabled: True
2025-06-13 23:29:06,121 INFO Ca-TSU weight: 0.3
2025-06-13 23:29:06,121 INFO Causal loss lambda: 0.3
2025-06-13 23:29:06,122 INFO Enhanced SRL enabled: True
2025-06-13 23:29:06,122 INFO Noise-Aware Loss enabled: True
2025-06-13 23:29:06,122 INFO Noise-Aware weight: 0.5
2025-06-13 23:29:06,132 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,132 INFO Creating enhanced SRL loss...
2025-06-13 23:29:06,133 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:29:06,136 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:29:06,145 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:29:06,156 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,156 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:29:06,162 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:29:06,162 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:29:06,167 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:29:06,170 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:29:06,185 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:29:06,236 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:29:06,237 INFO Loss component verification:
2025-06-13 23:29:06,237 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:29:06,237 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:29:06,238 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:29:06,238 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:29:06,238 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:29:06,246 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:29:06,247 INFO Loss component verification:
2025-06-13 23:29:06,247 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:29:06,248 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:29:06,248 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:29:06,248 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:29:06,248 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:29:09,946 INFO Graph assembled successfully.
2025-06-13 23:29:10,568 INFO Verifying model configuration...
2025-06-13 23:29:10,570 INFO Ca-TSU enabled: True
2025-06-13 23:29:10,570 INFO Enhanced SRL enabled: True
2025-06-13 23:29:10,570 INFO Noise-Aware Loss enabled: True
2025-06-13 23:29:10,570 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:29:10,571 INFO Evaluation will be performed every 10 steps
2025-06-13 23:29:29,428 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:33:03,573 INFO Epoch: loss: 0.980134, acc: 0.515625
2025-06-13 23:35:01,616 INFO 	Eval, eval loss: 0.8753952383995056, acc: 0.518293
2025-06-13 23:35:01,883 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_233501.txt
2025-06-13 23:35:01,883 INFO Test completed successfully!
2025-06-13 23:38:30,045 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-13 23:38:30,045 INFO Configuration - use_dual_path_srl: True
2025-06-13 23:38:30,045 INFO Configuration - use_enhanced_srl: True
2025-06-13 23:38:30,046 INFO Configuration - use_ca_tsu: True
2025-06-13 23:38:30,046 INFO Configuration - causal_loss_lambda: 0.3
2025-06-13 23:38:30,046 INFO Configuration - use_noise_aware_loss: True
2025-06-13 23:38:30,046 INFO Configuration - noise_aware_weight: 0.5
2025-06-13 23:38:30,046 INFO Configuration - variant_type: hedge
2025-06-13 23:38:30,047 INFO Full model configuration:
2025-06-13 23:38:30,047 INFO   alpha: 0.5
2025-06-13 23:38:30,047 INFO   batch_size: 32
2025-06-13 23:38:30,047 INFO   ca_tsu_weight: 0.3
2025-06-13 23:38:30,047 INFO   causal_loss_lambda: 0.3
2025-06-13 23:38:30,047 INFO   clip: 15.0
2025-06-13 23:38:30,048 INFO   consistency_loss_weight: 0.05
2025-06-13 23:38:30,048 INFO   constant_kl_lambda: 0.1
2025-06-13 23:38:30,048 INFO   daily_att: y
2025-06-13 23:38:30,048 INFO   decay_rate: 0.96
2025-06-13 23:38:30,048 INFO   decay_step: 100
2025-06-13 23:38:30,048 INFO   dropout_ce: 0.0
2025-06-13 23:38:30,049 INFO   dropout_mel: 0.0
2025-06-13 23:38:30,049 INFO   dropout_mel_in: 0.3
2025-06-13 23:38:30,049 INFO   dropout_vmd: 0.0
2025-06-13 23:38:30,049 INFO   dropout_vmd_in: 0.3
2025-06-13 23:38:30,049 INFO   enhanced_srl_weight: 0.1
2025-06-13 23:38:30,050 INFO   entropy_regularization_lambda: 0.001
2025-06-13 23:38:30,050 INFO   g_size: 50
2025-06-13 23:38:30,050 INFO   h_size: 150
2025-06-13 23:38:30,050 INFO   init_stock_with_word: 0
2025-06-13 23:38:30,050 INFO   kl_lambda_anneal_rate: 0.005
2025-06-13 23:38:30,050 INFO   kl_lambda_start_step: 0
2025-06-13 23:38:30,051 INFO   lr: 0.001
2025-06-13 23:38:30,051 INFO   max_n_days: 5
2025-06-13 23:38:30,051 INFO   max_n_msgs: 20
2025-06-13 23:38:30,051 INFO   max_n_words: 30
2025-06-13 23:38:30,051 INFO   mel_cell_type: gru
2025-06-13 23:38:30,052 INFO   mel_h_size: 100
2025-06-13 23:38:30,052 INFO   mode: all
2025-06-13 23:38:30,052 INFO   momentum: 0.9
2025-06-13 23:38:30,052 INFO   msin_h_size: 100
2025-06-13 23:38:30,052 INFO   n_epochs: 10
2025-06-13 23:38:30,052 INFO   noise_aware_weight: 0.5
2025-06-13 23:38:30,053 INFO   opt: adam
2025-06-13 23:38:30,053 INFO   pathway_competition_type: dynamic
2025-06-13 23:38:30,053 INFO   prediction_loss_weight: 0.1
2025-06-13 23:38:30,053 INFO   residual_connection_weight: 0.1
2025-06-13 23:38:30,053 INFO   shuffle: 1
2025-06-13 23:38:30,053 INFO   stock_embed_size: 150
2025-06-13 23:38:30,054 INFO   td_temporal_attention: True
2025-06-13 23:38:30,054 INFO   use_ca_tsu: True
2025-06-13 23:38:30,054 INFO   use_constant_kl_lambda: 0
2025-06-13 23:38:30,054 INFO   use_dual_path_srl: True
2025-06-13 23:38:30,054 INFO   use_enhanced_srl: True
2025-06-13 23:38:30,054 INFO   use_g_bn: 0
2025-06-13 23:38:30,055 INFO   use_in_bn: 0
2025-06-13 23:38:30,055 INFO   use_noise_aware_loss: True
2025-06-13 23:38:30,055 INFO   use_o_bn: 0
2025-06-13 23:38:30,055 INFO   variant_type: hedge
2025-06-13 23:38:30,055 INFO   vmd_cell_type: gru
2025-06-13 23:38:30,056 INFO   vmd_rec: zh
2025-06-13 23:38:30,056 INFO   volatility_adaptation_factor: 0.3
2025-06-13 23:38:30,056 INFO   volatility_reg_weight: 0.05
2025-06-13 23:38:30,056 INFO   weight_init: xavier-uniform
2025-06-13 23:38:30,056 INFO   word_embed_size: 50
2025-06-13 23:38:30,057 INFO   word_embed_type: glove
2025-06-13 23:38:30,057 INFO   y_size: 2
2025-06-13 23:38:30,057 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-13 23:38:30,060 INFO Start graph assembling...
2025-06-13 23:38:31,848 INFO use_dual_path_srl: True
2025-06-13 23:38:31,849 INFO variant_type: hedge
2025-06-13 23:38:31,849 INFO use_enhanced_srl: True
2025-06-13 23:38:31,849 INFO Enhanced SRL enabled from config
2025-06-13 23:38:31,849 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-13 23:38:31,849 INFO SRL condition: True = True and True
2025-06-13 23:38:31,850 INFO Using enhanced dual-path SRL architecture
2025-06-13 23:38:31,850 INFO Creating Enhanced Dual-Path SRL module...
2025-06-13 23:38:31,895 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-13 23:38:31,899 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-13 23:38:31,918 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-13 23:38:32,143 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-13 23:38:32,143 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-13 23:38:32,144 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-13 23:38:32,566 INFO Using Temporal Attention (TAP)
2025-06-13 23:38:32,610 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-13 23:38:32,611 INFO Ca-TSU enabled: True
2025-06-13 23:38:32,611 INFO Ca-TSU weight: 0.3
2025-06-13 23:38:32,611 INFO Causal loss lambda: 0.3
2025-06-13 23:38:32,612 INFO Enhanced SRL enabled: True
2025-06-13 23:38:32,612 INFO Noise-Aware Loss enabled: True
2025-06-13 23:38:32,612 INFO Noise-Aware weight: 0.5
2025-06-13 23:38:32,622 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,623 INFO Creating enhanced SRL loss...
2025-06-13 23:38:32,623 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-13 23:38:32,626 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-13 23:38:32,635 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-13 23:38:32,646 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,646 INFO Creating reliability weights for noise-aware loss
2025-06-13 23:38:32,652 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:38:32,653 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-13 23:38:32,658 INFO Created W_reliability with shape: (100, 1)
2025-06-13 23:38:32,660 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-13 23:38:32,675 INFO Adding causal consistency loss with lambda: 0.3
2025-06-13 23:38:32,726 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-13 23:38:32,726 INFO Loss component verification:
2025-06-13 23:38:32,727 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:38:32,727 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:38:32,727 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:38:32,727 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:38:32,727 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:38:32,735 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-13 23:38:32,735 INFO Loss component verification:
2025-06-13 23:38:32,735 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-13 23:38:32,736 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-13 23:38:32,736 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-13 23:38:32,736 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-13 23:38:32,736 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-13 23:38:36,649 INFO Graph assembled successfully.
2025-06-13 23:38:37,006 INFO Verifying model configuration...
2025-06-13 23:38:37,006 INFO Ca-TSU enabled: True
2025-06-13 23:38:37,007 INFO Enhanced SRL enabled: True
2025-06-13 23:38:37,007 INFO Noise-Aware Loss enabled: True
2025-06-13 23:38:37,007 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-13 23:38:37,007 INFO Evaluation will be performed every 10 steps
2025-06-13 23:38:57,467 INFO ASSEMBLE: word table #replacement: 19482
2025-06-13 23:43:03,260 INFO Epoch: loss: 0.950624, acc: 0.531250
2025-06-13 23:44:53,544 INFO 	Eval, eval loss: 0.8483394980430603, acc: 0.500000
2025-06-13 23:44:53,778 INFO Test summary saved to results/model_test/enhancement_test_summary_20250613_234453.txt
2025-06-13 23:44:53,779 INFO Test completed successfully!
2025-06-14 02:26:10,152 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 02:26:10,152 INFO Configuration - use_dual_path_srl: True
2025-06-14 02:26:10,153 INFO Configuration - use_enhanced_srl: True
2025-06-14 02:26:10,153 INFO Configuration - use_ca_tsu: True
2025-06-14 02:26:10,153 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 02:26:10,153 INFO Configuration - use_noise_aware_loss: True
2025-06-14 02:26:10,153 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 02:26:10,153 INFO Configuration - variant_type: hedge
2025-06-14 02:26:10,154 INFO Full model configuration:
2025-06-14 02:26:10,154 INFO   alpha: 0.5
2025-06-14 02:26:10,154 INFO   batch_size: 32
2025-06-14 02:26:10,154 INFO   ca_tsu_weight: 0.3
2025-06-14 02:26:10,155 INFO   causal_loss_lambda: 0.3
2025-06-14 02:26:10,155 INFO   clip: 15.0
2025-06-14 02:26:10,155 INFO   consistency_loss_weight: 0.05
2025-06-14 02:26:10,155 INFO   constant_kl_lambda: 0.1
2025-06-14 02:26:10,156 INFO   daily_att: y
2025-06-14 02:26:10,156 INFO   decay_rate: 0.96
2025-06-14 02:26:10,156 INFO   decay_step: 100
2025-06-14 02:26:10,156 INFO   dropout_ce: 0.0
2025-06-14 02:26:10,156 INFO   dropout_mel: 0.0
2025-06-14 02:26:10,157 INFO   dropout_mel_in: 0.3
2025-06-14 02:26:10,157 INFO   dropout_vmd: 0.0
2025-06-14 02:26:10,157 INFO   dropout_vmd_in: 0.3
2025-06-14 02:26:10,157 INFO   enhanced_srl_weight: 0.1
2025-06-14 02:26:10,157 INFO   entropy_regularization_lambda: 0.001
2025-06-14 02:26:10,158 INFO   g_size: 50
2025-06-14 02:26:10,158 INFO   h_size: 150
2025-06-14 02:26:10,158 INFO   init_stock_with_word: 0
2025-06-14 02:26:10,158 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 02:26:10,159 INFO   kl_lambda_start_step: 0
2025-06-14 02:26:10,159 INFO   lr: 0.001
2025-06-14 02:26:10,159 INFO   max_n_days: 5
2025-06-14 02:26:10,159 INFO   max_n_msgs: 20
2025-06-14 02:26:10,159 INFO   max_n_words: 30
2025-06-14 02:26:10,159 INFO   mel_cell_type: gru
2025-06-14 02:26:10,160 INFO   mel_h_size: 100
2025-06-14 02:26:10,160 INFO   mode: all
2025-06-14 02:26:10,160 INFO   momentum: 0.9
2025-06-14 02:26:10,160 INFO   msin_h_size: 100
2025-06-14 02:26:10,161 INFO   n_epochs: 10
2025-06-14 02:26:10,161 INFO   noise_aware_weight: 0.5
2025-06-14 02:26:10,161 INFO   opt: adam
2025-06-14 02:26:10,161 INFO   pathway_competition_type: dynamic
2025-06-14 02:26:10,161 INFO   prediction_loss_weight: 0.1
2025-06-14 02:26:10,162 INFO   residual_connection_weight: 0.1
2025-06-14 02:26:10,162 INFO   shuffle: 1
2025-06-14 02:26:10,162 INFO   stock_embed_size: 150
2025-06-14 02:26:10,162 INFO   td_temporal_attention: True
2025-06-14 02:26:10,162 INFO   use_ca_tsu: True
2025-06-14 02:26:10,163 INFO   use_constant_kl_lambda: 0
2025-06-14 02:26:10,163 INFO   use_dual_path_srl: True
2025-06-14 02:26:10,163 INFO   use_enhanced_srl: True
2025-06-14 02:26:10,163 INFO   use_g_bn: 0
2025-06-14 02:26:10,163 INFO   use_in_bn: 0
2025-06-14 02:26:10,164 INFO   use_noise_aware_loss: True
2025-06-14 02:26:10,164 INFO   use_o_bn: 0
2025-06-14 02:26:10,164 INFO   variant_type: hedge
2025-06-14 02:26:10,164 INFO   vmd_cell_type: gru
2025-06-14 02:26:10,164 INFO   vmd_rec: zh
2025-06-14 02:26:10,165 INFO   volatility_adaptation_factor: 0.3
2025-06-14 02:26:10,165 INFO   volatility_reg_weight: 0.05
2025-06-14 02:26:10,165 INFO   weight_init: xavier-uniform
2025-06-14 02:26:10,165 INFO   word_embed_size: 50
2025-06-14 02:26:10,165 INFO   word_embed_type: glove
2025-06-14 02:26:10,166 INFO   y_size: 2
2025-06-14 02:26:10,166 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 02:26:10,172 INFO Start graph assembling...
2025-06-14 02:26:11,941 INFO use_dual_path_srl: True
2025-06-14 02:26:11,942 INFO variant_type: hedge
2025-06-14 02:26:11,943 INFO use_enhanced_srl: True
2025-06-14 02:26:11,943 INFO Enhanced SRL enabled from config
2025-06-14 02:26:11,943 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 02:26:11,944 INFO SRL condition: True = True and True
2025-06-14 02:26:11,944 INFO Using enhanced dual-path SRL architecture
2025-06-14 02:26:11,944 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 02:26:11,989 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 02:26:11,994 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 02:26:12,013 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 02:26:12,236 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 02:26:12,236 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 02:26:12,236 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 02:26:12,636 INFO Using Temporal Attention (TAP)
2025-06-14 02:26:12,680 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 02:26:12,680 INFO Ca-TSU enabled: True
2025-06-14 02:26:12,680 INFO Ca-TSU weight: 0.3
2025-06-14 02:26:12,680 INFO Causal loss lambda: 0.3
2025-06-14 02:26:12,680 INFO Enhanced SRL enabled: True
2025-06-14 02:26:12,680 INFO Noise-Aware Loss enabled: True
2025-06-14 02:26:12,682 INFO Noise-Aware weight: 0.5
2025-06-14 02:26:12,692 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,693 INFO Creating enhanced SRL loss...
2025-06-14 02:26:12,693 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 02:26:12,697 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 02:26:12,706 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 02:26:12,718 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,718 INFO Creating reliability weights for noise-aware loss
2025-06-14 02:26:12,725 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:26:12,726 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 02:26:12,731 INFO Created W_reliability with shape: (100, 1)
2025-06-14 02:26:12,734 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:26:12,750 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 02:26:12,800 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 02:26:12,801 INFO Loss component verification:
2025-06-14 02:26:12,801 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:26:12,801 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:26:12,801 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:26:12,802 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:26:12,802 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:26:12,809 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:26:12,810 INFO Loss component verification:
2025-06-14 02:26:12,810 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:26:12,810 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:26:12,812 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:26:12,812 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:26:12,812 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:26:16,495 INFO Graph assembled successfully.
2025-06-14 02:26:16,820 INFO Verifying model configuration...
2025-06-14 02:26:16,820 INFO Ca-TSU enabled: True
2025-06-14 02:26:16,822 INFO Enhanced SRL enabled: True
2025-06-14 02:26:16,822 INFO Noise-Aware Loss enabled: True
2025-06-14 02:26:16,822 INFO Checking model components for noise-aware loss...
2025-06-14 02:26:16,822 INFO Model has 'use_noise_aware_loss': True
2025-06-14 02:26:16,822 INFO use_noise_aware_loss value: True
2025-06-14 02:26:16,823 INFO Model has 'noise_aware_weight': True
2025-06-14 02:26:16,823 INFO noise_aware_weight value: 0.5
2025-06-14 02:26:16,823 INFO Model has 'noise_aware_loss': True
2025-06-14 02:26:16,823 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 02:26:16,824 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 02:26:16,824 INFO Model has 'reliability_weights': True
2025-06-14 02:26:16,824 INFO Model has 'use_enhanced_srl': True
2025-06-14 02:26:16,824 INFO use_enhanced_srl value: True
2025-06-14 02:26:16,825 INFO Model has 'enhanced_srl_loss': True
2025-06-14 02:26:16,825 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 02:26:16,825 INFO Model has 'use_ca_tsu': True
2025-06-14 02:26:16,825 INFO use_ca_tsu value: True
2025-06-14 02:26:16,825 INFO Model has 'causal_consistency_loss': True
2025-06-14 02:26:16,826 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 02:26:16,826 INFO Model has 'loss_components': True
2025-06-14 02:26:16,826 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 02:26:16,826 INFO Manually activating loss components...
2025-06-14 02:26:16,826 INFO Components manually activated:
2025-06-14 02:26:16,827 INFO use_enhanced_srl: True
2025-06-14 02:26:16,827 INFO use_ca_tsu: True
2025-06-14 02:26:16,827 INFO use_noise_aware_loss: True
2025-06-14 02:26:16,827 INFO use_dual_path_srl: True
2025-06-14 02:26:16,827 INFO Running test with Ca-TSU, Enhanced SRL, and Noise-Aware Loss for 50 batches
2025-06-14 02:26:16,828 INFO Evaluation will be performed every 10 steps
2025-06-14 02:26:36,444 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 02:31:17,270 INFO Epoch: loss: 0.958961, acc: 0.515625
2025-06-14 02:33:24,213 INFO 	Eval, eval loss: 0.8459105491638184, acc: 0.521341
2025-06-14 02:33:24,561 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_023324.txt
2025-06-14 02:33:24,562 INFO Test completed successfully!
2025-06-14 02:45:00,050 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 02:45:00,050 INFO Configuration - use_dual_path_srl: True
2025-06-14 02:45:00,052 INFO Configuration - use_enhanced_srl: True
2025-06-14 02:45:00,052 INFO Configuration - use_ca_tsu: True
2025-06-14 02:45:00,052 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 02:45:00,052 INFO Configuration - use_noise_aware_loss: True
2025-06-14 02:45:00,053 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 02:45:00,053 INFO Configuration - variant_type: hedge
2025-06-14 02:45:00,053 INFO Full model configuration:
2025-06-14 02:45:00,053 INFO   alpha: 0.5
2025-06-14 02:45:00,054 INFO   batch_size: 32
2025-06-14 02:45:00,054 INFO   ca_tsu_weight: 0.3
2025-06-14 02:45:00,054 INFO   causal_loss_lambda: 0.3
2025-06-14 02:45:00,054 INFO   clip: 15.0
2025-06-14 02:45:00,055 INFO   consistency_loss_weight: 0.05
2025-06-14 02:45:00,055 INFO   constant_kl_lambda: 0.1
2025-06-14 02:45:00,055 INFO   daily_att: y
2025-06-14 02:45:00,055 INFO   decay_rate: 0.96
2025-06-14 02:45:00,055 INFO   decay_step: 100
2025-06-14 02:45:00,056 INFO   dropout_ce: 0.0
2025-06-14 02:45:00,056 INFO   dropout_mel: 0.0
2025-06-14 02:45:00,056 INFO   dropout_mel_in: 0.3
2025-06-14 02:45:00,056 INFO   dropout_vmd: 0.0
2025-06-14 02:45:00,057 INFO   dropout_vmd_in: 0.3
2025-06-14 02:45:00,057 INFO   enhanced_srl_weight: 0.1
2025-06-14 02:45:00,057 INFO   entropy_regularization_lambda: 0.001
2025-06-14 02:45:00,057 INFO   g_size: 50
2025-06-14 02:45:00,058 INFO   h_size: 150
2025-06-14 02:45:00,058 INFO   init_stock_with_word: 0
2025-06-14 02:45:00,058 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 02:45:00,058 INFO   kl_lambda_start_step: 0
2025-06-14 02:45:00,058 INFO   lr: 0.001
2025-06-14 02:45:00,059 INFO   max_n_days: 5
2025-06-14 02:45:00,059 INFO   max_n_msgs: 20
2025-06-14 02:45:00,059 INFO   max_n_words: 30
2025-06-14 02:45:00,059 INFO   mel_cell_type: gru
2025-06-14 02:45:00,060 INFO   mel_h_size: 100
2025-06-14 02:45:00,060 INFO   mode: all
2025-06-14 02:45:00,060 INFO   momentum: 0.9
2025-06-14 02:45:00,060 INFO   msin_h_size: 100
2025-06-14 02:45:00,061 INFO   n_epochs: 10
2025-06-14 02:45:00,061 INFO   noise_aware_weight: 0.5
2025-06-14 02:45:00,061 INFO   opt: adam
2025-06-14 02:45:00,061 INFO   pathway_competition_type: dynamic
2025-06-14 02:45:00,062 INFO   prediction_loss_weight: 0.1
2025-06-14 02:45:00,062 INFO   residual_connection_weight: 0.1
2025-06-14 02:45:00,062 INFO   shuffle: 1
2025-06-14 02:45:00,062 INFO   stock_embed_size: 150
2025-06-14 02:45:00,062 INFO   td_temporal_attention: True
2025-06-14 02:45:00,062 INFO   use_ca_tsu: True
2025-06-14 02:45:00,063 INFO   use_constant_kl_lambda: 0
2025-06-14 02:45:00,063 INFO   use_dual_path_srl: True
2025-06-14 02:45:00,063 INFO   use_enhanced_srl: True
2025-06-14 02:45:00,063 INFO   use_g_bn: 0
2025-06-14 02:45:00,063 INFO   use_in_bn: 0
2025-06-14 02:45:00,064 INFO   use_noise_aware_loss: True
2025-06-14 02:45:00,064 INFO   use_o_bn: 0
2025-06-14 02:45:00,064 INFO   variant_type: hedge
2025-06-14 02:45:00,064 INFO   vmd_cell_type: gru
2025-06-14 02:45:00,064 INFO   vmd_rec: zh
2025-06-14 02:45:00,065 INFO   volatility_adaptation_factor: 0.3
2025-06-14 02:45:00,065 INFO   volatility_reg_weight: 0.05
2025-06-14 02:45:00,065 INFO   weight_init: xavier-uniform
2025-06-14 02:45:00,065 INFO   word_embed_size: 50
2025-06-14 02:45:00,066 INFO   word_embed_type: glove
2025-06-14 02:45:00,066 INFO   y_size: 2
2025-06-14 02:45:00,067 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 02:45:00,069 INFO Start graph assembling...
2025-06-14 02:45:01,955 INFO use_dual_path_srl: True
2025-06-14 02:45:01,956 INFO variant_type: hedge
2025-06-14 02:45:01,956 INFO use_enhanced_srl: True
2025-06-14 02:45:01,956 INFO Enhanced SRL enabled from config
2025-06-14 02:45:01,956 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 02:45:01,956 INFO SRL condition: True = True and True
2025-06-14 02:45:01,956 INFO Using enhanced dual-path SRL architecture
2025-06-14 02:45:01,957 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 02:45:02,000 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 02:45:02,006 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 02:45:02,024 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 02:45:02,250 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 02:45:02,250 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 02:45:02,251 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 02:45:02,660 INFO Using Temporal Attention (TAP)
2025-06-14 02:45:02,703 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 02:45:02,704 INFO Ca-TSU enabled: True
2025-06-14 02:45:02,704 INFO Ca-TSU weight: 0.3
2025-06-14 02:45:02,704 INFO Causal loss lambda: 0.3
2025-06-14 02:45:02,704 INFO Enhanced SRL enabled: True
2025-06-14 02:45:02,705 INFO Noise-Aware Loss enabled: True
2025-06-14 02:45:02,705 INFO Noise-Aware weight: 0.5
2025-06-14 02:45:02,715 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,716 INFO Creating enhanced SRL loss...
2025-06-14 02:45:02,716 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 02:45:02,719 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 02:45:02,727 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 02:45:02,738 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,738 INFO Creating reliability weights for noise-aware loss
2025-06-14 02:45:02,744 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:45:02,745 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 02:45:02,750 INFO Created W_reliability with shape: (100, 1)
2025-06-14 02:45:02,752 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 02:45:02,769 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 02:45:02,819 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 02:45:02,819 INFO Loss component verification:
2025-06-14 02:45:02,819 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:45:02,820 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:45:02,820 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:45:02,820 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:45:02,820 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:45:02,828 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 02:45:02,828 INFO Loss component verification:
2025-06-14 02:45:02,828 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 02:45:02,829 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 02:45:02,829 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 02:45:02,829 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 02:45:02,829 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 02:45:07,349 INFO Graph assembled successfully.
2025-06-14 02:45:07,691 INFO Verifying model configuration...
2025-06-14 02:45:07,692 INFO Ca-TSU enabled: True
2025-06-14 02:45:07,692 INFO Enhanced SRL enabled: True
2025-06-14 02:45:07,692 INFO Noise-Aware Loss enabled: True
2025-06-14 02:45:07,694 INFO Checking model components for noise-aware loss...
2025-06-14 02:45:07,694 INFO Model has 'use_noise_aware_loss': True
2025-06-14 02:45:07,695 INFO use_noise_aware_loss value: True
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_weight': True
2025-06-14 02:45:07,695 INFO noise_aware_weight value: 0.5
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_loss': True
2025-06-14 02:45:07,695 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 02:45:07,695 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 02:45:07,696 INFO Model has 'reliability_weights': True
2025-06-14 02:45:07,696 INFO Model has 'use_enhanced_srl': True
2025-06-14 02:45:07,696 INFO use_enhanced_srl value: True
2025-06-14 02:45:07,696 INFO Model has 'enhanced_srl_loss': True
2025-06-14 02:45:07,697 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 02:45:07,697 INFO Model has 'use_ca_tsu': True
2025-06-14 02:45:07,697 INFO use_ca_tsu value: True
2025-06-14 02:45:07,697 INFO Model has 'causal_consistency_loss': True
2025-06-14 02:45:07,697 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 02:45:07,697 INFO Model has 'loss_components': True
2025-06-14 02:45:07,698 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 02:45:07,698 INFO Manually activating loss components...
2025-06-14 02:45:07,698 INFO Components manually activated:
2025-06-14 02:45:07,698 INFO use_enhanced_srl: True
2025-06-14 02:45:07,698 INFO use_ca_tsu: True
2025-06-14 02:45:07,699 INFO use_noise_aware_loss: True
2025-06-14 02:45:07,699 INFO use_dual_path_srl: True
2025-06-14 02:45:07,699 INFO Running test_noise_aware_loss...
2025-06-14 02:45:27,274 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 02:49:57,864 INFO Epoch: loss: 0.994126, acc: 0.540625
2025-06-14 02:52:07,056 INFO 	Eval, eval loss: 0.8706127405166626, acc: 0.510671
2025-06-14 02:52:07,326 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_025207.txt
2025-06-14 02:52:07,327 INFO Test completed successfully!
2025-06-14 03:10:31,188 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-14 03:10:31,189 INFO Configuration - use_dual_path_srl: True
2025-06-14 03:10:31,189 INFO Configuration - use_enhanced_srl: True
2025-06-14 03:10:31,189 INFO Configuration - use_ca_tsu: True
2025-06-14 03:10:31,189 INFO Configuration - causal_loss_lambda: 0.3
2025-06-14 03:10:31,189 INFO Configuration - use_noise_aware_loss: True
2025-06-14 03:10:31,190 INFO Configuration - noise_aware_weight: 0.5
2025-06-14 03:10:31,190 INFO Configuration - variant_type: hedge
2025-06-14 03:10:31,190 INFO Full model configuration:
2025-06-14 03:10:31,190 INFO   alpha: 0.5
2025-06-14 03:10:31,190 INFO   batch_size: 32
2025-06-14 03:10:31,191 INFO   ca_tsu_weight: 0.3
2025-06-14 03:10:31,191 INFO   causal_loss_lambda: 0.3
2025-06-14 03:10:31,191 INFO   clip: 15.0
2025-06-14 03:10:31,191 INFO   consistency_loss_weight: 0.05
2025-06-14 03:10:31,191 INFO   constant_kl_lambda: 0.1
2025-06-14 03:10:31,191 INFO   daily_att: y
2025-06-14 03:10:31,192 INFO   decay_rate: 0.96
2025-06-14 03:10:31,192 INFO   decay_step: 100
2025-06-14 03:10:31,192 INFO   dropout_ce: 0.0
2025-06-14 03:10:31,192 INFO   dropout_mel: 0.0
2025-06-14 03:10:31,192 INFO   dropout_mel_in: 0.3
2025-06-14 03:10:31,192 INFO   dropout_vmd: 0.0
2025-06-14 03:10:31,192 INFO   dropout_vmd_in: 0.3
2025-06-14 03:10:31,192 INFO   enhanced_srl_weight: 0.1
2025-06-14 03:10:31,193 INFO   entropy_regularization_lambda: 0.001
2025-06-14 03:10:31,193 INFO   g_size: 50
2025-06-14 03:10:31,193 INFO   h_size: 150
2025-06-14 03:10:31,193 INFO   init_stock_with_word: 0
2025-06-14 03:10:31,193 INFO   kl_lambda_anneal_rate: 0.005
2025-06-14 03:10:31,194 INFO   kl_lambda_start_step: 0
2025-06-14 03:10:31,194 INFO   lr: 0.001
2025-06-14 03:10:31,194 INFO   max_n_days: 5
2025-06-14 03:10:31,194 INFO   max_n_msgs: 20
2025-06-14 03:10:31,195 INFO   max_n_words: 30
2025-06-14 03:10:31,195 INFO   mel_cell_type: gru
2025-06-14 03:10:31,195 INFO   mel_h_size: 100
2025-06-14 03:10:31,195 INFO   mode: all
2025-06-14 03:10:31,195 INFO   momentum: 0.9
2025-06-14 03:10:31,196 INFO   msin_h_size: 100
2025-06-14 03:10:31,196 INFO   n_epochs: 10
2025-06-14 03:10:31,196 INFO   noise_aware_weight: 0.5
2025-06-14 03:10:31,196 INFO   opt: adam
2025-06-14 03:10:31,196 INFO   pathway_competition_type: dynamic
2025-06-14 03:10:31,196 INFO   prediction_loss_weight: 0.1
2025-06-14 03:10:31,197 INFO   residual_connection_weight: 0.1
2025-06-14 03:10:31,197 INFO   shuffle: 1
2025-06-14 03:10:31,197 INFO   stock_embed_size: 150
2025-06-14 03:10:31,197 INFO   td_temporal_attention: True
2025-06-14 03:10:31,197 INFO   use_ca_tsu: True
2025-06-14 03:10:31,197 INFO   use_constant_kl_lambda: 0
2025-06-14 03:10:31,198 INFO   use_dual_path_srl: True
2025-06-14 03:10:31,198 INFO   use_enhanced_srl: True
2025-06-14 03:10:31,198 INFO   use_g_bn: 0
2025-06-14 03:10:31,198 INFO   use_in_bn: 0
2025-06-14 03:10:31,198 INFO   use_noise_aware_loss: True
2025-06-14 03:10:31,199 INFO   use_o_bn: 0
2025-06-14 03:10:31,199 INFO   variant_type: hedge
2025-06-14 03:10:31,199 INFO   vmd_cell_type: gru
2025-06-14 03:10:31,199 INFO   vmd_rec: zh
2025-06-14 03:10:31,199 INFO   volatility_adaptation_factor: 0.3
2025-06-14 03:10:31,200 INFO   volatility_reg_weight: 0.05
2025-06-14 03:10:31,200 INFO   weight_init: xavier-uniform
2025-06-14 03:10:31,200 INFO   word_embed_size: 50
2025-06-14 03:10:31,200 INFO   word_embed_type: glove
2025-06-14 03:10:31,200 INFO   y_size: 2
2025-06-14 03:10:31,201 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-14 03:10:31,203 INFO Start graph assembling...
2025-06-14 03:10:32,965 INFO use_dual_path_srl: True
2025-06-14 03:10:32,965 INFO variant_type: hedge
2025-06-14 03:10:32,965 INFO use_enhanced_srl: True
2025-06-14 03:10:32,966 INFO Enhanced SRL enabled from config
2025-06-14 03:10:32,966 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-14 03:10:32,966 INFO SRL condition: True = True and True
2025-06-14 03:10:32,966 INFO Using enhanced dual-path SRL architecture
2025-06-14 03:10:32,966 INFO Creating Enhanced Dual-Path SRL module...
2025-06-14 03:10:33,012 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-14 03:10:33,017 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-14 03:10:33,038 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-14 03:10:33,261 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-14 03:10:33,261 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-14 03:10:33,262 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-14 03:10:33,671 INFO Using Temporal Attention (TAP)
2025-06-14 03:10:33,715 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-14 03:10:33,716 INFO Ca-TSU enabled: True
2025-06-14 03:10:33,716 INFO Ca-TSU weight: 0.3
2025-06-14 03:10:33,716 INFO Causal loss lambda: 0.3
2025-06-14 03:10:33,717 INFO Enhanced SRL enabled: True
2025-06-14 03:10:33,717 INFO Noise-Aware Loss enabled: True
2025-06-14 03:10:33,717 INFO Noise-Aware weight: 0.5
2025-06-14 03:10:33,726 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,727 INFO Creating enhanced SRL loss...
2025-06-14 03:10:33,727 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-14 03:10:33,730 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-14 03:10:33,739 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-14 03:10:33,749 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,749 INFO Creating reliability weights for noise-aware loss
2025-06-14 03:10:33,755 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 03:10:33,756 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-14 03:10:33,761 INFO Created W_reliability with shape: (100, 1)
2025-06-14 03:10:33,763 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-14 03:10:33,778 INFO Adding causal consistency loss with lambda: 0.3
2025-06-14 03:10:33,828 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-14 03:10:33,828 INFO Loss component verification:
2025-06-14 03:10:33,829 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 03:10:33,829 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 03:10:33,829 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 03:10:33,829 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 03:10:33,829 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 03:10:33,836 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-14 03:10:33,837 INFO Loss component verification:
2025-06-14 03:10:33,837 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-14 03:10:33,838 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-14 03:10:33,838 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-14 03:10:33,838 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-14 03:10:33,838 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-14 03:10:38,069 INFO Graph assembled successfully.
2025-06-14 03:10:38,506 INFO Verifying model configuration...
2025-06-14 03:10:38,506 INFO Ca-TSU enabled: True
2025-06-14 03:10:38,506 INFO Enhanced SRL enabled: True
2025-06-14 03:10:38,507 INFO Noise-Aware Loss enabled: True
2025-06-14 03:10:38,507 INFO Checking model components for noise-aware loss...
2025-06-14 03:10:38,507 INFO Model has 'use_noise_aware_loss': True
2025-06-14 03:10:38,507 INFO use_noise_aware_loss value: True
2025-06-14 03:10:38,508 INFO Model has 'noise_aware_weight': True
2025-06-14 03:10:38,508 INFO noise_aware_weight value: 0.5
2025-06-14 03:10:38,508 INFO Model has 'noise_aware_loss': True
2025-06-14 03:10:38,508 INFO Model has 'separate_noise_aware_loss': True
2025-06-14 03:10:38,509 INFO Model has 'noise_aware_loss_raw': True
2025-06-14 03:10:38,509 INFO Model has 'reliability_weights': True
2025-06-14 03:10:38,509 INFO Model has 'use_enhanced_srl': True
2025-06-14 03:10:38,509 INFO use_enhanced_srl value: True
2025-06-14 03:10:38,509 INFO Model has 'enhanced_srl_loss': True
2025-06-14 03:10:38,510 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-14 03:10:38,510 INFO Model has 'use_ca_tsu': True
2025-06-14 03:10:38,510 INFO use_ca_tsu value: True
2025-06-14 03:10:38,511 INFO Model has 'causal_consistency_loss': True
2025-06-14 03:10:38,511 INFO Model has 'causal_consistency_loss_raw': True
2025-06-14 03:10:38,511 INFO Model has 'loss_components': True
2025-06-14 03:10:38,511 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-14 03:10:38,512 INFO Manually activating loss components...
2025-06-14 03:10:38,512 INFO Components manually activated:
2025-06-14 03:10:38,512 INFO use_enhanced_srl: True
2025-06-14 03:10:38,512 INFO use_ca_tsu: True
2025-06-14 03:10:38,512 INFO use_noise_aware_loss: True
2025-06-14 03:10:38,513 INFO use_dual_path_srl: True
2025-06-14 03:10:38,513 INFO Running test_noise_aware_loss...
2025-06-14 03:10:57,603 INFO ASSEMBLE: word table #replacement: 19482
2025-06-14 03:16:45,993 INFO 	Eval, eval loss: 0.9241406321525574, acc: 0.490854
2025-06-14 03:16:46,258 INFO Test summary saved to results/model_test/enhancement_test_summary_20250614_031646.txt
2025-06-14 03:16:46,258 INFO Test completed successfully!
2025-06-15 13:31:32,653 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 13:31:32,654 INFO Configuration - use_dual_path_srl: True
2025-06-15 13:31:32,654 INFO Configuration - use_enhanced_srl: True
2025-06-15 13:31:32,654 INFO Configuration - use_ca_tsu: True
2025-06-15 13:31:32,654 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 13:31:32,655 INFO Configuration - use_noise_aware_loss: True
2025-06-15 13:31:32,655 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 13:31:32,655 INFO Configuration - variant_type: hedge
2025-06-15 13:31:32,655 INFO Full model configuration:
2025-06-15 13:31:32,655 INFO   alpha: 0.5
2025-06-15 13:31:32,655 INFO   batch_size: 32
2025-06-15 13:31:32,656 INFO   ca_tsu_weight: 0.3
2025-06-15 13:31:32,656 INFO   causal_loss_lambda: 0.3
2025-06-15 13:31:32,656 INFO   clip: 15.0
2025-06-15 13:31:32,656 INFO   consistency_loss_weight: 0.05
2025-06-15 13:31:32,656 INFO   constant_kl_lambda: 0.1
2025-06-15 13:31:32,657 INFO   daily_att: y
2025-06-15 13:31:32,657 INFO   decay_rate: 0.96
2025-06-15 13:31:32,657 INFO   decay_step: 100
2025-06-15 13:31:32,657 INFO   dropout_ce: 0.0
2025-06-15 13:31:32,657 INFO   dropout_mel: 0.0
2025-06-15 13:31:32,658 INFO   dropout_mel_in: 0.3
2025-06-15 13:31:32,658 INFO   dropout_vmd: 0.0
2025-06-15 13:31:32,658 INFO   dropout_vmd_in: 0.3
2025-06-15 13:31:32,658 INFO   enhanced_srl_weight: 0.1
2025-06-15 13:31:32,659 INFO   entropy_regularization_lambda: 0.001
2025-06-15 13:31:32,659 INFO   g_size: 50
2025-06-15 13:31:32,659 INFO   h_size: 150
2025-06-15 13:31:32,659 INFO   init_stock_with_word: 0
2025-06-15 13:31:32,659 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 13:31:32,660 INFO   kl_lambda_start_step: 0
2025-06-15 13:31:32,660 INFO   lr: 0.001
2025-06-15 13:31:32,660 INFO   max_n_days: 5
2025-06-15 13:31:32,660 INFO   max_n_msgs: 20
2025-06-15 13:31:32,660 INFO   max_n_words: 30
2025-06-15 13:31:32,662 INFO   mel_cell_type: gru
2025-06-15 13:31:32,662 INFO   mel_h_size: 100
2025-06-15 13:31:32,662 INFO   mode: all
2025-06-15 13:31:32,662 INFO   momentum: 0.9
2025-06-15 13:31:32,662 INFO   msin_h_size: 100
2025-06-15 13:31:32,663 INFO   n_epochs: 10
2025-06-15 13:31:32,663 INFO   noise_aware_weight: 0.5
2025-06-15 13:31:32,663 INFO   opt: adam
2025-06-15 13:31:32,663 INFO   pathway_competition_type: dynamic
2025-06-15 13:31:32,664 INFO   prediction_loss_weight: 0.1
2025-06-15 13:31:32,664 INFO   residual_connection_weight: 0.1
2025-06-15 13:31:32,664 INFO   shuffle: 1
2025-06-15 13:31:32,664 INFO   stock_embed_size: 150
2025-06-15 13:31:32,665 INFO   td_temporal_attention: True
2025-06-15 13:31:32,665 INFO   use_ca_tsu: True
2025-06-15 13:31:32,665 INFO   use_constant_kl_lambda: 0
2025-06-15 13:31:32,665 INFO   use_dual_path_srl: True
2025-06-15 13:31:32,665 INFO   use_enhanced_srl: True
2025-06-15 13:31:32,665 INFO   use_g_bn: 0
2025-06-15 13:31:32,666 INFO   use_in_bn: 0
2025-06-15 13:31:32,666 INFO   use_noise_aware_loss: True
2025-06-15 13:31:32,666 INFO   use_o_bn: 0
2025-06-15 13:31:32,666 INFO   variant_type: hedge
2025-06-15 13:31:32,666 INFO   vmd_cell_type: gru
2025-06-15 13:31:32,667 INFO   vmd_rec: zh
2025-06-15 13:31:32,667 INFO   volatility_adaptation_factor: 0.3
2025-06-15 13:31:32,667 INFO   volatility_reg_weight: 0.05
2025-06-15 13:31:32,667 INFO   weight_init: xavier-uniform
2025-06-15 13:31:32,667 INFO   word_embed_size: 50
2025-06-15 13:31:32,668 INFO   word_embed_type: glove
2025-06-15 13:31:32,668 INFO   y_size: 2
2025-06-15 13:31:32,669 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 13:31:32,676 INFO Start graph assembling...
2025-06-15 13:31:34,388 INFO use_dual_path_srl: True
2025-06-15 13:31:34,388 INFO variant_type: hedge
2025-06-15 13:31:34,388 INFO use_enhanced_srl: True
2025-06-15 13:31:34,389 INFO Enhanced SRL enabled from config
2025-06-15 13:31:34,389 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 13:31:34,389 INFO SRL condition: True = True and True
2025-06-15 13:31:34,390 INFO Using enhanced dual-path SRL architecture
2025-06-15 13:31:34,390 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 13:31:34,435 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 13:31:34,439 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 13:31:34,460 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 13:31:34,674 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 13:31:34,675 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 13:31:34,675 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 13:31:35,064 INFO Using Temporal Attention (TAP)
2025-06-15 13:31:35,110 INFO Building Adaptive Temporal Attention (ATA) module...
2025-06-15 13:31:35,110 INFO Ca-TSU enabled: True
2025-06-15 13:31:35,111 INFO Ca-TSU weight: 0.3
2025-06-15 13:31:35,111 INFO Causal loss lambda: 0.3
2025-06-15 13:31:35,111 INFO Enhanced SRL enabled: True
2025-06-15 13:31:35,111 INFO Noise-Aware Loss enabled: True
2025-06-15 13:31:35,111 INFO Noise-Aware weight: 0.5
2025-06-15 13:31:35,122 INFO Base loss (before additional components): Tensor("generative_ata_loss/explainability_loss_L2:0", dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,122 INFO Creating enhanced SRL loss...
2025-06-15 13:31:35,123 INFO Using h_t_dual_path for enhanced SRL loss: Tensor("enhanced_dual_path_srl/pathway_fusion/add_6:0", shape=(?, 5, 100), dtype=float32, device=/device:GPU:0) with shape (?, 5, 100)
2025-06-15 13:31:35,126 INFO h_t_dual_path shape: (?, 5, 100), static_h_size: 100
2025-06-15 13:31:35,133 INFO Price predictions shape: (?, ?, 3), Actual price shape: (?, 5)
2025-06-15 13:31:35,146 INFO Base prediction loss created: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,147 INFO Creating reliability weights for noise-aware loss
2025-06-15 13:31:35,153 INFO Created text_influence_scores: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/text_influence_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-15 13:31:35,154 INFO h_t_flat shape before reliability calculation: (?, 100)
2025-06-15 13:31:35,158 INFO Created W_reliability with shape: (100, 1)
2025-06-15 13:31:35,161 INFO Created reliability_weights: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/reliability_estimator/Reshape:0", shape=(?, 5, 1), dtype=float32, device=/device:GPU:0) with shape (?, 5, 1)
2025-06-15 13:31:35,176 INFO Adding causal consistency loss with lambda: 0.3
2025-06-15 13:31:35,227 INFO Final loss after all components: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0
2025-06-15 13:31:35,228 INFO Loss component verification:
2025-06-15 13:31:35,228 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-15 13:31:35,229 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-15 13:31:35,229 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-15 13:31:35,229 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-15 13:31:35,229 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-15 13:31:35,237 INFO Final loss after all components: Tensor("enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/add_causal_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-15 13:31:35,237 INFO Loss component verification:
2025-06-15 13:31:35,237 INFO [OK] Enhanced SRL loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/enhanced_srl_loss:0
2025-06-15 13:31:35,237 INFO [OK] Causal consistency loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/Neg:0
2025-06-15 13:31:35,237 INFO [OK] Noise-aware loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/reliability_weights/Mean:0
2025-06-15 13:31:35,238 INFO [OK] Weighted causal loss stored: enhanced_srl/enhanced_srl_loss/prediction_loss/causal_consistency_loss/causal_attention/weighted_causal_loss:0
2025-06-15 13:31:35,238 INFO Loss components dictionary contains: ['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw']
2025-06-15 13:31:38,727 INFO Graph assembled successfully.
2025-06-15 13:31:39,045 INFO Verifying model configuration...
2025-06-15 13:31:39,045 INFO Ca-TSU enabled: True
2025-06-15 13:31:39,045 INFO Enhanced SRL enabled: True
2025-06-15 13:31:39,046 INFO Noise-Aware Loss enabled: True
2025-06-15 13:31:39,046 INFO Checking model components for noise-aware loss...
2025-06-15 13:31:39,047 INFO Model has 'use_noise_aware_loss': True
2025-06-15 13:31:39,047 INFO use_noise_aware_loss value: True
2025-06-15 13:31:39,047 INFO Model has 'noise_aware_weight': True
2025-06-15 13:31:39,047 INFO noise_aware_weight value: 0.5
2025-06-15 13:31:39,048 INFO Model has 'noise_aware_loss': True
2025-06-15 13:31:39,048 INFO Model has 'separate_noise_aware_loss': True
2025-06-15 13:31:39,048 INFO Model has 'noise_aware_loss_raw': True
2025-06-15 13:31:39,048 INFO Model has 'reliability_weights': True
2025-06-15 13:31:39,048 INFO Model has 'use_enhanced_srl': True
2025-06-15 13:31:39,049 INFO use_enhanced_srl value: True
2025-06-15 13:31:39,049 INFO Model has 'enhanced_srl_loss': True
2025-06-15 13:31:39,049 INFO Model has 'enhanced_srl_loss_raw': True
2025-06-15 13:31:39,049 INFO Model has 'use_ca_tsu': True
2025-06-15 13:31:39,049 INFO use_ca_tsu value: True
2025-06-15 13:31:39,049 INFO Model has 'causal_consistency_loss': True
2025-06-15 13:31:39,049 INFO Model has 'causal_consistency_loss_raw': True
2025-06-15 13:31:39,049 INFO Model has 'loss_components': True
2025-06-15 13:31:39,049 INFO loss_components keys: dict_keys(['base_prediction_loss', 'noise_aware_loss', 'noise_aware_loss_raw', 'enhanced_srl_loss', 'enhanced_srl_loss_raw', 'causal_consistency_loss', 'causal_consistency_loss_raw'])
2025-06-15 13:31:39,051 INFO Manually activating loss components...
2025-06-15 13:31:39,051 INFO Components manually activated:
2025-06-15 13:31:39,051 INFO use_enhanced_srl: True
2025-06-15 13:31:39,051 INFO use_ca_tsu: True
2025-06-15 13:31:39,052 INFO use_noise_aware_loss: True
2025-06-15 13:31:39,052 INFO use_dual_path_srl: True
2025-06-15 13:31:39,052 INFO Running test_noise_aware_loss...
2025-06-15 13:31:58,890 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 13:37:32,281 INFO 	Eval, eval loss: 0.8381810188293457, acc: 0.501524
2025-06-15 13:37:32,496 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_133732.txt
2025-06-15 13:37:32,497 INFO Test completed successfully!
2025-06-15 17:55:20,854 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 17:55:20,854 INFO Configuration - use_dual_path_srl: True
2025-06-15 17:55:20,855 INFO Configuration - use_enhanced_srl: True
2025-06-15 17:55:20,855 INFO Configuration - use_ca_tsu: True
2025-06-15 17:55:20,855 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 17:55:20,855 INFO Configuration - use_noise_aware_loss: True
2025-06-15 17:55:20,856 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 17:55:20,856 INFO Configuration - variant_type: hedge
2025-06-15 17:55:20,856 INFO Full model configuration:
2025-06-15 17:55:20,856 INFO   alpha: 0.5
2025-06-15 17:55:20,856 INFO   batch_size: 32
2025-06-15 17:55:20,857 INFO   ca_tsu_weight: 0.3
2025-06-15 17:55:20,857 INFO   causal_loss_lambda: 0.3
2025-06-15 17:55:20,857 INFO   clip: 15.0
2025-06-15 17:55:20,857 INFO   consistency_loss_weight: 0.05
2025-06-15 17:55:20,857 INFO   constant_kl_lambda: 0.1
2025-06-15 17:55:20,858 INFO   daily_att: y
2025-06-15 17:55:20,858 INFO   decay_rate: 0.96
2025-06-15 17:55:20,858 INFO   decay_step: 100
2025-06-15 17:55:20,858 INFO   dropout_ce: 0.0
2025-06-15 17:55:20,858 INFO   dropout_mel: 0.0
2025-06-15 17:55:20,858 INFO   dropout_mel_in: 0.3
2025-06-15 17:55:20,859 INFO   dropout_vmd: 0.0
2025-06-15 17:55:20,859 INFO   dropout_vmd_in: 0.3
2025-06-15 17:55:20,859 INFO   enhanced_srl_weight: 0.1
2025-06-15 17:55:20,859 INFO   entropy_regularization_lambda: 0.001
2025-06-15 17:55:20,859 INFO   g_size: 50
2025-06-15 17:55:20,860 INFO   h_size: 150
2025-06-15 17:55:20,860 INFO   init_stock_with_word: 0
2025-06-15 17:55:20,860 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 17:55:20,860 INFO   kl_lambda_start_step: 0
2025-06-15 17:55:20,861 INFO   lr: 0.001
2025-06-15 17:55:20,861 INFO   max_n_days: 5
2025-06-15 17:55:20,861 INFO   max_n_msgs: 20
2025-06-15 17:55:20,861 INFO   max_n_words: 30
2025-06-15 17:55:20,862 INFO   mel_cell_type: gru
2025-06-15 17:55:20,862 INFO   mel_h_size: 100
2025-06-15 17:55:20,862 INFO   mode: all
2025-06-15 17:55:20,862 INFO   momentum: 0.9
2025-06-15 17:55:20,862 INFO   msin_h_size: 100
2025-06-15 17:55:20,862 INFO   n_epochs: 10
2025-06-15 17:55:20,862 INFO   noise_aware_weight: 0.5
2025-06-15 17:55:20,863 INFO   opt: adam
2025-06-15 17:55:20,863 INFO   pathway_competition_type: dynamic
2025-06-15 17:55:20,863 INFO   prediction_loss_weight: 0.1
2025-06-15 17:55:20,863 INFO   residual_connection_weight: 0.1
2025-06-15 17:55:20,864 INFO   shuffle: 1
2025-06-15 17:55:20,864 INFO   stock_embed_size: 150
2025-06-15 17:55:20,864 INFO   td_temporal_attention: True
2025-06-15 17:55:20,864 INFO   use_ca_tsu: True
2025-06-15 17:55:20,865 INFO   use_constant_kl_lambda: 0
2025-06-15 17:55:20,865 INFO   use_dual_path_srl: True
2025-06-15 17:55:20,865 INFO   use_enhanced_srl: True
2025-06-15 17:55:20,865 INFO   use_g_bn: 0
2025-06-15 17:55:20,865 INFO   use_in_bn: 0
2025-06-15 17:55:20,865 INFO   use_noise_aware_loss: True
2025-06-15 17:55:20,866 INFO   use_o_bn: 0
2025-06-15 17:55:20,866 INFO   variant_type: hedge
2025-06-15 17:55:20,866 INFO   vmd_cell_type: gru
2025-06-15 17:55:20,866 INFO   vmd_rec: zh
2025-06-15 17:55:20,866 INFO   volatility_adaptation_factor: 0.3
2025-06-15 17:55:20,866 INFO   volatility_reg_weight: 0.05
2025-06-15 17:55:20,866 INFO   weight_init: xavier-uniform
2025-06-15 17:55:20,866 INFO   word_embed_size: 50
2025-06-15 17:55:20,868 INFO   word_embed_type: glove
2025-06-15 17:55:20,868 INFO   y_size: 2
2025-06-15 17:55:20,869 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 17:55:20,875 INFO Start graph assembling...
2025-06-15 17:55:22,681 INFO use_dual_path_srl: True
2025-06-15 17:55:22,682 INFO variant_type: hedge
2025-06-15 17:55:22,682 INFO use_enhanced_srl: True
2025-06-15 17:55:22,682 INFO Enhanced SRL enabled from config
2025-06-15 17:55:22,682 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 17:55:22,683 INFO SRL condition: True = True and True
2025-06-15 17:55:22,683 INFO Using enhanced dual-path SRL architecture
2025-06-15 17:55:22,683 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 17:55:22,729 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 17:55:22,734 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 17:55:22,755 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 17:55:22,978 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 17:55:22,978 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 17:55:22,979 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 17:55:23,402 INFO Using Temporal Attention (TAP)
2025-06-15 17:55:23,447 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 17:55:23,447 INFO Ca-TSU enabled: True
2025-06-15 17:55:23,448 INFO Enhanced SRL enabled: True
2025-06-15 17:55:23,448 INFO Noise-Aware Loss enabled: True
2025-06-15 17:55:23,459 ERROR Error running test: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].
2025-06-15 17:55:23,466 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 34, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1510, in assemble_graph
    self._build_ata()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1295, in _build_ata
    self._create_generative_ata()  # This now sets self.loss to the generative objective
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1206, in _create_generative_ata
    kl_T = tf.gather_nd(self.kl, indexed_T_kl) # Shape: [batch_size]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 1970, in gather_nd
    "GatherNd", params=params, indices=indices, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 691, in _call_cpp_shape_fn_impl
    raise ValueError(err.message)
ValueError: indices.shape[-1] must be <= params.rank, but saw indices shape: [?,2] and params shape: [?] for 'generative_ata_loss/GatherNd' (op: 'GatherNd') with input shapes: [?], [?,2].

2025-06-15 18:07:10,506 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:07:10,506 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:07:10,507 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:07:10,507 INFO Configuration - use_ca_tsu: True
2025-06-15 18:07:10,507 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:07:10,507 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:07:10,508 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:07:10,508 INFO Configuration - variant_type: hedge
2025-06-15 18:07:10,508 INFO Full model configuration:
2025-06-15 18:07:10,508 INFO   alpha: 0.5
2025-06-15 18:07:10,508 INFO   batch_size: 32
2025-06-15 18:07:10,509 INFO   ca_tsu_weight: 0.3
2025-06-15 18:07:10,509 INFO   causal_loss_lambda: 0.3
2025-06-15 18:07:10,509 INFO   clip: 15.0
2025-06-15 18:07:10,509 INFO   consistency_loss_weight: 0.05
2025-06-15 18:07:10,509 INFO   constant_kl_lambda: 0.1
2025-06-15 18:07:10,510 INFO   daily_att: y
2025-06-15 18:07:10,510 INFO   decay_rate: 0.96
2025-06-15 18:07:10,510 INFO   decay_step: 100
2025-06-15 18:07:10,510 INFO   dropout_ce: 0.0
2025-06-15 18:07:10,510 INFO   dropout_mel: 0.0
2025-06-15 18:07:10,511 INFO   dropout_mel_in: 0.3
2025-06-15 18:07:10,511 INFO   dropout_vmd: 0.0
2025-06-15 18:07:10,511 INFO   dropout_vmd_in: 0.3
2025-06-15 18:07:10,511 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:07:10,511 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:07:10,511 INFO   g_size: 50
2025-06-15 18:07:10,512 INFO   h_size: 150
2025-06-15 18:07:10,512 INFO   init_stock_with_word: 0
2025-06-15 18:07:10,512 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:07:10,512 INFO   kl_lambda_start_step: 0
2025-06-15 18:07:10,513 INFO   lr: 0.001
2025-06-15 18:07:10,513 INFO   max_n_days: 5
2025-06-15 18:07:10,513 INFO   max_n_msgs: 20
2025-06-15 18:07:10,513 INFO   max_n_words: 30
2025-06-15 18:07:10,514 INFO   mel_cell_type: gru
2025-06-15 18:07:10,514 INFO   mel_h_size: 100
2025-06-15 18:07:10,514 INFO   mode: all
2025-06-15 18:07:10,514 INFO   momentum: 0.9
2025-06-15 18:07:10,514 INFO   msin_h_size: 100
2025-06-15 18:07:10,515 INFO   n_epochs: 10
2025-06-15 18:07:10,515 INFO   noise_aware_weight: 0.5
2025-06-15 18:07:10,515 INFO   opt: adam
2025-06-15 18:07:10,515 INFO   pathway_competition_type: dynamic
2025-06-15 18:07:10,515 INFO   prediction_loss_weight: 0.1
2025-06-15 18:07:10,516 INFO   residual_connection_weight: 0.1
2025-06-15 18:07:10,516 INFO   shuffle: 1
2025-06-15 18:07:10,516 INFO   stock_embed_size: 150
2025-06-15 18:07:10,516 INFO   td_temporal_attention: True
2025-06-15 18:07:10,517 INFO   use_ca_tsu: True
2025-06-15 18:07:10,517 INFO   use_constant_kl_lambda: 0
2025-06-15 18:07:10,517 INFO   use_dual_path_srl: True
2025-06-15 18:07:10,517 INFO   use_enhanced_srl: True
2025-06-15 18:07:10,518 INFO   use_g_bn: 0
2025-06-15 18:07:10,518 INFO   use_in_bn: 0
2025-06-15 18:07:10,518 INFO   use_noise_aware_loss: True
2025-06-15 18:07:10,518 INFO   use_o_bn: 0
2025-06-15 18:07:10,518 INFO   variant_type: hedge
2025-06-15 18:07:10,519 INFO   vmd_cell_type: gru
2025-06-15 18:07:10,519 INFO   vmd_rec: zh
2025-06-15 18:07:10,519 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:07:10,519 INFO   volatility_reg_weight: 0.05
2025-06-15 18:07:10,519 INFO   weight_init: xavier-uniform
2025-06-15 18:07:10,519 INFO   word_embed_size: 50
2025-06-15 18:07:10,521 INFO   word_embed_type: glove
2025-06-15 18:07:10,521 INFO   y_size: 2
2025-06-15 18:07:10,522 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:07:10,525 INFO Start graph assembling...
2025-06-15 18:07:12,294 INFO use_dual_path_srl: True
2025-06-15 18:07:12,295 INFO variant_type: hedge
2025-06-15 18:07:12,295 INFO use_enhanced_srl: True
2025-06-15 18:07:12,295 INFO Enhanced SRL enabled from config
2025-06-15 18:07:12,296 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:07:12,296 INFO SRL condition: True = True and True
2025-06-15 18:07:12,296 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:07:12,296 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:07:12,342 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:07:12,348 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:07:12,369 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:07:12,611 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:07:12,611 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:07:12,613 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:07:13,010 ERROR Error running test: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].
2025-06-15 18:07:13,015 ERROR Traceback (most recent call last):
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 686, in _call_cpp_shape_fn_impl
    input_tensors_as_shapes, status)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\errors_impl.py", line 473, in __exit__
    c_api.TF_GetCode(self.status.status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 34, in __init__
    self.model.assemble_graph() # Call assemble_graph to build the model's graph
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1501, in assemble_graph
    self._build_vmd()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 1093, in _build_vmd
    self._create_vmd_with_zh_rec()
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Model_tx_lf_dual_path.py", line 972, in _create_vmd_with_zh_rec
    self.kl_t = tf.transpose(kl_t_stacked, perm=[1, 0, 2], name='kl_t_stacked_zh') # shape: [batch, days, z_size]
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\array_ops.py", line 1336, in transpose
    ret = gen_array_ops.transpose(a, perm, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 5693, in transpose
    "Transpose", x=x, perm=perm, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2958, in create_op
    set_shapes_for_outputs(ret)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2209, in set_shapes_for_outputs
    shapes = shape_func(op)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2159, in call_with_requiring
    return call_cpp_shape_fn(op, require_shape_fn=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 627, in call_cpp_shape_fn
    require_shape_fn)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\common_shapes.py", line 691, in _call_cpp_shape_fn_impl
    raise ValueError(err.message)
ValueError: Dimension must be 2 but is 3 for 'vmd_zh_rec/vmd_zh_rec_iter/kl_t_stacked_zh' (op: 'Transpose') with input shapes: [?,?], [3].

2025-06-15 18:15:18,148 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:15:18,149 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:15:18,149 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:15:18,149 INFO Configuration - use_ca_tsu: True
2025-06-15 18:15:18,149 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:15:18,149 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:15:18,150 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:15:18,150 INFO Configuration - variant_type: hedge
2025-06-15 18:15:18,150 INFO Full model configuration:
2025-06-15 18:15:18,150 INFO   alpha: 0.5
2025-06-15 18:15:18,150 INFO   batch_size: 32
2025-06-15 18:15:18,151 INFO   ca_tsu_weight: 0.3
2025-06-15 18:15:18,151 INFO   causal_loss_lambda: 0.3
2025-06-15 18:15:18,151 INFO   clip: 15.0
2025-06-15 18:15:18,151 INFO   consistency_loss_weight: 0.05
2025-06-15 18:15:18,152 INFO   constant_kl_lambda: 0.1
2025-06-15 18:15:18,152 INFO   daily_att: y
2025-06-15 18:15:18,152 INFO   decay_rate: 0.96
2025-06-15 18:15:18,152 INFO   decay_step: 100
2025-06-15 18:15:18,152 INFO   dropout_ce: 0.0
2025-06-15 18:15:18,153 INFO   dropout_mel: 0.0
2025-06-15 18:15:18,153 INFO   dropout_mel_in: 0.3
2025-06-15 18:15:18,153 INFO   dropout_vmd: 0.0
2025-06-15 18:15:18,153 INFO   dropout_vmd_in: 0.3
2025-06-15 18:15:18,154 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:15:18,154 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:15:18,154 INFO   g_size: 50
2025-06-15 18:15:18,155 INFO   h_size: 150
2025-06-15 18:15:18,155 INFO   init_stock_with_word: 0
2025-06-15 18:15:18,155 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:15:18,155 INFO   kl_lambda_start_step: 0
2025-06-15 18:15:18,155 INFO   lr: 0.001
2025-06-15 18:15:18,156 INFO   max_n_days: 5
2025-06-15 18:15:18,156 INFO   max_n_msgs: 20
2025-06-15 18:15:18,156 INFO   max_n_words: 30
2025-06-15 18:15:18,156 INFO   mel_cell_type: gru
2025-06-15 18:15:18,156 INFO   mel_h_size: 100
2025-06-15 18:15:18,157 INFO   mode: all
2025-06-15 18:15:18,157 INFO   momentum: 0.9
2025-06-15 18:15:18,157 INFO   msin_h_size: 100
2025-06-15 18:15:18,157 INFO   n_epochs: 10
2025-06-15 18:15:18,157 INFO   noise_aware_weight: 0.5
2025-06-15 18:15:18,157 INFO   opt: adam
2025-06-15 18:15:18,158 INFO   pathway_competition_type: dynamic
2025-06-15 18:15:18,158 INFO   prediction_loss_weight: 0.1
2025-06-15 18:15:18,158 INFO   residual_connection_weight: 0.1
2025-06-15 18:15:18,158 INFO   shuffle: 1
2025-06-15 18:15:18,158 INFO   stock_embed_size: 150
2025-06-15 18:15:18,159 INFO   td_temporal_attention: True
2025-06-15 18:15:18,159 INFO   use_ca_tsu: True
2025-06-15 18:15:18,159 INFO   use_constant_kl_lambda: 0
2025-06-15 18:15:18,160 INFO   use_dual_path_srl: True
2025-06-15 18:15:18,160 INFO   use_enhanced_srl: True
2025-06-15 18:15:18,160 INFO   use_g_bn: 0
2025-06-15 18:15:18,160 INFO   use_in_bn: 0
2025-06-15 18:15:18,160 INFO   use_noise_aware_loss: True
2025-06-15 18:15:18,161 INFO   use_o_bn: 0
2025-06-15 18:15:18,161 INFO   variant_type: hedge
2025-06-15 18:15:18,161 INFO   vmd_cell_type: gru
2025-06-15 18:15:18,161 INFO   vmd_rec: zh
2025-06-15 18:15:18,162 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:15:18,162 INFO   volatility_reg_weight: 0.05
2025-06-15 18:15:18,162 INFO   weight_init: xavier-uniform
2025-06-15 18:15:18,162 INFO   word_embed_size: 50
2025-06-15 18:15:18,162 INFO   word_embed_type: glove
2025-06-15 18:15:18,163 INFO   y_size: 2
2025-06-15 18:15:18,163 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:15:18,166 INFO Start graph assembling...
2025-06-15 18:15:20,195 INFO use_dual_path_srl: True
2025-06-15 18:15:20,196 INFO variant_type: hedge
2025-06-15 18:15:20,196 INFO use_enhanced_srl: True
2025-06-15 18:15:20,196 INFO Enhanced SRL enabled from config
2025-06-15 18:15:20,197 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:15:20,197 INFO SRL condition: True = True and True
2025-06-15 18:15:20,197 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:15:20,198 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:15:20,262 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:15:20,268 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:15:20,300 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:15:20,558 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:15:20,559 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:15:20,559 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:15:20,889 INFO Using Temporal Attention (TAP)
2025-06-15 18:15:20,938 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:15:20,939 INFO Ca-TSU enabled: True
2025-06-15 18:15:20,939 INFO Enhanced SRL enabled: True
2025-06-15 18:15:20,940 INFO Noise-Aware Loss enabled: True
2025-06-15 18:15:20,955 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:15:20,955 INFO Adding auxiliary enhancement losses...
2025-06-15 18:15:20,980 INFO Creating Noise-Aware Loss component...
2025-06-15 18:15:20,990 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:15:20,991 INFO Creating Causal Consistency Loss component...
2025-06-15 18:15:21,029 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:15:21,030 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:15:21,030 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:15:23,829 INFO Graph assembled successfully.
2025-06-15 18:15:24,134 INFO Verifying model configuration...
2025-06-15 18:15:24,135 INFO Ca-TSU enabled: True
2025-06-15 18:15:24,135 INFO Enhanced SRL enabled: True
2025-06-15 18:15:24,135 INFO Noise-Aware Loss enabled: True
2025-06-15 18:15:24,135 INFO Checking model components for noise-aware loss...
2025-06-15 18:15:24,136 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:15:24,136 INFO use_noise_aware_loss value: True
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_weight': True
2025-06-15 18:15:24,136 INFO noise_aware_weight value: 0.5
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_loss': False
2025-06-15 18:15:24,136 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:15:24,136 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:15:24,137 INFO Model has 'reliability_weights': True
2025-06-15 18:15:24,137 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:15:24,137 INFO use_enhanced_srl value: True
2025-06-15 18:15:24,137 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:15:24,137 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:15:24,137 INFO Model has 'use_ca_tsu': True
2025-06-15 18:15:24,138 INFO use_ca_tsu value: True
2025-06-15 18:15:24,138 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:15:24,138 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:15:24,138 INFO Model has 'loss_components': True
2025-06-15 18:15:24,138 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:15:24,139 INFO Manually activating loss components...
2025-06-15 18:15:24,139 INFO Components manually activated:
2025-06-15 18:15:24,139 INFO use_enhanced_srl: True
2025-06-15 18:15:24,139 INFO use_ca_tsu: True
2025-06-15 18:15:24,140 INFO use_noise_aware_loss: True
2025-06-15 18:15:24,140 INFO use_dual_path_srl: True
2025-06-15 18:15:24,140 INFO Running test_noise_aware_loss...
2025-06-15 18:15:44,718 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:22:50,330 INFO 	Eval, eval loss: 1.5247420072555542, acc: 0.519817
2025-06-15 18:22:50,575 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_182250.txt
2025-06-15 18:22:50,576 INFO Test completed successfully!
2025-06-15 18:33:13,971 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:33:13,971 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:33:13,971 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:33:13,972 INFO Configuration - use_ca_tsu: True
2025-06-15 18:33:13,972 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:33:13,972 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:33:13,972 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:33:13,972 INFO Configuration - variant_type: hedge
2025-06-15 18:33:13,973 INFO Full model configuration:
2025-06-15 18:33:13,973 INFO   alpha: 0.5
2025-06-15 18:33:13,973 INFO   batch_size: 32
2025-06-15 18:33:13,973 INFO   ca_tsu_weight: 0.3
2025-06-15 18:33:13,974 INFO   causal_loss_lambda: 0.3
2025-06-15 18:33:13,974 INFO   clip: 15.0
2025-06-15 18:33:13,974 INFO   consistency_loss_weight: 0.05
2025-06-15 18:33:13,974 INFO   constant_kl_lambda: 0.1
2025-06-15 18:33:13,974 INFO   daily_att: y
2025-06-15 18:33:13,974 INFO   decay_rate: 0.96
2025-06-15 18:33:13,975 INFO   decay_step: 100
2025-06-15 18:33:13,975 INFO   dropout_ce: 0.0
2025-06-15 18:33:13,975 INFO   dropout_mel: 0.0
2025-06-15 18:33:13,975 INFO   dropout_mel_in: 0.3
2025-06-15 18:33:13,975 INFO   dropout_vmd: 0.0
2025-06-15 18:33:13,976 INFO   dropout_vmd_in: 0.3
2025-06-15 18:33:13,976 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:33:13,976 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:33:13,976 INFO   g_size: 50
2025-06-15 18:33:13,976 INFO   h_size: 150
2025-06-15 18:33:13,977 INFO   init_stock_with_word: 0
2025-06-15 18:33:13,977 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:33:13,977 INFO   kl_lambda_start_step: 0
2025-06-15 18:33:13,977 INFO   lr: 0.001
2025-06-15 18:33:13,977 INFO   max_n_days: 5
2025-06-15 18:33:13,977 INFO   max_n_msgs: 20
2025-06-15 18:33:13,978 INFO   max_n_words: 30
2025-06-15 18:33:13,978 INFO   mel_cell_type: gru
2025-06-15 18:33:13,978 INFO   mel_h_size: 100
2025-06-15 18:33:13,978 INFO   mode: all
2025-06-15 18:33:13,978 INFO   momentum: 0.9
2025-06-15 18:33:13,978 INFO   msin_h_size: 100
2025-06-15 18:33:13,979 INFO   n_epochs: 10
2025-06-15 18:33:13,979 INFO   noise_aware_weight: 0.5
2025-06-15 18:33:13,979 INFO   opt: adam
2025-06-15 18:33:13,979 INFO   pathway_competition_type: dynamic
2025-06-15 18:33:13,979 INFO   prediction_loss_weight: 0.1
2025-06-15 18:33:13,979 INFO   residual_connection_weight: 0.1
2025-06-15 18:33:13,980 INFO   shuffle: 1
2025-06-15 18:33:13,980 INFO   stock_embed_size: 150
2025-06-15 18:33:13,980 INFO   td_temporal_attention: True
2025-06-15 18:33:13,980 INFO   use_ca_tsu: True
2025-06-15 18:33:13,980 INFO   use_constant_kl_lambda: 0
2025-06-15 18:33:13,981 INFO   use_dual_path_srl: True
2025-06-15 18:33:13,981 INFO   use_enhanced_srl: True
2025-06-15 18:33:13,981 INFO   use_g_bn: 0
2025-06-15 18:33:13,981 INFO   use_in_bn: 0
2025-06-15 18:33:13,981 INFO   use_noise_aware_loss: True
2025-06-15 18:33:13,981 INFO   use_o_bn: 0
2025-06-15 18:33:13,982 INFO   variant_type: hedge
2025-06-15 18:33:13,982 INFO   vmd_cell_type: gru
2025-06-15 18:33:13,982 INFO   vmd_rec: zh
2025-06-15 18:33:13,982 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:33:13,982 INFO   volatility_reg_weight: 0.05
2025-06-15 18:33:13,983 INFO   weight_init: xavier-uniform
2025-06-15 18:33:13,983 INFO   word_embed_size: 50
2025-06-15 18:33:13,983 INFO   word_embed_type: glove
2025-06-15 18:33:13,983 INFO   y_size: 2
2025-06-15 18:33:13,984 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:33:13,986 INFO Start graph assembling...
2025-06-15 18:33:15,866 INFO use_dual_path_srl: True
2025-06-15 18:33:15,867 INFO variant_type: hedge
2025-06-15 18:33:15,867 INFO use_enhanced_srl: True
2025-06-15 18:33:15,867 INFO Enhanced SRL enabled from config
2025-06-15 18:33:15,867 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:33:15,868 INFO SRL condition: True = True and True
2025-06-15 18:33:15,868 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:33:15,868 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:33:15,913 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:33:15,917 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:33:15,939 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:33:16,165 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:33:16,165 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:33:16,166 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:33:16,482 INFO Using Temporal Attention (TAP)
2025-06-15 18:33:16,532 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:33:16,533 INFO Ca-TSU enabled: True
2025-06-15 18:33:16,533 INFO Enhanced SRL enabled: True
2025-06-15 18:33:16,533 INFO Noise-Aware Loss enabled: True
2025-06-15 18:33:16,550 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:16,550 INFO Adding auxiliary enhancement losses...
2025-06-15 18:33:16,577 INFO Creating Noise-Aware Loss component...
2025-06-15 18:33:16,587 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:33:16,590 INFO Creating Causal Consistency Loss component...
2025-06-15 18:33:16,638 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:33:16,639 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:16,639 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:33:19,252 INFO Graph assembled successfully.
2025-06-15 18:33:19,253 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:33:19,254 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:33:19,565 INFO Verifying model configuration...
2025-06-15 18:33:19,566 INFO Ca-TSU enabled: True
2025-06-15 18:33:19,566 INFO Enhanced SRL enabled: True
2025-06-15 18:33:19,567 INFO Noise-Aware Loss enabled: True
2025-06-15 18:33:19,567 INFO Checking model components for noise-aware loss...
2025-06-15 18:33:19,567 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:33:19,567 INFO use_noise_aware_loss value: True
2025-06-15 18:33:19,567 INFO Model has 'noise_aware_weight': True
2025-06-15 18:33:19,567 INFO noise_aware_weight value: 0.5
2025-06-15 18:33:19,567 INFO Model has 'noise_aware_loss': False
2025-06-15 18:33:19,569 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:33:19,569 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:33:19,569 INFO Model has 'reliability_weights': True
2025-06-15 18:33:19,569 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:33:19,570 INFO use_enhanced_srl value: True
2025-06-15 18:33:19,570 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:33:19,570 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:33:19,570 INFO Model has 'use_ca_tsu': True
2025-06-15 18:33:19,570 INFO use_ca_tsu value: True
2025-06-15 18:33:19,571 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:33:19,571 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:33:19,571 INFO Model has 'loss_components': True
2025-06-15 18:33:19,571 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:33:19,571 INFO Manually activating loss components...
2025-06-15 18:33:19,572 INFO Components manually activated:
2025-06-15 18:33:19,572 INFO use_enhanced_srl: True
2025-06-15 18:33:19,572 INFO use_ca_tsu: True
2025-06-15 18:33:19,572 INFO use_noise_aware_loss: True
2025-06-15 18:33:19,572 INFO use_dual_path_srl: True
2025-06-15 18:33:19,573 INFO Running test_noise_aware_loss...
2025-06-15 18:33:38,860 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:33:41,108 INFO Word table initialized
2025-06-15 18:33:41,108 INFO Checking loss components in the model graph...
2025-06-15 18:33:41,109 WARNING Enhanced SRL loss not found in the model
2025-06-15 18:33:41,109 WARNING Causal consistency loss not found in the model
2025-06-15 18:33:41,109 WARNING Noise-aware loss not found in the model
2025-06-15 18:33:41,109 INFO Reliability weights found: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Sigmoid:0", shape=(?, 1), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,109 INFO Reliability weights name: enhanced_srl_loss_calculation/noise_aware_component/Sigmoid:0
2025-06-15 18:33:41,110 INFO Reliability weights shape: (?, 1)
2025-06-15 18:33:41,110 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:33:41,110 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,110 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,111 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:33:41,111 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 18:33:41,112 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 18:33:41,247 INFO Starting training test for 10 batches
2025-06-15 18:33:56,379 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:33:56,380 INFO n_msgs_batch shape: Not a list
2025-06-15 18:33:56,380 INFO Sample n_msgs values: [1 1 3]
2025-06-15 18:33:56,380 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,380 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,381 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,382 INFO Batch 1, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,383 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,383 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,383 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,384 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,385 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,385 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 2: Setting 5 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,386 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,386 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 1: Setting 4 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 2: Setting 10 messages to True
2025-06-15 18:33:56,388 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,389 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 0: Setting 4 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,389 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,390 INFO Batch 5, Day 3: Setting 1 messages to True
2025-06-15 18:33:56,390 INFO Batch 5, Day 4: Setting 2 messages to True
2025-06-15 18:33:56,390 INFO Batch 6, Day 0: Setting 4 messages to True
2025-06-15 18:33:56,390 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 2: Setting 13 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 3: Setting 6 messages to True
2025-06-15 18:33:56,391 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,392 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,393 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,393 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,393 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,394 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,395 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,395 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,395 INFO Batch 9, Day 1: Setting 4 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 3: Setting 5 messages to True
2025-06-15 18:33:56,396 INFO Batch 9, Day 4: Setting 3 messages to True
2025-06-15 18:33:56,396 INFO Batch 10, Day 0: Setting 15 messages to True
2025-06-15 18:33:56,398 INFO Batch 10, Day 1: Setting 8 messages to True
2025-06-15 18:33:56,400 INFO Batch 10, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,401 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,401 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,401 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,402 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,403 INFO Batch 12, Day 3: Setting 1 messages to True
2025-06-15 18:33:56,404 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:33:56,404 INFO Batch 13, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,405 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,405 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,405 INFO Batch 14, Day 0: Setting 3 messages to True
2025-06-15 18:33:56,405 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 3: Setting 2 messages to True
2025-06-15 18:33:56,406 INFO Batch 14, Day 4: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,407 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,408 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,408 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,408 INFO Batch 16, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,409 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,409 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,410 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,410 INFO Batch 17, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,410 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,411 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,412 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,412 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,413 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,413 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 3: Setting 2 messages to True
2025-06-15 18:33:56,414 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,415 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,415 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,416 INFO Batch 19, Day 2: Setting 3 messages to True
2025-06-15 18:33:56,416 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,417 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,417 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,418 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,418 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,422 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,422 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,423 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,423 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,424 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,425 INFO Batch 22, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,425 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,426 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 0: Setting 3 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,427 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,428 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 0: Setting 5 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,430 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,431 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 1: Setting 3 messages to True
2025-06-15 18:33:56,431 INFO Batch 26, Day 2: Setting 2 messages to True
2025-06-15 18:33:56,432 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,432 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,432 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,433 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,434 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,435 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,435 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,436 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,437 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,438 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,438 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,438 INFO Batch 31, Day 0: Setting 2 messages to True
2025-06-15 18:33:56,439 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:33:56,439 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:33:56,440 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:33:56,441 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:33:56,442 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:33:56,442 INFO Message mask non-zero count: 226 out of 3200
2025-06-15 18:33:56,443 INFO First batch, first day mask: [ True False False False False False False False False False False False
 False False False False False False False False]
2025-06-15 18:33:56,443 INFO n_msgs_batch structure: <class 'numpy.ndarray'>
2025-06-15 18:33:56,444 INFO n_msgs_batch first item: [1 1 3 0 0]
2025-06-15 18:33:56,444 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:34:13,488 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 18:34:13,488 INFO   PERFORMANCE: Loss=1.3106 | Acc=0.5938 | MCC=0.0380
2025-06-15 18:34:13,489 INFO   LOSS COMPONENTS:
2025-06-15 18:34:13,489 INFO     - Causal Consistency Loss: 0.191054
2025-06-15 18:34:13,489 INFO     - Noise-Aware SRL Loss: 0.568306
2025-06-15 18:34:13,490 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:34:13,490 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 18:34:13,490 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:34:13,492 INFO     Volatility: 0.6453, Text Weight: 0.3908, Price Weight: 0.6092
2025-06-15 18:34:22,422 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:34:22,423 INFO n_msgs_batch shape: Not a list
2025-06-15 18:34:22,423 INFO Sample n_msgs values: [1 2 5]
2025-06-15 18:34:22,423 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,424 INFO Batch 0, Day 4: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,425 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,426 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,426 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:34:22,427 INFO Batch 2, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,427 INFO Batch 2, Day 4: Setting 4 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,427 INFO Batch 3, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 0: Setting 11 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 1: Setting 5 messages to True
2025-06-15 18:34:22,428 INFO Batch 4, Day 2: Setting 7 messages to True
2025-06-15 18:34:22,429 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,429 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,429 INFO Batch 5, Day 0: Setting 20 messages to True
2025-06-15 18:34:22,432 INFO Batch 5, Day 1: Setting 16 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,433 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,435 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,436 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,436 INFO Batch 6, Day 2: Setting 6 messages to True
2025-06-15 18:34:22,437 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,437 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,437 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,437 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,438 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,438 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 1: Setting 7 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 2: Setting 7 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,439 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,439 INFO Batch 9, Day 0: Setting 3 messages to True
2025-06-15 18:34:22,439 INFO Batch 9, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,440 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,441 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,442 INFO Batch 10, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,442 INFO Batch 10, Day 4: Setting 3 messages to True
2025-06-15 18:34:22,442 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,442 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,443 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,443 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,443 INFO Batch 12, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 3: Setting 8 messages to True
2025-06-15 18:34:22,444 INFO Batch 12, Day 4: Setting 2 messages to True
2025-06-15 18:34:22,444 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 3: Setting 2 messages to True
2025-06-15 18:34:22,445 INFO Batch 13, Day 4: Setting 14 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,446 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,447 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,447 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,447 INFO Batch 15, Day 1: Setting 4 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,448 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,448 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,448 INFO Batch 16, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,449 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,449 INFO Batch 17, Day 0: Setting 3 messages to True
2025-06-15 18:34:22,449 INFO Batch 17, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,450 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,450 INFO Batch 18, Day 0: Setting 10 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 2: Setting 2 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,451 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 3: Setting 5 messages to True
2025-06-15 18:34:22,452 INFO Batch 19, Day 4: Setting 1 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 0: Setting 4 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 2: Setting 3 messages to True
2025-06-15 18:34:22,453 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,454 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 0: Setting 6 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,454 INFO Batch 21, Day 2: Setting 6 messages to True
2025-06-15 18:34:22,455 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,455 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,455 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,456 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,456 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,456 INFO Batch 23, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,456 INFO Batch 23, Day 1: Setting 5 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,457 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,457 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,457 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,458 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 1: Setting 4 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,459 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,460 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,461 INFO Batch 27, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,461 INFO Batch 27, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 2: Setting 4 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,462 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,462 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,463 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 0: Setting 5 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 1: Setting 9 messages to True
2025-06-15 18:34:22,464 INFO Batch 29, Day 2: Setting 5 messages to True
2025-06-15 18:34:22,465 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:34:22,465 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,465 INFO Batch 30, Day 0: Setting 15 messages to True
2025-06-15 18:34:22,465 INFO Batch 30, Day 1: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 2: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 3: Setting 20 messages to True
2025-06-15 18:34:22,466 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,466 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 3: Setting 3 messages to True
2025-06-15 18:34:22,467 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:34:22,467 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:34:22,468 INFO Message mask non-zero count: 409 out of 3200
2025-06-15 18:34:22,468 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:34:54,871 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:34:54,871 INFO n_msgs_batch shape: Not a list
2025-06-15 18:34:54,872 INFO Sample n_msgs values: [1 2 0]
2025-06-15 18:34:54,872 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,872 INFO Batch 0, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,873 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,873 INFO Batch 1, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,874 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,874 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,875 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,875 INFO Batch 3, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 2: Setting 20 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,876 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,876 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,877 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,877 INFO Batch 5, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,877 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 3: Setting 2 messages to True
2025-06-15 18:34:54,878 INFO Batch 5, Day 4: Setting 3 messages to True
2025-06-15 18:34:54,878 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,878 INFO Batch 6, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,879 INFO Batch 7, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,880 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,880 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,881 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,881 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,882 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,882 INFO Batch 10, Day 3: Setting 8 messages to True
2025-06-15 18:34:54,883 INFO Batch 10, Day 4: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,883 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:34:54,884 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,884 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,884 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 0: Setting 4 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,885 INFO Batch 13, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 0: Setting 4 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,886 INFO Batch 14, Day 2: Setting 18 messages to True
2025-06-15 18:34:54,887 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,887 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,887 INFO Batch 15, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,888 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,888 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,888 INFO Batch 16, Day 2: Setting 12 messages to True
2025-06-15 18:34:54,889 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,889 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,889 INFO Batch 17, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,889 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,890 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,892 INFO Batch 18, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,892 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,893 INFO Batch 18, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,894 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,894 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,895 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,896 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:34:54,896 INFO Batch 20, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,897 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,897 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,897 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,898 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 0: Setting 8 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 3: Setting 7 messages to True
2025-06-15 18:34:54,899 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,900 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,901 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,902 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 0: Setting 7 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,903 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,904 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,904 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,904 INFO Batch 27, Day 1: Setting 5 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 3: Setting 3 messages to True
2025-06-15 18:34:54,905 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,905 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:34:54,905 INFO Batch 28, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,906 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 0: Setting 2 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:34:54,906 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 0: Setting 6 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 1: Setting 8 messages to True
2025-06-15 18:34:54,907 INFO Batch 30, Day 2: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:34:54,908 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 0: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 1: Setting 3 messages to True
2025-06-15 18:34:54,908 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:34:54,909 INFO Batch 31, Day 3: Setting 3 messages to True
2025-06-15 18:34:54,909 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:34:54,909 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:34:54,909 INFO Message mask non-zero count: 266 out of 3200
2025-06-15 18:34:54,910 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:17,296 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:17,297 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:17,297 INFO Sample n_msgs values: [1 1 4]
2025-06-15 18:35:17,297 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,298 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,299 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,300 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,301 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,301 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,302 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 3: Setting 2 messages to True
2025-06-15 18:35:17,303 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,303 INFO Batch 6, Day 0: Setting 6 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 2: Setting 5 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,304 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,304 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,305 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,305 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 3: Setting 1 messages to True
2025-06-15 18:35:17,306 INFO Batch 8, Day 4: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,307 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,308 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,309 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,309 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,309 INFO Batch 11, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,310 INFO Batch 13, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,310 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,312 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,312 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,313 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,314 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,315 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,315 INFO Batch 16, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,316 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,316 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 0: Setting 6 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 1: Setting 8 messages to True
2025-06-15 18:35:17,316 INFO Batch 17, Day 2: Setting 7 messages to True
2025-06-15 18:35:17,317 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,317 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,317 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,317 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,318 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,318 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,318 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,319 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,319 INFO Batch 20, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,319 INFO Batch 20, Day 1: Setting 7 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,320 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,320 INFO Batch 21, Day 0: Setting 4 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,321 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,322 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,322 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,323 INFO Batch 24, Day 0: Setting 4 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,324 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,324 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 1: Setting 5 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,325 INFO Batch 26, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 1: Setting 11 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,326 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 0: Setting 2 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 1: Setting 7 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 2: Setting 4 messages to True
2025-06-15 18:35:17,327 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,328 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,328 INFO Batch 28, Day 0: Setting 3 messages to True
2025-06-15 18:35:17,328 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,329 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,329 INFO Batch 29, Day 0: Setting 9 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 1: Setting 10 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:17,330 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:17,332 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,332 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:35:17,332 INFO Batch 31, Day 2: Setting 2 messages to True
2025-06-15 18:35:17,333 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:17,333 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:17,333 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:17,333 INFO Message mask non-zero count: 219 out of 3200
2025-06-15 18:35:17,333 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:42,147 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:42,147 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:42,147 INFO Sample n_msgs values: [2 5 3]
2025-06-15 18:35:42,148 INFO Batch 0, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 2: Setting 3 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 3: Setting 2 messages to True
2025-06-15 18:35:42,148 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,148 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,149 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,149 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 1: Setting 12 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,150 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,150 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,151 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,151 INFO Batch 4, Day 0: Setting 7 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,152 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,153 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 0: Setting 6 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 1: Setting 8 messages to True
2025-06-15 18:35:42,153 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,154 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,154 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,154 INFO Batch 6, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,155 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,156 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,157 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,158 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,159 INFO Batch 12, Day 0: Setting 3 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 1: Setting 9 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 2: Setting 8 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,160 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,160 INFO Batch 13, Day 0: Setting 5 messages to True
2025-06-15 18:35:42,160 INFO Batch 13, Day 1: Setting 8 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,161 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,162 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,163 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,164 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 0: Setting 6 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 1: Setting 4 messages to True
2025-06-15 18:35:42,165 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:42,166 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,166 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,166 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,167 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,167 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 0: Setting 5 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 1: Setting 7 messages to True
2025-06-15 18:35:42,167 INFO Batch 20, Day 2: Setting 10 messages to True
2025-06-15 18:35:42,168 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,168 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 0: Setting 16 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,168 INFO Batch 21, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,169 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,169 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,169 INFO Batch 22, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,170 INFO Batch 22, Day 3: Setting 5 messages to True
2025-06-15 18:35:42,170 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,170 INFO Batch 23, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,170 INFO Batch 23, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 2: Setting 5 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,171 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,171 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,171 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,172 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,172 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,172 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 3: Setting 1 messages to True
2025-06-15 18:35:42,173 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,173 INFO Batch 26, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,173 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,174 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,174 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,174 INFO Batch 27, Day 1: Setting 2 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,175 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,175 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:35:42,175 INFO Batch 28, Day 1: Setting 3 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 2: Setting 2 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,176 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,176 INFO Batch 29, Day 0: Setting 9 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 2: Setting 0 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,177 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,178 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 0: Setting 4 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 1: Setting 5 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 2: Setting 11 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:42,179 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:42,180 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:42,180 INFO Message mask non-zero count: 285 out of 3200
2025-06-15 18:35:42,180 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:35:54,370 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 18:35:54,371 INFO   PERFORMANCE: Loss=1.5446 | Acc=0.4688 | MCC=-0.0552
2025-06-15 18:35:54,371 INFO   LOSS COMPONENTS:
2025-06-15 18:35:54,371 INFO     - Causal Consistency Loss: -0.108177
2025-06-15 18:35:54,371 INFO     - Noise-Aware SRL Loss: 0.449558
2025-06-15 18:35:54,371 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:35:54,372 INFO     Alpha_i sample: 0.5767, Omega_i sample: 0.6401
2025-06-15 18:35:54,372 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:35:54,373 INFO     Volatility: 0.6441, Text Weight: 0.4702, Price Weight: 0.5298
2025-06-15 18:35:59,351 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:35:59,352 INFO n_msgs_batch shape: Not a list
2025-06-15 18:35:59,352 INFO Sample n_msgs values: [2 1 0]
2025-06-15 18:35:59,352 INFO Batch 0, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,352 INFO Batch 0, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,353 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,354 INFO Batch 2, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,354 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,355 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,356 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,356 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,357 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 0: Setting 4 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,358 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,359 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,359 INFO Batch 6, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,360 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,360 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,360 INFO Batch 7, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,361 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,361 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,362 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,362 INFO Batch 9, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,363 INFO Batch 9, Day 3: Setting 3 messages to True
2025-06-15 18:35:59,363 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 2: Setting 3 messages to True
2025-06-15 18:35:59,363 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,364 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,364 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,365 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,365 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 1: Setting 9 messages to True
2025-06-15 18:35:59,365 INFO Batch 12, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,366 INFO Batch 13, Day 0: Setting 6 messages to True
2025-06-15 18:35:59,366 INFO Batch 13, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,367 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,367 INFO Batch 14, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 1: Setting 9 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,368 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,368 INFO Batch 15, Day 0: Setting 3 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 3: Setting 20 messages to True
2025-06-15 18:35:59,369 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,369 INFO Batch 16, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 3: Setting 1 messages to True
2025-06-15 18:35:59,370 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,371 INFO Batch 18, Day 0: Setting 5 messages to True
2025-06-15 18:35:59,372 INFO Batch 18, Day 1: Setting 6 messages to True
2025-06-15 18:35:59,373 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:35:59,373 INFO Batch 18, Day 3: Setting 4 messages to True
2025-06-15 18:35:59,374 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 0: Setting 10 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,374 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,375 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 1: Setting 5 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,375 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,376 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 0: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 1: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 2: Setting 20 messages to True
2025-06-15 18:35:59,376 INFO Batch 21, Day 3: Setting 19 messages to True
2025-06-15 18:35:59,377 INFO Batch 21, Day 4: Setting 9 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,377 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,378 INFO Batch 23, Day 3: Setting 2 messages to True
2025-06-15 18:35:59,379 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 0: Setting 2 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,379 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,380 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 1: Setting 3 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,380 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,381 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,381 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,382 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 1: Setting 5 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,382 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,383 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 0: Setting 5 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,383 INFO Batch 28, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,384 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,384 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,384 INFO Batch 29, Day 0: Setting 20 messages to True
2025-06-15 18:35:59,384 INFO Batch 29, Day 1: Setting 3 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 2: Setting 2 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,385 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,385 INFO Batch 30, Day 0: Setting 9 messages to True
2025-06-15 18:35:59,385 INFO Batch 30, Day 1: Setting 1 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,386 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 1: Setting 2 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:35:59,387 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:35:59,388 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:35:59,388 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:35:59,388 INFO Message mask non-zero count: 372 out of 3200
2025-06-15 18:35:59,388 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:21,205 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:21,206 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:21,206 INFO Sample n_msgs values: [5 3 1]
2025-06-15 18:36:21,206 INFO Batch 0, Day 0: Setting 5 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,207 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 1: Setting 16 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 2: Setting 7 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,208 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 0: Setting 8 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,209 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,210 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 0: Setting 5 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,211 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 1: Setting 7 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 3: Setting 4 messages to True
2025-06-15 18:36:21,212 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,212 INFO Batch 6, Day 0: Setting 6 messages to True
2025-06-15 18:36:21,212 INFO Batch 6, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,213 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,213 INFO Batch 7, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,213 INFO Batch 7, Day 1: Setting 12 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 2: Setting 8 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,214 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,214 INFO Batch 8, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,214 INFO Batch 8, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,215 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,215 INFO Batch 9, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 1: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 2: Setting 20 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,216 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 0: Setting 7 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 2: Setting 5 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,217 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 2: Setting 5 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,218 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,218 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,219 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,219 INFO Batch 13, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,220 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,221 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,222 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,222 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,222 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,223 INFO Batch 16, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,224 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,224 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,225 INFO Batch 17, Day 3: Setting 2 messages to True
2025-06-15 18:36:21,225 INFO Batch 17, Day 4: Setting 3 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,225 INFO Batch 18, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,226 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,226 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,226 INFO Batch 19, Day 0: Setting 4 messages to True
2025-06-15 18:36:21,226 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 2: Setting 11 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,227 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,227 INFO Batch 20, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,228 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,229 INFO Batch 21, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,230 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,230 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,230 INFO Batch 22, Day 0: Setting 20 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 1: Setting 4 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,231 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,231 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,232 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,232 INFO Batch 24, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,232 INFO Batch 24, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,233 INFO Batch 24, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,233 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,234 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,234 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,234 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 2: Setting 3 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 3: Setting 3 messages to True
2025-06-15 18:36:21,235 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,235 INFO Batch 26, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 2: Setting 4 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,236 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,237 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,238 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 0: Setting 1 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 1: Setting 3 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,238 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 3: Setting 2 messages to True
2025-06-15 18:36:21,239 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 0: Setting 3 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 1: Setting 2 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:36:21,240 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,241 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 0: Setting 2 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:36:21,241 INFO Batch 31, Day 2: Setting 2 messages to True
2025-06-15 18:36:21,242 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:21,242 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:21,242 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:21,242 INFO Message mask non-zero count: 357 out of 3200
2025-06-15 18:36:21,243 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:37,759 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:37,759 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:37,760 INFO Sample n_msgs values: [1 3 4]
2025-06-15 18:36:37,760 INFO Batch 0, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 2: Setting 4 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,761 INFO Batch 0, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,762 INFO Batch 1, Day 3: Setting 3 messages to True
2025-06-15 18:36:37,763 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,763 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,764 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,764 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,765 INFO Batch 3, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 3, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,765 INFO Batch 4, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,766 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,766 INFO Batch 5, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,767 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 0: Setting 5 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 1: Setting 11 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 2: Setting 8 messages to True
2025-06-15 18:36:37,768 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 0: Setting 6 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 1: Setting 7 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,769 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,770 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,770 INFO Batch 8, Day 0: Setting 11 messages to True
2025-06-15 18:36:37,770 INFO Batch 8, Day 1: Setting 3 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,771 INFO Batch 9, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,772 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,772 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 2: Setting 4 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,773 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,774 INFO Batch 12, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,774 INFO Batch 12, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 2: Setting 5 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 3: Setting 6 messages to True
2025-06-15 18:36:37,775 INFO Batch 12, Day 4: Setting 1 messages to True
2025-06-15 18:36:37,775 INFO Batch 13, Day 0: Setting 10 messages to True
2025-06-15 18:36:37,775 INFO Batch 13, Day 1: Setting 13 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 2: Setting 10 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,776 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,776 INFO Batch 14, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,776 INFO Batch 14, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,777 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,777 INFO Batch 15, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,777 INFO Batch 15, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,778 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 2: Setting 3 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,779 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 3: Setting 1 messages to True
2025-06-15 18:36:37,780 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,781 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,782 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,784 INFO Batch 20, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,785 INFO Batch 20, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,785 INFO Batch 21, Day 0: Setting 2 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 1: Setting 18 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 2: Setting 8 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,786 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 1: Setting 20 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,787 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,788 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 1: Setting 2 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,789 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,790 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,790 INFO Batch 25, Day 2: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 25, Day 3: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 25, Day 4: Setting 2 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 0: Setting 9 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 1: Setting 7 messages to True
2025-06-15 18:36:37,791 INFO Batch 26, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,792 INFO Batch 27, Day 0: Setting 7 messages to True
2025-06-15 18:36:37,792 INFO Batch 27, Day 1: Setting 19 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,793 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,793 INFO Batch 28, Day 0: Setting 4 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 1: Setting 6 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 2: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,794 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,795 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 0: Setting 5 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 1: Setting 15 messages to True
2025-06-15 18:36:37,796 INFO Batch 30, Day 2: Setting 14 messages to True
2025-06-15 18:36:37,797 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,797 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,797 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:36:37,797 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:37,798 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:37,799 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:37,799 INFO Message mask non-zero count: 339 out of 3200
2025-06-15 18:36:37,799 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:36:58,041 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:36:58,041 INFO n_msgs_batch shape: Not a list
2025-06-15 18:36:58,042 INFO Sample n_msgs values: [3 4 1]
2025-06-15 18:36:58,042 INFO Batch 0, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,043 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,043 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,043 INFO Batch 1, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,044 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,044 INFO Batch 2, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 1: Setting 10 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,045 INFO Batch 2, Day 4: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 2: Setting 3 messages to True
2025-06-15 18:36:58,046 INFO Batch 3, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,047 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,047 INFO Batch 4, Day 0: Setting 17 messages to True
2025-06-15 18:36:58,047 INFO Batch 4, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 2: Setting 17 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,048 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,048 INFO Batch 5, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,048 INFO Batch 5, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 2: Setting 10 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,049 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,049 INFO Batch 6, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,050 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,051 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,051 INFO Batch 7, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,051 INFO Batch 7, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,052 INFO Batch 7, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,052 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,053 INFO Batch 8, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,053 INFO Batch 8, Day 2: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 8, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,054 INFO Batch 9, Day 0: Setting 5 messages to True
2025-06-15 18:36:58,054 INFO Batch 9, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,055 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,056 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,057 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,057 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,058 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,058 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,058 INFO Batch 12, Day 0: Setting 10 messages to True
2025-06-15 18:36:58,058 INFO Batch 12, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,059 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,059 INFO Batch 13, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 2: Setting 5 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,060 INFO Batch 13, Day 4: Setting 4 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 0: Setting 4 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,061 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,062 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,062 INFO Batch 15, Day 0: Setting 10 messages to True
2025-06-15 18:36:58,062 INFO Batch 15, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 2: Setting 19 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,063 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,063 INFO Batch 16, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 1: Setting 3 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,064 INFO Batch 16, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 2: Setting 4 messages to True
2025-06-15 18:36:58,065 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,066 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,066 INFO Batch 18, Day 2: Setting 4 messages to True
2025-06-15 18:36:58,067 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,067 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,067 INFO Batch 19, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,067 INFO Batch 19, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,068 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,068 INFO Batch 20, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,069 INFO Batch 20, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,070 INFO Batch 20, Day 4: Setting 4 messages to True
2025-06-15 18:36:58,070 INFO Batch 21, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 2: Setting 11 messages to True
2025-06-15 18:36:58,071 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,072 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,072 INFO Batch 22, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,072 INFO Batch 22, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 2: Setting 2 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,073 INFO Batch 22, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,073 INFO Batch 23, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,074 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,075 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,075 INFO Batch 24, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,076 INFO Batch 24, Day 3: Setting 2 messages to True
2025-06-15 18:36:58,076 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,076 INFO Batch 25, Day 0: Setting 3 messages to True
2025-06-15 18:36:58,076 INFO Batch 25, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 2: Setting 7 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,077 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 1: Setting 2 messages to True
2025-06-15 18:36:58,078 INFO Batch 26, Day 2: Setting 3 messages to True
2025-06-15 18:36:58,079 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,079 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,079 INFO Batch 27, Day 0: Setting 9 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,080 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 0: Setting 2 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 1: Setting 4 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,081 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,082 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:36:58,082 INFO Batch 29, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,083 INFO Batch 29, Day 3: Setting 1 messages to True
2025-06-15 18:36:58,083 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,083 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 1: Setting 6 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 2: Setting 0 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,084 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 1: Setting 8 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 2: Setting 1 messages to True
2025-06-15 18:36:58,085 INFO Batch 31, Day 3: Setting 0 messages to True
2025-06-15 18:36:58,086 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:36:58,086 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:36:58,086 INFO Message mask non-zero count: 341 out of 3200
2025-06-15 18:36:58,087 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:37:16,922 INFO n_msgs_batch type: <class 'numpy.ndarray'>
2025-06-15 18:37:16,922 INFO n_msgs_batch shape: Not a list
2025-06-15 18:37:16,923 INFO Sample n_msgs values: [4 9 0]
2025-06-15 18:37:16,923 INFO Batch 0, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,923 INFO Batch 0, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,923 INFO Batch 0, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 0, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 0, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,924 INFO Batch 1, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,924 INFO Batch 1, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 1, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,925 INFO Batch 2, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 1: Setting 3 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,926 INFO Batch 2, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,926 INFO Batch 3, Day 0: Setting 8 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 2: Setting 13 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 3: Setting 5 messages to True
2025-06-15 18:37:16,927 INFO Batch 3, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,927 INFO Batch 4, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,927 INFO Batch 4, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,928 INFO Batch 4, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,928 INFO Batch 5, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,928 INFO Batch 5, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,929 INFO Batch 5, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,929 INFO Batch 6, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,929 INFO Batch 6, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,930 INFO Batch 6, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,930 INFO Batch 7, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 1: Setting 20 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 2: Setting 6 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 3: Setting 6 messages to True
2025-06-15 18:37:16,931 INFO Batch 7, Day 4: Setting 5 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 2: Setting 7 messages to True
2025-06-15 18:37:16,932 INFO Batch 8, Day 3: Setting 2 messages to True
2025-06-15 18:37:16,933 INFO Batch 8, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 0: Setting 9 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,933 INFO Batch 9, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 9, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 9, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,934 INFO Batch 10, Day 2: Setting 4 messages to True
2025-06-15 18:37:16,935 INFO Batch 10, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,935 INFO Batch 10, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,935 INFO Batch 11, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,936 INFO Batch 11, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 0: Setting 20 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 1: Setting 11 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 2: Setting 11 messages to True
2025-06-15 18:37:16,936 INFO Batch 12, Day 3: Setting 3 messages to True
2025-06-15 18:37:16,937 INFO Batch 12, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 0: Setting 4 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,937 INFO Batch 13, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,938 INFO Batch 13, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,938 INFO Batch 13, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 0: Setting 9 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 1: Setting 19 messages to True
2025-06-15 18:37:16,938 INFO Batch 14, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,939 INFO Batch 14, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,939 INFO Batch 14, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,939 INFO Batch 15, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,939 INFO Batch 15, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 2: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 15, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,940 INFO Batch 16, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 1: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 2: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 3: Setting 8 messages to True
2025-06-15 18:37:16,941 INFO Batch 16, Day 4: Setting 9 messages to True
2025-06-15 18:37:16,941 INFO Batch 17, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,942 INFO Batch 17, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 1: Setting 6 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,943 INFO Batch 18, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,944 INFO Batch 18, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,944 INFO Batch 19, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,945 INFO Batch 19, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 0: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,945 INFO Batch 20, Day 3: Setting 3 messages to True
2025-06-15 18:37:16,946 INFO Batch 20, Day 4: Setting 7 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,946 INFO Batch 21, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,947 INFO Batch 21, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 0: Setting 3 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 1: Setting 7 messages to True
2025-06-15 18:37:16,947 INFO Batch 22, Day 2: Setting 20 messages to True
2025-06-15 18:37:16,948 INFO Batch 22, Day 3: Setting 10 messages to True
2025-06-15 18:37:16,948 INFO Batch 22, Day 4: Setting 12 messages to True
2025-06-15 18:37:16,948 INFO Batch 23, Day 0: Setting 6 messages to True
2025-06-15 18:37:16,948 INFO Batch 23, Day 1: Setting 2 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,949 INFO Batch 23, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,949 INFO Batch 24, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,949 INFO Batch 24, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 2: Setting 4 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,950 INFO Batch 24, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,950 INFO Batch 25, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,951 INFO Batch 25, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,952 INFO Batch 25, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 0: Setting 5 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,952 INFO Batch 26, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,953 INFO Batch 26, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,953 INFO Batch 26, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,953 INFO Batch 27, Day 0: Setting 3 messages to True
2025-06-15 18:37:16,953 INFO Batch 27, Day 1: Setting 4 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 3: Setting 7 messages to True
2025-06-15 18:37:16,954 INFO Batch 27, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,954 INFO Batch 28, Day 0: Setting 6 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 1: Setting 5 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 2: Setting 5 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,955 INFO Batch 28, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 2: Setting 2 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 3: Setting 0 messages to True
2025-06-15 18:37:16,956 INFO Batch 29, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 1: Setting 3 messages to True
2025-06-15 18:37:16,957 INFO Batch 30, Day 2: Setting 1 messages to True
2025-06-15 18:37:16,958 INFO Batch 30, Day 3: Setting 1 messages to True
2025-06-15 18:37:16,958 INFO Batch 30, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,958 INFO Batch 31, Day 0: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 1: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 2: Setting 3 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 3: Setting 1 messages to True
2025-06-15 18:37:16,959 INFO Batch 31, Day 4: Setting 0 messages to True
2025-06-15 18:37:16,960 INFO Message mask created and added to feed_dict with shape (32, 5, 20)
2025-06-15 18:37:16,960 INFO Message mask non-zero count: 462 out of 3200
2025-06-15 18:37:16,960 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:37:29,030 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 18:37:29,030 INFO   PERFORMANCE: Loss=1.4322 | Acc=0.6875 | MCC=0.3968
2025-06-15 18:37:29,032 INFO   LOSS COMPONENTS:
2025-06-15 18:37:29,032 INFO     - Causal Consistency Loss: -0.303763
2025-06-15 18:37:29,032 INFO     - Noise-Aware SRL Loss: 0.325305
2025-06-15 18:37:29,033 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:37:29,033 INFO     Alpha_i sample: 0.1342, Omega_i sample: 0.2418
2025-06-15 18:37:29,033 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:37:29,033 INFO     Volatility: 0.6982, Text Weight: 0.5317, Price Weight: 0.4683
2025-06-15 18:37:29,034 INFO Generating diagnostic plots...
2025-06-15 18:37:31,308 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 18:37:31,308 INFO Saving final checkpoint for test run...
2025-06-15 18:37:31,459 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate2717010154151498949 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate2717010154151498949 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-15 18:37:31,465 INFO Start dev phase...
2025-06-15 18:37:33,539 INFO Created and added message mask to eval feed_dict with shape (32, 5, 20)
2025-06-15 18:37:33,540 INFO Message mask non-zero count: 1966 out of 3200
2025-06-15 18:37:37,389 INFO Evaluated batch for dev phase: size=32.0, acc=0.5000
2025-06-15 18:37:37,702 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:37:37,703 INFO Message mask non-zero count: 114 out of 900
2025-06-15 18:37:38,924 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:37:39,170 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:37:39,170 INFO Message mask non-zero count: 8 out of 100
2025-06-15 18:37:39,707 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 18:37:40,033 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:37:40,033 INFO Message mask non-zero count: 106 out of 900
2025-06-15 18:37:41,372 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:37:42,131 INFO Created and added message mask to eval feed_dict with shape (2, 5, 20)
2025-06-15 18:37:42,131 INFO Message mask non-zero count: 31 out of 200
2025-06-15 18:37:42,755 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 18:37:43,560 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:37:43,561 INFO Message mask non-zero count: 23 out of 300
2025-06-15 18:37:44,263 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:37:45,283 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:37:45,284 INFO Message mask non-zero count: 221 out of 1700
2025-06-15 18:37:47,268 INFO Evaluated batch for dev phase: size=17.0, acc=0.6471
2025-06-15 18:37:47,556 INFO Created and added message mask to eval feed_dict with shape (8, 5, 20)
2025-06-15 18:37:47,556 INFO Message mask non-zero count: 52 out of 800
2025-06-15 18:37:48,815 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 18:37:49,133 INFO Created and added message mask to eval feed_dict with shape (21, 5, 20)
2025-06-15 18:37:49,133 INFO Message mask non-zero count: 342 out of 2100
2025-06-15 18:37:52,062 INFO Evaluated batch for dev phase: size=21.0, acc=0.3810
2025-06-15 18:37:52,367 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:37:52,368 INFO Message mask non-zero count: 241 out of 2000
2025-06-15 18:37:54,908 INFO Evaluated batch for dev phase: size=20.0, acc=0.8000
2025-06-15 18:37:55,226 INFO Created and added message mask to eval feed_dict with shape (19, 5, 20)
2025-06-15 18:37:55,227 INFO Message mask non-zero count: 270 out of 1900
2025-06-15 18:37:57,636 INFO Evaluated batch for dev phase: size=19.0, acc=0.4737
2025-06-15 18:37:58,160 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:37:58,160 INFO Message mask non-zero count: 20 out of 400
2025-06-15 18:37:58,968 INFO Evaluated batch for dev phase: size=4.0, acc=0.0000
2025-06-15 18:37:59,269 INFO Created and added message mask to eval feed_dict with shape (15, 5, 20)
2025-06-15 18:37:59,270 INFO Message mask non-zero count: 193 out of 1500
2025-06-15 18:38:01,327 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 18:38:01,627 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:38:01,628 INFO Message mask non-zero count: 101 out of 1200
2025-06-15 18:38:03,174 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 18:38:03,710 INFO Created and added message mask to eval feed_dict with shape (7, 5, 20)
2025-06-15 18:38:03,711 INFO Message mask non-zero count: 47 out of 700
2025-06-15 18:38:04,715 INFO Evaluated batch for dev phase: size=7.0, acc=0.7143
2025-06-15 18:38:05,014 INFO Created and added message mask to eval feed_dict with shape (11, 5, 20)
2025-06-15 18:38:05,014 INFO Message mask non-zero count: 89 out of 1100
2025-06-15 18:38:06,475 INFO Evaluated batch for dev phase: size=11.0, acc=0.3636
2025-06-15 18:38:06,778 INFO Created and added message mask to eval feed_dict with shape (14, 5, 20)
2025-06-15 18:38:06,779 INFO Message mask non-zero count: 130 out of 1400
2025-06-15 18:38:08,552 INFO Evaluated batch for dev phase: size=14.0, acc=0.7143
2025-06-15 18:38:09,078 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:38:09,078 INFO Message mask non-zero count: 57 out of 900
2025-06-15 18:38:10,306 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:38:10,568 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:10,568 INFO Message mask non-zero count: 3 out of 100
2025-06-15 18:38:11,089 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:38:11,399 INFO Created and added message mask to eval feed_dict with shape (14, 5, 20)
2025-06-15 18:38:11,400 INFO Message mask non-zero count: 197 out of 1400
2025-06-15 18:38:13,533 INFO Evaluated batch for dev phase: size=14.0, acc=0.3571
2025-06-15 18:38:13,869 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:38:13,870 INFO Message mask non-zero count: 278 out of 2000
2025-06-15 18:38:16,483 INFO Evaluated batch for dev phase: size=20.0, acc=0.4000
2025-06-15 18:38:16,813 INFO Created and added message mask to eval feed_dict with shape (6, 5, 20)
2025-06-15 18:38:16,814 INFO Message mask non-zero count: 43 out of 600
2025-06-15 18:38:18,008 INFO Evaluated batch for dev phase: size=6.0, acc=0.3333
2025-06-15 18:38:18,331 INFO Created and added message mask to eval feed_dict with shape (11, 5, 20)
2025-06-15 18:38:18,332 INFO Message mask non-zero count: 83 out of 1100
2025-06-15 18:38:20,135 INFO Evaluated batch for dev phase: size=11.0, acc=0.5455
2025-06-15 18:38:20,709 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:38:20,710 INFO Message mask non-zero count: 22 out of 400
2025-06-15 18:38:21,751 INFO Evaluated batch for dev phase: size=4.0, acc=0.2500
2025-06-15 18:38:22,081 INFO Created and added message mask to eval feed_dict with shape (6, 5, 20)
2025-06-15 18:38:22,082 INFO Message mask non-zero count: 28 out of 600
2025-06-15 18:38:23,215 INFO Evaluated batch for dev phase: size=6.0, acc=0.5000
2025-06-15 18:38:23,568 INFO Created and added message mask to eval feed_dict with shape (16, 5, 20)
2025-06-15 18:38:23,568 INFO Message mask non-zero count: 266 out of 1600
2025-06-15 18:38:26,107 INFO Evaluated batch for dev phase: size=16.0, acc=0.5000
2025-06-15 18:38:26,887 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:26,888 INFO Message mask non-zero count: 10 out of 300
2025-06-15 18:38:27,618 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:38:27,953 INFO Created and added message mask to eval feed_dict with shape (16, 5, 20)
2025-06-15 18:38:27,954 INFO Message mask non-zero count: 245 out of 1600
2025-06-15 18:38:29,980 INFO Evaluated batch for dev phase: size=16.0, acc=0.5625
2025-06-15 18:38:30,860 INFO Created and added message mask to eval feed_dict with shape (13, 5, 20)
2025-06-15 18:38:30,860 INFO Message mask non-zero count: 162 out of 1300
2025-06-15 18:38:32,764 INFO Evaluated batch for dev phase: size=13.0, acc=0.6154
2025-06-15 18:38:33,014 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:33,014 INFO Message mask non-zero count: 5 out of 100
2025-06-15 18:38:33,576 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:38:33,867 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:33,867 INFO Message mask non-zero count: 21 out of 300
2025-06-15 18:38:34,693 INFO Evaluated batch for dev phase: size=3.0, acc=0.0000
2025-06-15 18:38:34,970 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:34,970 INFO Message mask non-zero count: 18 out of 300
2025-06-15 18:38:35,702 INFO Evaluated batch for dev phase: size=3.0, acc=0.6667
2025-06-15 18:38:36,202 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:38:36,202 INFO Message mask non-zero count: 39 out of 400
2025-06-15 18:38:37,095 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 18:38:37,336 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:38:37,337 INFO Message mask non-zero count: 3 out of 100
2025-06-15 18:38:37,885 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 18:38:38,255 INFO Created and added message mask to eval feed_dict with shape (28, 5, 20)
2025-06-15 18:38:38,255 INFO Message mask non-zero count: 922 out of 2800
2025-06-15 18:38:41,323 INFO Evaluated batch for dev phase: size=28.0, acc=0.4643
2025-06-15 18:38:41,665 INFO Created and added message mask to eval feed_dict with shape (28, 5, 20)
2025-06-15 18:38:41,666 INFO Message mask non-zero count: 795 out of 2800
2025-06-15 18:38:44,850 INFO Evaluated batch for dev phase: size=28.0, acc=0.4286
2025-06-15 18:38:45,165 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:38:45,165 INFO Message mask non-zero count: 226 out of 1700
2025-06-15 18:38:47,266 INFO Evaluated batch for dev phase: size=17.0, acc=0.5294
2025-06-15 18:38:47,537 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:38:47,537 INFO Message mask non-zero count: 11 out of 300
2025-06-15 18:38:48,357 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:38:48,704 INFO Created and added message mask to eval feed_dict with shape (13, 5, 20)
2025-06-15 18:38:48,705 INFO Message mask non-zero count: 181 out of 1300
2025-06-15 18:38:50,540 INFO Evaluated batch for dev phase: size=13.0, acc=0.5385
2025-06-15 18:38:50,875 INFO Created and added message mask to eval feed_dict with shape (26, 5, 20)
2025-06-15 18:38:50,876 INFO Message mask non-zero count: 591 out of 2600
2025-06-15 18:38:53,825 INFO Evaluated batch for dev phase: size=26.0, acc=0.6154
2025-06-15 18:38:54,136 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:38:54,136 INFO Message mask non-zero count: 180 out of 1200
2025-06-15 18:38:55,937 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 18:38:56,824 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:38:56,824 INFO Message mask non-zero count: 250 out of 1700
2025-06-15 18:38:58,960 INFO Evaluated batch for dev phase: size=17.0, acc=0.6471
2025-06-15 18:38:59,322 INFO Created and added message mask to eval feed_dict with shape (26, 5, 20)
2025-06-15 18:38:59,323 INFO Message mask non-zero count: 856 out of 2600
2025-06-15 18:39:02,503 INFO Evaluated batch for dev phase: size=26.0, acc=0.6923
2025-06-15 18:39:02,860 INFO Created and added message mask to eval feed_dict with shape (22, 5, 20)
2025-06-15 18:39:02,860 INFO Message mask non-zero count: 286 out of 2200
2025-06-15 18:39:05,353 INFO Evaluated batch for dev phase: size=22.0, acc=0.5455
2025-06-15 18:39:05,784 INFO Created and added message mask to eval feed_dict with shape (31, 5, 20)
2025-06-15 18:39:05,784 INFO Message mask non-zero count: 1658 out of 3100
2025-06-15 18:39:09,111 INFO Evaluated batch for dev phase: size=31.0, acc=0.7419
2025-06-15 18:39:09,445 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:39:09,445 INFO Message mask non-zero count: 495 out of 2000
2025-06-15 18:53:06,414 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 18:53:06,414 INFO Configuration - use_dual_path_srl: True
2025-06-15 18:53:06,414 INFO Configuration - use_enhanced_srl: True
2025-06-15 18:53:06,415 INFO Configuration - use_ca_tsu: True
2025-06-15 18:53:06,415 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 18:53:06,415 INFO Configuration - use_noise_aware_loss: True
2025-06-15 18:53:06,416 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 18:53:06,416 INFO Configuration - variant_type: hedge
2025-06-15 18:53:06,416 INFO Full model configuration:
2025-06-15 18:53:06,416 INFO   alpha: 0.5
2025-06-15 18:53:06,417 INFO   batch_size: 32
2025-06-15 18:53:06,417 INFO   ca_tsu_weight: 0.3
2025-06-15 18:53:06,417 INFO   causal_loss_lambda: 0.3
2025-06-15 18:53:06,418 INFO   clip: 15.0
2025-06-15 18:53:06,418 INFO   consistency_loss_weight: 0.05
2025-06-15 18:53:06,418 INFO   constant_kl_lambda: 0.1
2025-06-15 18:53:06,418 INFO   daily_att: y
2025-06-15 18:53:06,419 INFO   decay_rate: 0.96
2025-06-15 18:53:06,419 INFO   decay_step: 100
2025-06-15 18:53:06,419 INFO   dropout_ce: 0.0
2025-06-15 18:53:06,419 INFO   dropout_mel: 0.0
2025-06-15 18:53:06,420 INFO   dropout_mel_in: 0.3
2025-06-15 18:53:06,420 INFO   dropout_vmd: 0.0
2025-06-15 18:53:06,420 INFO   dropout_vmd_in: 0.3
2025-06-15 18:53:06,421 INFO   enhanced_srl_weight: 0.1
2025-06-15 18:53:06,421 INFO   entropy_regularization_lambda: 0.001
2025-06-15 18:53:06,421 INFO   g_size: 50
2025-06-15 18:53:06,421 INFO   h_size: 150
2025-06-15 18:53:06,422 INFO   init_stock_with_word: 0
2025-06-15 18:53:06,422 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 18:53:06,422 INFO   kl_lambda_start_step: 0
2025-06-15 18:53:06,422 INFO   lr: 0.001
2025-06-15 18:53:06,423 INFO   max_n_days: 5
2025-06-15 18:53:06,423 INFO   max_n_msgs: 20
2025-06-15 18:53:06,424 INFO   max_n_words: 30
2025-06-15 18:53:06,424 INFO   mel_cell_type: gru
2025-06-15 18:53:06,424 INFO   mel_h_size: 100
2025-06-15 18:53:06,424 INFO   mode: all
2025-06-15 18:53:06,425 INFO   momentum: 0.9
2025-06-15 18:53:06,425 INFO   msin_h_size: 100
2025-06-15 18:53:06,425 INFO   n_epochs: 10
2025-06-15 18:53:06,425 INFO   noise_aware_weight: 0.5
2025-06-15 18:53:06,426 INFO   opt: adam
2025-06-15 18:53:06,426 INFO   pathway_competition_type: dynamic
2025-06-15 18:53:06,426 INFO   prediction_loss_weight: 0.1
2025-06-15 18:53:06,426 INFO   residual_connection_weight: 0.1
2025-06-15 18:53:06,427 INFO   shuffle: 1
2025-06-15 18:53:06,427 INFO   stock_embed_size: 150
2025-06-15 18:53:06,427 INFO   td_temporal_attention: True
2025-06-15 18:53:06,427 INFO   use_ca_tsu: True
2025-06-15 18:53:06,427 INFO   use_constant_kl_lambda: 0
2025-06-15 18:53:06,427 INFO   use_dual_path_srl: True
2025-06-15 18:53:06,428 INFO   use_enhanced_srl: True
2025-06-15 18:53:06,428 INFO   use_g_bn: 0
2025-06-15 18:53:06,428 INFO   use_in_bn: 0
2025-06-15 18:53:06,428 INFO   use_noise_aware_loss: True
2025-06-15 18:53:06,428 INFO   use_o_bn: 0
2025-06-15 18:53:06,429 INFO   variant_type: hedge
2025-06-15 18:53:06,429 INFO   vmd_cell_type: gru
2025-06-15 18:53:06,429 INFO   vmd_rec: zh
2025-06-15 18:53:06,430 INFO   volatility_adaptation_factor: 0.3
2025-06-15 18:53:06,430 INFO   volatility_reg_weight: 0.05
2025-06-15 18:53:06,430 INFO   weight_init: xavier-uniform
2025-06-15 18:53:06,430 INFO   word_embed_size: 50
2025-06-15 18:53:06,430 INFO   word_embed_type: glove
2025-06-15 18:53:06,431 INFO   y_size: 2
2025-06-15 18:53:06,431 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 18:53:06,434 INFO Start graph assembling...
2025-06-15 18:53:08,368 INFO use_dual_path_srl: True
2025-06-15 18:53:08,369 INFO variant_type: hedge
2025-06-15 18:53:08,370 INFO use_enhanced_srl: True
2025-06-15 18:53:08,370 INFO Enhanced SRL enabled from config
2025-06-15 18:53:08,370 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 18:53:08,370 INFO SRL condition: True = True and True
2025-06-15 18:53:08,371 INFO Using enhanced dual-path SRL architecture
2025-06-15 18:53:08,371 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 18:53:08,423 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 18:53:08,428 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 18:53:08,461 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 18:53:08,702 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 18:53:08,702 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 18:53:08,703 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 18:53:09,030 INFO Using Temporal Attention (TAP)
2025-06-15 18:53:09,074 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 18:53:09,075 INFO Ca-TSU enabled: True
2025-06-15 18:53:09,075 INFO Enhanced SRL enabled: True
2025-06-15 18:53:09,075 INFO Noise-Aware Loss enabled: True
2025-06-15 18:53:09,090 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:09,091 INFO Adding auxiliary enhancement losses...
2025-06-15 18:53:09,112 INFO Creating Noise-Aware Loss component...
2025-06-15 18:53:09,119 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 18:53:09,120 INFO Creating Causal Consistency Loss component...
2025-06-15 18:53:09,150 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 18:53:09,151 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:09,151 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:53:11,718 INFO Graph assembled successfully.
2025-06-15 18:53:11,720 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:53:11,721 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 18:53:12,021 INFO Verifying model configuration...
2025-06-15 18:53:12,021 INFO Ca-TSU enabled: True
2025-06-15 18:53:12,022 INFO Enhanced SRL enabled: True
2025-06-15 18:53:12,022 INFO Noise-Aware Loss enabled: True
2025-06-15 18:53:12,022 INFO Checking model components for noise-aware loss...
2025-06-15 18:53:12,022 INFO Model has 'use_noise_aware_loss': True
2025-06-15 18:53:12,022 INFO use_noise_aware_loss value: True
2025-06-15 18:53:12,023 INFO Model has 'noise_aware_weight': True
2025-06-15 18:53:12,023 INFO noise_aware_weight value: 0.5
2025-06-15 18:53:12,023 INFO Model has 'noise_aware_loss': False
2025-06-15 18:53:12,023 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 18:53:12,024 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 18:53:12,024 INFO Model has 'reliability_weights': True
2025-06-15 18:53:12,024 INFO Model has 'use_enhanced_srl': True
2025-06-15 18:53:12,024 INFO use_enhanced_srl value: True
2025-06-15 18:53:12,024 INFO Model has 'enhanced_srl_loss': False
2025-06-15 18:53:12,024 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 18:53:12,024 INFO Model has 'use_ca_tsu': True
2025-06-15 18:53:12,024 INFO use_ca_tsu value: True
2025-06-15 18:53:12,026 INFO Model has 'causal_consistency_loss': False
2025-06-15 18:53:12,026 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 18:53:12,026 INFO Model has 'loss_components': True
2025-06-15 18:53:12,026 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 18:53:12,026 INFO Manually activating loss components...
2025-06-15 18:53:12,027 INFO Components manually activated:
2025-06-15 18:53:12,027 INFO use_enhanced_srl: True
2025-06-15 18:53:12,027 INFO use_ca_tsu: True
2025-06-15 18:53:12,027 INFO use_noise_aware_loss: True
2025-06-15 18:53:12,027 INFO use_dual_path_srl: True
2025-06-15 18:53:12,027 INFO Running test_noise_aware_loss...
2025-06-15 18:53:32,145 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 18:53:33,930 INFO Word table initialized
2025-06-15 18:53:33,931 INFO Checking loss components in the model graph...
2025-06-15 18:53:33,931 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:53:33,932 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,933 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,933 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 18:53:33,934 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 18:53:33,935 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 18:53:34,141 INFO Starting training test for 10 batches
2025-06-15 18:53:51,272 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:54:07,194 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 18:54:07,194 INFO   PERFORMANCE: Loss=1.3386 | Acc=0.5000 | MCC=0.0000
2025-06-15 18:54:07,194 INFO   LOSS COMPONENTS:
2025-06-15 18:54:07,195 INFO     - Causal Consistency Loss: 0.216385
2025-06-15 18:54:07,195 INFO     - Noise-Aware SRL Loss: 0.567857
2025-06-15 18:54:07,195 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:54:07,196 INFO     Alpha_i sample: 0.7870, Omega_i sample: 0.4769
2025-06-15 18:54:07,196 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:54:07,197 INFO     Volatility: 0.6493, Text Weight: 0.3604, Price Weight: 0.6396
2025-06-15 18:54:30,875 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:00,788 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:23,756 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:43,296 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:55:57,119 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 18:55:57,119 INFO   PERFORMANCE: Loss=1.5031 | Acc=0.5000 | MCC=-0.0120
2025-06-15 18:55:57,121 INFO   LOSS COMPONENTS:
2025-06-15 18:55:57,121 INFO     - Causal Consistency Loss: -0.081693
2025-06-15 18:55:57,121 INFO     - Noise-Aware SRL Loss: 0.447155
2025-06-15 18:55:57,122 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:55:57,122 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 18:55:57,123 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:55:57,124 INFO     Volatility: 0.6575, Text Weight: 0.4227, Price Weight: 0.5773
2025-06-15 18:56:05,402 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:21,387 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:36,885 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:56:54,854 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:57:15,822 INFO Fetching all tensors from loss_components: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 18:57:30,814 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 18:57:30,816 INFO   PERFORMANCE: Loss=1.5266 | Acc=0.5625 | MCC=0.1291
2025-06-15 18:57:30,816 INFO   LOSS COMPONENTS:
2025-06-15 18:57:30,817 INFO     - Causal Consistency Loss: -0.132024
2025-06-15 18:57:30,818 INFO     - Noise-Aware SRL Loss: 0.259278
2025-06-15 18:57:30,818 INFO   Ca-TSU (Attention on Messages):
2025-06-15 18:57:30,819 INFO     Alpha_i sample: 0.0392, Omega_i sample: 0.1166
2025-06-15 18:57:30,819 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 18:57:30,821 INFO     Volatility: 0.6588, Text Weight: 0.5611, Price Weight: 0.4389
2025-06-15 18:57:30,821 INFO Generating diagnostic plots...
2025-06-15 18:57:34,019 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 18:57:34,020 INFO Saving final checkpoint for test run...
2025-06-15 18:57:34,287 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate16299212146189351773 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2209, MSIN_RNN/market_projection/kernel/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2213, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2215, MSIN_RNN/text_price_cross_attention/dense/bias/_2217, MSIN_RNN/text_price_cross_attention/dense/kernel/_2219, MSIN_RNN/text_self_attention/LayerNorm/beta/_2221, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2223, MSIN_RNN/text_self_attention/dense/bias/_2225, MSIN_RNN/text_self_attention/dense/kernel/_2227, W_f/_2229, W_ha/_2231, W_hf/_2233, W_hk/_2235, W_ho/_2237, W_hs/_2239, W_ht/_2241, W_hv/_2243, W_k/_2245, W_o/_2247, W_price_pred/_2249, W_price_pred/Adam/_2251, W_price_pred/Adam_1/_2253, W_reliability/_2255, W_reliability/Adam/_2257, W_reliability/Adam_1/_2259, W_s/_2261, W_sa/_2263, W_t/_2265, W_v/_2267, W_vk/_2269, b_price_pred/_2271, b_price_pred/Adam/_2273, b_price_pred/Adam_1/_2275, b_reliability/_2277, b_reliability/Adam/_2279, b_reliability/Adam_1/_2281, ca_tsu/W_K/_2283, ca_tsu/W_K/Adam/_2285, ca_tsu/W_K/Adam_1/_2287, ca_tsu/W_Q/_2289, ca_tsu/W_Q/Adam/_2291, ca_tsu/W_Q/Adam_1/_2293, ca_tsu/b_causal/_2295, ca_tsu/b_causal/Adam/_2297, ca_tsu/b_causal/Adam_1/_2299, embeds/word_table/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2311, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2347, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2419, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2421, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2443, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2467, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2469, mie/Variable/_2471, mie/Variable_1/_2473, mie/Variable_2/_2475, mie/Variable_3/_2477, mie/Variable_4/_2479, mie/Variable_5/_2481, mie/Variable_6/_2483, mie/Variable_7/_2485, optimizer/beta1_power/_2487, optimizer/beta2_power/_2489, tda/pred_from_gT_att_logits/bias/_2491, tda/pred_from_gT_att_logits/bias/Adam/_2493, tda/pred_from_gT_att_logits/bias/Adam_1/_2495, tda/pred_from_gT_att_logits/kernel/_2497, tda/pred_from_gT_att_logits/kernel/Adam/_2499, tda/pred_from_gT_att_logits/kernel/Adam_1/_2501, tda/v_i/g_projection_att/kernel/_2503, tda/v_i/g_projection_att/kernel/Adam/_2505, tda/v_i/g_projection_att/kernel/Adam_1/_2507, tda/v_i/w_i_temporal_att/_2509, tda/v_i/w_i_temporal_att/Adam/_2511, tda/v_i/w_i_temporal_att/Adam_1/_2513, text_diff_projection/bias/_2515, text_diff_projection/bias/Adam/_2517, text_diff_projection/bias/Adam_1/_2519, text_diff_projection/kernel/_2521, text_diff_projection/kernel/Adam/_2523, text_diff_projection/kernel/Adam_1/_2525, text_price_cross_attention/dense/_2527, text_price_cross_attention/wk/_2529, text_price_cross_attention/wq/_2531, text_price_cross_attention/wv/_2533, text_self_attention/dense/_2535, text_self_attention/wk/_2537, text_self_attention/wq/_2539, text_self_attention/wv/_2541, u_t/linear_layer/W/_2543, u_t/linear_layer/W/Adam/_2545, u_t/linear_layer/W/Adam_1/_2547, u_t/w_u_original/_2549, u_t/w_u_original/Adam/_2551, u_t/w_u_original/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2563, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2575, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2587, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2599, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2623, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2635, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2647, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2659, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2661)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate16299212146189351773 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2209, MSIN_RNN/market_projection/kernel/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2213, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2215, MSIN_RNN/text_price_cross_attention/dense/bias/_2217, MSIN_RNN/text_price_cross_attention/dense/kernel/_2219, MSIN_RNN/text_self_attention/LayerNorm/beta/_2221, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2223, MSIN_RNN/text_self_attention/dense/bias/_2225, MSIN_RNN/text_self_attention/dense/kernel/_2227, W_f/_2229, W_ha/_2231, W_hf/_2233, W_hk/_2235, W_ho/_2237, W_hs/_2239, W_ht/_2241, W_hv/_2243, W_k/_2245, W_o/_2247, W_price_pred/_2249, W_price_pred/Adam/_2251, W_price_pred/Adam_1/_2253, W_reliability/_2255, W_reliability/Adam/_2257, W_reliability/Adam_1/_2259, W_s/_2261, W_sa/_2263, W_t/_2265, W_v/_2267, W_vk/_2269, b_price_pred/_2271, b_price_pred/Adam/_2273, b_price_pred/Adam_1/_2275, b_reliability/_2277, b_reliability/Adam/_2279, b_reliability/Adam_1/_2281, ca_tsu/W_K/_2283, ca_tsu/W_K/Adam/_2285, ca_tsu/W_K/Adam_1/_2287, ca_tsu/W_Q/_2289, ca_tsu/W_Q/Adam/_2291, ca_tsu/W_Q/Adam_1/_2293, ca_tsu/b_causal/_2295, ca_tsu/b_causal/Adam/_2297, ca_tsu/b_causal/Adam_1/_2299, embeds/word_table/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2311, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2347, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2419, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2421, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2443, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2467, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2469, mie/Variable/_2471, mie/Variable_1/_2473, mie/Variable_2/_2475, mie/Variable_3/_2477, mie/Variable_4/_2479, mie/Variable_5/_2481, mie/Variable_6/_2483, mie/Variable_7/_2485, optimizer/beta1_power/_2487, optimizer/beta2_power/_2489, tda/pred_from_gT_att_logits/bias/_2491, tda/pred_from_gT_att_logits/bias/Adam/_2493, tda/pred_from_gT_att_logits/bias/Adam_1/_2495, tda/pred_from_gT_att_logits/kernel/_2497, tda/pred_from_gT_att_logits/kernel/Adam/_2499, tda/pred_from_gT_att_logits/kernel/Adam_1/_2501, tda/v_i/g_projection_att/kernel/_2503, tda/v_i/g_projection_att/kernel/Adam/_2505, tda/v_i/g_projection_att/kernel/Adam_1/_2507, tda/v_i/w_i_temporal_att/_2509, tda/v_i/w_i_temporal_att/Adam/_2511, tda/v_i/w_i_temporal_att/Adam_1/_2513, text_diff_projection/bias/_2515, text_diff_projection/bias/Adam/_2517, text_diff_projection/bias/Adam_1/_2519, text_diff_projection/kernel/_2521, text_diff_projection/kernel/Adam/_2523, text_diff_projection/kernel/Adam_1/_2525, text_price_cross_attention/dense/_2527, text_price_cross_attention/wk/_2529, text_price_cross_attention/wq/_2531, text_price_cross_attention/wv/_2533, text_self_attention/dense/_2535, text_self_attention/wk/_2537, text_self_attention/wq/_2539, text_self_attention/wv/_2541, u_t/linear_layer/W/_2543, u_t/linear_layer/W/Adam/_2545, u_t/linear_layer/W/Adam_1/_2547, u_t/w_u_original/_2549, u_t/w_u_original/Adam/_2551, u_t/w_u_original/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2563, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2575, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2587, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2599, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2623, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2635, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2647, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2659, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2661)]]

2025-06-15 18:57:34,290 INFO Start dev phase...
2025-06-15 18:57:36,805 INFO Created and added message mask to eval feed_dict with shape (32, 5, 20)
2025-06-15 18:57:36,806 INFO Message mask non-zero count: 1966 out of 3200
2025-06-15 18:57:41,276 INFO Evaluated batch for dev phase: size=32.0, acc=0.4375
2025-06-15 18:57:41,620 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:57:41,621 INFO Message mask non-zero count: 114 out of 900
2025-06-15 18:57:43,182 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:57:43,448 INFO Created and added message mask to eval feed_dict with shape (1, 5, 20)
2025-06-15 18:57:43,448 INFO Message mask non-zero count: 8 out of 100
2025-06-15 18:57:44,011 INFO Evaluated batch for dev phase: size=1.0, acc=0.0000
2025-06-15 18:57:44,367 INFO Created and added message mask to eval feed_dict with shape (9, 5, 20)
2025-06-15 18:57:44,367 INFO Message mask non-zero count: 106 out of 900
2025-06-15 18:57:45,868 INFO Evaluated batch for dev phase: size=9.0, acc=0.4444
2025-06-15 18:57:46,674 INFO Created and added message mask to eval feed_dict with shape (2, 5, 20)
2025-06-15 18:57:46,675 INFO Message mask non-zero count: 31 out of 200
2025-06-15 18:57:47,285 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 18:57:48,061 INFO Created and added message mask to eval feed_dict with shape (3, 5, 20)
2025-06-15 18:57:48,061 INFO Message mask non-zero count: 23 out of 300
2025-06-15 18:57:48,793 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 18:57:49,813 INFO Created and added message mask to eval feed_dict with shape (17, 5, 20)
2025-06-15 18:57:49,815 INFO Message mask non-zero count: 221 out of 1700
2025-06-15 18:57:52,040 INFO Evaluated batch for dev phase: size=17.0, acc=0.3529
2025-06-15 18:57:52,334 INFO Created and added message mask to eval feed_dict with shape (8, 5, 20)
2025-06-15 18:57:52,335 INFO Message mask non-zero count: 52 out of 800
2025-06-15 18:57:53,623 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 18:57:53,939 INFO Created and added message mask to eval feed_dict with shape (21, 5, 20)
2025-06-15 18:57:53,940 INFO Message mask non-zero count: 342 out of 2100
2025-06-15 18:57:56,949 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 18:57:57,281 INFO Created and added message mask to eval feed_dict with shape (20, 5, 20)
2025-06-15 18:57:57,282 INFO Message mask non-zero count: 241 out of 2000
2025-06-15 18:57:59,933 INFO Evaluated batch for dev phase: size=20.0, acc=0.6000
2025-06-15 18:58:00,276 INFO Created and added message mask to eval feed_dict with shape (19, 5, 20)
2025-06-15 18:58:00,277 INFO Message mask non-zero count: 270 out of 1900
2025-06-15 18:58:02,773 INFO Evaluated batch for dev phase: size=19.0, acc=0.5789
2025-06-15 18:58:03,302 INFO Created and added message mask to eval feed_dict with shape (4, 5, 20)
2025-06-15 18:58:03,303 INFO Message mask non-zero count: 20 out of 400
2025-06-15 18:58:04,110 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 18:58:04,453 INFO Created and added message mask to eval feed_dict with shape (15, 5, 20)
2025-06-15 18:58:04,453 INFO Message mask non-zero count: 193 out of 1500
2025-06-15 18:58:06,376 INFO Evaluated batch for dev phase: size=15.0, acc=0.7333
2025-06-15 18:58:06,679 INFO Created and added message mask to eval feed_dict with shape (12, 5, 20)
2025-06-15 18:58:06,680 INFO Message mask non-zero count: 101 out of 1200
2025-06-15 18:58:08,466 INFO Evaluated batch for dev phase: size=12.0, acc=0.5000
2025-06-15 18:58:08,999 INFO Created and added message mask to eval feed_dict with shape (7, 5, 20)
2025-06-15 18:58:08,999 INFO Message mask non-zero count: 47 out of 700
2025-06-15 18:58:10,315 INFO Evaluated batch for dev phase: size=7.0, acc=0.2857
2025-06-15 19:30:39,939 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 19:30:39,940 INFO Configuration - use_dual_path_srl: True
2025-06-15 19:30:39,940 INFO Configuration - use_enhanced_srl: True
2025-06-15 19:30:39,940 INFO Configuration - use_ca_tsu: True
2025-06-15 19:30:39,940 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 19:30:39,940 INFO Configuration - use_noise_aware_loss: True
2025-06-15 19:30:39,941 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 19:30:39,941 INFO Configuration - variant_type: hedge
2025-06-15 19:30:39,941 INFO Full model configuration:
2025-06-15 19:30:39,941 INFO   alpha: 0.5
2025-06-15 19:30:39,941 INFO   batch_size: 32
2025-06-15 19:30:39,941 INFO   ca_tsu_weight: 0.3
2025-06-15 19:30:39,941 INFO   causal_loss_lambda: 0.3
2025-06-15 19:30:39,941 INFO   clip: 15.0
2025-06-15 19:30:39,943 INFO   consistency_loss_weight: 0.05
2025-06-15 19:30:39,943 INFO   constant_kl_lambda: 0.1
2025-06-15 19:30:39,943 INFO   daily_att: y
2025-06-15 19:30:39,943 INFO   decay_rate: 0.96
2025-06-15 19:30:39,943 INFO   decay_step: 100
2025-06-15 19:30:39,944 INFO   dropout_ce: 0.0
2025-06-15 19:30:39,944 INFO   dropout_mel: 0.0
2025-06-15 19:30:39,944 INFO   dropout_mel_in: 0.3
2025-06-15 19:30:39,944 INFO   dropout_vmd: 0.0
2025-06-15 19:30:39,944 INFO   dropout_vmd_in: 0.3
2025-06-15 19:30:39,945 INFO   enhanced_srl_weight: 0.1
2025-06-15 19:30:39,945 INFO   entropy_regularization_lambda: 0.001
2025-06-15 19:30:39,945 INFO   g_size: 50
2025-06-15 19:30:39,945 INFO   h_size: 150
2025-06-15 19:30:39,945 INFO   init_stock_with_word: 0
2025-06-15 19:30:39,946 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 19:30:39,946 INFO   kl_lambda_start_step: 0
2025-06-15 19:30:39,946 INFO   lr: 0.001
2025-06-15 19:30:39,946 INFO   max_n_days: 5
2025-06-15 19:30:39,946 INFO   max_n_msgs: 20
2025-06-15 19:30:39,946 INFO   max_n_words: 30
2025-06-15 19:30:39,947 INFO   mel_cell_type: gru
2025-06-15 19:30:39,947 INFO   mel_h_size: 100
2025-06-15 19:30:39,947 INFO   mode: all
2025-06-15 19:30:39,947 INFO   momentum: 0.9
2025-06-15 19:30:39,947 INFO   msin_h_size: 100
2025-06-15 19:30:39,947 INFO   n_epochs: 10
2025-06-15 19:30:39,947 INFO   noise_aware_weight: 0.5
2025-06-15 19:30:39,948 INFO   opt: adam
2025-06-15 19:30:39,948 INFO   pathway_competition_type: dynamic
2025-06-15 19:30:39,948 INFO   prediction_loss_weight: 0.1
2025-06-15 19:30:39,948 INFO   residual_connection_weight: 0.1
2025-06-15 19:30:39,949 INFO   shuffle: 1
2025-06-15 19:30:39,949 INFO   stock_embed_size: 150
2025-06-15 19:30:39,949 INFO   td_temporal_attention: True
2025-06-15 19:30:39,949 INFO   use_ca_tsu: True
2025-06-15 19:30:39,949 INFO   use_constant_kl_lambda: 0
2025-06-15 19:30:39,949 INFO   use_dual_path_srl: True
2025-06-15 19:30:39,950 INFO   use_enhanced_srl: True
2025-06-15 19:30:39,950 INFO   use_g_bn: 0
2025-06-15 19:30:39,950 INFO   use_in_bn: 0
2025-06-15 19:30:39,950 INFO   use_noise_aware_loss: True
2025-06-15 19:30:39,950 INFO   use_o_bn: 0
2025-06-15 19:30:39,951 INFO   variant_type: hedge
2025-06-15 19:30:39,951 INFO   vmd_cell_type: gru
2025-06-15 19:30:39,951 INFO   vmd_rec: zh
2025-06-15 19:30:39,951 INFO   volatility_adaptation_factor: 0.3
2025-06-15 19:30:39,951 INFO   volatility_reg_weight: 0.05
2025-06-15 19:30:39,951 INFO   weight_init: xavier-uniform
2025-06-15 19:30:39,952 INFO   word_embed_size: 50
2025-06-15 19:30:39,952 INFO   word_embed_type: glove
2025-06-15 19:30:39,952 INFO   y_size: 2
2025-06-15 19:30:39,953 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 19:30:39,955 INFO Start graph assembling...
2025-06-15 19:30:42,011 INFO use_dual_path_srl: True
2025-06-15 19:30:42,011 INFO variant_type: hedge
2025-06-15 19:30:42,013 INFO use_enhanced_srl: True
2025-06-15 19:30:42,013 INFO Enhanced SRL enabled from config
2025-06-15 19:30:42,013 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 19:30:42,014 INFO SRL condition: True = True and True
2025-06-15 19:30:42,014 INFO Using enhanced dual-path SRL architecture
2025-06-15 19:30:42,014 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 19:30:42,066 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 19:30:42,071 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 19:30:42,092 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 19:30:42,361 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 19:30:42,362 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 19:30:42,362 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 19:30:42,727 INFO Using Temporal Attention (TAP)
2025-06-15 19:30:42,783 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 19:30:42,783 INFO Ca-TSU enabled: True
2025-06-15 19:30:42,784 INFO Enhanced SRL enabled: True
2025-06-15 19:30:42,784 INFO Noise-Aware Loss enabled: True
2025-06-15 19:30:42,802 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:30:42,803 INFO Adding auxiliary enhancement losses...
2025-06-15 19:30:42,830 INFO Creating Noise-Aware Loss component...
2025-06-15 19:30:42,844 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 19:30:42,847 INFO Creating Causal Consistency Loss component...
2025-06-15 19:30:42,884 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 19:30:42,884 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:30:42,885 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:30:45,743 INFO Graph assembled successfully.
2025-06-15 19:30:45,745 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:30:45,745 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:30:46,031 INFO Verifying model configuration...
2025-06-15 19:30:46,031 INFO Ca-TSU enabled: True
2025-06-15 19:30:46,031 INFO Enhanced SRL enabled: True
2025-06-15 19:30:46,031 INFO Noise-Aware Loss enabled: True
2025-06-15 19:30:46,033 INFO Checking model components for noise-aware loss...
2025-06-15 19:30:46,033 INFO Model has 'use_noise_aware_loss': True
2025-06-15 19:30:46,033 INFO use_noise_aware_loss value: True
2025-06-15 19:30:46,033 INFO Model has 'noise_aware_weight': True
2025-06-15 19:30:46,033 INFO noise_aware_weight value: 0.5
2025-06-15 19:30:46,033 INFO Model has 'noise_aware_loss': False
2025-06-15 19:30:46,034 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 19:30:46,034 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 19:30:46,034 INFO Model has 'reliability_weights': True
2025-06-15 19:30:46,034 INFO Model has 'use_enhanced_srl': True
2025-06-15 19:30:46,034 INFO use_enhanced_srl value: True
2025-06-15 19:30:46,035 INFO Model has 'enhanced_srl_loss': False
2025-06-15 19:30:46,035 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 19:30:46,035 INFO Model has 'use_ca_tsu': True
2025-06-15 19:30:46,035 INFO use_ca_tsu value: True
2025-06-15 19:30:46,035 INFO Model has 'causal_consistency_loss': False
2025-06-15 19:30:46,035 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 19:30:46,036 INFO Model has 'loss_components': True
2025-06-15 19:30:46,036 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 19:30:46,036 INFO Manually activating loss components...
2025-06-15 19:30:46,036 INFO Components manually activated:
2025-06-15 19:30:46,036 INFO use_enhanced_srl: True
2025-06-15 19:30:46,036 INFO use_ca_tsu: True
2025-06-15 19:30:46,037 INFO use_noise_aware_loss: True
2025-06-15 19:30:46,037 INFO use_dual_path_srl: True
2025-06-15 19:30:46,037 INFO Running test_noise_aware_loss...
2025-06-15 19:31:04,787 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 19:31:06,864 INFO Word table initialized
2025-06-15 19:31:06,865 INFO Checking loss components in the model graph...
2025-06-15 19:31:06,865 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:31:06,866 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,866 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,866 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:31:06,867 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 19:31:06,868 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 19:31:06,982 INFO Starting training test for 10 batches
2025-06-15 19:31:34,559 ERROR Error during test_noise_aware_loss: list indices must be integers or slices, not str
2025-06-15 19:31:34,560 ERROR Traceback (most recent call last):
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 761, in test_noise_aware_loss
    ops_to_run[tensor_name] = getattr(self.model, tensor_name)
TypeError: list indices must be integers or slices, not str

2025-06-15 19:31:34,570 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_193134.txt
2025-06-15 19:31:34,571 INFO Test completed successfully!
2025-06-15 19:42:28,578 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-15 19:42:28,579 INFO Configuration - use_dual_path_srl: True
2025-06-15 19:42:28,579 INFO Configuration - use_enhanced_srl: True
2025-06-15 19:42:28,579 INFO Configuration - use_ca_tsu: True
2025-06-15 19:42:28,580 INFO Configuration - causal_loss_lambda: 0.3
2025-06-15 19:42:28,580 INFO Configuration - use_noise_aware_loss: True
2025-06-15 19:42:28,580 INFO Configuration - noise_aware_weight: 0.5
2025-06-15 19:42:28,580 INFO Configuration - variant_type: hedge
2025-06-15 19:42:28,581 INFO Full model configuration:
2025-06-15 19:42:28,581 INFO   alpha: 0.5
2025-06-15 19:42:28,581 INFO   batch_size: 32
2025-06-15 19:42:28,581 INFO   ca_tsu_weight: 0.3
2025-06-15 19:42:28,581 INFO   causal_loss_lambda: 0.3
2025-06-15 19:42:28,582 INFO   clip: 15.0
2025-06-15 19:42:28,582 INFO   consistency_loss_weight: 0.05
2025-06-15 19:42:28,582 INFO   constant_kl_lambda: 0.1
2025-06-15 19:42:28,582 INFO   daily_att: y
2025-06-15 19:42:28,582 INFO   decay_rate: 0.96
2025-06-15 19:42:28,582 INFO   decay_step: 100
2025-06-15 19:42:28,583 INFO   dropout_ce: 0.0
2025-06-15 19:42:28,583 INFO   dropout_mel: 0.0
2025-06-15 19:42:28,583 INFO   dropout_mel_in: 0.3
2025-06-15 19:42:28,583 INFO   dropout_vmd: 0.0
2025-06-15 19:42:28,584 INFO   dropout_vmd_in: 0.3
2025-06-15 19:42:28,584 INFO   enhanced_srl_weight: 0.1
2025-06-15 19:42:28,584 INFO   entropy_regularization_lambda: 0.001
2025-06-15 19:42:28,584 INFO   g_size: 50
2025-06-15 19:42:28,585 INFO   h_size: 150
2025-06-15 19:42:28,585 INFO   init_stock_with_word: 0
2025-06-15 19:42:28,585 INFO   kl_lambda_anneal_rate: 0.005
2025-06-15 19:42:28,585 INFO   kl_lambda_start_step: 0
2025-06-15 19:42:28,586 INFO   lr: 0.001
2025-06-15 19:42:28,586 INFO   max_n_days: 5
2025-06-15 19:42:28,586 INFO   max_n_msgs: 20
2025-06-15 19:42:28,586 INFO   max_n_words: 30
2025-06-15 19:42:28,587 INFO   mel_cell_type: gru
2025-06-15 19:42:28,587 INFO   mel_h_size: 100
2025-06-15 19:42:28,587 INFO   mode: all
2025-06-15 19:42:28,587 INFO   momentum: 0.9
2025-06-15 19:42:28,587 INFO   msin_h_size: 100
2025-06-15 19:42:28,588 INFO   n_epochs: 10
2025-06-15 19:42:28,588 INFO   noise_aware_weight: 0.5
2025-06-15 19:42:28,588 INFO   opt: adam
2025-06-15 19:42:28,588 INFO   pathway_competition_type: dynamic
2025-06-15 19:42:28,589 INFO   prediction_loss_weight: 0.1
2025-06-15 19:42:28,589 INFO   residual_connection_weight: 0.1
2025-06-15 19:42:28,589 INFO   shuffle: 1
2025-06-15 19:42:28,589 INFO   stock_embed_size: 150
2025-06-15 19:42:28,590 INFO   td_temporal_attention: True
2025-06-15 19:42:28,590 INFO   use_ca_tsu: True
2025-06-15 19:42:28,590 INFO   use_constant_kl_lambda: 0
2025-06-15 19:42:28,590 INFO   use_dual_path_srl: True
2025-06-15 19:42:28,590 INFO   use_enhanced_srl: True
2025-06-15 19:42:28,591 INFO   use_g_bn: 0
2025-06-15 19:42:28,591 INFO   use_in_bn: 0
2025-06-15 19:42:28,591 INFO   use_noise_aware_loss: True
2025-06-15 19:42:28,591 INFO   use_o_bn: 0
2025-06-15 19:42:28,592 INFO   variant_type: hedge
2025-06-15 19:42:28,592 INFO   vmd_cell_type: gru
2025-06-15 19:42:28,592 INFO   vmd_rec: zh
2025-06-15 19:42:28,592 INFO   volatility_adaptation_factor: 0.3
2025-06-15 19:42:28,592 INFO   volatility_reg_weight: 0.05
2025-06-15 19:42:28,593 INFO   weight_init: xavier-uniform
2025-06-15 19:42:28,593 INFO   word_embed_size: 50
2025-06-15 19:42:28,593 INFO   word_embed_type: glove
2025-06-15 19:42:28,593 INFO   y_size: 2
2025-06-15 19:42:28,594 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-15 19:42:28,597 INFO Start graph assembling...
2025-06-15 19:42:30,453 INFO use_dual_path_srl: True
2025-06-15 19:42:30,454 INFO variant_type: hedge
2025-06-15 19:42:30,454 INFO use_enhanced_srl: True
2025-06-15 19:42:30,454 INFO Enhanced SRL enabled from config
2025-06-15 19:42:30,455 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-15 19:42:30,455 INFO SRL condition: True = True and True
2025-06-15 19:42:30,455 INFO Using enhanced dual-path SRL architecture
2025-06-15 19:42:30,455 INFO Creating Enhanced Dual-Path SRL module...
2025-06-15 19:42:30,503 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-15 19:42:30,508 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-15 19:42:30,530 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-15 19:42:30,767 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-15 19:42:30,768 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-15 19:42:30,768 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-15 19:42:31,066 INFO Using Temporal Attention (TAP)
2025-06-15 19:42:31,111 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-15 19:42:31,111 INFO Ca-TSU enabled: True
2025-06-15 19:42:31,111 INFO Enhanced SRL enabled: True
2025-06-15 19:42:31,111 INFO Noise-Aware Loss enabled: True
2025-06-15 19:42:31,126 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:31,127 INFO Adding auxiliary enhancement losses...
2025-06-15 19:42:31,152 INFO Creating Noise-Aware Loss component...
2025-06-15 19:42:31,161 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-15 19:42:31,162 INFO Creating Causal Consistency Loss component...
2025-06-15 19:42:31,197 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-15 19:42:31,197 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:31,198 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:42:33,706 INFO Graph assembled successfully.
2025-06-15 19:42:33,707 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:42:33,708 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-15 19:42:34,002 INFO Verifying model configuration...
2025-06-15 19:42:34,003 INFO Ca-TSU enabled: True
2025-06-15 19:42:34,003 INFO Enhanced SRL enabled: True
2025-06-15 19:42:34,003 INFO Noise-Aware Loss enabled: True
2025-06-15 19:42:34,004 INFO Checking model components for noise-aware loss...
2025-06-15 19:42:34,004 INFO Model has 'use_noise_aware_loss': True
2025-06-15 19:42:34,004 INFO use_noise_aware_loss value: True
2025-06-15 19:42:34,004 INFO Model has 'noise_aware_weight': True
2025-06-15 19:42:34,004 INFO noise_aware_weight value: 0.5
2025-06-15 19:42:34,005 INFO Model has 'noise_aware_loss': False
2025-06-15 19:42:34,005 INFO Model has 'separate_noise_aware_loss': False
2025-06-15 19:42:34,005 INFO Model has 'noise_aware_loss_raw': False
2025-06-15 19:42:34,005 INFO Model has 'reliability_weights': True
2025-06-15 19:42:34,005 INFO Model has 'use_enhanced_srl': True
2025-06-15 19:42:34,006 INFO use_enhanced_srl value: True
2025-06-15 19:42:34,006 INFO Model has 'enhanced_srl_loss': False
2025-06-15 19:42:34,006 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-15 19:42:34,006 INFO Model has 'use_ca_tsu': True
2025-06-15 19:42:34,006 INFO use_ca_tsu value: True
2025-06-15 19:42:34,007 INFO Model has 'causal_consistency_loss': False
2025-06-15 19:42:34,007 INFO Model has 'causal_consistency_loss_raw': False
2025-06-15 19:42:34,007 INFO Model has 'loss_components': True
2025-06-15 19:42:34,007 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-15 19:42:34,008 INFO Manually activating loss components...
2025-06-15 19:42:34,008 INFO Components manually activated:
2025-06-15 19:42:34,008 INFO use_enhanced_srl: True
2025-06-15 19:42:34,008 INFO use_ca_tsu: True
2025-06-15 19:42:34,009 INFO use_noise_aware_loss: True
2025-06-15 19:42:34,009 INFO use_dual_path_srl: True
2025-06-15 19:42:34,009 INFO Running test_noise_aware_loss...
2025-06-15 19:42:52,295 INFO ASSEMBLE: word table #replacement: 19482
2025-06-15 19:42:53,672 INFO Word table initialized
2025-06-15 19:42:53,672 INFO Checking loss components in the model graph...
2025-06-15 19:42:53,673 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-15 19:42:53,673 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,673 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,673 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-15 19:42:53,674 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-15 19:42:53,674 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [UNAVAILABLE]
 Raw Noise-Aware Loss: [UNAVAILABLE]
============================================================

2025-06-15 19:42:53,765 INFO Starting training test for 10 batches
2025-06-15 19:43:32,546 INFO --- Batch 1/10 (Step 1) ---
2025-06-15 19:43:32,546 INFO   PERFORMANCE: Loss=1.3541 | Acc=0.5000 | MCC=0.0667
2025-06-15 19:43:32,547 INFO   LOSS COMPONENTS:
2025-06-15 19:43:32,547 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:43:32,548 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:43:32,549 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:43:32,549 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-15 19:43:32,550 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:43:32,551 INFO     Volatility: 0.6823, Text Weight: 0.4486, Price Weight: 0.5514
2025-06-15 19:45:08,788 INFO --- Batch 5/10 (Step 5) ---
2025-06-15 19:45:08,788 INFO   PERFORMANCE: Loss=1.5291 | Acc=0.4375 | MCC=-0.1524
2025-06-15 19:45:08,789 INFO   LOSS COMPONENTS:
2025-06-15 19:45:08,789 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:45:08,789 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:45:08,790 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:45:08,790 INFO     Alpha_i sample: 0.5267, Omega_i sample: 0.4717
2025-06-15 19:45:08,791 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:45:08,792 INFO     Volatility: 0.6630, Text Weight: 0.5136, Price Weight: 0.4864
2025-06-15 19:46:40,909 INFO --- Batch 10/10 (Step 10) ---
2025-06-15 19:46:40,909 INFO   PERFORMANCE: Loss=1.4441 | Acc=0.5312 | MCC=-0.1556
2025-06-15 19:46:40,909 INFO   LOSS COMPONENTS:
2025-06-15 19:46:40,910 INFO     - Causal Consistency Loss: 0.000000
2025-06-15 19:46:40,910 INFO     - Noise-Aware SRL Loss: 0.000000
2025-06-15 19:46:40,910 INFO   Ca-TSU (Attention on Messages):
2025-06-15 19:46:40,911 INFO     Alpha_i sample: 0.0256, Omega_i sample: 0.1006
2025-06-15 19:46:40,911 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-15 19:46:40,915 INFO     Volatility: 0.6656, Text Weight: 0.4793, Price Weight: 0.5207
2025-06-15 19:46:40,916 INFO Generating diagnostic plots...
2025-06-15 19:46:43,379 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-15 19:46:43,379 INFO Saving final checkpoint for test run...
2025-06-15 19:46:43,586 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate11164020777254175702 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2203, MSIN_RNN/market_projection/kernel/_2205, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2207, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2209, MSIN_RNN/text_price_cross_attention/dense/bias/_2211, MSIN_RNN/text_price_cross_attention/dense/kernel/_2213, MSIN_RNN/text_self_attention/LayerNorm/beta/_2215, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2217, MSIN_RNN/text_self_attention/dense/bias/_2219, MSIN_RNN/text_self_attention/dense/kernel/_2221, W_f/_2223, W_ha/_2225, W_hf/_2227, W_hk/_2229, W_ho/_2231, W_hs/_2233, W_ht/_2235, W_hv/_2237, W_k/_2239, W_o/_2241, W_price_pred/_2243, W_price_pred/Adam/_2245, W_price_pred/Adam_1/_2247, W_reliability/_2249, W_reliability/Adam/_2251, W_reliability/Adam_1/_2253, W_s/_2255, W_sa/_2257, W_t/_2259, W_v/_2261, W_vk/_2263, b_price_pred/_2265, b_price_pred/Adam/_2267, b_price_pred/Adam_1/_2269, b_reliability/_2271, b_reliability/Adam/_2273, b_reliability/Adam_1/_2275, ca_tsu/W_K/_2277, ca_tsu/W_K/Adam/_2279, ca_tsu/W_K/Adam_1/_2281, ca_tsu/W_Q/_2283, ca_tsu/W_Q/Adam/_2285, ca_tsu/W_Q/Adam_1/_2287, ca_tsu/b_causal/_2289, ca_tsu/b_causal/Adam/_2291, ca_tsu/b_causal/Adam_1/_2293, embeds/word_table/_2295, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2297, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2343, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2345, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2415, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2419, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2463, mie/Variable/_2465, mie/Variable_1/_2467, mie/Variable_2/_2469, mie/Variable_3/_2471, mie/Variable_4/_2473, mie/Variable_5/_2475, mie/Variable_6/_2477, mie/Variable_7/_2479, optimizer/beta1_power/_2481, optimizer/beta2_power/_2483, tda/pred_from_gT_att_logits/bias/_2485, tda/pred_from_gT_att_logits/bias/Adam/_2487, tda/pred_from_gT_att_logits/bias/Adam_1/_2489, tda/pred_from_gT_att_logits/kernel/_2491, tda/pred_from_gT_att_logits/kernel/Adam/_2493, tda/pred_from_gT_att_logits/kernel/Adam_1/_2495, tda/v_i/g_projection_att/kernel/_2497, tda/v_i/g_projection_att/kernel/Adam/_2499, tda/v_i/g_projection_att/kernel/Adam_1/_2501, tda/v_i/w_i_temporal_att/_2503, tda/v_i/w_i_temporal_att/Adam/_2505, tda/v_i/w_i_temporal_att/Adam_1/_2507, text_diff_projection/bias/_2509, text_diff_projection/bias/Adam/_2511, text_diff_projection/bias/Adam_1/_2513, text_diff_projection/kernel/_2515, text_diff_projection/kernel/Adam/_2517, text_diff_projection/kernel/Adam_1/_2519, text_price_cross_attention/dense/_2521, text_price_cross_attention/wk/_2523, text_price_cross_attention/wq/_2525, text_price_cross_attention/wv/_2527, text_self_attention/dense/_2529, text_self_attention/wk/_2531, text_self_attention/wq/_2533, text_self_attention/wv/_2535, u_t/linear_layer/W/_2537, u_t/linear_layer/W/Adam/_2539, u_t/linear_layer/W/Adam_1/_2541, u_t/w_u_original/_2543, u_t/w_u_original/Adam/_2545, u_t/w_u_original/Adam_1/_2547, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2549, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2559, vmd_zh_rec_iter/gru_cell/candidate/bias/_2561, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2567, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/gates/bias/_2573, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/kernel/_2579, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2583, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2585, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2597, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_mu/W/_2609, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/b/_2615, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2619, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2621, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2631, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2633, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_mu/W/_2645, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/b/_2651, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2655)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate11164020777254175702 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2203, MSIN_RNN/market_projection/kernel/_2205, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2207, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2209, MSIN_RNN/text_price_cross_attention/dense/bias/_2211, MSIN_RNN/text_price_cross_attention/dense/kernel/_2213, MSIN_RNN/text_self_attention/LayerNorm/beta/_2215, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2217, MSIN_RNN/text_self_attention/dense/bias/_2219, MSIN_RNN/text_self_attention/dense/kernel/_2221, W_f/_2223, W_ha/_2225, W_hf/_2227, W_hk/_2229, W_ho/_2231, W_hs/_2233, W_ht/_2235, W_hv/_2237, W_k/_2239, W_o/_2241, W_price_pred/_2243, W_price_pred/Adam/_2245, W_price_pred/Adam_1/_2247, W_reliability/_2249, W_reliability/Adam/_2251, W_reliability/Adam_1/_2253, W_s/_2255, W_sa/_2257, W_t/_2259, W_v/_2261, W_vk/_2263, b_price_pred/_2265, b_price_pred/Adam/_2267, b_price_pred/Adam_1/_2269, b_reliability/_2271, b_reliability/Adam/_2273, b_reliability/Adam_1/_2275, ca_tsu/W_K/_2277, ca_tsu/W_K/Adam/_2279, ca_tsu/W_K/Adam_1/_2281, ca_tsu/W_Q/_2283, ca_tsu/W_Q/Adam/_2285, ca_tsu/W_Q/Adam_1/_2287, ca_tsu/b_causal/_2289, ca_tsu/b_causal/Adam/_2291, ca_tsu/b_causal/Adam_1/_2293, embeds/word_table/_2295, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2297, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2343, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2345, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2415, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2419, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2463, mie/Variable/_2465, mie/Variable_1/_2467, mie/Variable_2/_2469, mie/Variable_3/_2471, mie/Variable_4/_2473, mie/Variable_5/_2475, mie/Variable_6/_2477, mie/Variable_7/_2479, optimizer/beta1_power/_2481, optimizer/beta2_power/_2483, tda/pred_from_gT_att_logits/bias/_2485, tda/pred_from_gT_att_logits/bias/Adam/_2487, tda/pred_from_gT_att_logits/bias/Adam_1/_2489, tda/pred_from_gT_att_logits/kernel/_2491, tda/pred_from_gT_att_logits/kernel/Adam/_2493, tda/pred_from_gT_att_logits/kernel/Adam_1/_2495, tda/v_i/g_projection_att/kernel/_2497, tda/v_i/g_projection_att/kernel/Adam/_2499, tda/v_i/g_projection_att/kernel/Adam_1/_2501, tda/v_i/w_i_temporal_att/_2503, tda/v_i/w_i_temporal_att/Adam/_2505, tda/v_i/w_i_temporal_att/Adam_1/_2507, text_diff_projection/bias/_2509, text_diff_projection/bias/Adam/_2511, text_diff_projection/bias/Adam_1/_2513, text_diff_projection/kernel/_2515, text_diff_projection/kernel/Adam/_2517, text_diff_projection/kernel/Adam_1/_2519, text_price_cross_attention/dense/_2521, text_price_cross_attention/wk/_2523, text_price_cross_attention/wq/_2525, text_price_cross_attention/wv/_2527, text_self_attention/dense/_2529, text_self_attention/wk/_2531, text_self_attention/wq/_2533, text_self_attention/wv/_2535, u_t/linear_layer/W/_2537, u_t/linear_layer/W/Adam/_2539, u_t/linear_layer/W/Adam_1/_2541, u_t/w_u_original/_2543, u_t/w_u_original/Adam/_2545, u_t/w_u_original/Adam_1/_2547, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2549, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2559, vmd_zh_rec_iter/gru_cell/candidate/bias/_2561, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2565, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2567, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2571, vmd_zh_rec_iter/gru_cell/gates/bias/_2573, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2577, vmd_zh_rec_iter/gru_cell/gates/kernel/_2579, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2583, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2585, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2595, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2597, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2607, vmd_zh_rec_iter/z_posterior/z_mu/W/_2609, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2613, vmd_zh_rec_iter/z_posterior/z_mu/b/_2615, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2619, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2621, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2631, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2633, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2643, vmd_zh_rec_iter/z_prior/z_mu/W/_2645, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2649, vmd_zh_rec_iter/z_prior/z_mu/b/_2651, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2655)]]

2025-06-15 19:46:43,589 INFO Start dev phase...
2025-06-15 19:46:50,484 INFO Evaluated batch for dev phase: size=32.0, acc=0.5625
2025-06-15 19:46:52,177 INFO Evaluated batch for dev phase: size=9.0, acc=0.3333
2025-06-15 19:46:53,090 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:46:54,901 INFO Evaluated batch for dev phase: size=9.0, acc=0.3333
2025-06-15 19:46:56,469 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 19:46:58,005 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:01,645 INFO Evaluated batch for dev phase: size=17.0, acc=0.3529
2025-06-15 19:47:03,338 INFO Evaluated batch for dev phase: size=8.0, acc=0.6250
2025-06-15 19:47:06,419 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 19:47:09,359 INFO Evaluated batch for dev phase: size=20.0, acc=0.5500
2025-06-15 19:47:12,083 INFO Evaluated batch for dev phase: size=19.0, acc=0.4737
2025-06-15 19:47:13,729 INFO Evaluated batch for dev phase: size=4.0, acc=0.7500
2025-06-15 19:47:16,278 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 19:47:18,495 INFO Evaluated batch for dev phase: size=12.0, acc=0.5000
2025-06-15 19:47:20,510 INFO Evaluated batch for dev phase: size=7.0, acc=0.7143
2025-06-15 19:47:22,478 INFO Evaluated batch for dev phase: size=11.0, acc=0.1818
2025-06-15 19:47:24,781 INFO Evaluated batch for dev phase: size=14.0, acc=0.5000
2025-06-15 19:47:26,839 INFO Evaluated batch for dev phase: size=9.0, acc=0.1111
2025-06-15 19:47:27,618 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:29,726 INFO Evaluated batch for dev phase: size=14.0, acc=0.5000
2025-06-15 19:47:32,548 INFO Evaluated batch for dev phase: size=20.0, acc=0.5500
2025-06-15 19:47:33,944 INFO Evaluated batch for dev phase: size=6.0, acc=0.6667
2025-06-15 19:47:35,781 INFO Evaluated batch for dev phase: size=11.0, acc=0.2727
2025-06-15 19:47:37,105 INFO Evaluated batch for dev phase: size=4.0, acc=0.5000
2025-06-15 19:47:38,476 INFO Evaluated batch for dev phase: size=6.0, acc=0.5000
2025-06-15 19:47:40,820 INFO Evaluated batch for dev phase: size=16.0, acc=0.4375
2025-06-15 19:47:42,327 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:44,769 INFO Evaluated batch for dev phase: size=16.0, acc=0.5000
2025-06-15 19:47:47,294 INFO Evaluated batch for dev phase: size=13.0, acc=0.4615
2025-06-15 19:47:48,088 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:49,291 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:50,341 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:47:51,638 INFO Evaluated batch for dev phase: size=4.0, acc=0.2500
2025-06-15 19:47:52,439 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:47:55,976 INFO Evaluated batch for dev phase: size=28.0, acc=0.4286
2025-06-15 19:47:59,590 INFO Evaluated batch for dev phase: size=28.0, acc=0.3214
2025-06-15 19:48:02,202 INFO Evaluated batch for dev phase: size=17.0, acc=0.4706
2025-06-15 19:48:03,296 INFO Evaluated batch for dev phase: size=3.0, acc=0.3333
2025-06-15 19:48:05,729 INFO Evaluated batch for dev phase: size=13.0, acc=0.3846
2025-06-15 19:48:09,394 INFO Evaluated batch for dev phase: size=26.0, acc=0.4615
2025-06-15 19:48:11,294 INFO Evaluated batch for dev phase: size=12.0, acc=0.4167
2025-06-15 19:48:14,305 INFO Evaluated batch for dev phase: size=17.0, acc=0.7059
2025-06-15 19:48:17,575 INFO Evaluated batch for dev phase: size=26.0, acc=0.4231
2025-06-15 19:48:20,759 INFO Evaluated batch for dev phase: size=22.0, acc=0.5909
2025-06-15 19:48:24,865 INFO Evaluated batch for dev phase: size=31.0, acc=0.6129
2025-06-15 19:48:28,080 INFO Evaluated batch for dev phase: size=20.0, acc=0.5000
2025-06-15 19:48:29,741 INFO Evaluated batch for dev phase: size=6.0, acc=0.6667
2025-06-15 19:48:31,645 INFO Evaluated batch for dev phase: size=8.0, acc=0.3750
2025-06-15 19:48:34,502 INFO Evaluated batch for dev phase: size=21.0, acc=0.4762
2025-06-15 19:48:36,644 INFO Evaluated batch for dev phase: size=15.0, acc=0.4000
2025-06-15 19:48:40,391 INFO Evaluated batch for dev phase: size=24.0, acc=0.6250
2025-06-15 19:48:41,252 INFO Evaluated batch for dev phase: size=2.0, acc=0.5000
2025-06-15 19:48:42,279 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:48:43,285 INFO Evaluated batch for dev phase: size=1.0, acc=1.0000
2025-06-15 19:48:43,760 INFO Completed dev evaluation: size=656.0, acc=0.4787
2025-06-15 19:48:43,761 INFO 	Eval, eval loss: 1.4466718435287476, acc: 0.478659
2025-06-15 19:48:43,920 INFO Test summary saved to results/model_test/enhancement_test_summary_20250615_194843.txt
2025-06-15 19:48:43,921 INFO Test completed successfully!
2025-06-16 00:07:53,649 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 00:07:53,650 INFO Configuration - use_dual_path_srl: True
2025-06-16 00:07:53,650 INFO Configuration - use_enhanced_srl: True
2025-06-16 00:07:53,651 INFO Configuration - use_ca_tsu: True
2025-06-16 00:07:53,651 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 00:07:53,651 INFO Configuration - use_noise_aware_loss: True
2025-06-16 00:07:53,652 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 00:07:53,652 INFO Configuration - variant_type: hedge
2025-06-16 00:07:53,652 INFO Full model configuration:
2025-06-16 00:07:53,653 INFO   alpha: 0.5
2025-06-16 00:07:53,653 INFO   batch_size: 32
2025-06-16 00:07:53,653 INFO   ca_tsu_weight: 0.3
2025-06-16 00:07:53,653 INFO   causal_loss_lambda: 0.3
2025-06-16 00:07:53,654 INFO   clip: 15.0
2025-06-16 00:07:53,654 INFO   consistency_loss_weight: 0.05
2025-06-16 00:07:53,654 INFO   constant_kl_lambda: 0.1
2025-06-16 00:07:53,655 INFO   daily_att: y
2025-06-16 00:07:53,655 INFO   decay_rate: 0.96
2025-06-16 00:07:53,655 INFO   decay_step: 100
2025-06-16 00:07:53,655 INFO   dropout_ce: 0.0
2025-06-16 00:07:53,656 INFO   dropout_mel: 0.0
2025-06-16 00:07:53,656 INFO   dropout_mel_in: 0.3
2025-06-16 00:07:53,656 INFO   dropout_vmd: 0.0
2025-06-16 00:07:53,656 INFO   dropout_vmd_in: 0.3
2025-06-16 00:07:53,657 INFO   enhanced_srl_weight: 0.1
2025-06-16 00:07:53,657 INFO   entropy_regularization_lambda: 0.001
2025-06-16 00:07:53,657 INFO   g_size: 50
2025-06-16 00:07:53,658 INFO   h_size: 150
2025-06-16 00:07:53,658 INFO   init_stock_with_word: 0
2025-06-16 00:07:53,658 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 00:07:53,658 INFO   kl_lambda_start_step: 0
2025-06-16 00:07:53,659 INFO   lr: 0.001
2025-06-16 00:07:53,659 INFO   max_n_days: 5
2025-06-16 00:07:53,659 INFO   max_n_msgs: 20
2025-06-16 00:07:53,660 INFO   max_n_words: 30
2025-06-16 00:07:53,660 INFO   mel_cell_type: gru
2025-06-16 00:07:53,660 INFO   mel_h_size: 100
2025-06-16 00:07:53,660 INFO   mode: all
2025-06-16 00:07:53,661 INFO   momentum: 0.9
2025-06-16 00:07:53,661 INFO   msin_h_size: 100
2025-06-16 00:07:53,661 INFO   n_epochs: 10
2025-06-16 00:07:53,661 INFO   noise_aware_weight: 0.5
2025-06-16 00:07:53,662 INFO   opt: adam
2025-06-16 00:07:53,662 INFO   pathway_competition_type: dynamic
2025-06-16 00:07:53,662 INFO   prediction_loss_weight: 0.1
2025-06-16 00:07:53,662 INFO   residual_connection_weight: 0.1
2025-06-16 00:07:53,663 INFO   shuffle: 1
2025-06-16 00:07:53,663 INFO   stock_embed_size: 150
2025-06-16 00:07:53,663 INFO   td_temporal_attention: True
2025-06-16 00:07:53,663 INFO   use_ca_tsu: True
2025-06-16 00:07:53,663 INFO   use_constant_kl_lambda: 0
2025-06-16 00:07:53,664 INFO   use_dual_path_srl: True
2025-06-16 00:07:53,664 INFO   use_enhanced_srl: True
2025-06-16 00:07:53,664 INFO   use_g_bn: 0
2025-06-16 00:07:53,664 INFO   use_in_bn: 0
2025-06-16 00:07:53,665 INFO   use_noise_aware_loss: True
2025-06-16 00:07:53,665 INFO   use_o_bn: 0
2025-06-16 00:07:53,666 INFO   variant_type: hedge
2025-06-16 00:07:53,666 INFO   vmd_cell_type: gru
2025-06-16 00:07:53,666 INFO   vmd_rec: zh
2025-06-16 00:07:53,666 INFO   volatility_adaptation_factor: 0.3
2025-06-16 00:07:53,667 INFO   volatility_reg_weight: 0.05
2025-06-16 00:07:53,667 INFO   weight_init: xavier-uniform
2025-06-16 00:07:53,667 INFO   word_embed_size: 50
2025-06-16 00:07:53,667 INFO   word_embed_type: glove
2025-06-16 00:07:53,668 INFO   y_size: 2
2025-06-16 00:07:53,669 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 00:07:53,679 INFO Start graph assembling...
2025-06-16 00:07:55,559 INFO use_dual_path_srl: True
2025-06-16 00:07:55,559 INFO variant_type: hedge
2025-06-16 00:07:55,560 INFO use_enhanced_srl: True
2025-06-16 00:07:55,560 INFO Enhanced SRL enabled from config
2025-06-16 00:07:55,560 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 00:07:55,561 INFO SRL condition: True = True and True
2025-06-16 00:07:55,561 INFO Using enhanced dual-path SRL architecture
2025-06-16 00:07:55,561 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 00:07:55,621 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 00:07:55,627 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 00:07:55,651 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 00:07:55,898 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 00:07:55,899 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 00:07:55,899 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 00:07:56,233 INFO Using Temporal Attention (TAP)
2025-06-16 00:07:56,280 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 00:07:56,280 INFO Ca-TSU enabled: True
2025-06-16 00:07:56,280 INFO Enhanced SRL enabled: True
2025-06-16 00:07:56,281 INFO Noise-Aware Loss enabled: True
2025-06-16 00:07:56,298 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:07:56,298 INFO Adding auxiliary enhancement losses...
2025-06-16 00:07:56,321 INFO Creating Noise-Aware Loss component...
2025-06-16 00:07:56,331 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 00:07:56,332 INFO Creating Causal Consistency Loss component...
2025-06-16 00:07:56,365 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 00:07:56,366 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:07:56,367 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:07:59,111 INFO Graph assembled successfully.
2025-06-16 00:07:59,114 INFO Ensured checkpoint directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:07:59,114 INFO Ensured graph directory exists: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\graphs_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:07:59,449 INFO Verifying model configuration...
2025-06-16 00:07:59,449 INFO Ca-TSU enabled: True
2025-06-16 00:07:59,450 INFO Enhanced SRL enabled: True
2025-06-16 00:07:59,450 INFO Noise-Aware Loss enabled: True
2025-06-16 00:07:59,450 INFO Checking model components for noise-aware loss...
2025-06-16 00:07:59,450 INFO Model has 'use_noise_aware_loss': True
2025-06-16 00:07:59,451 INFO use_noise_aware_loss value: True
2025-06-16 00:07:59,451 INFO Model has 'noise_aware_weight': True
2025-06-16 00:07:59,451 INFO noise_aware_weight value: 0.5
2025-06-16 00:07:59,451 INFO Model has 'noise_aware_loss': False
2025-06-16 00:07:59,452 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 00:07:59,452 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 00:07:59,452 INFO Model has 'reliability_weights': True
2025-06-16 00:07:59,452 INFO Model has 'use_enhanced_srl': True
2025-06-16 00:07:59,452 INFO use_enhanced_srl value: True
2025-06-16 00:07:59,453 INFO Model has 'enhanced_srl_loss': False
2025-06-16 00:07:59,453 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 00:07:59,453 INFO Model has 'use_ca_tsu': True
2025-06-16 00:07:59,453 INFO use_ca_tsu value: True
2025-06-16 00:07:59,454 INFO Model has 'causal_consistency_loss': False
2025-06-16 00:07:59,454 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 00:07:59,454 INFO Model has 'loss_components': True
2025-06-16 00:07:59,454 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 00:07:59,455 INFO Manually activating loss components...
2025-06-16 00:07:59,455 INFO Components manually activated:
2025-06-16 00:07:59,455 INFO use_enhanced_srl: True
2025-06-16 00:07:59,455 INFO use_ca_tsu: True
2025-06-16 00:07:59,456 INFO use_noise_aware_loss: True
2025-06-16 00:07:59,456 INFO use_dual_path_srl: True
2025-06-16 00:07:59,456 INFO Running test_noise_aware_loss...
2025-06-16 00:08:18,239 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 00:08:20,168 INFO Word table initialized
2025-06-16 00:08:20,168 INFO Checking loss components in the model graph...
2025-06-16 00:08:20,168 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:08:20,169 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,169 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,169 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:08:20,170 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 00:08:20,170 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 00:08:20,276 INFO Starting training test for 10 batches
2025-06-16 00:08:56,121 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 00:08:56,121 INFO   PERFORMANCE: Loss=1.2272 | Acc=0.4688 | MCC=-0.0658
2025-06-16 00:08:56,122 INFO   LOSS COMPONENTS:
2025-06-16 00:08:56,122 INFO     - Causal Consistency Loss: -0.104554
2025-06-16 00:08:56,122 INFO     - Noise-Aware SRL Loss: 0.567192
2025-06-16 00:08:56,122 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:08:56,123 INFO     Alpha_i sample: 0.7313, Omega_i sample: 0.4296
2025-06-16 00:08:56,123 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:08:56,125 INFO     Volatility: 0.6336, Text Weight: 0.3901, Price Weight: 0.6099
2025-06-16 00:10:28,050 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 00:10:28,051 INFO   PERFORMANCE: Loss=1.4263 | Acc=0.4688 | MCC=0.0170
2025-06-16 00:10:28,052 INFO   LOSS COMPONENTS:
2025-06-16 00:10:28,052 INFO     - Causal Consistency Loss: -0.438606
2025-06-16 00:10:28,052 INFO     - Noise-Aware SRL Loss: 0.478382
2025-06-16 00:10:28,053 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:10:28,053 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:10:28,054 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:10:28,055 INFO     Volatility: 0.6410, Text Weight: 0.3082, Price Weight: 0.6918
2025-06-16 00:12:10,773 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 00:12:10,773 INFO   PERFORMANCE: Loss=1.4287 | Acc=0.6250 | MCC=0.2277
2025-06-16 00:12:10,773 INFO   LOSS COMPONENTS:
2025-06-16 00:12:10,774 INFO     - Causal Consistency Loss: -0.539270
2025-06-16 00:12:10,774 INFO     - Noise-Aware SRL Loss: 0.379341
2025-06-16 00:12:10,774 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:12:10,775 INFO     Alpha_i sample: 0.5108, Omega_i sample: 0.5182
2025-06-16 00:12:10,775 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:12:10,776 INFO     Volatility: 0.6672, Text Weight: 0.3045, Price Weight: 0.6955
2025-06-16 00:12:10,776 INFO Generating diagnostic plots...
2025-06-16 00:12:13,050 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 00:12:13,050 INFO Saving final checkpoint for test run...
2025-06-16 00:12:13,202 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate10565111754745538991 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate10565111754745538991 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 00:12:13,205 INFO Start dev phase...
2025-06-16 00:14:08,732 INFO Completed dev evaluation: size=656.0, acc=0.5015
2025-06-16 00:14:08,733 INFO 	Eval, eval loss: 1.4639867544174194, acc: 0.501524
2025-06-16 00:14:08,913 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_001408.txt
2025-06-16 00:14:08,915 INFO Test completed successfully!
2025-06-16 00:18:27,177 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 00:18:27,178 INFO Configuration - use_dual_path_srl: True
2025-06-16 00:18:27,178 INFO Configuration - use_enhanced_srl: True
2025-06-16 00:18:27,179 INFO Configuration - use_ca_tsu: True
2025-06-16 00:18:27,179 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 00:18:27,179 INFO Configuration - use_noise_aware_loss: True
2025-06-16 00:18:27,179 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 00:18:27,179 INFO Configuration - variant_type: hedge
2025-06-16 00:18:27,180 INFO Full model configuration:
2025-06-16 00:18:27,180 INFO   alpha: 0.5
2025-06-16 00:18:27,180 INFO   batch_size: 32
2025-06-16 00:18:27,180 INFO   ca_tsu_weight: 0.3
2025-06-16 00:18:27,181 INFO   causal_loss_lambda: 0.3
2025-06-16 00:18:27,181 INFO   clip: 15.0
2025-06-16 00:18:27,181 INFO   consistency_loss_weight: 0.05
2025-06-16 00:18:27,181 INFO   constant_kl_lambda: 0.1
2025-06-16 00:18:27,181 INFO   daily_att: y
2025-06-16 00:18:27,182 INFO   decay_rate: 0.96
2025-06-16 00:18:27,182 INFO   decay_step: 100
2025-06-16 00:18:27,182 INFO   dropout_ce: 0.0
2025-06-16 00:18:27,182 INFO   dropout_mel: 0.0
2025-06-16 00:18:27,182 INFO   dropout_mel_in: 0.3
2025-06-16 00:18:27,182 INFO   dropout_vmd: 0.0
2025-06-16 00:18:27,182 INFO   dropout_vmd_in: 0.3
2025-06-16 00:18:27,184 INFO   enhanced_srl_weight: 0.1
2025-06-16 00:18:27,184 INFO   entropy_regularization_lambda: 0.001
2025-06-16 00:18:27,184 INFO   g_size: 50
2025-06-16 00:18:27,184 INFO   h_size: 150
2025-06-16 00:18:27,185 INFO   init_stock_with_word: 0
2025-06-16 00:18:27,185 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 00:18:27,185 INFO   kl_lambda_start_step: 0
2025-06-16 00:18:27,185 INFO   lr: 0.001
2025-06-16 00:18:27,185 INFO   max_n_days: 5
2025-06-16 00:18:27,186 INFO   max_n_msgs: 20
2025-06-16 00:18:27,186 INFO   max_n_words: 30
2025-06-16 00:18:27,186 INFO   mel_cell_type: gru
2025-06-16 00:18:27,186 INFO   mel_h_size: 100
2025-06-16 00:18:27,187 INFO   mode: all
2025-06-16 00:18:27,187 INFO   momentum: 0.9
2025-06-16 00:18:27,187 INFO   msin_h_size: 100
2025-06-16 00:18:27,187 INFO   n_epochs: 10
2025-06-16 00:18:27,188 INFO   noise_aware_weight: 0.5
2025-06-16 00:18:27,188 INFO   opt: adam
2025-06-16 00:18:27,188 INFO   pathway_competition_type: dynamic
2025-06-16 00:18:27,188 INFO   prediction_loss_weight: 0.1
2025-06-16 00:18:27,188 INFO   residual_connection_weight: 0.1
2025-06-16 00:18:27,189 INFO   shuffle: 1
2025-06-16 00:18:27,189 INFO   stock_embed_size: 150
2025-06-16 00:18:27,189 INFO   td_temporal_attention: True
2025-06-16 00:18:27,189 INFO   use_ca_tsu: True
2025-06-16 00:18:27,189 INFO   use_constant_kl_lambda: 0
2025-06-16 00:18:27,190 INFO   use_dual_path_srl: True
2025-06-16 00:18:27,190 INFO   use_enhanced_srl: True
2025-06-16 00:18:27,190 INFO   use_g_bn: 0
2025-06-16 00:18:27,190 INFO   use_in_bn: 0
2025-06-16 00:18:27,190 INFO   use_noise_aware_loss: True
2025-06-16 00:18:27,191 INFO   use_o_bn: 0
2025-06-16 00:18:27,191 INFO   variant_type: hedge
2025-06-16 00:18:27,191 INFO   vmd_cell_type: gru
2025-06-16 00:18:27,192 INFO   vmd_rec: zh
2025-06-16 00:18:27,192 INFO   volatility_adaptation_factor: 0.3
2025-06-16 00:18:27,192 INFO   volatility_reg_weight: 0.05
2025-06-16 00:18:27,192 INFO   weight_init: xavier-uniform
2025-06-16 00:18:27,193 INFO   word_embed_size: 50
2025-06-16 00:18:27,193 INFO   word_embed_type: glove
2025-06-16 00:18:27,194 INFO   y_size: 2
2025-06-16 00:18:27,195 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 00:18:27,198 INFO Start graph assembling...
2025-06-16 00:18:29,037 INFO use_dual_path_srl: True
2025-06-16 00:18:29,038 INFO variant_type: hedge
2025-06-16 00:18:29,038 INFO use_enhanced_srl: True
2025-06-16 00:18:29,038 INFO Enhanced SRL enabled from config
2025-06-16 00:18:29,039 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 00:18:29,039 INFO SRL condition: True = True and True
2025-06-16 00:18:29,039 INFO Using enhanced dual-path SRL architecture
2025-06-16 00:18:29,039 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 00:18:29,086 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 00:18:29,091 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 00:18:29,112 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 00:18:29,343 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 00:18:29,343 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 00:18:29,343 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 00:18:29,632 INFO Using Temporal Attention (TAP)
2025-06-16 00:18:29,684 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 00:18:29,685 INFO Ca-TSU enabled: True
2025-06-16 00:18:29,685 INFO Enhanced SRL enabled: True
2025-06-16 00:18:29,685 INFO Noise-Aware Loss enabled: True
2025-06-16 00:18:29,705 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:29,706 INFO Adding auxiliary enhancement losses...
2025-06-16 00:18:29,728 INFO Creating Noise-Aware Loss component...
2025-06-16 00:18:29,737 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 00:18:29,738 INFO Creating Causal Consistency Loss component...
2025-06-16 00:18:29,774 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 00:18:29,775 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:29,775 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:18:32,387 INFO Graph assembled successfully.
2025-06-16 00:18:32,389 INFO Ensured checkpoint directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:18:32,389 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 00:18:32,760 INFO Verifying model configuration...
2025-06-16 00:18:32,761 INFO Ca-TSU enabled: True
2025-06-16 00:18:32,761 INFO Enhanced SRL enabled: True
2025-06-16 00:18:32,761 INFO Noise-Aware Loss enabled: True
2025-06-16 00:18:32,762 INFO Checking model components for noise-aware loss...
2025-06-16 00:18:32,762 INFO Model has 'use_noise_aware_loss': True
2025-06-16 00:18:32,762 INFO use_noise_aware_loss value: True
2025-06-16 00:18:32,762 INFO Model has 'noise_aware_weight': True
2025-06-16 00:18:32,762 INFO noise_aware_weight value: 0.5
2025-06-16 00:18:32,763 INFO Model has 'noise_aware_loss': False
2025-06-16 00:18:32,763 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 00:18:32,763 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 00:18:32,763 INFO Model has 'reliability_weights': True
2025-06-16 00:18:32,763 INFO Model has 'use_enhanced_srl': True
2025-06-16 00:18:32,764 INFO use_enhanced_srl value: True
2025-06-16 00:18:32,764 INFO Model has 'enhanced_srl_loss': False
2025-06-16 00:18:32,764 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 00:18:32,764 INFO Model has 'use_ca_tsu': True
2025-06-16 00:18:32,764 INFO use_ca_tsu value: True
2025-06-16 00:18:32,765 INFO Model has 'causal_consistency_loss': False
2025-06-16 00:18:32,765 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 00:18:32,765 INFO Model has 'loss_components': True
2025-06-16 00:18:32,765 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 00:18:32,766 INFO Manually activating loss components...
2025-06-16 00:18:32,766 INFO Components manually activated:
2025-06-16 00:18:32,766 INFO use_enhanced_srl: True
2025-06-16 00:18:32,766 INFO use_ca_tsu: True
2025-06-16 00:18:32,767 INFO use_noise_aware_loss: True
2025-06-16 00:18:32,767 INFO use_dual_path_srl: True
2025-06-16 00:18:32,767 INFO Running test_noise_aware_loss...
2025-06-16 00:18:52,267 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 00:18:53,782 INFO Word table initialized
2025-06-16 00:18:53,782 INFO Checking loss components in the model graph...
2025-06-16 00:18:53,783 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 00:18:53,783 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,783 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,783 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 00:18:53,784 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 00:18:53,784 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 00:18:53,884 INFO Starting training test for 10 batches
2025-06-16 00:19:33,795 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 00:19:33,796 INFO   PERFORMANCE: Loss=1.2826 | Acc=0.6875 | MCC=0.3968
2025-06-16 00:19:33,796 INFO   LOSS COMPONENTS:
2025-06-16 00:19:33,797 INFO     - Causal Consistency Loss: 0.362965
2025-06-16 00:19:33,797 INFO     - Noise-Aware SRL Loss: 0.544637
2025-06-16 00:19:33,798 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:19:33,798 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:19:33,798 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:19:33,799 INFO     Volatility: 0.6333, Text Weight: 0.3961, Price Weight: 0.6039
2025-06-16 00:21:07,349 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 00:21:07,349 INFO   PERFORMANCE: Loss=1.5202 | Acc=0.5000 | MCC=0.0159
2025-06-16 00:21:07,350 INFO   LOSS COMPONENTS:
2025-06-16 00:21:07,350 INFO     - Causal Consistency Loss: 0.117333
2025-06-16 00:21:07,350 INFO     - Noise-Aware SRL Loss: 0.412208
2025-06-16 00:21:07,351 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:21:07,351 INFO     Alpha_i sample: 0.3309, Omega_i sample: 0.5388
2025-06-16 00:21:07,351 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:21:07,352 INFO     Volatility: 0.6566, Text Weight: 0.5679, Price Weight: 0.4321
2025-06-16 00:22:40,762 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 00:22:40,763 INFO   PERFORMANCE: Loss=1.4503 | Acc=0.6250 | MCC=0.3830
2025-06-16 00:22:40,763 INFO   LOSS COMPONENTS:
2025-06-16 00:22:40,764 INFO     - Causal Consistency Loss: -0.069837
2025-06-16 00:22:40,764 INFO     - Noise-Aware SRL Loss: 0.224927
2025-06-16 00:22:40,765 INFO   Ca-TSU (Attention on Messages):
2025-06-16 00:22:40,766 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 00:22:40,766 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 00:22:40,768 INFO     Volatility: 0.6415, Text Weight: 0.7446, Price Weight: 0.2554
2025-06-16 00:22:40,769 INFO Generating diagnostic plots...
2025-06-16 00:22:43,474 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 00:22:43,474 INFO Saving final checkpoint for test run...
2025-06-16 00:22:43,764 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate12414907740630760731 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 60, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate12414907740630760731 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 00:22:43,768 INFO Start dev phase...
2025-06-16 00:24:43,184 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-16 00:24:43,185 INFO 	Eval, eval loss: 1.473867654800415, acc: 0.504573
2025-06-16 00:24:43,503 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_002443.txt
2025-06-16 00:24:43,503 INFO Test completed successfully!
2025-06-16 01:54:53,715 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 01:54:53,715 INFO Configuration - use_dual_path_srl: True
2025-06-16 01:54:53,715 INFO Configuration - use_enhanced_srl: True
2025-06-16 01:54:53,716 INFO Configuration - use_ca_tsu: True
2025-06-16 01:54:53,716 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 01:54:53,716 INFO Configuration - use_noise_aware_loss: True
2025-06-16 01:54:53,716 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 01:54:53,716 INFO Configuration - variant_type: hedge
2025-06-16 01:54:53,716 INFO Full model configuration:
2025-06-16 01:54:53,717 INFO   alpha: 0.5
2025-06-16 01:54:53,717 INFO   batch_size: 32
2025-06-16 01:54:53,717 INFO   ca_tsu_weight: 0.3
2025-06-16 01:54:53,717 INFO   causal_loss_lambda: 0.3
2025-06-16 01:54:53,717 INFO   clip: 15.0
2025-06-16 01:54:53,718 INFO   consistency_loss_weight: 0.05
2025-06-16 01:54:53,718 INFO   constant_kl_lambda: 0.1
2025-06-16 01:54:53,718 INFO   daily_att: y
2025-06-16 01:54:53,718 INFO   decay_rate: 0.96
2025-06-16 01:54:53,718 INFO   decay_step: 100
2025-06-16 01:54:53,718 INFO   dropout_ce: 0.0
2025-06-16 01:54:53,719 INFO   dropout_mel: 0.0
2025-06-16 01:54:53,719 INFO   dropout_mel_in: 0.3
2025-06-16 01:54:53,719 INFO   dropout_vmd: 0.0
2025-06-16 01:54:53,719 INFO   dropout_vmd_in: 0.3
2025-06-16 01:54:53,719 INFO   enhanced_srl_weight: 0.1
2025-06-16 01:54:53,720 INFO   entropy_regularization_lambda: 0.001
2025-06-16 01:54:53,720 INFO   g_size: 50
2025-06-16 01:54:53,720 INFO   h_size: 150
2025-06-16 01:54:53,720 INFO   init_stock_with_word: 0
2025-06-16 01:54:53,720 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 01:54:53,722 INFO   kl_lambda_start_step: 0
2025-06-16 01:54:53,722 INFO   lr: 0.001
2025-06-16 01:54:53,722 INFO   max_n_days: 5
2025-06-16 01:54:53,722 INFO   max_n_msgs: 20
2025-06-16 01:54:53,722 INFO   max_n_words: 30
2025-06-16 01:54:53,723 INFO   mel_cell_type: gru
2025-06-16 01:54:53,723 INFO   mel_h_size: 100
2025-06-16 01:54:53,723 INFO   mode: all
2025-06-16 01:54:53,723 INFO   momentum: 0.9
2025-06-16 01:54:53,723 INFO   msin_h_size: 100
2025-06-16 01:54:53,724 INFO   n_epochs: 10
2025-06-16 01:54:53,724 INFO   noise_aware_weight: 0.5
2025-06-16 01:54:53,724 INFO   opt: adam
2025-06-16 01:54:53,724 INFO   pathway_competition_type: dynamic
2025-06-16 01:54:53,724 INFO   prediction_loss_weight: 0.1
2025-06-16 01:54:53,725 INFO   residual_connection_weight: 0.1
2025-06-16 01:54:53,725 INFO   shuffle: 1
2025-06-16 01:54:53,725 INFO   stock_embed_size: 150
2025-06-16 01:54:53,725 INFO   td_temporal_attention: True
2025-06-16 01:54:53,725 INFO   use_ca_tsu: True
2025-06-16 01:54:53,726 INFO   use_constant_kl_lambda: 0
2025-06-16 01:54:53,726 INFO   use_dual_path_srl: True
2025-06-16 01:54:53,726 INFO   use_enhanced_srl: True
2025-06-16 01:54:53,726 INFO   use_g_bn: 0
2025-06-16 01:54:53,726 INFO   use_in_bn: 0
2025-06-16 01:54:53,727 INFO   use_noise_aware_loss: True
2025-06-16 01:54:53,727 INFO   use_o_bn: 0
2025-06-16 01:54:53,727 INFO   variant_type: hedge
2025-06-16 01:54:53,727 INFO   vmd_cell_type: gru
2025-06-16 01:54:53,727 INFO   vmd_rec: zh
2025-06-16 01:54:53,728 INFO   volatility_adaptation_factor: 0.3
2025-06-16 01:54:53,728 INFO   volatility_reg_weight: 0.05
2025-06-16 01:54:53,728 INFO   weight_init: xavier-uniform
2025-06-16 01:54:53,728 INFO   word_embed_size: 50
2025-06-16 01:54:53,728 INFO   word_embed_type: glove
2025-06-16 01:54:53,728 INFO   y_size: 2
2025-06-16 01:54:53,729 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 01:54:53,746 INFO Start graph assembling...
2025-06-16 01:54:55,805 INFO use_dual_path_srl: True
2025-06-16 01:54:55,806 INFO variant_type: hedge
2025-06-16 01:54:55,806 INFO use_enhanced_srl: True
2025-06-16 01:54:55,806 INFO Enhanced SRL enabled from config
2025-06-16 01:54:55,806 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 01:54:55,807 INFO SRL condition: True = True and True
2025-06-16 01:54:55,807 INFO Using enhanced dual-path SRL architecture
2025-06-16 01:54:55,807 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 01:54:55,853 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 01:54:55,857 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 01:54:55,877 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 01:54:56,099 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 01:54:56,101 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 01:54:56,101 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 01:54:56,377 INFO Using Temporal Attention (TAP)
2025-06-16 01:54:56,424 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 01:54:56,424 INFO Ca-TSU enabled: True
2025-06-16 01:54:56,425 INFO Enhanced SRL enabled: True
2025-06-16 01:54:56,425 INFO Noise-Aware Loss enabled: True
2025-06-16 01:54:56,442 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:54:56,443 INFO Adding auxiliary enhancement losses...
2025-06-16 01:54:56,469 INFO Creating Noise-Aware Loss component...
2025-06-16 01:54:56,479 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 01:54:56,481 INFO Creating Causal Consistency Loss component...
2025-06-16 01:54:56,512 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 01:54:56,513 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:54:56,513 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 01:54:59,044 INFO Graph assembled successfully.
2025-06-16 01:54:59,045 INFO Ensured checkpoint directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 01:54:59,045 INFO Updated saver path: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess
2025-06-16 01:54:59,046 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 01:54:59,333 INFO Verifying model configuration...
2025-06-16 01:54:59,334 INFO Ca-TSU enabled: True
2025-06-16 01:54:59,334 INFO Enhanced SRL enabled: True
2025-06-16 01:54:59,334 INFO Noise-Aware Loss enabled: True
2025-06-16 01:54:59,334 INFO Checking model components for noise-aware loss...
2025-06-16 01:54:59,335 INFO Model has 'use_noise_aware_loss': True
2025-06-16 01:54:59,335 INFO use_noise_aware_loss value: True
2025-06-16 01:54:59,335 INFO Model has 'noise_aware_weight': True
2025-06-16 01:54:59,335 INFO noise_aware_weight value: 0.5
2025-06-16 01:54:59,335 INFO Model has 'noise_aware_loss': False
2025-06-16 01:54:59,336 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 01:54:59,336 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 01:54:59,336 INFO Model has 'reliability_weights': True
2025-06-16 01:54:59,336 INFO Model has 'use_enhanced_srl': True
2025-06-16 01:54:59,336 INFO use_enhanced_srl value: True
2025-06-16 01:54:59,336 INFO Model has 'enhanced_srl_loss': False
2025-06-16 01:54:59,337 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 01:54:59,337 INFO Model has 'use_ca_tsu': True
2025-06-16 01:54:59,337 INFO use_ca_tsu value: True
2025-06-16 01:54:59,337 INFO Model has 'causal_consistency_loss': False
2025-06-16 01:54:59,337 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 01:54:59,338 INFO Model has 'loss_components': True
2025-06-16 01:54:59,338 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 01:54:59,338 INFO Manually activating loss components...
2025-06-16 01:54:59,338 INFO Components manually activated:
2025-06-16 01:54:59,338 INFO use_enhanced_srl: True
2025-06-16 01:54:59,339 INFO use_ca_tsu: True
2025-06-16 01:54:59,339 INFO use_noise_aware_loss: True
2025-06-16 01:54:59,339 INFO use_dual_path_srl: True
2025-06-16 01:54:59,339 INFO Running test_noise_aware_loss...
2025-06-16 01:55:17,287 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 01:55:18,994 INFO Word table initialized
2025-06-16 01:55:18,995 INFO Checking loss components in the model graph...
2025-06-16 01:55:18,995 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 01:55:18,995 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,996 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,996 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 01:55:18,997 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 01:55:18,997 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 01:55:19,090 INFO Starting training test for 10 batches
2025-06-16 01:55:48,644 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 01:55:48,645 INFO   PERFORMANCE: Loss=1.2215 | Acc=0.5938 | MCC=0.1683
2025-06-16 01:55:48,645 INFO   LOSS COMPONENTS:
2025-06-16 01:55:48,645 INFO     - Causal Consistency Loss: -0.001870
2025-06-16 01:55:48,646 INFO     - Noise-Aware SRL Loss: 0.564380
2025-06-16 01:55:48,646 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:55:48,646 INFO     Alpha_i sample: 0.4893, Omega_i sample: 0.5857
2025-06-16 01:55:48,647 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:55:48,647 INFO     Volatility: 0.6509, Text Weight: 0.4045, Price Weight: 0.5955
2025-06-16 01:57:24,359 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 01:57:24,360 INFO   PERFORMANCE: Loss=1.5011 | Acc=0.5625 | MCC=0.1156
2025-06-16 01:57:24,360 INFO   LOSS COMPONENTS:
2025-06-16 01:57:24,360 INFO     - Causal Consistency Loss: -0.209621
2025-06-16 01:57:24,361 INFO     - Noise-Aware SRL Loss: 0.438760
2025-06-16 01:57:24,361 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:57:24,361 INFO     Alpha_i sample: 0.0619, Omega_i sample: 0.0756
2025-06-16 01:57:24,362 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:57:24,363 INFO     Volatility: 0.6682, Text Weight: 0.3983, Price Weight: 0.6017
2025-06-16 01:58:51,088 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 01:58:51,088 INFO   PERFORMANCE: Loss=1.4671 | Acc=0.6562 | MCC=0.3730
2025-06-16 01:58:51,089 INFO   LOSS COMPONENTS:
2025-06-16 01:58:51,089 INFO     - Causal Consistency Loss: -0.397442
2025-06-16 01:58:51,089 INFO     - Noise-Aware SRL Loss: 0.314393
2025-06-16 01:58:51,090 INFO   Ca-TSU (Attention on Messages):
2025-06-16 01:58:51,090 INFO     Alpha_i sample: 0.2372, Omega_i sample: 0.1722
2025-06-16 01:58:51,090 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 01:58:51,091 INFO     Volatility: 0.6815, Text Weight: 0.3715, Price Weight: 0.6285
2025-06-16 01:58:51,091 INFO Generating diagnostic plots...
2025-06-16 01:58:53,459 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 01:58:53,460 INFO Saving final checkpoint for test run...
2025-06-16 01:58:53,614 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate17819015953694519701 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 66, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_checkpoints_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate17819015953694519701 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 01:58:53,616 INFO Start dev phase...
2025-06-16 02:00:46,733 INFO Completed dev evaluation: size=656.0, acc=0.5412
2025-06-16 02:00:46,734 INFO 	Eval, eval loss: 1.4631372690200806, acc: 0.541159
2025-06-16 02:00:46,910 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_020046.txt
2025-06-16 02:00:46,910 INFO Test completed successfully!
2025-06-16 02:06:41,885 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 02:06:41,885 INFO Configuration - use_dual_path_srl: True
2025-06-16 02:06:41,886 INFO Configuration - use_enhanced_srl: True
2025-06-16 02:06:41,886 INFO Configuration - use_ca_tsu: True
2025-06-16 02:06:41,886 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 02:06:41,886 INFO Configuration - use_noise_aware_loss: True
2025-06-16 02:06:41,886 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 02:06:41,886 INFO Configuration - variant_type: hedge
2025-06-16 02:06:41,887 INFO Full model configuration:
2025-06-16 02:06:41,887 INFO   alpha: 0.5
2025-06-16 02:06:41,887 INFO   batch_size: 32
2025-06-16 02:06:41,887 INFO   ca_tsu_weight: 0.3
2025-06-16 02:06:41,887 INFO   causal_loss_lambda: 0.3
2025-06-16 02:06:41,888 INFO   clip: 15.0
2025-06-16 02:06:41,888 INFO   consistency_loss_weight: 0.05
2025-06-16 02:06:41,888 INFO   constant_kl_lambda: 0.1
2025-06-16 02:06:41,888 INFO   daily_att: y
2025-06-16 02:06:41,888 INFO   decay_rate: 0.96
2025-06-16 02:06:41,889 INFO   decay_step: 100
2025-06-16 02:06:41,889 INFO   dropout_ce: 0.0
2025-06-16 02:06:41,889 INFO   dropout_mel: 0.0
2025-06-16 02:06:41,889 INFO   dropout_mel_in: 0.3
2025-06-16 02:06:41,889 INFO   dropout_vmd: 0.0
2025-06-16 02:06:41,890 INFO   dropout_vmd_in: 0.3
2025-06-16 02:06:41,890 INFO   enhanced_srl_weight: 0.1
2025-06-16 02:06:41,890 INFO   entropy_regularization_lambda: 0.001
2025-06-16 02:06:41,890 INFO   g_size: 50
2025-06-16 02:06:41,890 INFO   h_size: 150
2025-06-16 02:06:41,891 INFO   init_stock_with_word: 0
2025-06-16 02:06:41,891 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 02:06:41,891 INFO   kl_lambda_start_step: 0
2025-06-16 02:06:41,891 INFO   lr: 0.001
2025-06-16 02:06:41,891 INFO   max_n_days: 5
2025-06-16 02:06:41,892 INFO   max_n_msgs: 20
2025-06-16 02:06:41,892 INFO   max_n_words: 30
2025-06-16 02:06:41,892 INFO   mel_cell_type: gru
2025-06-16 02:06:41,892 INFO   mel_h_size: 100
2025-06-16 02:06:41,892 INFO   mode: all
2025-06-16 02:06:41,892 INFO   momentum: 0.9
2025-06-16 02:06:41,893 INFO   msin_h_size: 100
2025-06-16 02:06:41,893 INFO   n_epochs: 10
2025-06-16 02:06:41,893 INFO   noise_aware_weight: 0.5
2025-06-16 02:06:41,893 INFO   opt: adam
2025-06-16 02:06:41,893 INFO   pathway_competition_type: dynamic
2025-06-16 02:06:41,894 INFO   prediction_loss_weight: 0.1
2025-06-16 02:06:41,894 INFO   residual_connection_weight: 0.1
2025-06-16 02:06:41,894 INFO   shuffle: 1
2025-06-16 02:06:41,894 INFO   stock_embed_size: 150
2025-06-16 02:06:41,894 INFO   td_temporal_attention: True
2025-06-16 02:06:41,894 INFO   use_ca_tsu: True
2025-06-16 02:06:41,895 INFO   use_constant_kl_lambda: 0
2025-06-16 02:06:41,895 INFO   use_dual_path_srl: True
2025-06-16 02:06:41,895 INFO   use_enhanced_srl: True
2025-06-16 02:06:41,895 INFO   use_g_bn: 0
2025-06-16 02:06:41,895 INFO   use_in_bn: 0
2025-06-16 02:06:41,896 INFO   use_noise_aware_loss: True
2025-06-16 02:06:41,896 INFO   use_o_bn: 0
2025-06-16 02:06:41,896 INFO   variant_type: hedge
2025-06-16 02:06:41,897 INFO   vmd_cell_type: gru
2025-06-16 02:06:41,897 INFO   vmd_rec: zh
2025-06-16 02:06:41,897 INFO   volatility_adaptation_factor: 0.3
2025-06-16 02:06:41,897 INFO   volatility_reg_weight: 0.05
2025-06-16 02:06:41,897 INFO   weight_init: xavier-uniform
2025-06-16 02:06:41,898 INFO   word_embed_size: 50
2025-06-16 02:06:41,898 INFO   word_embed_type: glove
2025-06-16 02:06:41,898 INFO   y_size: 2
2025-06-16 02:06:41,899 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 02:06:41,901 INFO Start graph assembling...
2025-06-16 02:06:43,622 INFO use_dual_path_srl: True
2025-06-16 02:06:43,622 INFO variant_type: hedge
2025-06-16 02:06:43,623 INFO use_enhanced_srl: True
2025-06-16 02:06:43,623 INFO Enhanced SRL enabled from config
2025-06-16 02:06:43,623 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 02:06:43,623 INFO SRL condition: True = True and True
2025-06-16 02:06:43,623 INFO Using enhanced dual-path SRL architecture
2025-06-16 02:06:43,624 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 02:06:43,669 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 02:06:43,676 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 02:06:43,705 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 02:06:43,939 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 02:06:43,939 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 02:06:43,939 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 02:06:44,218 INFO Using Temporal Attention (TAP)
2025-06-16 02:06:44,265 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 02:06:44,266 INFO Ca-TSU enabled: True
2025-06-16 02:06:44,266 INFO Enhanced SRL enabled: True
2025-06-16 02:06:44,266 INFO Noise-Aware Loss enabled: True
2025-06-16 02:06:44,279 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:06:44,280 INFO Adding auxiliary enhancement losses...
2025-06-16 02:06:44,301 INFO Creating Noise-Aware Loss component...
2025-06-16 02:06:44,310 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 02:06:44,312 INFO Creating Causal Consistency Loss component...
2025-06-16 02:06:44,344 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 02:06:44,344 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:06:44,345 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:06:46,741 INFO Graph assembled successfully.
2025-06-16 02:06:46,742 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp
2025-06-16 02:06:47,022 INFO Verifying model configuration...
2025-06-16 02:06:47,023 INFO Ca-TSU enabled: True
2025-06-16 02:06:47,023 INFO Enhanced SRL enabled: True
2025-06-16 02:06:47,023 INFO Noise-Aware Loss enabled: True
2025-06-16 02:06:47,023 INFO Checking model components for noise-aware loss...
2025-06-16 02:06:47,024 INFO Model has 'use_noise_aware_loss': True
2025-06-16 02:06:47,024 INFO use_noise_aware_loss value: True
2025-06-16 02:06:47,024 INFO Model has 'noise_aware_weight': True
2025-06-16 02:06:47,024 INFO noise_aware_weight value: 0.5
2025-06-16 02:06:47,024 INFO Model has 'noise_aware_loss': False
2025-06-16 02:06:47,024 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 02:06:47,025 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 02:06:47,025 INFO Model has 'reliability_weights': True
2025-06-16 02:06:47,025 INFO Model has 'use_enhanced_srl': True
2025-06-16 02:06:47,025 INFO use_enhanced_srl value: True
2025-06-16 02:06:47,025 INFO Model has 'enhanced_srl_loss': False
2025-06-16 02:06:47,026 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 02:06:47,026 INFO Model has 'use_ca_tsu': True
2025-06-16 02:06:47,026 INFO use_ca_tsu value: True
2025-06-16 02:06:47,026 INFO Model has 'causal_consistency_loss': False
2025-06-16 02:06:47,026 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 02:06:47,027 INFO Model has 'loss_components': True
2025-06-16 02:06:47,027 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 02:06:47,027 INFO Manually activating loss components...
2025-06-16 02:06:47,027 INFO Components manually activated:
2025-06-16 02:06:47,027 INFO use_enhanced_srl: True
2025-06-16 02:06:47,027 INFO use_ca_tsu: True
2025-06-16 02:06:47,028 INFO use_noise_aware_loss: True
2025-06-16 02:06:47,028 INFO use_dual_path_srl: True
2025-06-16 02:06:47,028 INFO Running test_noise_aware_loss...
2025-06-16 02:07:05,356 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 02:07:06,863 INFO Word table initialized
2025-06-16 02:07:06,864 INFO Checking loss components in the model graph...
2025-06-16 02:07:06,864 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:07:06,864 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:07:06,865 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 02:07:06,866 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 02:07:06,979 INFO Starting training test for 10 batches
2025-06-16 02:07:37,314 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 02:07:37,315 INFO   PERFORMANCE: Loss=1.2741 | Acc=0.4688 | MCC=-0.0636
2025-06-16 02:07:37,315 INFO   LOSS COMPONENTS:
2025-06-16 02:07:37,316 INFO     - Causal Consistency Loss: -0.027083
2025-06-16 02:07:37,316 INFO     - Noise-Aware SRL Loss: 0.582821
2025-06-16 02:07:37,316 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:07:37,316 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:07:37,316 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:07:37,317 INFO     Volatility: 0.6657, Text Weight: 0.3620, Price Weight: 0.6380
2025-06-16 02:09:18,432 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 02:09:18,433 INFO   PERFORMANCE: Loss=1.3136 | Acc=0.6562 | MCC=0.3235
2025-06-16 02:09:18,434 INFO   LOSS COMPONENTS:
2025-06-16 02:09:18,434 INFO     - Causal Consistency Loss: -0.276444
2025-06-16 02:09:18,435 INFO     - Noise-Aware SRL Loss: 0.449430
2025-06-16 02:09:18,435 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:09:18,436 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:09:18,436 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:09:18,437 INFO     Volatility: 0.6584, Text Weight: 0.3784, Price Weight: 0.6216
2025-06-16 02:10:45,241 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 02:10:45,241 INFO   PERFORMANCE: Loss=1.5016 | Acc=0.5000 | MCC=-0.0120
2025-06-16 02:10:45,242 INFO   LOSS COMPONENTS:
2025-06-16 02:10:45,242 INFO     - Causal Consistency Loss: -0.486508
2025-06-16 02:10:45,243 INFO     - Noise-Aware SRL Loss: 0.343409
2025-06-16 02:10:45,243 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:10:45,244 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:10:45,244 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:10:45,245 INFO     Volatility: 0.6844, Text Weight: 0.3521, Price Weight: 0.6479
2025-06-16 02:10:45,245 INFO Generating diagnostic plots...
2025-06-16 02:10:47,485 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 02:10:47,486 INFO Saving final checkpoint for test run...
2025-06-16 02:10:47,682 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate7345179497305110221 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 66, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate7345179497305110221 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2207, MSIN_RNN/market_projection/kernel/_2209, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2211, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2213, MSIN_RNN/text_price_cross_attention/dense/bias/_2215, MSIN_RNN/text_price_cross_attention/dense/kernel/_2217, MSIN_RNN/text_self_attention/LayerNorm/beta/_2219, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2221, MSIN_RNN/text_self_attention/dense/bias/_2223, MSIN_RNN/text_self_attention/dense/kernel/_2225, W_f/_2227, W_ha/_2229, W_hf/_2231, W_hk/_2233, W_ho/_2235, W_hs/_2237, W_ht/_2239, W_hv/_2241, W_k/_2243, W_o/_2245, W_price_pred/_2247, W_price_pred/Adam/_2249, W_price_pred/Adam_1/_2251, W_reliability/_2253, W_reliability/Adam/_2255, W_reliability/Adam_1/_2257, W_s/_2259, W_sa/_2261, W_t/_2263, W_v/_2265, W_vk/_2267, b_price_pred/_2269, b_price_pred/Adam/_2271, b_price_pred/Adam_1/_2273, b_reliability/_2275, b_reliability/Adam/_2277, b_reliability/Adam_1/_2279, ca_tsu/W_K/_2281, ca_tsu/W_K/Adam/_2283, ca_tsu/W_K/Adam_1/_2285, ca_tsu/W_Q/_2287, ca_tsu/W_Q/Adam/_2289, ca_tsu/W_Q/Adam_1/_2291, ca_tsu/b_causal/_2293, ca_tsu/b_causal/Adam/_2295, ca_tsu/b_causal/Adam_1/_2297, embeds/word_table/_2299, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2301, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2303, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2305, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2307, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2309, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2323, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2325, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2327, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2331, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2333, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2337, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2339, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2341, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2343, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2345, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2395, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2397, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2399, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2401, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2403, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2405, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2407, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2409, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2411, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2413, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2415, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2417, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2419, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2443, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2445, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2447, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2449, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2451, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2453, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2455, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2457, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2459, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2461, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2463, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2465, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2467, mie/Variable/_2469, mie/Variable_1/_2471, mie/Variable_2/_2473, mie/Variable_3/_2475, mie/Variable_4/_2477, mie/Variable_5/_2479, mie/Variable_6/_2481, mie/Variable_7/_2483, optimizer/beta1_power/_2485, optimizer/beta2_power/_2487, tda/pred_from_gT_att_logits/bias/_2489, tda/pred_from_gT_att_logits/bias/Adam/_2491, tda/pred_from_gT_att_logits/bias/Adam_1/_2493, tda/pred_from_gT_att_logits/kernel/_2495, tda/pred_from_gT_att_logits/kernel/Adam/_2497, tda/pred_from_gT_att_logits/kernel/Adam_1/_2499, tda/v_i/g_projection_att/kernel/_2501, tda/v_i/g_projection_att/kernel/Adam/_2503, tda/v_i/g_projection_att/kernel/Adam_1/_2505, tda/v_i/w_i_temporal_att/_2507, tda/v_i/w_i_temporal_att/Adam/_2509, tda/v_i/w_i_temporal_att/Adam_1/_2511, text_diff_projection/bias/_2513, text_diff_projection/bias/Adam/_2515, text_diff_projection/bias/Adam_1/_2517, text_diff_projection/kernel/_2519, text_diff_projection/kernel/Adam/_2521, text_diff_projection/kernel/Adam_1/_2523, text_price_cross_attention/dense/_2525, text_price_cross_attention/wk/_2527, text_price_cross_attention/wq/_2529, text_price_cross_attention/wv/_2531, text_self_attention/dense/_2533, text_self_attention/wk/_2535, text_self_attention/wq/_2537, text_self_attention/wv/_2539, u_t/linear_layer/W/_2541, u_t/linear_layer/W/Adam/_2543, u_t/linear_layer/W/Adam_1/_2545, u_t/w_u_original/_2547, u_t/w_u_original/Adam/_2549, u_t/w_u_original/Adam_1/_2551, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2553, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2555, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2557, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2559, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2561, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2563, vmd_zh_rec_iter/gru_cell/candidate/bias/_2565, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2567, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2569, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2571, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2573, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2575, vmd_zh_rec_iter/gru_cell/gates/bias/_2577, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2579, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2581, vmd_zh_rec_iter/gru_cell/gates/kernel/_2583, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2585, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2587, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_posterior/z_mu/W/_2613, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_posterior/z_mu/b/_2619, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2623, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2625, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2627, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2629, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2631, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2633, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2635, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2637, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2639, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2641, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2643, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2645, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2647, vmd_zh_rec_iter/z_prior/z_mu/W/_2649, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2651, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2653, vmd_zh_rec_iter/z_prior/z_mu/b/_2655, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2657, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2659)]]

2025-06-16 02:10:47,684 INFO Start dev phase...
2025-06-16 02:12:35,359 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-16 02:12:35,360 INFO 	Eval, eval loss: 1.4525160789489746, acc: 0.518293
2025-06-16 02:12:35,530 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_021235.txt
2025-06-16 02:12:35,531 INFO Test completed successfully!
2025-06-16 02:24:29,372 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 02:24:29,372 INFO Configuration - use_dual_path_srl: True
2025-06-16 02:24:29,372 INFO Configuration - use_enhanced_srl: True
2025-06-16 02:24:29,372 INFO Configuration - use_ca_tsu: True
2025-06-16 02:24:29,372 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 02:24:29,372 INFO Configuration - use_noise_aware_loss: True
2025-06-16 02:24:29,373 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 02:24:29,373 INFO Configuration - variant_type: hedge
2025-06-16 02:24:29,373 INFO Full model configuration:
2025-06-16 02:24:29,373 INFO   alpha: 0.5
2025-06-16 02:24:29,373 INFO   batch_size: 32
2025-06-16 02:24:29,374 INFO   ca_tsu_weight: 0.3
2025-06-16 02:24:29,374 INFO   causal_loss_lambda: 0.3
2025-06-16 02:24:29,374 INFO   clip: 15.0
2025-06-16 02:24:29,374 INFO   consistency_loss_weight: 0.05
2025-06-16 02:24:29,374 INFO   constant_kl_lambda: 0.1
2025-06-16 02:24:29,374 INFO   daily_att: y
2025-06-16 02:24:29,375 INFO   decay_rate: 0.96
2025-06-16 02:24:29,375 INFO   decay_step: 100
2025-06-16 02:24:29,375 INFO   dropout_ce: 0.0
2025-06-16 02:24:29,375 INFO   dropout_mel: 0.0
2025-06-16 02:24:29,376 INFO   dropout_mel_in: 0.3
2025-06-16 02:24:29,376 INFO   dropout_vmd: 0.0
2025-06-16 02:24:29,376 INFO   dropout_vmd_in: 0.3
2025-06-16 02:24:29,376 INFO   enhanced_srl_weight: 0.1
2025-06-16 02:24:29,376 INFO   entropy_regularization_lambda: 0.001
2025-06-16 02:24:29,377 INFO   g_size: 50
2025-06-16 02:24:29,377 INFO   h_size: 150
2025-06-16 02:24:29,377 INFO   init_stock_with_word: 0
2025-06-16 02:24:29,377 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 02:24:29,378 INFO   kl_lambda_start_step: 0
2025-06-16 02:24:29,378 INFO   lr: 0.001
2025-06-16 02:24:29,378 INFO   max_n_days: 5
2025-06-16 02:24:29,378 INFO   max_n_msgs: 20
2025-06-16 02:24:29,378 INFO   max_n_words: 30
2025-06-16 02:24:29,378 INFO   mel_cell_type: gru
2025-06-16 02:24:29,379 INFO   mel_h_size: 100
2025-06-16 02:24:29,379 INFO   mode: all
2025-06-16 02:24:29,379 INFO   momentum: 0.9
2025-06-16 02:24:29,379 INFO   msin_h_size: 100
2025-06-16 02:24:29,379 INFO   n_epochs: 10
2025-06-16 02:24:29,380 INFO   noise_aware_weight: 0.5
2025-06-16 02:24:29,380 INFO   opt: adam
2025-06-16 02:24:29,380 INFO   pathway_competition_type: dynamic
2025-06-16 02:24:29,380 INFO   prediction_loss_weight: 0.1
2025-06-16 02:24:29,380 INFO   residual_connection_weight: 0.1
2025-06-16 02:24:29,381 INFO   shuffle: 1
2025-06-16 02:24:29,381 INFO   stock_embed_size: 150
2025-06-16 02:24:29,381 INFO   td_temporal_attention: True
2025-06-16 02:24:29,381 INFO   use_ca_tsu: True
2025-06-16 02:24:29,381 INFO   use_constant_kl_lambda: 0
2025-06-16 02:24:29,381 INFO   use_dual_path_srl: True
2025-06-16 02:24:29,382 INFO   use_enhanced_srl: True
2025-06-16 02:24:29,382 INFO   use_g_bn: 0
2025-06-16 02:24:29,382 INFO   use_in_bn: 0
2025-06-16 02:24:29,382 INFO   use_noise_aware_loss: True
2025-06-16 02:24:29,382 INFO   use_o_bn: 0
2025-06-16 02:24:29,382 INFO   variant_type: hedge
2025-06-16 02:24:29,383 INFO   vmd_cell_type: gru
2025-06-16 02:24:29,383 INFO   vmd_rec: zh
2025-06-16 02:24:29,383 INFO   volatility_adaptation_factor: 0.3
2025-06-16 02:24:29,383 INFO   volatility_reg_weight: 0.05
2025-06-16 02:24:29,384 INFO   weight_init: xavier-uniform
2025-06-16 02:24:29,384 INFO   word_embed_size: 50
2025-06-16 02:24:29,384 INFO   word_embed_type: glove
2025-06-16 02:24:29,384 INFO   y_size: 2
2025-06-16 02:24:29,385 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 02:24:29,392 INFO Start graph assembling...
2025-06-16 02:24:31,118 INFO use_dual_path_srl: True
2025-06-16 02:24:31,118 INFO variant_type: hedge
2025-06-16 02:24:31,118 INFO use_enhanced_srl: True
2025-06-16 02:24:31,119 INFO Enhanced SRL enabled from config
2025-06-16 02:24:31,119 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 02:24:31,119 INFO SRL condition: True = True and True
2025-06-16 02:24:31,119 INFO Using enhanced dual-path SRL architecture
2025-06-16 02:24:31,120 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 02:24:31,165 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 02:24:31,169 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 02:24:31,189 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 02:24:31,414 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 02:24:31,414 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 02:24:31,414 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 02:24:31,684 INFO Using Temporal Attention (TAP)
2025-06-16 02:24:31,728 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 02:24:31,728 INFO Ca-TSU enabled: True
2025-06-16 02:24:31,728 INFO Enhanced SRL enabled: True
2025-06-16 02:24:31,729 INFO Noise-Aware Loss enabled: True
2025-06-16 02:24:31,743 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:31,743 INFO Adding auxiliary enhancement losses...
2025-06-16 02:24:31,765 INFO Creating Noise-Aware Loss component...
2025-06-16 02:24:31,773 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 02:24:31,774 INFO Creating Causal Consistency Loss component...
2025-06-16 02:24:31,808 INFO Using Causal Consistency Loss with weight: 0.3
2025-06-16 02:24:31,809 INFO Final loss after all components: Tensor("causal_consistency_component/add_causal_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:31,809 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:24:34,200 INFO Graph assembled successfully.
2025-06-16 02:24:34,201 INFO Ensured graph directory exists: D__FinalYear_KLTN_PEN_PEN-main_PEN-main_graphs_tx_lf_dual_path_all-hedge-gru_6a582145
2025-06-16 02:24:34,531 INFO Verifying model configuration...
2025-06-16 02:24:34,531 INFO Ca-TSU enabled: True
2025-06-16 02:24:34,531 INFO Enhanced SRL enabled: True
2025-06-16 02:24:34,532 INFO Noise-Aware Loss enabled: True
2025-06-16 02:24:34,532 INFO Checking model components for noise-aware loss...
2025-06-16 02:24:34,532 INFO Model has 'use_noise_aware_loss': True
2025-06-16 02:24:34,532 INFO use_noise_aware_loss value: True
2025-06-16 02:24:34,532 INFO Model has 'noise_aware_weight': True
2025-06-16 02:24:34,532 INFO noise_aware_weight value: 0.5
2025-06-16 02:24:34,533 INFO Model has 'noise_aware_loss': False
2025-06-16 02:24:34,533 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 02:24:34,533 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 02:24:34,533 INFO Model has 'reliability_weights': True
2025-06-16 02:24:34,533 INFO Model has 'use_enhanced_srl': True
2025-06-16 02:24:34,534 INFO use_enhanced_srl value: True
2025-06-16 02:24:34,534 INFO Model has 'enhanced_srl_loss': False
2025-06-16 02:24:34,534 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 02:24:34,534 INFO Model has 'use_ca_tsu': True
2025-06-16 02:24:34,534 INFO use_ca_tsu value: True
2025-06-16 02:24:34,534 INFO Model has 'causal_consistency_loss': False
2025-06-16 02:24:34,535 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 02:24:34,535 INFO Model has 'loss_components': True
2025-06-16 02:24:34,535 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 02:24:34,535 INFO Manually activating loss components...
2025-06-16 02:24:34,536 INFO Components manually activated:
2025-06-16 02:24:34,536 INFO use_enhanced_srl: True
2025-06-16 02:24:34,536 INFO use_ca_tsu: True
2025-06-16 02:24:34,536 INFO use_noise_aware_loss: True
2025-06-16 02:24:34,536 INFO use_dual_path_srl: True
2025-06-16 02:24:34,537 INFO Running test_noise_aware_loss...
2025-06-16 02:24:52,873 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 02:24:54,686 INFO Word table initialized
2025-06-16 02:24:54,687 INFO Checking loss components in the model graph...
2025-06-16 02:24:54,687 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 02:24:54,688 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,688 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,688 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component/Neg:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 02:24:54,689 INFO Model: all-hedge-gru_6a582145, starting new session
2025-06-16 02:24:54,690 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 02:24:54,803 INFO Starting training test for 10 batches
2025-06-16 02:25:40,898 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 02:25:40,899 INFO   PERFORMANCE: Loss=1.3204 | Acc=0.5625 | MCC=0.1156
2025-06-16 02:25:40,899 INFO   LOSS COMPONENTS:
2025-06-16 02:25:40,900 INFO     - Causal Consistency Loss: 0.296538
2025-06-16 02:25:40,900 INFO     - Noise-Aware SRL Loss: 0.555084
2025-06-16 02:25:40,900 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:25:40,901 INFO     Alpha_i sample: 0.2989, Omega_i sample: 0.4712
2025-06-16 02:25:40,901 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:25:40,902 INFO     Volatility: 0.6680, Text Weight: 0.4298, Price Weight: 0.5702
2025-06-16 02:27:01,135 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 02:27:01,136 INFO   PERFORMANCE: Loss=1.4199 | Acc=0.5938 | MCC=0.1773
2025-06-16 02:27:01,136 INFO   LOSS COMPONENTS:
2025-06-16 02:27:01,137 INFO     - Causal Consistency Loss: -0.144180
2025-06-16 02:27:01,137 INFO     - Noise-Aware SRL Loss: 0.394152
2025-06-16 02:27:01,137 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:27:01,137 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:27:01,138 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:27:01,139 INFO     Volatility: 0.6467, Text Weight: 0.4941, Price Weight: 0.5059
2025-06-16 02:28:29,376 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 02:28:29,378 INFO   PERFORMANCE: Loss=1.5198 | Acc=0.5938 | MCC=0.2085
2025-06-16 02:28:29,378 INFO   LOSS COMPONENTS:
2025-06-16 02:28:29,378 INFO     - Causal Consistency Loss: -0.163450
2025-06-16 02:28:29,379 INFO     - Noise-Aware SRL Loss: 0.223226
2025-06-16 02:28:29,379 INFO   Ca-TSU (Attention on Messages):
2025-06-16 02:28:29,379 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 02:28:29,380 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 02:28:29,381 INFO     Volatility: 0.6569, Text Weight: 0.6088, Price Weight: 0.3912
2025-06-16 02:28:29,381 INFO Generating diagnostic plots...
2025-06-16 02:28:31,589 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 02:28:31,589 INFO Saving final checkpoint for test run...
2025-06-16 02:28:32,448 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_6a582145\sess-10
2025-06-16 02:28:32,449 INFO Start dev phase...
2025-06-16 02:30:24,448 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-16 02:30:24,449 INFO 	Eval, eval loss: 1.472795844078064, acc: 0.489329
2025-06-16 02:30:24,633 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_023024.txt
2025-06-16 02:30:24,633 INFO Test completed successfully!
2025-06-16 03:56:50,419 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 03:56:50,421 INFO Configuration - use_dual_path_srl: True
2025-06-16 03:56:50,421 INFO Configuration - use_enhanced_srl: True
2025-06-16 03:56:50,421 INFO Configuration - use_ca_tsu: True
2025-06-16 03:56:50,421 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 03:56:50,422 INFO Configuration - use_noise_aware_loss: True
2025-06-16 03:56:50,422 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 03:56:50,422 INFO Configuration - variant_type: hedge
2025-06-16 03:56:50,422 INFO Full model configuration:
2025-06-16 03:56:50,422 INFO   alpha: 0.5
2025-06-16 03:56:50,422 INFO   batch_size: 32
2025-06-16 03:56:50,423 INFO   ca_tsu_weight: 0.3
2025-06-16 03:56:50,423 INFO   causal_loss_lambda: 0.3
2025-06-16 03:56:50,423 INFO   clip: 15.0
2025-06-16 03:56:50,423 INFO   consistency_loss_weight: 0.05
2025-06-16 03:56:50,423 INFO   constant_kl_lambda: 0.1
2025-06-16 03:56:50,424 INFO   daily_att: y
2025-06-16 03:56:50,424 INFO   decay_rate: 0.96
2025-06-16 03:56:50,424 INFO   decay_step: 100
2025-06-16 03:56:50,424 INFO   dropout_ce: 0.0
2025-06-16 03:56:50,424 INFO   dropout_mel: 0.0
2025-06-16 03:56:50,424 INFO   dropout_mel_in: 0.3
2025-06-16 03:56:50,425 INFO   dropout_vmd: 0.0
2025-06-16 03:56:50,425 INFO   dropout_vmd_in: 0.3
2025-06-16 03:56:50,425 INFO   enhanced_srl_weight: 0.1
2025-06-16 03:56:50,425 INFO   entropy_regularization_lambda: 0.001
2025-06-16 03:56:50,426 INFO   g_size: 50
2025-06-16 03:56:50,426 INFO   h_size: 150
2025-06-16 03:56:50,426 INFO   init_stock_with_word: 0
2025-06-16 03:56:50,426 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 03:56:50,426 INFO   kl_lambda_start_step: 0
2025-06-16 03:56:50,427 INFO   lr: 0.001
2025-06-16 03:56:50,427 INFO   max_n_days: 5
2025-06-16 03:56:50,427 INFO   max_n_msgs: 20
2025-06-16 03:56:50,427 INFO   max_n_words: 30
2025-06-16 03:56:50,427 INFO   mel_cell_type: gru
2025-06-16 03:56:50,427 INFO   mel_h_size: 100
2025-06-16 03:56:50,427 INFO   mode: all
2025-06-16 03:56:50,428 INFO   momentum: 0.9
2025-06-16 03:56:50,428 INFO   msin_h_size: 100
2025-06-16 03:56:50,428 INFO   n_epochs: 10
2025-06-16 03:56:50,428 INFO   noise_aware_weight: 0.5
2025-06-16 03:56:50,428 INFO   opt: adam
2025-06-16 03:56:50,428 INFO   pathway_competition_type: dynamic
2025-06-16 03:56:50,429 INFO   prediction_loss_weight: 0.1
2025-06-16 03:56:50,429 INFO   residual_connection_weight: 0.1
2025-06-16 03:56:50,429 INFO   shuffle: 1
2025-06-16 03:56:50,429 INFO   stock_embed_size: 150
2025-06-16 03:56:50,429 INFO   td_temporal_attention: True
2025-06-16 03:56:50,430 INFO   use_ca_tsu: True
2025-06-16 03:56:50,430 INFO   use_constant_kl_lambda: 0
2025-06-16 03:56:50,430 INFO   use_dual_path_srl: True
2025-06-16 03:56:50,430 INFO   use_enhanced_srl: True
2025-06-16 03:56:50,430 INFO   use_g_bn: 0
2025-06-16 03:56:50,431 INFO   use_in_bn: 0
2025-06-16 03:56:50,431 INFO   use_noise_aware_loss: True
2025-06-16 03:56:50,431 INFO   use_o_bn: 0
2025-06-16 03:56:50,431 INFO   variant_type: hedge
2025-06-16 03:56:50,431 INFO   vmd_cell_type: gru
2025-06-16 03:56:50,432 INFO   vmd_rec: zh
2025-06-16 03:56:50,432 INFO   volatility_adaptation_factor: 0.3
2025-06-16 03:56:50,432 INFO   volatility_reg_weight: 0.05
2025-06-16 03:56:50,432 INFO   weight_init: xavier-uniform
2025-06-16 03:56:50,432 INFO   word_embed_size: 50
2025-06-16 03:56:50,433 INFO   word_embed_type: glove
2025-06-16 03:56:50,433 INFO   y_size: 2
2025-06-16 03:56:50,433 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 03:56:50,439 INFO Start graph assembling...
2025-06-16 03:56:52,157 INFO use_dual_path_srl: True
2025-06-16 03:56:52,157 INFO variant_type: hedge
2025-06-16 03:56:52,157 INFO use_enhanced_srl: True
2025-06-16 03:56:52,158 INFO Enhanced SRL enabled from config
2025-06-16 03:56:52,158 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 03:56:52,158 INFO SRL condition: True = True and True
2025-06-16 03:56:52,158 INFO Using enhanced dual-path SRL architecture
2025-06-16 03:56:52,158 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 03:56:52,203 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 03:56:52,208 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 03:56:52,227 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 03:56:52,451 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 03:56:52,452 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 03:56:52,452 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 03:56:52,717 INFO Using Temporal Attention (TAP)
2025-06-16 03:56:52,762 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 03:56:52,762 INFO Ca-TSU enabled: True
2025-06-16 03:56:52,763 INFO Enhanced SRL enabled: True
2025-06-16 03:56:52,763 INFO Noise-Aware Loss enabled: True
2025-06-16 03:56:52,778 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:56:52,778 INFO Adding auxiliary enhancement losses...
2025-06-16 03:56:52,800 INFO Creating Noise-Aware Loss component...
2025-06-16 03:56:52,808 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 03:56:52,809 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 03:56:52,809 INFO Causal Loss KL Divergence: P shape=(?, 5, 20), Q shape=(?, 5, 20)
2025-06-16 03:56:52,817 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 03:56:52,817 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:56:52,817 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 03:56:55,123 INFO Graph assembled successfully.
2025-06-16 03:56:55,415 INFO Verifying model configuration...
2025-06-16 03:56:55,415 INFO Ca-TSU enabled: True
2025-06-16 03:56:55,415 INFO Enhanced SRL enabled: True
2025-06-16 03:56:55,416 INFO Noise-Aware Loss enabled: True
2025-06-16 03:56:55,416 INFO Checking model components for noise-aware loss...
2025-06-16 03:56:55,416 INFO Model has 'use_noise_aware_loss': True
2025-06-16 03:56:55,416 INFO use_noise_aware_loss value: True
2025-06-16 03:56:55,416 INFO Model has 'noise_aware_weight': True
2025-06-16 03:56:55,417 INFO noise_aware_weight value: 0.5
2025-06-16 03:56:55,417 INFO Model has 'noise_aware_loss': False
2025-06-16 03:56:55,417 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 03:56:55,418 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 03:56:55,418 INFO Model has 'reliability_weights': True
2025-06-16 03:56:55,418 INFO Model has 'use_enhanced_srl': True
2025-06-16 03:56:55,418 INFO use_enhanced_srl value: True
2025-06-16 03:56:55,419 INFO Model has 'enhanced_srl_loss': False
2025-06-16 03:56:55,419 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 03:56:55,419 INFO Model has 'use_ca_tsu': True
2025-06-16 03:56:55,419 INFO use_ca_tsu value: True
2025-06-16 03:56:55,419 INFO Model has 'causal_consistency_loss': False
2025-06-16 03:56:55,420 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 03:56:55,420 INFO Model has 'loss_components': True
2025-06-16 03:56:55,420 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 03:56:55,420 INFO Manually activating loss components...
2025-06-16 03:56:55,420 INFO Components manually activated:
2025-06-16 03:56:55,420 INFO use_enhanced_srl: True
2025-06-16 03:56:55,421 INFO use_ca_tsu: True
2025-06-16 03:56:55,421 INFO use_noise_aware_loss: True
2025-06-16 03:56:55,421 INFO use_dual_path_srl: True
2025-06-16 03:56:55,422 INFO Running test_noise_aware_loss...
2025-06-16 03:57:13,676 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 03:57:15,317 INFO Word table initialized
2025-06-16 03:57:15,318 INFO Checking loss components in the model graph...
2025-06-16 03:57:15,318 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 03:57:15,318 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 03:57:15,319 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, starting new session
2025-06-16 03:57:15,320 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 03:57:15,402 INFO Starting training test for 10 batches
2025-06-16 03:57:49,206 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 03:57:49,207 INFO   PERFORMANCE: Loss=1.3116 | Acc=0.5312 | MCC=0.0485
2025-06-16 03:57:49,207 INFO   LOSS COMPONENTS:
2025-06-16 03:57:49,207 INFO     - Causal Consistency Loss: 0.287717
2025-06-16 03:57:49,208 INFO     - Noise-Aware SRL Loss: 0.535706
2025-06-16 03:57:49,208 INFO   Ca-TSU (Attention on Messages):
2025-06-16 03:57:49,208 INFO     Alpha_i sample: 0.1212, Omega_i sample: 0.1440
2025-06-16 03:57:49,209 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 03:57:49,209 INFO     Volatility: 0.6707, Text Weight: 0.4400, Price Weight: 0.5600
2025-06-16 03:59:16,690 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 03:59:16,690 INFO   PERFORMANCE: Loss=1.4679 | Acc=0.6562 | MCC=0.3131
2025-06-16 03:59:16,691 INFO   LOSS COMPONENTS:
2025-06-16 03:59:16,692 INFO     - Causal Consistency Loss: 0.274589
2025-06-16 03:59:16,692 INFO     - Noise-Aware SRL Loss: 0.322688
2025-06-16 03:59:16,692 INFO   Ca-TSU (Attention on Messages):
2025-06-16 03:59:16,692 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 03:59:16,692 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 03:59:16,693 INFO     Volatility: 0.6658, Text Weight: 0.5208, Price Weight: 0.4792
2025-06-16 04:00:43,059 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 04:00:43,059 INFO   PERFORMANCE: Loss=1.5917 | Acc=0.5312 | MCC=-0.0367
2025-06-16 04:00:43,059 INFO   LOSS COMPONENTS:
2025-06-16 04:00:43,060 INFO     - Causal Consistency Loss: 0.260981
2025-06-16 04:00:43,060 INFO     - Noise-Aware SRL Loss: 0.128287
2025-06-16 04:00:43,060 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:00:43,060 INFO     Alpha_i sample: 0.1815, Omega_i sample: 0.4871
2025-06-16 04:00:43,061 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:00:43,062 INFO     Volatility: 0.6444, Text Weight: 0.7108, Price Weight: 0.2892
2025-06-16 04:00:43,062 INFO Generating diagnostic plots...
2025-06-16 04:00:45,230 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:00:45,230 INFO Saving final checkpoint for test run...
2025-06-16 04:00:45,382 ERROR Failed to save final checkpoint after test run: Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate15857935528832320232 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2183, MSIN_RNN/market_projection/kernel/_2185, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2187, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2189, MSIN_RNN/text_price_cross_attention/dense/bias/_2191, MSIN_RNN/text_price_cross_attention/dense/kernel/_2193, MSIN_RNN/text_self_attention/LayerNorm/beta/_2195, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2197, MSIN_RNN/text_self_attention/dense/bias/_2199, MSIN_RNN/text_self_attention/dense/kernel/_2201, W_f/_2203, W_ha/_2205, W_hf/_2207, W_hk/_2209, W_ho/_2211, W_hs/_2213, W_ht/_2215, W_hv/_2217, W_k/_2219, W_o/_2221, W_price_pred/_2223, W_price_pred/Adam/_2225, W_price_pred/Adam_1/_2227, W_reliability/_2229, W_reliability/Adam/_2231, W_reliability/Adam_1/_2233, W_s/_2235, W_sa/_2237, W_t/_2239, W_v/_2241, W_vk/_2243, b_price_pred/_2245, b_price_pred/Adam/_2247, b_price_pred/Adam_1/_2249, b_reliability/_2251, b_reliability/Adam/_2253, b_reliability/Adam_1/_2255, ca_tsu/W_K/_2257, ca_tsu/W_K/Adam/_2259, ca_tsu/W_K/Adam_1/_2261, ca_tsu/W_Q/_2263, ca_tsu/W_Q/Adam/_2265, ca_tsu/W_Q/Adam_1/_2267, ca_tsu/b_causal/_2269, ca_tsu/b_causal/Adam/_2271, ca_tsu/b_causal/Adam_1/_2273, embeds/word_table/_2275, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2277, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2279, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2281, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2283, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2285, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2287, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2289, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2291, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2293, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2295, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2297, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2299, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2301, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2303, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2305, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2323, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2325, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2327, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2331, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2333, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2337, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2339, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2341, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2343, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2345, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2395, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2397, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2399, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2401, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2403, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2405, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2407, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2409, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2411, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2413, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2415, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2419, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2443, mie/Variable/_2445, mie/Variable_1/_2447, mie/Variable_2/_2449, mie/Variable_3/_2451, mie/Variable_4/_2453, mie/Variable_5/_2455, mie/Variable_6/_2457, mie/Variable_7/_2459, optimizer/beta1_power/_2461, optimizer/beta2_power/_2463, tda/pred_from_gT_att_logits/bias/_2465, tda/pred_from_gT_att_logits/bias/Adam/_2467, tda/pred_from_gT_att_logits/bias/Adam_1/_2469, tda/pred_from_gT_att_logits/kernel/_2471, tda/pred_from_gT_att_logits/kernel/Adam/_2473, tda/pred_from_gT_att_logits/kernel/Adam_1/_2475, tda/v_i/g_projection_att/kernel/_2477, tda/v_i/g_projection_att/kernel/Adam/_2479, tda/v_i/g_projection_att/kernel/Adam_1/_2481, tda/v_i/w_i_temporal_att/_2483, tda/v_i/w_i_temporal_att/Adam/_2485, tda/v_i/w_i_temporal_att/Adam_1/_2487, text_price_cross_attention/dense/_2489, text_price_cross_attention/wk/_2491, text_price_cross_attention/wq/_2493, text_price_cross_attention/wv/_2495, text_self_attention/dense/_2497, text_self_attention/wk/_2499, text_self_attention/wq/_2501, text_self_attention/wv/_2503, u_t/linear_layer/W/_2505, u_t/linear_layer/W/Adam/_2507, u_t/linear_layer/W/Adam_1/_2509, u_t/w_u_original/_2511, u_t/w_u_original/Adam/_2513, u_t/w_u_original/Adam_1/_2515, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2517, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2519, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2521, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2523, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2525, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2527, vmd_zh_rec_iter/gru_cell/candidate/bias/_2529, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2531, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2533, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2535, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2537, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2539, vmd_zh_rec_iter/gru_cell/gates/bias/_2541, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2543, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2545, vmd_zh_rec_iter/gru_cell/gates/kernel/_2547, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2549, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2551, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2553, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2555, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2557, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2559, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2561, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2563, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2565, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2567, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2569, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2571, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2573, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2575, vmd_zh_rec_iter/z_posterior/z_mu/W/_2577, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2579, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2581, vmd_zh_rec_iter/z_posterior/z_mu/b/_2583, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2585, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2587, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_prior/z_mu/W/_2613, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_prior/z_mu/b/_2619, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2623)]]

Caused by op 'save/SaveV2', defined at:
  File "src/test_noise_aware_loss.py", line 239, in <module>
    success = run_test()
  File "src/test_noise_aware_loss.py", line 167, in run_test
    executor = Executor_tx_lf_dual_path(model_obj=Model_tx_lf_dual_path)
  File "D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\src\Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1218, in __init__
    self.build()
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 748, in _build_internal
    save_tensor = self._AddSaveOps(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 296, in _AddSaveOps
    save = self.save_op(filename_tensor, saveables)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\training\saver.py", line 239, in save_op
    tensors)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1162, in save_v2
    shape_and_slices=shape_and_slices, tensors=tensors, name=name)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 2956, in create_op
    op_def=op_def)
  File "D:\tool\anaconda\envs\py36\lib\site-packages\tensorflow\python\framework\ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Failed to create a NewWriteableFile: D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp\sess-10.data-00000-of-00001.tempstate15857935528832320232 : The system cannot find the path specified.
; No such process
	 [[Node: save/SaveV2 = SaveV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/SaveV2/tensor_names, save/SaveV2/shape_and_slices, MSIN_RNN/market_projection/bias/_2183, MSIN_RNN/market_projection/kernel/_2185, MSIN_RNN/text_price_cross_attention/LayerNorm/beta/_2187, MSIN_RNN/text_price_cross_attention/LayerNorm/gamma/_2189, MSIN_RNN/text_price_cross_attention/dense/bias/_2191, MSIN_RNN/text_price_cross_attention/dense/kernel/_2193, MSIN_RNN/text_self_attention/LayerNorm/beta/_2195, MSIN_RNN/text_self_attention/LayerNorm/gamma/_2197, MSIN_RNN/text_self_attention/dense/bias/_2199, MSIN_RNN/text_self_attention/dense/kernel/_2201, W_f/_2203, W_ha/_2205, W_hf/_2207, W_hk/_2209, W_ho/_2211, W_hs/_2213, W_ht/_2215, W_hv/_2217, W_k/_2219, W_o/_2221, W_price_pred/_2223, W_price_pred/Adam/_2225, W_price_pred/Adam_1/_2227, W_reliability/_2229, W_reliability/Adam/_2231, W_reliability/Adam_1/_2233, W_s/_2235, W_sa/_2237, W_t/_2239, W_v/_2241, W_vk/_2243, b_price_pred/_2245, b_price_pred/Adam/_2247, b_price_pred/Adam_1/_2249, b_reliability/_2251, b_reliability/Adam/_2253, b_reliability/Adam_1/_2255, ca_tsu/W_K/_2257, ca_tsu/W_K/Adam/_2259, ca_tsu/W_K/Adam_1/_2261, ca_tsu/W_Q/_2263, ca_tsu/W_Q/Adam/_2265, ca_tsu/W_Q/Adam_1/_2267, ca_tsu/b_causal/_2269, ca_tsu/b_causal/Adam/_2271, ca_tsu/b_causal/Adam_1/_2273, embeds/word_table/_2275, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/_2277, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam/_2279, enhanced_dual_path_srl/pathway_fusion/pathway_logits/bias/Adam_1/_2281, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/_2283, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam/_2285, enhanced_dual_path_srl/pathway_fusion/pathway_logits/kernel/Adam_1/_2287, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/_2289, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam/_2291, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/bias/Adam_1/_2293, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/_2295, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam/_2297, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/message_keys/kernel/Adam_1/_2299, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/_2301, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam/_2303, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/bias/Adam_1/_2305, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/_2307, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam/_2309, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/pd_representation/kernel/Adam_1/_2311, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/_2313, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam/_2315, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/bias/Adam_1/_2317, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/_2319, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam/_2321, enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/price_query/kernel/Adam_1/_2323, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/_2325, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam/_2327, enhanced_dual_path_srl/text_driven_pathway/td_representation/bias/Adam_1/_2329, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/_2331, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam/_2333, enhanced_dual_path_srl/text_driven_pathway/td_representation/kernel/Adam_1/_2335, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/_2337, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam/_2339, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/bias/Adam_1/_2341, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/_2343, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam/_2345, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/keys/kernel/Adam_1/_2347, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/_2349, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam/_2351, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/bias/Adam_1/_2353, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/_2355, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam/_2357, enhanced_dual_path_srl/text_driven_pathway/temporal_attention/queries/kernel/Adam_1/_2359, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/_2361, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam/_2363, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/bias/Adam_1/_2365, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/_2367, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam/_2369, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden1/kernel/Adam_1/_2371, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/_2373, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam/_2375, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/bias/Adam_1/_2377, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/_2379, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam/_2381, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/hidden2/kernel/Adam_1/_2383, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/_2385, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam/_2387, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/bias/Adam_1/_2389, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/_2391, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam/_2393, enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/price_predictions/kernel/Adam_1/_2395, global_step, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/_2397, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam/_2399, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/bias/Adam_1/_2401, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/_2403, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam/_2405, mel_iter/bidirectional_rnn/bw/gru_cell/candidate/kernel/Adam_1/_2407, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/_2409, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam/_2411, mel_iter/bidirectional_rnn/bw/gru_cell/gates/bias/Adam_1/_2413, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/_2415, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam/_2417, mel_iter/bidirectional_rnn/bw/gru_cell/gates/kernel/Adam_1/_2419, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/_2421, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam/_2423, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/bias/Adam_1/_2425, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/_2427, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam/_2429, mel_iter/bidirectional_rnn/fw/gru_cell/candidate/kernel/Adam_1/_2431, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/_2433, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam/_2435, mel_iter/bidirectional_rnn/fw/gru_cell/gates/bias/Adam_1/_2437, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/_2439, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam/_2441, mel_iter/bidirectional_rnn/fw/gru_cell/gates/kernel/Adam_1/_2443, mie/Variable/_2445, mie/Variable_1/_2447, mie/Variable_2/_2449, mie/Variable_3/_2451, mie/Variable_4/_2453, mie/Variable_5/_2455, mie/Variable_6/_2457, mie/Variable_7/_2459, optimizer/beta1_power/_2461, optimizer/beta2_power/_2463, tda/pred_from_gT_att_logits/bias/_2465, tda/pred_from_gT_att_logits/bias/Adam/_2467, tda/pred_from_gT_att_logits/bias/Adam_1/_2469, tda/pred_from_gT_att_logits/kernel/_2471, tda/pred_from_gT_att_logits/kernel/Adam/_2473, tda/pred_from_gT_att_logits/kernel/Adam_1/_2475, tda/v_i/g_projection_att/kernel/_2477, tda/v_i/g_projection_att/kernel/Adam/_2479, tda/v_i/g_projection_att/kernel/Adam_1/_2481, tda/v_i/w_i_temporal_att/_2483, tda/v_i/w_i_temporal_att/Adam/_2485, tda/v_i/w_i_temporal_att/Adam_1/_2487, text_price_cross_attention/dense/_2489, text_price_cross_attention/wk/_2491, text_price_cross_attention/wq/_2493, text_price_cross_attention/wv/_2495, text_self_attention/dense/_2497, text_self_attention/wk/_2499, text_self_attention/wq/_2501, text_self_attention/wv/_2503, u_t/linear_layer/W/_2505, u_t/linear_layer/W/Adam/_2507, u_t/linear_layer/W/Adam_1/_2509, u_t/w_u_original/_2511, u_t/w_u_original/Adam/_2513, u_t/w_u_original/Adam_1/_2515, vmd_zh_rec_iter/g_to_y_logits_zh/W/_2517, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam/_2519, vmd_zh_rec_iter/g_to_y_logits_zh/W/Adam_1/_2521, vmd_zh_rec_iter/g_to_y_logits_zh/b/_2523, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam/_2525, vmd_zh_rec_iter/g_to_y_logits_zh/b/Adam_1/_2527, vmd_zh_rec_iter/gru_cell/candidate/bias/_2529, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam/_2531, vmd_zh_rec_iter/gru_cell/candidate/bias/Adam_1/_2533, vmd_zh_rec_iter/gru_cell/candidate/kernel/_2535, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam/_2537, vmd_zh_rec_iter/gru_cell/candidate/kernel/Adam_1/_2539, vmd_zh_rec_iter/gru_cell/gates/bias/_2541, vmd_zh_rec_iter/gru_cell/gates/bias/Adam/_2543, vmd_zh_rec_iter/gru_cell/gates/bias/Adam_1/_2545, vmd_zh_rec_iter/gru_cell/gates/kernel/_2547, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam/_2549, vmd_zh_rec_iter/gru_cell/gates/kernel/Adam_1/_2551, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/_2553, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam/_2555, vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1/_2557, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/_2559, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam/_2561, vmd_zh_rec_iter/z_posterior/hidden_for_z/b/Adam_1/_2563, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/_2565, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam/_2567, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/W/Adam_1/_2569, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/_2571, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam/_2573, vmd_zh_rec_iter/z_posterior/z_log_sigma_sq/b/Adam_1/_2575, vmd_zh_rec_iter/z_posterior/z_mu/W/_2577, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam/_2579, vmd_zh_rec_iter/z_posterior/z_mu/W/Adam_1/_2581, vmd_zh_rec_iter/z_posterior/z_mu/b/_2583, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam/_2585, vmd_zh_rec_iter/z_posterior/z_mu/b/Adam_1/_2587, vmd_zh_rec_iter/z_prior/hidden_for_z/W/_2589, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam/_2591, vmd_zh_rec_iter/z_prior/hidden_for_z/W/Adam_1/_2593, vmd_zh_rec_iter/z_prior/hidden_for_z/b/_2595, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam/_2597, vmd_zh_rec_iter/z_prior/hidden_for_z/b/Adam_1/_2599, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/_2601, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam/_2603, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/W/Adam_1/_2605, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/_2607, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam/_2609, vmd_zh_rec_iter/z_prior/z_log_sigma_sq/b/Adam_1/_2611, vmd_zh_rec_iter/z_prior/z_mu/W/_2613, vmd_zh_rec_iter/z_prior/z_mu/W/Adam/_2615, vmd_zh_rec_iter/z_prior/z_mu/W/Adam_1/_2617, vmd_zh_rec_iter/z_prior/z_mu/b/_2619, vmd_zh_rec_iter/z_prior/z_mu/b/Adam/_2621, vmd_zh_rec_iter/z_prior/z_mu/b/Adam_1/_2623)]]

2025-06-16 04:00:45,384 INFO Start dev phase...
2025-06-16 04:02:30,245 INFO Completed dev evaluation: size=656.0, acc=0.4604
2025-06-16 04:02:30,246 INFO 	Eval, eval loss: 2.3676211833953857, acc: 0.460366
2025-06-16 04:02:30,401 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_040230.txt
2025-06-16 04:02:30,402 INFO Test completed successfully!
2025-06-16 04:05:38,001 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 04:05:38,001 INFO Configuration - use_dual_path_srl: True
2025-06-16 04:05:38,001 INFO Configuration - use_enhanced_srl: True
2025-06-16 04:05:38,001 INFO Configuration - use_ca_tsu: True
2025-06-16 04:05:38,002 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 04:05:38,002 INFO Configuration - use_noise_aware_loss: True
2025-06-16 04:05:38,002 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 04:05:38,002 INFO Configuration - variant_type: hedge
2025-06-16 04:05:38,003 INFO Full model configuration:
2025-06-16 04:05:38,003 INFO   alpha: 0.5
2025-06-16 04:05:38,003 INFO   batch_size: 32
2025-06-16 04:05:38,003 INFO   ca_tsu_weight: 0.3
2025-06-16 04:05:38,004 INFO   causal_loss_lambda: 0.3
2025-06-16 04:05:38,004 INFO   clip: 15.0
2025-06-16 04:05:38,004 INFO   consistency_loss_weight: 0.05
2025-06-16 04:05:38,004 INFO   constant_kl_lambda: 0.1
2025-06-16 04:05:38,005 INFO   daily_att: y
2025-06-16 04:05:38,005 INFO   decay_rate: 0.96
2025-06-16 04:05:38,005 INFO   decay_step: 100
2025-06-16 04:05:38,005 INFO   dropout_ce: 0.0
2025-06-16 04:05:38,005 INFO   dropout_mel: 0.0
2025-06-16 04:05:38,006 INFO   dropout_mel_in: 0.3
2025-06-16 04:05:38,006 INFO   dropout_vmd: 0.0
2025-06-16 04:05:38,006 INFO   dropout_vmd_in: 0.3
2025-06-16 04:05:38,006 INFO   enhanced_srl_weight: 0.1
2025-06-16 04:05:38,007 INFO   entropy_regularization_lambda: 0.001
2025-06-16 04:05:38,007 INFO   g_size: 50
2025-06-16 04:05:38,007 INFO   h_size: 150
2025-06-16 04:05:38,008 INFO   init_stock_with_word: 0
2025-06-16 04:05:38,008 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 04:05:38,008 INFO   kl_lambda_start_step: 0
2025-06-16 04:05:38,008 INFO   lr: 0.001
2025-06-16 04:05:38,009 INFO   max_n_days: 5
2025-06-16 04:05:38,009 INFO   max_n_msgs: 20
2025-06-16 04:05:38,009 INFO   max_n_words: 30
2025-06-16 04:05:38,009 INFO   mel_cell_type: gru
2025-06-16 04:05:38,009 INFO   mel_h_size: 100
2025-06-16 04:05:38,010 INFO   mode: all
2025-06-16 04:05:38,010 INFO   momentum: 0.9
2025-06-16 04:05:38,010 INFO   msin_h_size: 100
2025-06-16 04:05:38,010 INFO   n_epochs: 10
2025-06-16 04:05:38,011 INFO   noise_aware_weight: 0.5
2025-06-16 04:05:38,011 INFO   opt: adam
2025-06-16 04:05:38,011 INFO   pathway_competition_type: dynamic
2025-06-16 04:05:38,011 INFO   prediction_loss_weight: 0.1
2025-06-16 04:05:38,012 INFO   residual_connection_weight: 0.1
2025-06-16 04:05:38,012 INFO   shuffle: 1
2025-06-16 04:05:38,012 INFO   stock_embed_size: 150
2025-06-16 04:05:38,012 INFO   td_temporal_attention: True
2025-06-16 04:05:38,012 INFO   use_ca_tsu: True
2025-06-16 04:05:38,013 INFO   use_constant_kl_lambda: 0
2025-06-16 04:05:38,013 INFO   use_dual_path_srl: True
2025-06-16 04:05:38,013 INFO   use_enhanced_srl: True
2025-06-16 04:05:38,013 INFO   use_g_bn: 0
2025-06-16 04:05:38,013 INFO   use_in_bn: 0
2025-06-16 04:05:38,014 INFO   use_noise_aware_loss: True
2025-06-16 04:05:38,014 INFO   use_o_bn: 0
2025-06-16 04:05:38,014 INFO   variant_type: hedge
2025-06-16 04:05:38,014 INFO   vmd_cell_type: gru
2025-06-16 04:05:38,014 INFO   vmd_rec: zh
2025-06-16 04:05:38,015 INFO   volatility_adaptation_factor: 0.3
2025-06-16 04:05:38,015 INFO   volatility_reg_weight: 0.05
2025-06-16 04:05:38,015 INFO   weight_init: xavier-uniform
2025-06-16 04:05:38,015 INFO   word_embed_size: 50
2025-06-16 04:05:38,016 INFO   word_embed_type: glove
2025-06-16 04:05:38,016 INFO   y_size: 2
2025-06-16 04:05:38,016 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 04:05:38,018 INFO Start graph assembling...
2025-06-16 04:05:39,720 INFO use_dual_path_srl: True
2025-06-16 04:05:39,721 INFO variant_type: hedge
2025-06-16 04:05:39,721 INFO use_enhanced_srl: True
2025-06-16 04:05:39,722 INFO Enhanced SRL enabled from config
2025-06-16 04:05:39,722 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 04:05:39,723 INFO SRL condition: True = True and True
2025-06-16 04:05:39,723 INFO Using enhanced dual-path SRL architecture
2025-06-16 04:05:39,723 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 04:05:39,766 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 04:05:39,770 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 04:05:39,789 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 04:05:40,012 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 04:05:40,012 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 04:05:40,012 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 04:05:40,276 INFO Using Temporal Attention (TAP)
2025-06-16 04:05:40,319 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 04:05:40,319 INFO Ca-TSU enabled: True
2025-06-16 04:05:40,320 INFO Enhanced SRL enabled: True
2025-06-16 04:05:40,320 INFO Noise-Aware Loss enabled: True
2025-06-16 04:05:40,333 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:05:40,334 INFO Adding auxiliary enhancement losses...
2025-06-16 04:05:40,354 INFO Creating Noise-Aware Loss component...
2025-06-16 04:05:40,361 INFO Using Noise-Aware Loss as SRL component with weight: 0.5
2025-06-16 04:05:40,362 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 04:05:40,363 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 04:05:40,372 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 04:05:40,372 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:05:40,372 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:05:42,667 INFO Graph assembled successfully.
2025-06-16 04:05:42,941 INFO Verifying model configuration...
2025-06-16 04:05:42,941 INFO Ca-TSU enabled: True
2025-06-16 04:05:42,942 INFO Enhanced SRL enabled: True
2025-06-16 04:05:42,942 INFO Noise-Aware Loss enabled: True
2025-06-16 04:05:42,942 INFO Checking model components for noise-aware loss...
2025-06-16 04:05:42,943 INFO Model has 'use_noise_aware_loss': True
2025-06-16 04:05:42,943 INFO use_noise_aware_loss value: True
2025-06-16 04:05:42,943 INFO Model has 'noise_aware_weight': True
2025-06-16 04:05:42,943 INFO noise_aware_weight value: 0.5
2025-06-16 04:05:42,944 INFO Model has 'noise_aware_loss': False
2025-06-16 04:05:42,944 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 04:05:42,944 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 04:05:42,944 INFO Model has 'reliability_weights': True
2025-06-16 04:05:42,944 INFO Model has 'use_enhanced_srl': True
2025-06-16 04:05:42,944 INFO use_enhanced_srl value: True
2025-06-16 04:05:42,944 INFO Model has 'enhanced_srl_loss': False
2025-06-16 04:05:42,944 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 04:05:42,945 INFO Model has 'use_ca_tsu': True
2025-06-16 04:05:42,945 INFO use_ca_tsu value: True
2025-06-16 04:05:42,945 INFO Model has 'causal_consistency_loss': False
2025-06-16 04:05:42,945 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 04:05:42,945 INFO Model has 'loss_components': True
2025-06-16 04:05:42,945 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 04:05:42,946 INFO Manually activating loss components...
2025-06-16 04:05:42,946 INFO Components manually activated:
2025-06-16 04:05:42,946 INFO use_enhanced_srl: True
2025-06-16 04:05:42,946 INFO use_ca_tsu: True
2025-06-16 04:05:42,946 INFO use_noise_aware_loss: True
2025-06-16 04:05:42,947 INFO use_dual_path_srl: True
2025-06-16 04:05:42,947 INFO Running test_noise_aware_loss...
2025-06-16 04:06:01,030 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 04:06:02,323 INFO Word table initialized
2025-06-16 04:06:02,324 INFO Checking loss components in the model graph...
2025-06-16 04:06:02,324 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:06:02,324 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:02,324 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_loss_calculation/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:02,325 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:06:03,182 INFO Model: all-hedge-gru_6a582145, session restored from checkpoint
2025-06-16 04:06:03,183 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 04:06:03,274 INFO Starting training test for 10 batches
2025-06-16 04:06:29,314 INFO --- Batch 1/10 (Step 11) ---
2025-06-16 04:06:29,315 INFO   PERFORMANCE: Loss=1.5852 | Acc=0.5312 | MCC=0.1459
2025-06-16 04:06:29,316 INFO   LOSS COMPONENTS:
2025-06-16 04:06:29,316 INFO     - Causal Consistency Loss: 0.121544
2025-06-16 04:06:29,316 INFO     - Noise-Aware SRL Loss: 0.218777
2025-06-16 04:06:29,316 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:06:29,317 INFO     Alpha_i sample: 0.3071, Omega_i sample: 0.4636
2025-06-16 04:06:29,317 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:06:29,318 INFO     Volatility: 0.6789, Text Weight: 0.6124, Price Weight: 0.3876
2025-06-16 04:07:49,321 INFO --- Batch 5/10 (Step 15) ---
2025-06-16 04:07:49,321 INFO   PERFORMANCE: Loss=1.5153 | Acc=0.5625 | MCC=0.1291
2025-06-16 04:07:49,321 INFO   LOSS COMPONENTS:
2025-06-16 04:07:49,322 INFO     - Causal Consistency Loss: 0.038750
2025-06-16 04:07:49,322 INFO     - Noise-Aware SRL Loss: 0.133969
2025-06-16 04:07:49,322 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:07:49,323 INFO     Alpha_i sample: 0.1037, Omega_i sample: 0.0856
2025-06-16 04:07:49,323 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:07:49,324 INFO     Volatility: 0.6606, Text Weight: 0.7166, Price Weight: 0.2834
2025-06-16 04:09:21,196 INFO --- Batch 10/10 (Step 20) ---
2025-06-16 04:09:21,197 INFO   PERFORMANCE: Loss=1.2709 | Acc=0.6250 | MCC=0.2431
2025-06-16 04:09:21,197 INFO   LOSS COMPONENTS:
2025-06-16 04:09:21,197 INFO     - Causal Consistency Loss: 0.046813
2025-06-16 04:09:21,198 INFO     - Noise-Aware SRL Loss: 0.059435
2025-06-16 04:09:21,198 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:09:21,198 INFO     Alpha_i sample: 0.6734, Omega_i sample: 0.4123
2025-06-16 04:09:21,200 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:09:21,201 INFO     Volatility: 0.6641, Text Weight: 0.8599, Price Weight: 0.1401
2025-06-16 04:09:21,201 INFO Generating diagnostic plots...
2025-06-16 04:09:23,359 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:09:23,359 INFO Saving final checkpoint for test run...
2025-06-16 04:09:24,241 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_6a582145\sess-20
2025-06-16 04:09:24,241 INFO Start dev phase...
2025-06-16 04:11:11,407 INFO Completed dev evaluation: size=656.0, acc=0.5229
2025-06-16 04:11:11,408 INFO 	Eval, eval loss: 1.2733991146087646, acc: 0.522866
2025-06-16 04:11:11,599 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_041111.txt
2025-06-16 04:11:11,600 INFO Test completed successfully!
2025-06-16 04:24:36,272 INFO Starting noise-aware loss test for enhanced dual-path SRL...
2025-06-16 04:24:36,272 INFO Configuration - use_dual_path_srl: True
2025-06-16 04:24:36,273 INFO Configuration - use_enhanced_srl: True
2025-06-16 04:24:36,273 INFO Configuration - use_ca_tsu: True
2025-06-16 04:24:36,273 INFO Configuration - causal_loss_lambda: 0.3
2025-06-16 04:24:36,273 INFO Configuration - use_noise_aware_loss: True
2025-06-16 04:24:36,274 INFO Configuration - noise_aware_weight: 0.5
2025-06-16 04:24:36,274 INFO Configuration - variant_type: hedge
2025-06-16 04:24:36,274 INFO Full model configuration:
2025-06-16 04:24:36,274 INFO   alpha: 0.5
2025-06-16 04:24:36,275 INFO   batch_size: 32
2025-06-16 04:24:36,276 INFO   ca_tsu_weight: 0.3
2025-06-16 04:24:36,276 INFO   causal_loss_lambda: 0.3
2025-06-16 04:24:36,277 INFO   clip: 15.0
2025-06-16 04:24:36,277 INFO   consistency_loss_weight: 0.05
2025-06-16 04:24:36,277 INFO   constant_kl_lambda: 0.1
2025-06-16 04:24:36,278 INFO   daily_att: y
2025-06-16 04:24:36,278 INFO   decay_rate: 0.96
2025-06-16 04:24:36,278 INFO   decay_step: 100
2025-06-16 04:24:36,279 INFO   dropout_ce: 0.0
2025-06-16 04:24:36,279 INFO   dropout_mel: 0.0
2025-06-16 04:24:36,279 INFO   dropout_mel_in: 0.3
2025-06-16 04:24:36,279 INFO   dropout_vmd: 0.0
2025-06-16 04:24:36,279 INFO   dropout_vmd_in: 0.3
2025-06-16 04:24:36,280 INFO   enhanced_srl_weight: 0.1
2025-06-16 04:24:36,280 INFO   entropy_regularization_lambda: 0.001
2025-06-16 04:24:36,280 INFO   g_size: 50
2025-06-16 04:24:36,280 INFO   h_size: 150
2025-06-16 04:24:36,281 INFO   init_stock_with_word: 0
2025-06-16 04:24:36,281 INFO   kl_lambda_anneal_rate: 0.005
2025-06-16 04:24:36,281 INFO   kl_lambda_start_step: 0
2025-06-16 04:24:36,281 INFO   lr: 0.001
2025-06-16 04:24:36,281 INFO   max_n_days: 5
2025-06-16 04:24:36,282 INFO   max_n_msgs: 20
2025-06-16 04:24:36,282 INFO   max_n_words: 30
2025-06-16 04:24:36,282 INFO   mel_cell_type: gru
2025-06-16 04:24:36,282 INFO   mel_h_size: 100
2025-06-16 04:24:36,283 INFO   mode: all
2025-06-16 04:24:36,283 INFO   momentum: 0.9
2025-06-16 04:24:36,283 INFO   msin_h_size: 100
2025-06-16 04:24:36,283 INFO   n_epochs: 10
2025-06-16 04:24:36,283 INFO   noise_aware_weight: 0.5
2025-06-16 04:24:36,284 INFO   opt: adam
2025-06-16 04:24:36,284 INFO   pathway_competition_type: dynamic
2025-06-16 04:24:36,284 INFO   prediction_loss_weight: 0.1
2025-06-16 04:24:36,284 INFO   residual_connection_weight: 0.1
2025-06-16 04:24:36,284 INFO   shuffle: 1
2025-06-16 04:24:36,285 INFO   stock_embed_size: 150
2025-06-16 04:24:36,285 INFO   td_temporal_attention: True
2025-06-16 04:24:36,285 INFO   use_ca_tsu: True
2025-06-16 04:24:36,285 INFO   use_constant_kl_lambda: 0
2025-06-16 04:24:36,285 INFO   use_dual_path_srl: True
2025-06-16 04:24:36,286 INFO   use_enhanced_srl: True
2025-06-16 04:24:36,286 INFO   path_separation_margin: 0.8
2025-06-16 04:24:36,286 INFO   use_g_bn: 0
2025-06-16 04:24:36,286 INFO   use_in_bn: 0
2025-06-16 04:24:36,287 INFO   use_noise_aware_loss: True
2025-06-16 04:24:36,287 INFO   use_o_bn: 0
2025-06-16 04:24:36,287 INFO   variant_type: hedge
2025-06-16 04:24:36,287 INFO   vmd_cell_type: gru
2025-06-16 04:24:36,288 INFO   vmd_rec: zh
2025-06-16 04:24:36,288 INFO   volatility_adaptation_factor: 0.3
2025-06-16 04:24:36,288 INFO   volatility_reg_weight: 0.05
2025-06-16 04:24:36,288 INFO   weight_init: xavier-uniform
2025-06-16 04:24:36,288 INFO   word_embed_size: 50
2025-06-16 04:24:36,289 INFO   word_embed_type: glove
2025-06-16 04:24:36,289 INFO   y_size: 2
2025-06-16 04:24:36,289 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 04:24:36,292 INFO Start graph assembling...
2025-06-16 04:24:38,056 INFO use_dual_path_srl: True
2025-06-16 04:24:38,058 INFO variant_type: hedge
2025-06-16 04:24:38,058 INFO use_enhanced_srl: True
2025-06-16 04:24:38,058 INFO Enhanced SRL enabled from config
2025-06-16 04:24:38,058 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 04:24:38,059 INFO SRL condition: True = True and True
2025-06-16 04:24:38,059 INFO Using enhanced dual-path SRL architecture
2025-06-16 04:24:38,059 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 04:24:38,103 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 04:24:38,107 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 04:24:38,127 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 04:24:38,349 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 04:24:38,349 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 04:24:38,349 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 04:24:38,618 INFO Using Temporal Attention (TAP)
2025-06-16 04:24:38,662 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 04:24:38,662 INFO Ca-TSU enabled: True
2025-06-16 04:24:38,663 INFO Enhanced SRL enabled: True
2025-06-16 04:24:38,663 INFO Noise-Aware Loss enabled: True
2025-06-16 04:24:38,679 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:24:38,679 INFO Adding auxiliary enhancement losses...
2025-06-16 04:24:38,683 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 04:24:38,695 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5
2025-06-16 04:24:38,696 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 04:24:38,696 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 04:24:38,706 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-16 04:24:38,706 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:24:38,706 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:24:41,097 INFO Graph assembled successfully.
2025-06-16 04:24:41,363 INFO Verifying model configuration...
2025-06-16 04:24:41,363 INFO Ca-TSU enabled: True
2025-06-16 04:24:41,363 INFO Enhanced SRL enabled: True
2025-06-16 04:24:41,364 INFO Noise-Aware Loss enabled: True
2025-06-16 04:24:41,364 INFO Checking model components for noise-aware loss...
2025-06-16 04:24:41,364 INFO Model has 'use_noise_aware_loss': True
2025-06-16 04:24:41,364 INFO use_noise_aware_loss value: True
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_weight': True
2025-06-16 04:24:41,365 INFO noise_aware_weight value: 0.5
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_loss': False
2025-06-16 04:24:41,365 INFO Model has 'separate_noise_aware_loss': False
2025-06-16 04:24:41,365 INFO Model has 'noise_aware_loss_raw': True
2025-06-16 04:24:41,365 INFO Model has 'reliability_weights': True
2025-06-16 04:24:41,366 INFO Model has 'use_enhanced_srl': True
2025-06-16 04:24:41,366 INFO use_enhanced_srl value: True
2025-06-16 04:24:41,366 INFO Model has 'enhanced_srl_loss': False
2025-06-16 04:24:41,366 INFO Model has 'enhanced_srl_loss_raw': False
2025-06-16 04:24:41,366 INFO Model has 'use_ca_tsu': True
2025-06-16 04:24:41,366 INFO use_ca_tsu value: True
2025-06-16 04:24:41,367 INFO Model has 'causal_consistency_loss': False
2025-06-16 04:24:41,367 INFO Model has 'causal_consistency_loss_raw': True
2025-06-16 04:24:41,367 INFO Model has 'loss_components': True
2025-06-16 04:24:41,367 INFO loss_components keys: dict_keys(['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw'])
2025-06-16 04:24:41,367 INFO Manually activating loss components...
2025-06-16 04:24:41,368 INFO Components manually activated:
2025-06-16 04:24:41,368 INFO use_enhanced_srl: True
2025-06-16 04:24:41,368 INFO use_ca_tsu: True
2025-06-16 04:24:41,368 INFO use_noise_aware_loss: True
2025-06-16 04:24:41,368 INFO use_dual_path_srl: True
2025-06-16 04:24:41,369 INFO Running test_noise_aware_loss...
2025-06-16 04:24:59,335 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 04:25:00,611 INFO Word table initialized
2025-06-16 04:25:00,611 INFO Checking loss components in the model graph...
2025-06-16 04:25:00,612 INFO Loss components dictionary found with keys: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 04:25:00,612 INFO   base_generative_objective: Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,612 INFO   noise_aware_loss_raw: Tensor("enhanced_srl_contrastive_loss/noise_aware_component/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,613 INFO   causal_consistency_loss_raw: Tensor("causal_consistency_component_kl/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-16 04:25:00,613 INFO Model: all-hedge-gru_683ac293, starting new session
2025-06-16 04:25:00,613 INFO 
============================================================
ENHANCED DUAL-PATH SRL MODEL TEST
============================================================

MODEL CONFIGURATION:
 Enhanced SRL: [ENABLED] (Weight: 0.1)
 Ca-TSU: [ENABLED] (Lambda: 0.3)
 Noise-Aware Loss: [ENABLED] (Weight: 0.5)
 Dual-Path SRL: [ENABLED]

TRAINING PLAN:
 Total batches: 10
 Progress logging: Every 5 batches
 Evaluation: Every 10 batches

COMPONENT STATUS:
 Raw SRL Loss: [UNAVAILABLE]
 Raw Causal Loss: [AVAILABLE]
 Raw Noise-Aware Loss: [AVAILABLE]
============================================================

2025-06-16 04:25:00,732 INFO Starting training test for 10 batches
2025-06-16 04:25:34,932 INFO --- Batch 1/10 (Step 1) ---
2025-06-16 04:25:34,933 INFO   PERFORMANCE: Loss=1.0826 | Acc=0.3438 | MCC=-0.3181
2025-06-16 04:25:34,933 INFO   LOSS COMPONENTS:
2025-06-16 04:25:34,934 INFO     - Causal Consistency Loss: 0.028141
2025-06-16 04:25:34,934 INFO     - Noise-Aware SRL Loss: 0.051800
2025-06-16 04:25:34,934 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:25:34,935 INFO     Alpha_i sample: 0.3222, Omega_i sample: 0.3128
2025-06-16 04:25:34,935 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:25:34,936 INFO     Volatility: 0.6807, Text Weight: 0.4060, Price Weight: 0.5940
2025-06-16 04:27:07,150 INFO --- Batch 5/10 (Step 5) ---
2025-06-16 04:27:07,151 INFO   PERFORMANCE: Loss=1.1927 | Acc=0.6562 | MCC=0.2901
2025-06-16 04:27:07,151 INFO   LOSS COMPONENTS:
2025-06-16 04:27:07,151 INFO     - Causal Consistency Loss: 0.017319
2025-06-16 04:27:07,152 INFO     - Noise-Aware SRL Loss: 0.004696
2025-06-16 04:27:07,152 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:27:07,152 INFO     Alpha_i sample: 0.0987, Omega_i sample: 0.1133
2025-06-16 04:27:07,152 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:27:07,153 INFO     Volatility: 0.6683, Text Weight: 0.3898, Price Weight: 0.6102
2025-06-16 04:28:27,820 INFO --- Batch 10/10 (Step 10) ---
2025-06-16 04:28:27,820 INFO   PERFORMANCE: Loss=1.4480 | Acc=0.4688 | MCC=-0.0485
2025-06-16 04:28:27,821 INFO   LOSS COMPONENTS:
2025-06-16 04:28:27,821 INFO     - Causal Consistency Loss: 0.015376
2025-06-16 04:28:27,821 INFO     - Noise-Aware SRL Loss: 0.000090
2025-06-16 04:28:27,822 INFO   Ca-TSU (Attention on Messages):
2025-06-16 04:28:27,822 INFO     Alpha_i sample: 1.0000, Omega_i sample: 1.0000
2025-06-16 04:28:27,822 INFO   ENHANCED SRL (Pathway Dynamics):
2025-06-16 04:28:27,823 INFO     Volatility: 0.6785, Text Weight: 0.4115, Price Weight: 0.5885
2025-06-16 04:28:27,824 INFO Generating diagnostic plots...
2025-06-16 04:28:29,871 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 04:28:29,872 INFO Saving final checkpoint for test run...
2025-06-16 04:28:30,699 INFO Final checkpoint saved to D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_683ac293\sess-10
2025-06-16 04:28:30,700 INFO Start dev phase...
2025-06-16 04:30:15,163 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-16 04:30:15,164 INFO 	Eval, eval loss: 1.4004164934158325, acc: 0.509146
2025-06-16 04:30:15,314 INFO Test summary saved to results/model_test/enhancement_test_summary_20250616_043015.txt
2025-06-16 04:30:15,315 INFO Test completed successfully!
2025-06-16 05:01:34,823 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:01:34,826 INFO Start graph assembling...
2025-06-16 05:01:36,553 INFO use_dual_path_srl: True
2025-06-16 05:01:36,554 INFO variant_type: hedge
2025-06-16 05:01:36,556 INFO use_enhanced_srl: True
2025-06-16 05:01:36,556 INFO Enhanced SRL enabled from config
2025-06-16 05:01:36,557 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:01:36,557 INFO SRL condition: True = True and True
2025-06-16 05:01:36,558 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:01:36,558 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:01:36,602 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:01:36,607 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:01:36,627 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:01:36,933 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:01:36,935 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:01:36,935 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:01:37,128 INFO Using Temporal Attention (TAP)
2025-06-16 05:01:37,172 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:01:37,173 INFO Ca-TSU enabled: True
2025-06-16 05:01:37,173 INFO Enhanced SRL enabled: True
2025-06-16 05:01:37,174 INFO Noise-Aware Loss enabled: True
2025-06-16 05:01:37,188 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:01:37,189 INFO Adding auxiliary enhancement losses...
2025-06-16 05:01:37,193 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:01:37,204 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.14678259732696614
2025-06-16 05:01:37,206 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:01:37,206 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:01:37,216 INFO Using KL-based Causal Consistency Loss with weight: 0.14149911285154604
2025-06-16 05:01:37,217 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:01:37,218 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:01:39,562 INFO Graph assembled successfully.
2025-06-16 05:01:57,783 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:01:59,079 INFO Word table initialized.
2025-06-16 05:01:59,080 INFO Model: all-hedge-gru_c3d38f61, starting new session.
2025-06-16 05:06:40,440 INFO 	iter: 20, batch loss: 1.2097033262252808, batch acc: 0.020508
2025-06-16 05:07:30,318 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:11:20,660 INFO 	iter: 40, batch loss: 0.9644396901130676, batch acc: 0.013672
2025-06-16 05:13:01,740 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:16:01,430 INFO 	iter: 60, batch loss: 0.8074793219566345, batch acc: 0.020508
2025-06-16 05:18:29,104 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 05:18:29,105 INFO Generating diagnostic plots...
2025-06-16 05:18:31,342 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 05:19:50,699 INFO Completed dev evaluation: size=420.0, acc=0.4548
2025-06-16 05:19:50,701 INFO 	Eval, eval loss: 0.8074036836624146, acc: 0.454762, mcc: -0.032582
2025-06-16 05:19:50,892 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,895 INFO Start graph assembling...
2025-06-16 05:19:50,934 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,937 INFO Start graph assembling...
2025-06-16 05:19:50,966 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,971 INFO Start graph assembling...
2025-06-16 05:19:50,994 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:50,997 INFO Start graph assembling...
2025-06-16 05:19:51,026 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,029 INFO Start graph assembling...
2025-06-16 05:19:51,054 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,059 INFO Start graph assembling...
2025-06-16 05:19:51,085 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,089 INFO Start graph assembling...
2025-06-16 05:19:51,116 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,120 INFO Start graph assembling...
2025-06-16 05:19:51,150 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,155 INFO Start graph assembling...
2025-06-16 05:19:51,189 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,194 INFO Start graph assembling...
2025-06-16 05:19:51,218 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,222 INFO Start graph assembling...
2025-06-16 05:19:51,245 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,248 INFO Start graph assembling...
2025-06-16 05:19:51,273 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,276 INFO Start graph assembling...
2025-06-16 05:19:51,299 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,302 INFO Start graph assembling...
2025-06-16 05:19:51,328 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,332 INFO Start graph assembling...
2025-06-16 05:19:51,356 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,359 INFO Start graph assembling...
2025-06-16 05:19:51,381 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,384 INFO Start graph assembling...
2025-06-16 05:19:51,405 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,408 INFO Start graph assembling...
2025-06-16 05:19:51,432 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,435 INFO Start graph assembling...
2025-06-16 05:19:51,456 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,459 INFO Start graph assembling...
2025-06-16 05:19:51,479 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,481 INFO Start graph assembling...
2025-06-16 05:19:51,501 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,504 INFO Start graph assembling...
2025-06-16 05:19:51,524 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,527 INFO Start graph assembling...
2025-06-16 05:19:51,545 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,548 INFO Start graph assembling...
2025-06-16 05:19:51,568 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,570 INFO Start graph assembling...
2025-06-16 05:19:51,590 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,593 INFO Start graph assembling...
2025-06-16 05:19:51,772 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,773 INFO Start graph assembling...
2025-06-16 05:19:51,791 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,793 INFO Start graph assembling...
2025-06-16 05:19:51,812 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,814 INFO Start graph assembling...
2025-06-16 05:19:51,833 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,835 INFO Start graph assembling...
2025-06-16 05:19:51,854 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,856 INFO Start graph assembling...
2025-06-16 05:19:51,874 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,876 INFO Start graph assembling...
2025-06-16 05:19:51,894 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,897 INFO Start graph assembling...
2025-06-16 05:19:51,918 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,921 INFO Start graph assembling...
2025-06-16 05:19:51,945 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,948 INFO Start graph assembling...
2025-06-16 05:19:51,969 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,973 INFO Start graph assembling...
2025-06-16 05:19:51,993 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:51,996 INFO Start graph assembling...
2025-06-16 05:19:52,018 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,020 INFO Start graph assembling...
2025-06-16 05:19:52,040 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,043 INFO Start graph assembling...
2025-06-16 05:19:52,066 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,070 INFO Start graph assembling...
2025-06-16 05:19:52,094 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,097 INFO Start graph assembling...
2025-06-16 05:19:52,122 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,127 INFO Start graph assembling...
2025-06-16 05:19:52,152 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,156 INFO Start graph assembling...
2025-06-16 05:19:52,176 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,179 INFO Start graph assembling...
2025-06-16 05:19:52,200 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,203 INFO Start graph assembling...
2025-06-16 05:19:52,222 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,225 INFO Start graph assembling...
2025-06-16 05:19:52,244 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,246 INFO Start graph assembling...
2025-06-16 05:19:52,266 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,269 INFO Start graph assembling...
2025-06-16 05:19:52,288 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:19:52,290 INFO Start graph assembling...
2025-06-16 05:25:36,858 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:25:36,861 INFO Start graph assembling...
2025-06-16 05:25:38,741 INFO use_dual_path_srl: True
2025-06-16 05:25:38,742 INFO variant_type: hedge
2025-06-16 05:25:38,742 INFO use_enhanced_srl: True
2025-06-16 05:25:38,743 INFO Enhanced SRL enabled from config
2025-06-16 05:25:38,744 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:25:38,744 INFO SRL condition: True = True and True
2025-06-16 05:25:38,744 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:25:38,745 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:25:38,790 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:25:38,795 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:25:38,815 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:25:39,131 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:25:39,132 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:25:39,132 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:25:39,343 INFO Using Temporal Attention (TAP)
2025-06-16 05:25:39,387 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:25:39,388 INFO Ca-TSU enabled: True
2025-06-16 05:25:39,389 INFO Enhanced SRL enabled: True
2025-06-16 05:25:39,389 INFO Noise-Aware Loss enabled: True
2025-06-16 05:25:39,404 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:25:39,405 INFO Adding auxiliary enhancement losses...
2025-06-16 05:25:39,409 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:25:39,420 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.15315703994294622
2025-06-16 05:25:39,422 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:25:39,423 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:25:39,433 INFO Using KL-based Causal Consistency Loss with weight: 0.6183063804607332
2025-06-16 05:25:39,434 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:25:39,435 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:25:41,891 INFO Graph assembled successfully.
2025-06-16 05:25:59,978 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:26:01,424 INFO Word table initialized.
2025-06-16 05:26:01,426 INFO Model: all-hedge-gru_6852cc19, starting new session.
2025-06-16 05:30:44,198 INFO 	iter: 20, batch loss: 1.3794220685958862, batch acc: 0.656250
2025-06-16 05:31:34,108 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:35:24,454 INFO 	iter: 40, batch loss: 0.994213879108429, batch acc: 0.593750
2025-06-16 05:37:05,056 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:40:03,707 INFO 	iter: 60, batch loss: 0.7729192972183228, batch acc: 0.656250
2025-06-16 05:42:34,220 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 05:42:34,221 INFO Generating diagnostic plots...
2025-06-16 05:42:36,469 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 05:43:59,223 INFO Completed dev evaluation: size=420.0, acc=0.5310
2025-06-16 05:43:59,224 INFO 	Eval, eval loss: 0.7507549524307251, acc: 0.530952, mcc: 0.022574
2025-06-16 05:43:59,417 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 05:43:59,419 INFO Start graph assembling...
2025-06-16 05:44:01,657 INFO use_dual_path_srl: True
2025-06-16 05:44:01,658 INFO variant_type: hedge
2025-06-16 05:44:01,658 INFO use_enhanced_srl: True
2025-06-16 05:44:01,659 INFO Enhanced SRL enabled from config
2025-06-16 05:44:01,659 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 05:44:01,660 INFO SRL condition: True = True and True
2025-06-16 05:44:01,660 INFO Using enhanced dual-path SRL architecture
2025-06-16 05:44:01,660 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 05:44:01,704 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 05:44:01,710 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 05:44:01,732 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 05:44:02,060 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 05:44:02,061 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 05:44:02,062 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 05:44:02,267 INFO Using Temporal Attention (TAP)
2025-06-16 05:44:02,314 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 05:44:02,314 INFO Ca-TSU enabled: True
2025-06-16 05:44:02,315 INFO Enhanced SRL enabled: True
2025-06-16 05:44:02,316 INFO Noise-Aware Loss enabled: True
2025-06-16 05:44:02,330 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 05:44:02,331 INFO Adding auxiliary enhancement losses...
2025-06-16 05:44:02,336 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 05:44:02,348 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.4038800300098692
2025-06-16 05:44:02,349 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 05:44:02,350 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 05:44:02,360 INFO Using KL-based Causal Consistency Loss with weight: 0.4025476029891924
2025-06-16 05:44:02,360 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 05:44:02,361 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 05:44:04,844 INFO Graph assembled successfully.
2025-06-16 05:44:23,057 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 05:44:23,843 INFO Word table initialized.
2025-06-16 05:44:23,844 INFO Model: all-hedge-gru_20194b07, starting new session.
2025-06-16 05:49:08,535 INFO 	iter: 20, batch loss: 1.300557255744934, batch acc: 0.625000
2025-06-16 05:50:00,058 INFO Epoch 1 finished. Checkpoint saved.
2025-06-16 05:53:49,041 INFO 	iter: 40, batch loss: 1.0455877780914307, batch acc: 0.468750
2025-06-16 05:55:28,965 INFO Epoch 2 finished. Checkpoint saved.
2025-06-16 05:58:26,438 INFO 	iter: 60, batch loss: 0.8638330698013306, batch acc: 0.593750
2025-06-16 06:00:57,608 INFO Epoch 3 finished. Checkpoint saved.
2025-06-16 06:00:57,609 INFO Generating diagnostic plots...
2025-06-16 06:00:59,816 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-16 06:02:20,955 INFO Completed dev evaluation: size=420.0, acc=0.4833
2025-06-16 06:02:20,957 INFO 	Eval, eval loss: 0.8231965899467468, acc: 0.483333, mcc: -0.026428
2025-06-16 06:02:21,141 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-16 06:02:21,143 INFO Start graph assembling...
2025-06-16 06:02:23,291 INFO use_dual_path_srl: True
2025-06-16 06:02:23,292 INFO variant_type: hedge
2025-06-16 06:02:23,292 INFO use_enhanced_srl: True
2025-06-16 06:02:23,293 INFO Enhanced SRL enabled from config
2025-06-16 06:02:23,293 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-16 06:02:23,293 INFO SRL condition: True = True and True
2025-06-16 06:02:23,294 INFO Using enhanced dual-path SRL architecture
2025-06-16 06:02:23,294 INFO Creating Enhanced Dual-Path SRL module...
2025-06-16 06:02:23,340 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-16 06:02:23,345 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-16 06:02:23,368 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-16 06:02:23,696 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-16 06:02:23,697 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-16 06:02:23,698 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-16 06:02:23,901 INFO Using Temporal Attention (TAP)
2025-06-16 06:02:23,947 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-16 06:02:23,948 INFO Ca-TSU enabled: True
2025-06-16 06:02:23,948 INFO Enhanced SRL enabled: True
2025-06-16 06:02:23,949 INFO Noise-Aware Loss enabled: True
2025-06-16 06:02:23,964 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-16 06:02:23,964 INFO Adding auxiliary enhancement losses...
2025-06-16 06:02:23,968 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-16 06:02:23,980 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.18082405748438934
2025-06-16 06:02:23,982 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-16 06:02:23,983 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-16 06:02:23,993 INFO Using KL-based Causal Consistency Loss with weight: 0.24237599698962034
2025-06-16 06:02:23,994 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-16 06:02:23,994 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-16 06:02:26,506 INFO Graph assembled successfully.
2025-06-16 06:02:44,465 INFO ASSEMBLE: word table #replacement: 19482
2025-06-16 06:02:45,222 INFO Word table initialized.
2025-06-16 06:02:45,223 INFO Model: all-hedge-gru_a52b0337, starting new session.
2025-06-19 06:50:45,405 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-19 06:50:45,413 INFO Configuration updated for full run.
2025-06-19 06:50:45,413 INFO   use_dual_path_srl: True
2025-06-19 06:50:45,413 INFO   use_enhanced_srl: True
2025-06-19 06:50:45,413 INFO   use_ca_tsu: True
2025-06-19 06:50:45,413 INFO   use_noise_aware_loss: True
2025-06-19 06:50:45,413 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-19 06:50:45,413 INFO   causal_loss_lambda (for Ca-TSU): 0.3
2025-06-19 06:50:45,414 INFO   noise_aware_weight (for SRL): 0.5
2025-06-19 06:50:45,414 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:50:45,416 INFO Start graph assembling...
2025-06-19 06:50:45,486 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:50:45,503 INFO Start graph assembling...
2025-06-19 06:50:47,595 INFO use_dual_path_srl: True
2025-06-19 06:50:47,596 INFO variant_type: hedge
2025-06-19 06:50:47,596 INFO use_enhanced_srl: True
2025-06-19 06:50:47,596 INFO Enhanced SRL enabled from config
2025-06-19 06:50:47,596 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:50:47,596 INFO SRL condition: True = True and True
2025-06-19 06:50:47,596 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:50:47,596 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:50:47,638 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:50:47,642 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:50:47,646 INFO use_dual_path_srl: True
2025-06-19 06:50:47,647 INFO variant_type: hedge
2025-06-19 06:50:47,647 INFO use_enhanced_srl: True
2025-06-19 06:50:47,647 INFO Enhanced SRL enabled from config
2025-06-19 06:50:47,647 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:50:47,647 INFO SRL condition: True = True and True
2025-06-19 06:50:47,647 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:50:47,647 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:50:47,660 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:50:47,690 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:50:47,694 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:50:47,711 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:50:47,874 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:50:47,874 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:50:47,874 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:50:47,929 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:50:47,930 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:50:47,930 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:50:48,151 INFO Using Temporal Attention (TAP)
2025-06-19 06:50:48,193 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:50:48,193 INFO Ca-TSU enabled: True
2025-06-19 06:50:48,193 INFO Enhanced SRL enabled: True
2025-06-19 06:50:48,193 INFO Noise-Aware Loss enabled: True
2025-06-19 06:50:48,207 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:48,207 INFO Adding auxiliary enhancement losses...
2025-06-19 06:50:48,210 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:50:48,221 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5
2025-06-19 06:50:48,221 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:50:48,221 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:50:48,226 INFO Using Temporal Attention (TAP)
2025-06-19 06:50:48,230 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-19 06:50:48,230 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:48,230 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:50:48,268 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:50:48,268 INFO Ca-TSU enabled: True
2025-06-19 06:50:48,268 INFO Enhanced SRL enabled: True
2025-06-19 06:50:48,268 INFO Noise-Aware Loss enabled: True
2025-06-19 06:50:48,282 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:48,283 INFO Adding auxiliary enhancement losses...
2025-06-19 06:50:48,286 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:50:48,296 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10805633902938261
2025-06-19 06:50:48,297 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:50:48,297 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:50:48,307 INFO Using KL-based Causal Consistency Loss with weight: 1.8259287281307697
2025-06-19 06:50:48,307 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:48,307 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:50:50,521 INFO Graph assembled successfully.
2025-06-19 06:50:50,744 INFO Graph assembled successfully.
2025-06-19 06:50:51,349 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:50:51,353 INFO Start graph assembling...
2025-06-19 06:50:53,260 INFO use_dual_path_srl: True
2025-06-19 06:50:53,260 INFO variant_type: hedge
2025-06-19 06:50:53,260 INFO use_enhanced_srl: True
2025-06-19 06:50:53,260 INFO Enhanced SRL enabled from config
2025-06-19 06:50:53,260 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:50:53,260 INFO SRL condition: True = True and True
2025-06-19 06:50:53,260 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:50:53,260 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:50:53,305 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:50:53,310 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:50:53,329 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:50:53,645 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:50:53,645 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:50:53,645 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:50:53,840 INFO Using Temporal Attention (TAP)
2025-06-19 06:50:53,884 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:50:53,884 INFO Ca-TSU enabled: True
2025-06-19 06:50:53,884 INFO Enhanced SRL enabled: True
2025-06-19 06:50:53,884 INFO Noise-Aware Loss enabled: True
2025-06-19 06:50:53,898 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:53,898 INFO Adding auxiliary enhancement losses...
2025-06-19 06:50:53,901 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:50:53,911 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06651884195128158
2025-06-19 06:50:53,912 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:50:53,912 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:50:53,922 INFO Using KL-based Causal Consistency Loss with weight: 0.26007119377954535
2025-06-19 06:50:53,922 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:50:53,922 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:50:56,256 INFO Graph assembled successfully.
2025-06-19 06:50:57,888 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:50:57,890 INFO Start graph assembling...
2025-06-19 06:50:59,800 INFO use_dual_path_srl: True
2025-06-19 06:50:59,833 INFO variant_type: hedge
2025-06-19 06:50:59,833 INFO use_enhanced_srl: True
2025-06-19 06:50:59,833 INFO Enhanced SRL enabled from config
2025-06-19 06:50:59,834 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:50:59,834 INFO SRL condition: True = True and True
2025-06-19 06:50:59,834 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:50:59,834 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:50:59,888 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:50:59,892 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:50:59,909 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:00,123 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:00,123 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:00,123 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:00,414 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:02,097 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:02,097 INFO Ca-TSU enabled: True
2025-06-19 06:51:02,097 INFO Enhanced SRL enabled: True
2025-06-19 06:51:02,097 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:02,111 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:02,111 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:02,114 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:02,124 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.0916601119281824
2025-06-19 06:51:02,125 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:02,125 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:02,134 INFO Using KL-based Causal Consistency Loss with weight: 1.1745092891173299
2025-06-19 06:51:02,134 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:02,134 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:04,426 INFO Graph assembled successfully.
2025-06-19 06:51:05,831 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:05,833 INFO Start graph assembling...
2025-06-19 06:51:07,633 INFO use_dual_path_srl: True
2025-06-19 06:51:07,633 INFO variant_type: hedge
2025-06-19 06:51:07,633 INFO use_enhanced_srl: True
2025-06-19 06:51:07,633 INFO Enhanced SRL enabled from config
2025-06-19 06:51:07,633 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:07,633 INFO SRL condition: True = True and True
2025-06-19 06:51:07,633 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:07,633 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:07,675 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:07,679 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:07,697 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:07,995 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:07,996 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:07,996 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:08,187 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:08,229 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:08,229 INFO Ca-TSU enabled: True
2025-06-19 06:51:08,229 INFO Enhanced SRL enabled: True
2025-06-19 06:51:08,229 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:08,242 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:08,242 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:08,245 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:08,255 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09079021395019195
2025-06-19 06:51:08,256 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:08,256 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:08,265 INFO Using KL-based Causal Consistency Loss with weight: 0.1441985916417411
2025-06-19 06:51:08,265 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:08,265 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:10,554 INFO Graph assembled successfully.
2025-06-19 06:51:12,727 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:12,729 INFO Start graph assembling...
2025-06-19 06:51:14,656 INFO use_dual_path_srl: True
2025-06-19 06:51:14,656 INFO variant_type: hedge
2025-06-19 06:51:14,656 INFO use_enhanced_srl: True
2025-06-19 06:51:14,656 INFO Enhanced SRL enabled from config
2025-06-19 06:51:14,656 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:14,656 INFO SRL condition: True = True and True
2025-06-19 06:51:14,656 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:14,656 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:14,700 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:14,704 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:14,722 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:14,937 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:14,937 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:14,937 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:15,131 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:15,172 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:15,172 INFO Ca-TSU enabled: True
2025-06-19 06:51:15,172 INFO Enhanced SRL enabled: True
2025-06-19 06:51:15,172 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:15,279 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:15,279 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:15,282 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:15,293 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09000365872569321
2025-06-19 06:51:15,293 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:15,294 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:15,303 INFO Using KL-based Causal Consistency Loss with weight: 1.2713919561583515
2025-06-19 06:51:15,303 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:15,303 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:17,487 INFO Graph assembled successfully.
2025-06-19 06:51:18,970 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:18,973 INFO Start graph assembling...
2025-06-19 06:51:20,790 INFO use_dual_path_srl: True
2025-06-19 06:51:22,067 INFO variant_type: hedge
2025-06-19 06:51:22,067 INFO use_enhanced_srl: True
2025-06-19 06:51:22,067 INFO Enhanced SRL enabled from config
2025-06-19 06:51:22,067 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:22,067 INFO SRL condition: True = True and True
2025-06-19 06:51:22,068 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:22,068 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:22,124 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:22,128 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:22,148 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:22,364 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:22,365 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:22,365 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:22,559 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:22,602 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:22,602 INFO Ca-TSU enabled: True
2025-06-19 06:51:22,602 INFO Enhanced SRL enabled: True
2025-06-19 06:51:22,602 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:22,616 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:22,616 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:22,619 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:22,727 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.13219557306594695
2025-06-19 06:51:22,728 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:22,728 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:22,737 INFO Using KL-based Causal Consistency Loss with weight: 0.9505883745524183
2025-06-19 06:51:22,738 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:22,738 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:24,953 INFO Graph assembled successfully.
2025-06-19 06:51:26,692 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:26,697 INFO Start graph assembling...
2025-06-19 06:51:28,512 INFO use_dual_path_srl: True
2025-06-19 06:51:28,512 INFO variant_type: hedge
2025-06-19 06:51:28,512 INFO use_enhanced_srl: True
2025-06-19 06:51:28,512 INFO Enhanced SRL enabled from config
2025-06-19 06:51:28,512 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:28,512 INFO SRL condition: True = True and True
2025-06-19 06:51:28,512 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:28,512 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:28,555 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:28,559 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:28,576 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:28,789 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:28,789 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:28,789 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:28,983 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:29,025 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:29,025 INFO Ca-TSU enabled: True
2025-06-19 06:51:29,025 INFO Enhanced SRL enabled: True
2025-06-19 06:51:29,025 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:29,038 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:29,038 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:29,041 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:29,051 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.053049749032589064
2025-06-19 06:51:29,052 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:29,052 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:29,154 INFO Using KL-based Causal Consistency Loss with weight: 0.18384203256332254
2025-06-19 06:51:29,154 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:29,155 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:31,362 INFO Graph assembled successfully.
2025-06-19 06:51:33,035 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:33,036 INFO Start graph assembling...
2025-06-19 06:51:34,868 INFO use_dual_path_srl: True
2025-06-19 06:51:34,869 INFO variant_type: hedge
2025-06-19 06:51:34,869 INFO use_enhanced_srl: True
2025-06-19 06:51:34,869 INFO Enhanced SRL enabled from config
2025-06-19 06:51:34,869 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:34,869 INFO SRL condition: True = True and True
2025-06-19 06:51:34,869 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:34,869 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:34,911 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:34,915 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:34,933 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:35,145 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:35,145 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:35,145 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:35,339 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:35,381 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:35,381 INFO Ca-TSU enabled: True
2025-06-19 06:51:35,381 INFO Enhanced SRL enabled: True
2025-06-19 06:51:35,381 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:35,395 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:35,395 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:35,398 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:35,408 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6140210565755596
2025-06-19 06:51:35,409 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:35,409 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:35,418 INFO Using KL-based Causal Consistency Loss with weight: 0.5471946454425088
2025-06-19 06:51:35,418 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:35,418 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:37,708 INFO Graph assembled successfully.
2025-06-19 06:51:39,107 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:39,108 INFO Start graph assembling...
2025-06-19 06:51:40,928 INFO use_dual_path_srl: True
2025-06-19 06:51:40,928 INFO variant_type: hedge
2025-06-19 06:51:40,928 INFO use_enhanced_srl: True
2025-06-19 06:51:40,928 INFO Enhanced SRL enabled from config
2025-06-19 06:51:40,928 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:40,928 INFO SRL condition: True = True and True
2025-06-19 06:51:40,928 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:40,928 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:40,974 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:40,978 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:40,997 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:41,216 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:41,544 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:41,545 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:41,754 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:41,796 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:41,796 INFO Ca-TSU enabled: True
2025-06-19 06:51:41,796 INFO Enhanced SRL enabled: True
2025-06-19 06:51:41,796 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:41,810 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:41,810 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:41,813 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:41,823 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6612401273606624
2025-06-19 06:51:41,824 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:41,824 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:41,833 INFO Using KL-based Causal Consistency Loss with weight: 0.1918622904954956
2025-06-19 06:51:41,833 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:41,833 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:44,114 INFO Graph assembled successfully.
2025-06-19 06:51:45,617 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:45,619 INFO Start graph assembling...
2025-06-19 06:51:47,452 INFO use_dual_path_srl: True
2025-06-19 06:51:47,452 INFO variant_type: hedge
2025-06-19 06:51:47,452 INFO use_enhanced_srl: True
2025-06-19 06:51:47,452 INFO Enhanced SRL enabled from config
2025-06-19 06:51:47,452 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:47,452 INFO SRL condition: True = True and True
2025-06-19 06:51:47,452 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:47,452 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:47,495 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:47,500 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:47,517 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:47,734 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:47,734 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:47,734 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:47,928 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:47,970 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:47,970 INFO Ca-TSU enabled: True
2025-06-19 06:51:47,970 INFO Enhanced SRL enabled: True
2025-06-19 06:51:47,971 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:47,984 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:47,984 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:47,987 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:47,998 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5361415251042756
2025-06-19 06:51:47,998 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:47,998 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:48,007 INFO Using KL-based Causal Consistency Loss with weight: 0.6927746947706642
2025-06-19 06:51:48,007 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:48,007 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:50,291 INFO Graph assembled successfully.
2025-06-19 06:51:52,784 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:52,785 INFO Start graph assembling...
2025-06-19 06:51:54,609 INFO use_dual_path_srl: True
2025-06-19 06:51:54,610 INFO variant_type: hedge
2025-06-19 06:51:54,610 INFO use_enhanced_srl: True
2025-06-19 06:51:54,610 INFO Enhanced SRL enabled from config
2025-06-19 06:51:54,610 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:51:54,610 INFO SRL condition: True = True and True
2025-06-19 06:51:54,610 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:51:54,610 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:51:54,652 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:51:54,656 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:51:54,675 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:51:54,888 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:51:54,888 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:51:54,888 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:51:55,080 INFO Using Temporal Attention (TAP)
2025-06-19 06:51:55,121 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:51:55,121 INFO Ca-TSU enabled: True
2025-06-19 06:51:55,121 INFO Enhanced SRL enabled: True
2025-06-19 06:51:55,122 INFO Noise-Aware Loss enabled: True
2025-06-19 06:51:55,135 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:55,135 INFO Adding auxiliary enhancement losses...
2025-06-19 06:51:55,138 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:51:55,149 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8404984520989002
2025-06-19 06:51:55,149 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:51:55,150 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:51:55,158 INFO Using KL-based Causal Consistency Loss with weight: 0.20284388514029772
2025-06-19 06:51:55,158 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:51:55,159 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:51:57,468 INFO Graph assembled successfully.
2025-06-19 06:51:58,870 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:51:58,872 INFO Start graph assembling...
2025-06-19 06:52:00,724 INFO use_dual_path_srl: True
2025-06-19 06:52:00,724 INFO variant_type: hedge
2025-06-19 06:52:00,724 INFO use_enhanced_srl: True
2025-06-19 06:52:00,724 INFO Enhanced SRL enabled from config
2025-06-19 06:52:00,724 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:00,724 INFO SRL condition: True = True and True
2025-06-19 06:52:00,724 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:00,724 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:00,766 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:00,770 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:00,788 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:01,002 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:01,003 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:01,003 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:01,196 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:01,237 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:01,237 INFO Ca-TSU enabled: True
2025-06-19 06:52:01,237 INFO Enhanced SRL enabled: True
2025-06-19 06:52:01,237 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:01,250 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:01,250 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:01,253 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:01,264 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6058935404283793
2025-06-19 06:52:01,265 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:01,265 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:01,274 INFO Using KL-based Causal Consistency Loss with weight: 0.42939124843805515
2025-06-19 06:52:01,274 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:01,274 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:03,559 INFO Graph assembled successfully.
2025-06-19 06:52:05,206 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:05,207 INFO Start graph assembling...
2025-06-19 06:52:07,027 INFO use_dual_path_srl: True
2025-06-19 06:52:07,027 INFO variant_type: hedge
2025-06-19 06:52:07,027 INFO use_enhanced_srl: True
2025-06-19 06:52:07,027 INFO Enhanced SRL enabled from config
2025-06-19 06:52:07,027 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:07,027 INFO SRL condition: True = True and True
2025-06-19 06:52:07,027 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:07,027 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:07,070 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:07,074 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:07,091 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:07,308 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:07,308 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:07,308 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:07,501 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:07,543 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:07,543 INFO Ca-TSU enabled: True
2025-06-19 06:52:07,543 INFO Enhanced SRL enabled: True
2025-06-19 06:52:07,543 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:07,557 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:07,557 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:07,560 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:07,570 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1174341657897249
2025-06-19 06:52:07,571 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:07,571 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:07,580 INFO Using KL-based Causal Consistency Loss with weight: 0.8701675146406387
2025-06-19 06:52:07,580 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:07,581 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:09,874 INFO Graph assembled successfully.
2025-06-19 06:52:11,192 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:11,194 INFO Start graph assembling...
2025-06-19 06:52:13,172 INFO use_dual_path_srl: True
2025-06-19 06:52:13,172 INFO variant_type: hedge
2025-06-19 06:52:13,172 INFO use_enhanced_srl: True
2025-06-19 06:52:13,172 INFO Enhanced SRL enabled from config
2025-06-19 06:52:13,172 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:13,172 INFO SRL condition: True = True and True
2025-06-19 06:52:13,172 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:13,172 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:13,215 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:13,219 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:13,236 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:13,449 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:13,449 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:13,449 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:13,640 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:13,682 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:13,682 INFO Ca-TSU enabled: True
2025-06-19 06:52:13,682 INFO Enhanced SRL enabled: True
2025-06-19 06:52:13,682 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:13,695 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:13,695 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:13,698 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:13,708 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.07330942773909169
2025-06-19 06:52:13,709 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:13,709 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:13,718 INFO Using KL-based Causal Consistency Loss with weight: 1.1465450091208471
2025-06-19 06:52:13,718 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:13,718 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:16,035 INFO Graph assembled successfully.
2025-06-19 06:52:19,119 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:19,122 INFO Start graph assembling...
2025-06-19 06:52:21,047 INFO use_dual_path_srl: True
2025-06-19 06:52:21,048 INFO variant_type: hedge
2025-06-19 06:52:21,048 INFO use_enhanced_srl: True
2025-06-19 06:52:21,048 INFO Enhanced SRL enabled from config
2025-06-19 06:52:21,048 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:21,048 INFO SRL condition: True = True and True
2025-06-19 06:52:21,048 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:21,048 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:21,091 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:21,095 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:21,113 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:21,421 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:21,421 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:21,421 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:21,616 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:21,658 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:21,658 INFO Ca-TSU enabled: True
2025-06-19 06:52:21,658 INFO Enhanced SRL enabled: True
2025-06-19 06:52:21,658 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:21,672 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:21,672 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:21,675 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:21,685 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.12712421481078814
2025-06-19 06:52:21,686 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:21,686 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:21,695 INFO Using KL-based Causal Consistency Loss with weight: 0.15901482277525683
2025-06-19 06:52:21,695 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:21,695 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:24,018 INFO Graph assembled successfully.
2025-06-19 06:52:25,719 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:25,721 INFO Start graph assembling...
2025-06-19 06:52:27,666 INFO use_dual_path_srl: True
2025-06-19 06:52:27,666 INFO variant_type: hedge
2025-06-19 06:52:27,666 INFO use_enhanced_srl: True
2025-06-19 06:52:27,666 INFO Enhanced SRL enabled from config
2025-06-19 06:52:27,666 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:27,666 INFO SRL condition: True = True and True
2025-06-19 06:52:27,666 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:27,666 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:27,709 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:27,713 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:27,731 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:27,948 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:27,948 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:27,948 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:28,235 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:28,276 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:28,276 INFO Ca-TSU enabled: True
2025-06-19 06:52:28,276 INFO Enhanced SRL enabled: True
2025-06-19 06:52:28,276 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:28,290 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:28,290 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:28,293 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:28,304 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.24305539490301206
2025-06-19 06:52:28,305 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:28,305 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:28,314 INFO Using KL-based Causal Consistency Loss with weight: 1.279755548232006
2025-06-19 06:52:28,314 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:28,314 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:30,546 INFO Graph assembled successfully.
2025-06-19 06:52:32,245 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:32,247 INFO Start graph assembling...
2025-06-19 06:52:34,082 INFO use_dual_path_srl: True
2025-06-19 06:52:34,082 INFO variant_type: hedge
2025-06-19 06:52:34,082 INFO use_enhanced_srl: True
2025-06-19 06:52:34,082 INFO Enhanced SRL enabled from config
2025-06-19 06:52:34,082 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:34,082 INFO SRL condition: True = True and True
2025-06-19 06:52:34,082 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:34,082 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:34,124 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:34,129 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:34,146 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:34,360 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:34,360 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:34,360 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:34,641 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:34,683 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:34,683 INFO Ca-TSU enabled: True
2025-06-19 06:52:34,684 INFO Enhanced SRL enabled: True
2025-06-19 06:52:34,684 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:34,697 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:34,697 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:34,700 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:34,711 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6208402190524283
2025-06-19 06:52:34,711 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:34,711 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:34,721 INFO Using KL-based Causal Consistency Loss with weight: 1.7998319774368416
2025-06-19 06:52:34,721 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:34,721 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:37,068 INFO Graph assembled successfully.
2025-06-19 06:52:38,495 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:38,497 INFO Start graph assembling...
2025-06-19 06:52:40,365 INFO use_dual_path_srl: True
2025-06-19 06:52:40,365 INFO variant_type: hedge
2025-06-19 06:52:40,365 INFO use_enhanced_srl: True
2025-06-19 06:52:40,365 INFO Enhanced SRL enabled from config
2025-06-19 06:52:40,365 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:40,365 INFO SRL condition: True = True and True
2025-06-19 06:52:40,365 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:40,365 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:40,408 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:40,412 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:40,430 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:40,743 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:40,743 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:40,743 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:40,950 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:40,995 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:40,995 INFO Ca-TSU enabled: True
2025-06-19 06:52:40,995 INFO Enhanced SRL enabled: True
2025-06-19 06:52:40,995 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:41,009 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:41,009 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:41,012 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:41,023 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2116740905981786
2025-06-19 06:52:41,023 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:41,024 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:41,033 INFO Using KL-based Causal Consistency Loss with weight: 0.3175099180385156
2025-06-19 06:52:41,033 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:41,034 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:43,376 INFO Graph assembled successfully.
2025-06-19 06:52:45,071 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:45,073 INFO Start graph assembling...
2025-06-19 06:52:47,016 INFO use_dual_path_srl: True
2025-06-19 06:52:47,016 INFO variant_type: hedge
2025-06-19 06:52:47,016 INFO use_enhanced_srl: True
2025-06-19 06:52:47,016 INFO Enhanced SRL enabled from config
2025-06-19 06:52:47,017 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:47,017 INFO SRL condition: True = True and True
2025-06-19 06:52:47,017 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:47,017 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:47,060 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:47,064 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:47,081 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:47,294 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:47,294 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:47,294 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:47,488 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:47,530 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:47,530 INFO Ca-TSU enabled: True
2025-06-19 06:52:47,530 INFO Enhanced SRL enabled: True
2025-06-19 06:52:47,530 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:47,544 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:47,544 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:47,547 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:47,557 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.39375634737528836
2025-06-19 06:52:47,558 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:47,558 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:47,567 INFO Using KL-based Causal Consistency Loss with weight: 0.18477430460167898
2025-06-19 06:52:47,567 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:47,567 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:49,869 INFO Graph assembled successfully.
2025-06-19 06:52:51,328 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:51,330 INFO Start graph assembling...
2025-06-19 06:52:53,272 INFO use_dual_path_srl: True
2025-06-19 06:52:53,272 INFO variant_type: hedge
2025-06-19 06:52:53,272 INFO use_enhanced_srl: True
2025-06-19 06:52:53,272 INFO Enhanced SRL enabled from config
2025-06-19 06:52:53,272 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:52:53,272 INFO SRL condition: True = True and True
2025-06-19 06:52:53,272 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:52:53,272 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:52:53,314 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:52:53,319 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:52:53,424 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:52:53,640 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:52:53,640 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:52:53,640 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:52:53,835 INFO Using Temporal Attention (TAP)
2025-06-19 06:52:53,877 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:52:53,877 INFO Ca-TSU enabled: True
2025-06-19 06:52:53,877 INFO Enhanced SRL enabled: True
2025-06-19 06:52:53,877 INFO Noise-Aware Loss enabled: True
2025-06-19 06:52:53,892 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:53,892 INFO Adding auxiliary enhancement losses...
2025-06-19 06:52:53,895 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:52:53,905 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06560162769848475
2025-06-19 06:52:53,906 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:52:53,906 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:52:53,915 INFO Using KL-based Causal Consistency Loss with weight: 0.16878130379846654
2025-06-19 06:52:53,915 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:52:53,915 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:52:56,261 INFO Graph assembled successfully.
2025-06-19 06:52:59,034 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:52:59,036 INFO Start graph assembling...
2025-06-19 06:53:00,994 INFO use_dual_path_srl: True
2025-06-19 06:53:00,994 INFO variant_type: hedge
2025-06-19 06:53:00,994 INFO use_enhanced_srl: True
2025-06-19 06:53:00,994 INFO Enhanced SRL enabled from config
2025-06-19 06:53:00,994 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:00,994 INFO SRL condition: True = True and True
2025-06-19 06:53:00,995 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:00,995 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:01,037 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:01,041 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:01,059 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:01,275 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:01,275 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:01,275 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:01,561 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:01,603 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:01,603 INFO Ca-TSU enabled: True
2025-06-19 06:53:01,603 INFO Enhanced SRL enabled: True
2025-06-19 06:53:01,603 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:01,616 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:01,616 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:01,619 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:01,630 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08369147442061091
2025-06-19 06:53:01,631 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:01,631 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:01,640 INFO Using KL-based Causal Consistency Loss with weight: 1.307990359596425
2025-06-19 06:53:01,640 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:01,640 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:03,990 INFO Graph assembled successfully.
2025-06-19 06:53:05,373 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:05,375 INFO Start graph assembling...
2025-06-19 06:53:07,253 INFO use_dual_path_srl: True
2025-06-19 06:53:07,254 INFO variant_type: hedge
2025-06-19 06:53:07,254 INFO use_enhanced_srl: True
2025-06-19 06:53:07,254 INFO Enhanced SRL enabled from config
2025-06-19 06:53:07,254 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:07,254 INFO SRL condition: True = True and True
2025-06-19 06:53:07,254 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:07,254 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:07,297 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:07,302 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:07,320 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:07,638 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:07,639 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:07,639 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:07,835 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:07,878 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:07,878 INFO Ca-TSU enabled: True
2025-06-19 06:53:07,878 INFO Enhanced SRL enabled: True
2025-06-19 06:53:07,878 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:07,892 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:07,892 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:07,895 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:07,905 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.07819339563468652
2025-06-19 06:53:07,906 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:07,906 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:07,916 INFO Using KL-based Causal Consistency Loss with weight: 0.9662086224197917
2025-06-19 06:53:07,916 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:07,916 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:10,265 INFO Graph assembled successfully.
2025-06-19 06:53:11,900 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:11,902 INFO Start graph assembling...
2025-06-19 06:53:13,861 INFO use_dual_path_srl: True
2025-06-19 06:53:13,861 INFO variant_type: hedge
2025-06-19 06:53:13,861 INFO use_enhanced_srl: True
2025-06-19 06:53:13,861 INFO Enhanced SRL enabled from config
2025-06-19 06:53:13,861 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:13,861 INFO SRL condition: True = True and True
2025-06-19 06:53:13,861 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:13,861 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:13,904 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:13,909 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:13,926 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:14,142 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:14,142 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:14,142 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:14,337 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:14,485 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:14,486 INFO Ca-TSU enabled: True
2025-06-19 06:53:14,486 INFO Enhanced SRL enabled: True
2025-06-19 06:53:14,486 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:14,500 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:14,500 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:14,503 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:14,513 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.46622260473654886
2025-06-19 06:53:14,514 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:14,514 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:14,525 INFO Using KL-based Causal Consistency Loss with weight: 0.8690921393148733
2025-06-19 06:53:14,525 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:14,525 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:16,784 INFO Graph assembled successfully.
2025-06-19 06:53:18,308 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:18,310 INFO Start graph assembling...
2025-06-19 06:53:20,185 INFO use_dual_path_srl: True
2025-06-19 06:53:20,185 INFO variant_type: hedge
2025-06-19 06:53:20,185 INFO use_enhanced_srl: True
2025-06-19 06:53:20,185 INFO Enhanced SRL enabled from config
2025-06-19 06:53:20,185 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:20,185 INFO SRL condition: True = True and True
2025-06-19 06:53:20,185 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:20,185 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:20,230 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:20,234 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:20,252 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:20,474 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:20,474 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:20,474 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:20,767 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:20,810 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:20,810 INFO Ca-TSU enabled: True
2025-06-19 06:53:20,810 INFO Enhanced SRL enabled: True
2025-06-19 06:53:20,810 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:20,823 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:20,824 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:20,826 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:20,837 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3234145437209152
2025-06-19 06:53:20,838 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:20,838 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:20,847 INFO Using KL-based Causal Consistency Loss with weight: 0.7897413471432276
2025-06-19 06:53:20,847 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:20,847 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:23,082 INFO Graph assembled successfully.
2025-06-19 06:53:24,908 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:24,910 INFO Start graph assembling...
2025-06-19 06:53:26,799 INFO use_dual_path_srl: True
2025-06-19 06:53:26,800 INFO variant_type: hedge
2025-06-19 06:53:26,800 INFO use_enhanced_srl: True
2025-06-19 06:53:26,800 INFO Enhanced SRL enabled from config
2025-06-19 06:53:26,800 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:26,800 INFO SRL condition: True = True and True
2025-06-19 06:53:26,800 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:26,800 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:26,844 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:26,849 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:26,868 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:27,086 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:27,086 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:27,086 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:27,377 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:27,419 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:27,419 INFO Ca-TSU enabled: True
2025-06-19 06:53:27,419 INFO Enhanced SRL enabled: True
2025-06-19 06:53:27,419 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:27,433 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:27,433 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:27,436 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:27,447 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1040675277169096
2025-06-19 06:53:27,448 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:27,448 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:27,457 INFO Using KL-based Causal Consistency Loss with weight: 0.10285630454024905
2025-06-19 06:53:27,457 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:27,457 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:29,814 INFO Graph assembled successfully.
2025-06-19 06:53:31,471 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:31,472 INFO Start graph assembling...
2025-06-19 06:53:33,331 INFO use_dual_path_srl: True
2025-06-19 06:53:33,331 INFO variant_type: hedge
2025-06-19 06:53:33,331 INFO use_enhanced_srl: True
2025-06-19 06:53:33,331 INFO Enhanced SRL enabled from config
2025-06-19 06:53:33,331 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:33,331 INFO SRL condition: True = True and True
2025-06-19 06:53:33,331 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:33,331 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:33,374 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:33,378 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:33,396 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:33,703 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:33,703 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:33,703 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:33,899 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:33,942 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:33,942 INFO Ca-TSU enabled: True
2025-06-19 06:53:33,942 INFO Enhanced SRL enabled: True
2025-06-19 06:53:33,942 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:33,955 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:33,956 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:33,959 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:33,970 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06488711009482545
2025-06-19 06:53:33,970 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:33,970 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:33,979 INFO Using KL-based Causal Consistency Loss with weight: 1.061367711846424
2025-06-19 06:53:33,979 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:33,980 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:36,303 INFO Graph assembled successfully.
2025-06-19 06:53:37,957 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:37,958 INFO Start graph assembling...
2025-06-19 06:53:39,923 INFO use_dual_path_srl: True
2025-06-19 06:53:39,924 INFO variant_type: hedge
2025-06-19 06:53:39,924 INFO use_enhanced_srl: True
2025-06-19 06:53:39,924 INFO Enhanced SRL enabled from config
2025-06-19 06:53:39,924 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:39,924 INFO SRL condition: True = True and True
2025-06-19 06:53:39,924 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:39,924 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:39,967 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:39,971 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:39,989 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:40,205 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:40,206 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:40,206 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:40,400 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:40,442 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:40,442 INFO Ca-TSU enabled: True
2025-06-19 06:53:40,442 INFO Enhanced SRL enabled: True
2025-06-19 06:53:40,443 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:40,456 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:40,456 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:40,459 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:40,469 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.16660208606440657
2025-06-19 06:53:40,470 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:40,470 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:40,579 INFO Using KL-based Causal Consistency Loss with weight: 0.6191210304840787
2025-06-19 06:53:40,580 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:40,580 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:42,809 INFO Graph assembled successfully.
2025-06-19 06:53:45,419 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:45,420 INFO Start graph assembling...
2025-06-19 06:53:47,284 INFO use_dual_path_srl: True
2025-06-19 06:53:47,285 INFO variant_type: hedge
2025-06-19 06:53:47,285 INFO use_enhanced_srl: True
2025-06-19 06:53:47,285 INFO Enhanced SRL enabled from config
2025-06-19 06:53:47,285 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:47,285 INFO SRL condition: True = True and True
2025-06-19 06:53:47,285 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:47,285 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:47,329 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:47,333 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:47,351 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:47,570 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:47,570 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:47,570 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:47,767 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:47,811 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:47,811 INFO Ca-TSU enabled: True
2025-06-19 06:53:47,811 INFO Enhanced SRL enabled: True
2025-06-19 06:53:47,811 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:47,825 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:47,825 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:47,828 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:47,838 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.34821648661715887
2025-06-19 06:53:47,839 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:47,839 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:47,848 INFO Using KL-based Causal Consistency Loss with weight: 0.6807791157897505
2025-06-19 06:53:47,848 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:47,848 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:50,169 INFO Graph assembled successfully.
2025-06-19 06:53:51,621 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:51,622 INFO Start graph assembling...
2025-06-19 06:53:53,478 INFO use_dual_path_srl: True
2025-06-19 06:53:53,478 INFO variant_type: hedge
2025-06-19 06:53:53,478 INFO use_enhanced_srl: True
2025-06-19 06:53:53,478 INFO Enhanced SRL enabled from config
2025-06-19 06:53:53,478 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:53:53,478 INFO SRL condition: True = True and True
2025-06-19 06:53:53,478 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:53:53,478 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:53:53,522 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:53:53,526 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:53:53,544 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:53:53,763 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:53:53,763 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:53:53,763 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:53:53,959 INFO Using Temporal Attention (TAP)
2025-06-19 06:53:54,001 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:53:54,001 INFO Ca-TSU enabled: True
2025-06-19 06:53:54,002 INFO Enhanced SRL enabled: True
2025-06-19 06:53:54,002 INFO Noise-Aware Loss enabled: True
2025-06-19 06:53:54,015 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:54,015 INFO Adding auxiliary enhancement losses...
2025-06-19 06:53:54,018 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:53:54,029 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.11813110407367308
2025-06-19 06:53:54,029 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:53:54,029 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:53:54,038 INFO Using KL-based Causal Consistency Loss with weight: 0.7440406545929273
2025-06-19 06:53:54,038 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:53:54,038 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:53:56,370 INFO Graph assembled successfully.
2025-06-19 06:53:58,330 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:53:58,332 INFO Start graph assembling...
2025-06-19 06:54:00,205 INFO use_dual_path_srl: True
2025-06-19 06:54:00,205 INFO variant_type: hedge
2025-06-19 06:54:00,205 INFO use_enhanced_srl: True
2025-06-19 06:54:00,205 INFO Enhanced SRL enabled from config
2025-06-19 06:54:00,205 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:00,205 INFO SRL condition: True = True and True
2025-06-19 06:54:00,205 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:00,205 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:00,250 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:00,255 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:00,273 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:00,496 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:00,496 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:00,496 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:00,692 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:00,735 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:00,735 INFO Ca-TSU enabled: True
2025-06-19 06:54:00,735 INFO Enhanced SRL enabled: True
2025-06-19 06:54:00,735 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:00,748 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:00,749 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:00,752 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:00,762 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.30433443859673154
2025-06-19 06:54:00,763 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:00,763 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:00,772 INFO Using KL-based Causal Consistency Loss with weight: 0.7998564844449293
2025-06-19 06:54:00,772 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:00,772 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:03,082 INFO Graph assembled successfully.
2025-06-19 06:54:04,694 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:04,696 INFO Start graph assembling...
2025-06-19 06:54:06,536 INFO use_dual_path_srl: True
2025-06-19 06:54:06,536 INFO variant_type: hedge
2025-06-19 06:54:06,536 INFO use_enhanced_srl: True
2025-06-19 06:54:06,536 INFO Enhanced SRL enabled from config
2025-06-19 06:54:06,536 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:06,536 INFO SRL condition: True = True and True
2025-06-19 06:54:06,536 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:06,536 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:06,581 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:06,585 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:06,604 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:06,826 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:06,826 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:06,826 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:07,019 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:07,061 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:07,061 INFO Ca-TSU enabled: True
2025-06-19 06:54:07,061 INFO Enhanced SRL enabled: True
2025-06-19 06:54:07,061 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:07,075 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:07,075 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:07,078 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:07,088 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.12277174322891994
2025-06-19 06:54:07,089 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:07,089 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:07,098 INFO Using KL-based Causal Consistency Loss with weight: 1.8905822483037795
2025-06-19 06:54:07,098 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:07,098 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:09,407 INFO Graph assembled successfully.
2025-06-19 06:54:11,031 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:11,033 INFO Start graph assembling...
2025-06-19 06:54:12,888 INFO use_dual_path_srl: True
2025-06-19 06:54:12,888 INFO variant_type: hedge
2025-06-19 06:54:12,888 INFO use_enhanced_srl: True
2025-06-19 06:54:12,888 INFO Enhanced SRL enabled from config
2025-06-19 06:54:12,888 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:12,888 INFO SRL condition: True = True and True
2025-06-19 06:54:12,888 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:12,888 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:12,931 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:12,935 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:12,954 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:13,172 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:13,172 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:13,172 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:13,367 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:13,408 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:13,408 INFO Ca-TSU enabled: True
2025-06-19 06:54:13,408 INFO Enhanced SRL enabled: True
2025-06-19 06:54:13,408 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:13,422 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:13,422 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:13,425 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:13,436 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09640076784976687
2025-06-19 06:54:13,436 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:13,436 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:13,445 INFO Using KL-based Causal Consistency Loss with weight: 0.24663621048809173
2025-06-19 06:54:13,445 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:13,446 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:15,772 INFO Graph assembled successfully.
2025-06-19 06:54:18,045 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:18,047 INFO Start graph assembling...
2025-06-19 06:54:19,908 INFO use_dual_path_srl: True
2025-06-19 06:54:19,908 INFO variant_type: hedge
2025-06-19 06:54:19,908 INFO use_enhanced_srl: True
2025-06-19 06:54:19,908 INFO Enhanced SRL enabled from config
2025-06-19 06:54:19,908 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:19,908 INFO SRL condition: True = True and True
2025-06-19 06:54:19,908 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:19,908 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:19,952 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:19,957 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:19,975 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:20,196 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:20,196 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:20,196 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:20,392 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:20,741 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:20,741 INFO Ca-TSU enabled: True
2025-06-19 06:54:20,741 INFO Enhanced SRL enabled: True
2025-06-19 06:54:20,741 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:20,755 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:20,755 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:20,758 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:20,769 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08879298175790595
2025-06-19 06:54:20,769 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:20,770 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:20,779 INFO Using KL-based Causal Consistency Loss with weight: 0.30042754091547985
2025-06-19 06:54:20,779 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:20,779 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:23,082 INFO Graph assembled successfully.
2025-06-19 06:54:25,221 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:25,222 INFO Start graph assembling...
2025-06-19 06:54:27,094 INFO use_dual_path_srl: True
2025-06-19 06:54:27,094 INFO variant_type: hedge
2025-06-19 06:54:27,094 INFO use_enhanced_srl: True
2025-06-19 06:54:27,094 INFO Enhanced SRL enabled from config
2025-06-19 06:54:27,094 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:27,094 INFO SRL condition: True = True and True
2025-06-19 06:54:27,094 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:27,094 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:27,137 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:27,141 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:27,159 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:27,379 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:27,380 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:27,380 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:27,575 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:27,618 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:27,618 INFO Ca-TSU enabled: True
2025-06-19 06:54:27,618 INFO Enhanced SRL enabled: True
2025-06-19 06:54:27,618 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:27,631 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:27,631 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:27,634 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:27,645 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3121090872575177
2025-06-19 06:54:27,645 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:27,646 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:27,655 INFO Using KL-based Causal Consistency Loss with weight: 0.5725832266674024
2025-06-19 06:54:27,655 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:27,655 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:29,985 INFO Graph assembled successfully.
2025-06-19 06:54:31,451 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:31,453 INFO Start graph assembling...
2025-06-19 06:54:33,377 INFO use_dual_path_srl: True
2025-06-19 06:54:33,377 INFO variant_type: hedge
2025-06-19 06:54:33,377 INFO use_enhanced_srl: True
2025-06-19 06:54:33,377 INFO Enhanced SRL enabled from config
2025-06-19 06:54:33,377 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:33,377 INFO SRL condition: True = True and True
2025-06-19 06:54:33,377 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:33,377 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:33,419 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:33,423 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:33,441 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:33,747 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:33,747 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:33,747 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:33,939 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:33,981 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:33,982 INFO Ca-TSU enabled: True
2025-06-19 06:54:33,982 INFO Enhanced SRL enabled: True
2025-06-19 06:54:33,982 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:33,995 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:33,995 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:33,998 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:34,008 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.22830959683919103
2025-06-19 06:54:34,009 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:34,009 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:34,018 INFO Using KL-based Causal Consistency Loss with weight: 1.0606260509832948
2025-06-19 06:54:34,018 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:34,018 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:36,338 INFO Graph assembled successfully.
2025-06-19 06:54:37,900 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:37,902 INFO Start graph assembling...
2025-06-19 06:54:39,856 INFO use_dual_path_srl: True
2025-06-19 06:54:39,857 INFO variant_type: hedge
2025-06-19 06:54:39,857 INFO use_enhanced_srl: True
2025-06-19 06:54:39,857 INFO Enhanced SRL enabled from config
2025-06-19 06:54:39,857 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:39,857 INFO SRL condition: True = True and True
2025-06-19 06:54:39,857 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:39,857 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:39,900 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:39,904 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:39,921 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:40,133 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:40,133 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:40,133 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:40,423 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:40,466 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:40,466 INFO Ca-TSU enabled: True
2025-06-19 06:54:40,466 INFO Enhanced SRL enabled: True
2025-06-19 06:54:40,466 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:40,479 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:40,479 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:40,482 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:40,493 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5810153312951979
2025-06-19 06:54:40,493 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:40,494 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:40,502 INFO Using KL-based Causal Consistency Loss with weight: 0.26974819202296646
2025-06-19 06:54:40,503 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:40,503 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:42,852 INFO Graph assembled successfully.
2025-06-19 06:54:44,291 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:44,293 INFO Start graph assembling...
2025-06-19 06:54:46,186 INFO use_dual_path_srl: True
2025-06-19 06:54:46,541 INFO variant_type: hedge
2025-06-19 06:54:46,541 INFO use_enhanced_srl: True
2025-06-19 06:54:46,541 INFO Enhanced SRL enabled from config
2025-06-19 06:54:46,541 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:46,541 INFO SRL condition: True = True and True
2025-06-19 06:54:46,542 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:46,542 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:46,598 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:46,602 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:46,620 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:46,838 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:46,838 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:46,838 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:47,132 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:47,174 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:47,174 INFO Ca-TSU enabled: True
2025-06-19 06:54:47,174 INFO Enhanced SRL enabled: True
2025-06-19 06:54:47,174 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:47,187 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:47,187 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:47,190 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:47,201 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.44576021155074524
2025-06-19 06:54:47,202 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:47,202 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:47,211 INFO Using KL-based Causal Consistency Loss with weight: 0.30924526410560105
2025-06-19 06:54:47,211 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:47,211 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:49,547 INFO Graph assembled successfully.
2025-06-19 06:54:51,177 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:51,178 INFO Start graph assembling...
2025-06-19 06:54:53,045 INFO use_dual_path_srl: True
2025-06-19 06:54:53,045 INFO variant_type: hedge
2025-06-19 06:54:53,045 INFO use_enhanced_srl: True
2025-06-19 06:54:53,045 INFO Enhanced SRL enabled from config
2025-06-19 06:54:53,045 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:54:53,045 INFO SRL condition: True = True and True
2025-06-19 06:54:53,045 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:54:53,045 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:54:53,088 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:54:53,092 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:54:53,110 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:54:53,421 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:54:53,421 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:54:53,421 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:54:53,615 INFO Using Temporal Attention (TAP)
2025-06-19 06:54:53,657 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:54:53,657 INFO Ca-TSU enabled: True
2025-06-19 06:54:53,657 INFO Enhanced SRL enabled: True
2025-06-19 06:54:53,657 INFO Noise-Aware Loss enabled: True
2025-06-19 06:54:53,671 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:53,671 INFO Adding auxiliary enhancement losses...
2025-06-19 06:54:53,674 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:54:53,684 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.9774731573961377
2025-06-19 06:54:53,685 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:54:53,685 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:54:53,694 INFO Using KL-based Causal Consistency Loss with weight: 0.27533330720135024
2025-06-19 06:54:53,694 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:54:53,694 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:54:56,029 INFO Graph assembled successfully.
2025-06-19 06:54:58,127 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:54:58,129 INFO Start graph assembling...
2025-06-19 06:55:00,216 INFO use_dual_path_srl: True
2025-06-19 06:55:00,216 INFO variant_type: hedge
2025-06-19 06:55:00,216 INFO use_enhanced_srl: True
2025-06-19 06:55:00,216 INFO Enhanced SRL enabled from config
2025-06-19 06:55:00,216 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:00,216 INFO SRL condition: True = True and True
2025-06-19 06:55:00,216 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:00,216 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:00,262 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:00,266 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:00,286 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:00,516 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:00,516 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:00,516 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:00,720 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:00,870 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:00,870 INFO Ca-TSU enabled: True
2025-06-19 06:55:00,870 INFO Enhanced SRL enabled: True
2025-06-19 06:55:00,870 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:00,885 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:00,885 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:00,888 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:00,899 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10574550528588422
2025-06-19 06:55:00,900 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:00,900 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:00,909 INFO Using KL-based Causal Consistency Loss with weight: 0.7012455537309256
2025-06-19 06:55:00,909 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:00,909 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:03,160 INFO Graph assembled successfully.
2025-06-19 06:55:04,666 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:04,668 INFO Start graph assembling...
2025-06-19 06:55:06,553 INFO use_dual_path_srl: True
2025-06-19 06:55:06,553 INFO variant_type: hedge
2025-06-19 06:55:06,553 INFO use_enhanced_srl: True
2025-06-19 06:55:06,553 INFO Enhanced SRL enabled from config
2025-06-19 06:55:06,553 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:06,553 INFO SRL condition: True = True and True
2025-06-19 06:55:06,553 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:06,553 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:06,599 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:06,603 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:06,622 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:06,842 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:08,125 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:08,126 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:08,336 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:08,378 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:08,379 INFO Ca-TSU enabled: True
2025-06-19 06:55:08,379 INFO Enhanced SRL enabled: True
2025-06-19 06:55:08,379 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:08,493 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:08,493 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:08,496 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:08,507 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.27174644214217014
2025-06-19 06:55:08,508 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:08,508 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:08,517 INFO Using KL-based Causal Consistency Loss with weight: 0.10464805042213385
2025-06-19 06:55:08,517 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:08,517 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:10,724 INFO Graph assembled successfully.
2025-06-19 06:55:12,673 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:12,675 INFO Start graph assembling...
2025-06-19 06:55:14,557 INFO use_dual_path_srl: True
2025-06-19 06:55:14,557 INFO variant_type: hedge
2025-06-19 06:55:14,557 INFO use_enhanced_srl: True
2025-06-19 06:55:14,557 INFO Enhanced SRL enabled from config
2025-06-19 06:55:14,557 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:14,557 INFO SRL condition: True = True and True
2025-06-19 06:55:14,557 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:14,557 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:14,603 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:14,608 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:14,628 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:14,855 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:14,855 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:14,855 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:15,053 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:15,094 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:15,095 INFO Ca-TSU enabled: True
2025-06-19 06:55:15,095 INFO Enhanced SRL enabled: True
2025-06-19 06:55:15,095 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:15,214 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:15,214 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:15,217 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:15,228 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10942758948629257
2025-06-19 06:55:15,229 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:15,229 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:15,238 INFO Using KL-based Causal Consistency Loss with weight: 0.29697322514331576
2025-06-19 06:55:15,238 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:15,238 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:17,454 INFO Graph assembled successfully.
2025-06-19 06:55:19,291 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:19,293 INFO Start graph assembling...
2025-06-19 06:55:21,174 INFO use_dual_path_srl: True
2025-06-19 06:55:21,174 INFO variant_type: hedge
2025-06-19 06:55:21,174 INFO use_enhanced_srl: True
2025-06-19 06:55:21,174 INFO Enhanced SRL enabled from config
2025-06-19 06:55:21,174 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:21,174 INFO SRL condition: True = True and True
2025-06-19 06:55:21,175 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:21,175 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:21,218 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:21,223 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:21,241 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:21,461 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:21,461 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:21,461 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:21,657 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:21,699 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:21,699 INFO Ca-TSU enabled: True
2025-06-19 06:55:21,699 INFO Enhanced SRL enabled: True
2025-06-19 06:55:21,699 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:21,713 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:21,713 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:21,819 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:21,830 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.20666012531718828
2025-06-19 06:55:21,831 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:21,831 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:21,840 INFO Using KL-based Causal Consistency Loss with weight: 0.2921740996418073
2025-06-19 06:55:21,840 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:21,840 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:24,046 INFO Graph assembled successfully.
2025-06-19 06:55:25,971 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:25,973 INFO Start graph assembling...
2025-06-19 06:55:27,851 INFO use_dual_path_srl: True
2025-06-19 06:55:30,323 INFO variant_type: hedge
2025-06-19 06:55:30,323 INFO use_enhanced_srl: True
2025-06-19 06:55:30,323 INFO Enhanced SRL enabled from config
2025-06-19 06:55:30,323 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:30,323 INFO SRL condition: True = True and True
2025-06-19 06:55:30,324 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:30,324 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:30,383 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:30,387 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:30,407 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:30,629 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:30,629 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:30,629 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:30,823 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:30,865 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:30,865 INFO Ca-TSU enabled: True
2025-06-19 06:55:30,865 INFO Enhanced SRL enabled: True
2025-06-19 06:55:30,865 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:30,878 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:30,878 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:30,882 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:30,994 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3786247548014266
2025-06-19 06:55:30,995 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:30,995 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:31,004 INFO Using KL-based Causal Consistency Loss with weight: 0.9964549769812102
2025-06-19 06:55:31,004 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:31,004 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:33,205 INFO Graph assembled successfully.
2025-06-19 06:55:35,058 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:35,060 INFO Start graph assembling...
2025-06-19 06:55:36,954 INFO use_dual_path_srl: True
2025-06-19 06:55:36,954 INFO variant_type: hedge
2025-06-19 06:55:36,954 INFO use_enhanced_srl: True
2025-06-19 06:55:36,954 INFO Enhanced SRL enabled from config
2025-06-19 06:55:36,954 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:36,954 INFO SRL condition: True = True and True
2025-06-19 06:55:36,954 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:36,954 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:36,999 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:37,003 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:37,022 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:37,246 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:37,246 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:37,246 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:37,449 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:37,492 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:37,492 INFO Ca-TSU enabled: True
2025-06-19 06:55:37,492 INFO Enhanced SRL enabled: True
2025-06-19 06:55:37,492 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:37,506 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:37,506 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:37,509 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:37,520 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06721854258689487
2025-06-19 06:55:37,521 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:37,521 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:37,636 INFO Using KL-based Causal Consistency Loss with weight: 0.2492849708378413
2025-06-19 06:55:37,636 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:37,636 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:39,850 INFO Graph assembled successfully.
2025-06-19 06:55:41,385 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:41,387 INFO Start graph assembling...
2025-06-19 06:55:43,276 INFO use_dual_path_srl: True
2025-06-19 06:55:43,575 INFO variant_type: hedge
2025-06-19 06:55:43,575 INFO use_enhanced_srl: True
2025-06-19 06:55:43,575 INFO Enhanced SRL enabled from config
2025-06-19 06:55:43,576 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:43,576 INFO SRL condition: True = True and True
2025-06-19 06:55:43,576 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:43,576 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:43,632 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:43,636 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:43,655 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:43,875 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:43,875 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:43,875 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:44,070 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:44,112 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:44,112 INFO Ca-TSU enabled: True
2025-06-19 06:55:44,112 INFO Enhanced SRL enabled: True
2025-06-19 06:55:44,112 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:44,125 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:44,125 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:44,128 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:44,139 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.23912433496832727
2025-06-19 06:55:44,139 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:44,140 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:44,250 INFO Using KL-based Causal Consistency Loss with weight: 1.2116800615992978
2025-06-19 06:55:44,250 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:44,250 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:46,490 INFO Graph assembled successfully.
2025-06-19 06:55:48,206 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:48,207 INFO Start graph assembling...
2025-06-19 06:55:50,106 INFO use_dual_path_srl: True
2025-06-19 06:55:50,106 INFO variant_type: hedge
2025-06-19 06:55:50,107 INFO use_enhanced_srl: True
2025-06-19 06:55:50,107 INFO Enhanced SRL enabled from config
2025-06-19 06:55:50,107 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:50,107 INFO SRL condition: True = True and True
2025-06-19 06:55:50,107 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:50,107 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:50,151 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:50,155 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:50,173 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:50,394 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:50,395 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:50,395 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:50,590 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:50,633 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:50,634 INFO Ca-TSU enabled: True
2025-06-19 06:55:50,634 INFO Enhanced SRL enabled: True
2025-06-19 06:55:50,634 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:50,647 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:50,647 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:50,650 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:50,661 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2323204807544845
2025-06-19 06:55:50,661 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:50,662 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:50,671 INFO Using KL-based Causal Consistency Loss with weight: 1.9773999400588762
2025-06-19 06:55:50,672 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:50,672 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:55:53,026 INFO Graph assembled successfully.
2025-06-19 06:55:57,128 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:55:57,130 INFO Start graph assembling...
2025-06-19 06:55:58,984 INFO use_dual_path_srl: True
2025-06-19 06:55:58,985 INFO variant_type: hedge
2025-06-19 06:55:58,985 INFO use_enhanced_srl: True
2025-06-19 06:55:58,985 INFO Enhanced SRL enabled from config
2025-06-19 06:55:58,985 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:55:58,985 INFO SRL condition: True = True and True
2025-06-19 06:55:58,985 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:55:58,985 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:55:59,028 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:55:59,032 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:55:59,050 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:55:59,271 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:55:59,271 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:55:59,271 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:55:59,468 INFO Using Temporal Attention (TAP)
2025-06-19 06:55:59,512 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:55:59,512 INFO Ca-TSU enabled: True
2025-06-19 06:55:59,512 INFO Enhanced SRL enabled: True
2025-06-19 06:55:59,512 INFO Noise-Aware Loss enabled: True
2025-06-19 06:55:59,528 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:59,528 INFO Adding auxiliary enhancement losses...
2025-06-19 06:55:59,531 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:55:59,542 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.07288869080398859
2025-06-19 06:55:59,543 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:55:59,543 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:55:59,553 INFO Using KL-based Causal Consistency Loss with weight: 0.7007480973885408
2025-06-19 06:55:59,553 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:55:59,553 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:56:01,874 INFO Graph assembled successfully.
2025-06-19 06:56:07,099 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:56:07,101 INFO Start graph assembling...
2025-06-19 06:56:08,985 INFO use_dual_path_srl: True
2025-06-19 06:56:08,985 INFO variant_type: hedge
2025-06-19 06:56:08,985 INFO use_enhanced_srl: True
2025-06-19 06:56:08,985 INFO Enhanced SRL enabled from config
2025-06-19 06:56:08,985 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:56:08,985 INFO SRL condition: True = True and True
2025-06-19 06:56:08,985 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:56:08,985 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:56:09,029 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:56:09,033 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:56:09,051 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:56:09,273 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:56:09,273 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:56:09,273 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:56:09,469 INFO Using Temporal Attention (TAP)
2025-06-19 06:56:09,512 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:56:09,513 INFO Ca-TSU enabled: True
2025-06-19 06:56:09,513 INFO Enhanced SRL enabled: True
2025-06-19 06:56:09,513 INFO Noise-Aware Loss enabled: True
2025-06-19 06:56:09,526 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:09,526 INFO Adding auxiliary enhancement losses...
2025-06-19 06:56:09,529 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:56:09,540 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1807880416518056
2025-06-19 06:56:09,540 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:56:09,541 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:56:09,550 INFO Using KL-based Causal Consistency Loss with weight: 0.3009745612324184
2025-06-19 06:56:09,550 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:09,550 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:56:11,903 INFO Graph assembled successfully.
2025-06-19 06:56:16,135 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:56:16,137 INFO Start graph assembling...
2025-06-19 06:56:18,019 INFO use_dual_path_srl: True
2025-06-19 06:56:18,859 INFO variant_type: hedge
2025-06-19 06:56:18,859 INFO use_enhanced_srl: True
2025-06-19 06:56:18,859 INFO Enhanced SRL enabled from config
2025-06-19 06:56:18,860 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:56:18,860 INFO SRL condition: True = True and True
2025-06-19 06:56:18,860 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:56:18,860 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:56:18,918 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:56:18,923 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:56:18,942 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:56:19,163 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:56:19,163 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:56:19,163 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:56:19,357 INFO Using Temporal Attention (TAP)
2025-06-19 06:56:19,400 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:56:19,400 INFO Ca-TSU enabled: True
2025-06-19 06:56:19,400 INFO Enhanced SRL enabled: True
2025-06-19 06:56:19,400 INFO Noise-Aware Loss enabled: True
2025-06-19 06:56:19,413 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:19,414 INFO Adding auxiliary enhancement losses...
2025-06-19 06:56:19,417 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:56:19,427 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.053458831006572595
2025-06-19 06:56:19,428 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:56:19,428 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:56:19,437 INFO Using KL-based Causal Consistency Loss with weight: 0.7403345978687282
2025-06-19 06:56:19,437 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:19,437 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:56:21,753 INFO Graph assembled successfully.
2025-06-19 06:56:27,628 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 06:56:27,630 INFO Start graph assembling...
2025-06-19 06:56:29,523 INFO use_dual_path_srl: True
2025-06-19 06:56:29,523 INFO variant_type: hedge
2025-06-19 06:56:29,523 INFO use_enhanced_srl: True
2025-06-19 06:56:29,523 INFO Enhanced SRL enabled from config
2025-06-19 06:56:29,523 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 06:56:29,523 INFO SRL condition: True = True and True
2025-06-19 06:56:29,523 INFO Using enhanced dual-path SRL architecture
2025-06-19 06:56:29,523 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 06:56:29,571 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 06:56:29,575 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 06:56:29,594 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 06:56:29,821 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 06:56:29,821 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 06:56:29,821 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 06:56:30,019 INFO Using Temporal Attention (TAP)
2025-06-19 06:56:30,062 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 06:56:30,062 INFO Ca-TSU enabled: True
2025-06-19 06:56:30,062 INFO Enhanced SRL enabled: True
2025-06-19 06:56:30,062 INFO Noise-Aware Loss enabled: True
2025-06-19 06:56:30,076 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:30,076 INFO Adding auxiliary enhancement losses...
2025-06-19 06:56:30,079 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 06:56:30,090 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.13769047090209427
2025-06-19 06:56:30,090 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 06:56:30,090 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 06:56:30,100 INFO Using KL-based Causal Consistency Loss with weight: 0.11273763576508168
2025-06-19 06:56:30,100 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 06:56:30,100 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 06:56:32,421 INFO Graph assembled successfully.
2025-06-19 07:13:38,460 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:13:38,465 INFO Start graph assembling...
2025-06-19 07:13:40,243 INFO use_dual_path_srl: True
2025-06-19 07:13:40,243 INFO variant_type: hedge
2025-06-19 07:13:40,243 INFO use_enhanced_srl: True
2025-06-19 07:13:40,243 INFO Enhanced SRL enabled from config
2025-06-19 07:13:40,243 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:13:40,243 INFO SRL condition: True = True and True
2025-06-19 07:13:40,243 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:13:40,243 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:13:40,287 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:13:40,291 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:13:40,308 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:13:40,530 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:13:40,530 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:13:40,530 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:13:40,834 INFO Using Temporal Attention (TAP)
2025-06-19 07:13:40,880 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:13:40,880 INFO Ca-TSU enabled: True
2025-06-19 07:13:40,880 INFO Enhanced SRL enabled: True
2025-06-19 07:13:40,881 INFO Noise-Aware Loss enabled: True
2025-06-19 07:13:40,895 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:40,895 INFO Adding auxiliary enhancement losses...
2025-06-19 07:13:40,898 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:13:40,909 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.13994434773108905
2025-06-19 07:13:40,910 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:13:40,910 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:13:40,921 INFO Using KL-based Causal Consistency Loss with weight: 1.3472744093670377
2025-06-19 07:13:40,921 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:40,921 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:13:43,334 INFO Graph assembled successfully.
2025-06-19 07:13:44,890 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:13:44,891 INFO Start graph assembling...
2025-06-19 07:13:46,746 INFO use_dual_path_srl: True
2025-06-19 07:13:46,746 INFO variant_type: hedge
2025-06-19 07:13:46,746 INFO use_enhanced_srl: True
2025-06-19 07:13:46,746 INFO Enhanced SRL enabled from config
2025-06-19 07:13:46,746 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:13:46,746 INFO SRL condition: True = True and True
2025-06-19 07:13:46,746 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:13:46,746 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:13:46,789 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:13:46,793 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:13:46,811 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:13:47,128 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:13:47,128 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:13:47,128 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:13:47,323 INFO Using Temporal Attention (TAP)
2025-06-19 07:13:47,367 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:13:47,367 INFO Ca-TSU enabled: True
2025-06-19 07:13:47,367 INFO Enhanced SRL enabled: True
2025-06-19 07:13:47,367 INFO Noise-Aware Loss enabled: True
2025-06-19 07:13:47,381 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:47,381 INFO Adding auxiliary enhancement losses...
2025-06-19 07:13:47,384 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:13:47,394 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.13047261352912418
2025-06-19 07:13:47,395 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:13:47,395 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:13:47,405 INFO Using KL-based Causal Consistency Loss with weight: 0.8228852383017986
2025-06-19 07:13:47,405 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:47,405 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:13:49,763 INFO Graph assembled successfully.
2025-06-19 07:13:51,666 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:13:51,668 INFO Start graph assembling...
2025-06-19 07:13:53,595 INFO use_dual_path_srl: True
2025-06-19 07:13:53,595 INFO variant_type: hedge
2025-06-19 07:13:53,595 INFO use_enhanced_srl: True
2025-06-19 07:13:53,595 INFO Enhanced SRL enabled from config
2025-06-19 07:13:53,595 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:13:53,595 INFO SRL condition: True = True and True
2025-06-19 07:13:53,596 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:13:53,596 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:13:53,638 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:13:53,642 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:13:53,660 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:13:53,877 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:13:53,877 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:13:53,877 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:13:54,174 INFO Using Temporal Attention (TAP)
2025-06-19 07:13:54,217 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:13:54,217 INFO Ca-TSU enabled: True
2025-06-19 07:13:54,217 INFO Enhanced SRL enabled: True
2025-06-19 07:13:54,217 INFO Noise-Aware Loss enabled: True
2025-06-19 07:13:54,231 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:54,231 INFO Adding auxiliary enhancement losses...
2025-06-19 07:13:54,234 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:13:54,245 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5626362807336843
2025-06-19 07:13:54,246 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:13:54,246 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:13:54,255 INFO Using KL-based Causal Consistency Loss with weight: 0.6754653498785884
2025-06-19 07:13:54,255 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:13:54,255 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:13:56,645 INFO Graph assembled successfully.
2025-06-19 07:13:57,859 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:13:57,861 INFO Start graph assembling...
2025-06-19 07:13:59,743 INFO use_dual_path_srl: True
2025-06-19 07:13:59,861 INFO variant_type: hedge
2025-06-19 07:13:59,861 INFO use_enhanced_srl: True
2025-06-19 07:13:59,861 INFO Enhanced SRL enabled from config
2025-06-19 07:13:59,862 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:13:59,862 INFO SRL condition: True = True and True
2025-06-19 07:13:59,862 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:13:59,862 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:13:59,916 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:13:59,921 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:13:59,939 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:00,258 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:00,258 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:00,258 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:00,453 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:00,495 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:00,495 INFO Ca-TSU enabled: True
2025-06-19 07:14:00,495 INFO Enhanced SRL enabled: True
2025-06-19 07:14:00,496 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:00,509 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:00,509 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:00,512 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:00,523 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.45783647549403006
2025-06-19 07:14:00,523 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:00,524 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:00,533 INFO Using KL-based Causal Consistency Loss with weight: 0.13000666809024672
2025-06-19 07:14:00,533 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:00,533 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:02,882 INFO Graph assembled successfully.
2025-06-19 07:14:04,589 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:04,591 INFO Start graph assembling...
2025-06-19 07:14:06,540 INFO use_dual_path_srl: True
2025-06-19 07:14:06,540 INFO variant_type: hedge
2025-06-19 07:14:06,540 INFO use_enhanced_srl: True
2025-06-19 07:14:06,540 INFO Enhanced SRL enabled from config
2025-06-19 07:14:06,540 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:06,540 INFO SRL condition: True = True and True
2025-06-19 07:14:06,540 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:06,540 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:06,582 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:06,587 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:06,604 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:06,822 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:06,822 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:06,822 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:07,017 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:07,059 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:07,059 INFO Ca-TSU enabled: True
2025-06-19 07:14:07,059 INFO Enhanced SRL enabled: True
2025-06-19 07:14:07,059 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:07,175 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:07,176 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:07,179 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:07,189 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.05093084182587562
2025-06-19 07:14:07,190 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:07,190 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:07,199 INFO Using KL-based Causal Consistency Loss with weight: 0.11847373798878244
2025-06-19 07:14:07,199 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:07,199 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:09,429 INFO Graph assembled successfully.
2025-06-19 07:14:11,028 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:11,030 INFO Start graph assembling...
2025-06-19 07:14:12,922 INFO use_dual_path_srl: True
2025-06-19 07:14:12,922 INFO variant_type: hedge
2025-06-19 07:14:12,922 INFO use_enhanced_srl: True
2025-06-19 07:14:12,922 INFO Enhanced SRL enabled from config
2025-06-19 07:14:12,922 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:12,922 INFO SRL condition: True = True and True
2025-06-19 07:14:12,923 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:12,923 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:12,966 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:12,970 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:12,988 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:13,208 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:13,208 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:13,208 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:13,405 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:13,447 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:13,447 INFO Ca-TSU enabled: True
2025-06-19 07:14:13,448 INFO Enhanced SRL enabled: True
2025-06-19 07:14:13,448 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:13,462 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:13,462 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:13,465 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:13,587 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.71180472423564
2025-06-19 07:14:13,588 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:13,588 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:13,597 INFO Using KL-based Causal Consistency Loss with weight: 0.5935215384498317
2025-06-19 07:14:13,597 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:13,597 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:15,865 INFO Graph assembled successfully.
2025-06-19 07:14:19,326 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:19,328 INFO Start graph assembling...
2025-06-19 07:14:21,193 INFO use_dual_path_srl: True
2025-06-19 07:14:21,193 INFO variant_type: hedge
2025-06-19 07:14:21,193 INFO use_enhanced_srl: True
2025-06-19 07:14:21,193 INFO Enhanced SRL enabled from config
2025-06-19 07:14:21,193 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:21,193 INFO SRL condition: True = True and True
2025-06-19 07:14:21,193 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:21,193 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:21,236 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:21,240 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:21,258 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:21,479 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:21,479 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:21,479 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:21,676 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:21,719 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:21,719 INFO Ca-TSU enabled: True
2025-06-19 07:14:21,719 INFO Enhanced SRL enabled: True
2025-06-19 07:14:21,719 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:21,733 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:21,733 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:21,736 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:21,747 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5988406990498614
2025-06-19 07:14:21,748 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:21,748 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:21,859 INFO Using KL-based Causal Consistency Loss with weight: 1.1335327735001892
2025-06-19 07:14:21,859 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:21,860 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:24,099 INFO Graph assembled successfully.
2025-06-19 07:14:25,485 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:25,486 INFO Start graph assembling...
2025-06-19 07:14:27,370 INFO use_dual_path_srl: True
2025-06-19 07:14:27,370 INFO variant_type: hedge
2025-06-19 07:14:27,370 INFO use_enhanced_srl: True
2025-06-19 07:14:27,370 INFO Enhanced SRL enabled from config
2025-06-19 07:14:27,370 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:27,370 INFO SRL condition: True = True and True
2025-06-19 07:14:27,370 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:27,370 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:27,413 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:27,418 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:27,435 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:27,655 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:27,655 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:27,655 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:27,853 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:27,896 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:27,896 INFO Ca-TSU enabled: True
2025-06-19 07:14:27,896 INFO Enhanced SRL enabled: True
2025-06-19 07:14:27,896 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:27,910 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:27,910 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:27,913 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:27,924 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06357102612260526
2025-06-19 07:14:27,924 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:27,925 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:27,934 INFO Using KL-based Causal Consistency Loss with weight: 0.35006042225214345
2025-06-19 07:14:27,934 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:27,934 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:30,301 INFO Graph assembled successfully.
2025-06-19 07:14:31,725 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:31,727 INFO Start graph assembling...
2025-06-19 07:14:33,585 INFO use_dual_path_srl: True
2025-06-19 07:14:33,585 INFO variant_type: hedge
2025-06-19 07:14:33,585 INFO use_enhanced_srl: True
2025-06-19 07:14:33,585 INFO Enhanced SRL enabled from config
2025-06-19 07:14:33,585 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:33,585 INFO SRL condition: True = True and True
2025-06-19 07:14:33,585 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:33,585 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:33,628 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:33,632 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:33,650 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:33,868 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:33,868 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:33,868 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:34,064 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:34,107 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:34,107 INFO Ca-TSU enabled: True
2025-06-19 07:14:34,107 INFO Enhanced SRL enabled: True
2025-06-19 07:14:34,107 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:34,121 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:34,121 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:34,124 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:34,134 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8396486940690067
2025-06-19 07:14:34,135 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:34,135 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:34,144 INFO Using KL-based Causal Consistency Loss with weight: 0.1270957130200213
2025-06-19 07:14:34,144 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:34,144 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:36,487 INFO Graph assembled successfully.
2025-06-19 07:14:38,222 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:38,225 INFO Start graph assembling...
2025-06-19 07:14:40,109 INFO use_dual_path_srl: True
2025-06-19 07:14:40,110 INFO variant_type: hedge
2025-06-19 07:14:40,110 INFO use_enhanced_srl: True
2025-06-19 07:14:40,110 INFO Enhanced SRL enabled from config
2025-06-19 07:14:40,110 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:40,110 INFO SRL condition: True = True and True
2025-06-19 07:14:40,110 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:40,110 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:40,153 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:40,158 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:40,175 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:40,394 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:40,394 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:40,394 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:40,592 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:40,635 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:40,635 INFO Ca-TSU enabled: True
2025-06-19 07:14:40,635 INFO Enhanced SRL enabled: True
2025-06-19 07:14:40,635 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:40,649 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:40,649 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:40,652 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:40,663 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3077900058556739
2025-06-19 07:14:40,664 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:40,664 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:40,673 INFO Using KL-based Causal Consistency Loss with weight: 0.6866693929805603
2025-06-19 07:14:40,674 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:40,674 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:43,075 INFO Graph assembled successfully.
2025-06-19 07:14:45,193 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:45,196 INFO Start graph assembling...
2025-06-19 07:14:47,079 INFO use_dual_path_srl: True
2025-06-19 07:14:47,079 INFO variant_type: hedge
2025-06-19 07:14:47,079 INFO use_enhanced_srl: True
2025-06-19 07:14:47,079 INFO Enhanced SRL enabled from config
2025-06-19 07:14:47,079 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:47,079 INFO SRL condition: True = True and True
2025-06-19 07:14:47,079 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:47,079 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:47,122 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:47,127 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:47,145 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:47,366 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:47,367 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:47,367 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:47,565 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:47,609 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:47,609 INFO Ca-TSU enabled: True
2025-06-19 07:14:47,609 INFO Enhanced SRL enabled: True
2025-06-19 07:14:47,610 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:47,625 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:47,625 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:47,628 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:47,639 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8434167528695946
2025-06-19 07:14:47,640 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:47,640 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:47,650 INFO Using KL-based Causal Consistency Loss with weight: 0.35049222019328813
2025-06-19 07:14:47,650 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:47,650 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:50,018 INFO Graph assembled successfully.
2025-06-19 07:14:51,567 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:51,569 INFO Start graph assembling...
2025-06-19 07:14:53,440 INFO use_dual_path_srl: True
2025-06-19 07:14:53,440 INFO variant_type: hedge
2025-06-19 07:14:53,440 INFO use_enhanced_srl: True
2025-06-19 07:14:53,440 INFO Enhanced SRL enabled from config
2025-06-19 07:14:53,440 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:14:53,440 INFO SRL condition: True = True and True
2025-06-19 07:14:53,440 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:14:53,440 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:14:53,483 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:14:53,488 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:14:53,506 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:14:53,724 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:14:53,724 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:14:53,724 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:14:53,920 INFO Using Temporal Attention (TAP)
2025-06-19 07:14:53,963 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:14:53,963 INFO Ca-TSU enabled: True
2025-06-19 07:14:53,963 INFO Enhanced SRL enabled: True
2025-06-19 07:14:53,963 INFO Noise-Aware Loss enabled: True
2025-06-19 07:14:53,976 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:53,976 INFO Adding auxiliary enhancement losses...
2025-06-19 07:14:53,979 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:14:53,990 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2820697022370666
2025-06-19 07:14:53,991 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:14:53,991 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:14:54,000 INFO Using KL-based Causal Consistency Loss with weight: 1.0850409787030126
2025-06-19 07:14:54,001 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:14:54,001 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:14:56,351 INFO Graph assembled successfully.
2025-06-19 07:14:58,216 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:14:58,218 INFO Start graph assembling...
2025-06-19 07:15:00,112 INFO use_dual_path_srl: True
2025-06-19 07:15:00,112 INFO variant_type: hedge
2025-06-19 07:15:00,112 INFO use_enhanced_srl: True
2025-06-19 07:15:00,112 INFO Enhanced SRL enabled from config
2025-06-19 07:15:00,112 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:00,112 INFO SRL condition: True = True and True
2025-06-19 07:15:00,113 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:00,113 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:00,157 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:00,162 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:00,180 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:00,402 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:00,402 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:00,402 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:00,600 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:00,644 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:00,644 INFO Ca-TSU enabled: True
2025-06-19 07:15:00,644 INFO Enhanced SRL enabled: True
2025-06-19 07:15:00,644 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:00,658 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:00,658 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:00,661 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:00,672 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3414232485082297
2025-06-19 07:15:00,673 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:00,673 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:00,683 INFO Using KL-based Causal Consistency Loss with weight: 0.2610751077788682
2025-06-19 07:15:00,683 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:00,683 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:03,033 INFO Graph assembled successfully.
2025-06-19 07:15:04,579 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:04,580 INFO Start graph assembling...
2025-06-19 07:15:06,632 INFO use_dual_path_srl: True
2025-06-19 07:15:06,632 INFO variant_type: hedge
2025-06-19 07:15:06,632 INFO use_enhanced_srl: True
2025-06-19 07:15:06,632 INFO Enhanced SRL enabled from config
2025-06-19 07:15:06,632 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:06,632 INFO SRL condition: True = True and True
2025-06-19 07:15:06,632 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:06,632 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:06,676 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:06,680 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:06,698 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:06,919 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:06,919 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:06,920 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:07,117 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:07,160 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:07,160 INFO Ca-TSU enabled: True
2025-06-19 07:15:07,160 INFO Enhanced SRL enabled: True
2025-06-19 07:15:07,160 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:07,174 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:07,174 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:07,177 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:07,188 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5912252270490762
2025-06-19 07:15:07,188 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:07,188 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:07,198 INFO Using KL-based Causal Consistency Loss with weight: 1.9944388156621928
2025-06-19 07:15:07,198 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:07,198 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:09,547 INFO Graph assembled successfully.
2025-06-19 07:15:11,517 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:11,519 INFO Start graph assembling...
2025-06-19 07:15:13,450 INFO use_dual_path_srl: True
2025-06-19 07:15:13,451 INFO variant_type: hedge
2025-06-19 07:15:13,451 INFO use_enhanced_srl: True
2025-06-19 07:15:13,451 INFO Enhanced SRL enabled from config
2025-06-19 07:15:13,451 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:13,451 INFO SRL condition: True = True and True
2025-06-19 07:15:13,451 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:13,451 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:13,494 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:13,499 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:13,516 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:13,832 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:13,832 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:13,832 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:14,027 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:14,069 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:14,070 INFO Ca-TSU enabled: True
2025-06-19 07:15:14,070 INFO Enhanced SRL enabled: True
2025-06-19 07:15:14,070 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:14,083 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:14,083 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:14,086 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:14,097 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2163028693067244
2025-06-19 07:15:14,098 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:14,098 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:14,107 INFO Using KL-based Causal Consistency Loss with weight: 0.38116846782768
2025-06-19 07:15:14,107 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:14,107 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:16,466 INFO Graph assembled successfully.
2025-06-19 07:15:17,963 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:17,965 INFO Start graph assembling...
2025-06-19 07:15:19,954 INFO use_dual_path_srl: True
2025-06-19 07:15:19,954 INFO variant_type: hedge
2025-06-19 07:15:19,954 INFO use_enhanced_srl: True
2025-06-19 07:15:19,954 INFO Enhanced SRL enabled from config
2025-06-19 07:15:19,954 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:19,954 INFO SRL condition: True = True and True
2025-06-19 07:15:19,954 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:19,954 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:19,997 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:20,001 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:20,020 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:20,241 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:20,241 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:20,241 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:20,542 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:20,584 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:20,584 INFO Ca-TSU enabled: True
2025-06-19 07:15:20,584 INFO Enhanced SRL enabled: True
2025-06-19 07:15:20,584 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:20,597 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:20,597 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:20,601 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:20,611 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8320517574756546
2025-06-19 07:15:20,612 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:20,612 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:20,621 INFO Using KL-based Causal Consistency Loss with weight: 0.47735084735742284
2025-06-19 07:15:20,621 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:20,621 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:22,885 INFO Graph assembled successfully.
2025-06-19 07:15:25,964 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:25,966 INFO Start graph assembling...
2025-06-19 07:15:27,870 INFO use_dual_path_srl: True
2025-06-19 07:15:27,870 INFO variant_type: hedge
2025-06-19 07:15:27,870 INFO use_enhanced_srl: True
2025-06-19 07:15:27,870 INFO Enhanced SRL enabled from config
2025-06-19 07:15:27,870 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:27,870 INFO SRL condition: True = True and True
2025-06-19 07:15:27,870 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:27,870 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:27,913 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:27,917 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:27,935 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:28,154 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:28,155 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:28,155 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:28,448 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:28,490 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:28,491 INFO Ca-TSU enabled: True
2025-06-19 07:15:28,491 INFO Enhanced SRL enabled: True
2025-06-19 07:15:28,491 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:28,504 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:28,504 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:28,507 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:28,518 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09093462896827849
2025-06-19 07:15:28,519 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:28,519 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:28,529 INFO Using KL-based Causal Consistency Loss with weight: 0.3785232264745189
2025-06-19 07:15:28,529 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:28,529 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:30,910 INFO Graph assembled successfully.
2025-06-19 07:15:33,149 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:33,152 INFO Start graph assembling...
2025-06-19 07:15:35,030 INFO use_dual_path_srl: True
2025-06-19 07:15:35,030 INFO variant_type: hedge
2025-06-19 07:15:35,030 INFO use_enhanced_srl: True
2025-06-19 07:15:35,030 INFO Enhanced SRL enabled from config
2025-06-19 07:15:35,030 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:35,030 INFO SRL condition: True = True and True
2025-06-19 07:15:35,030 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:35,030 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:35,074 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:35,078 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:35,096 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:35,409 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:35,409 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:35,409 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:35,605 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:35,647 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:35,647 INFO Ca-TSU enabled: True
2025-06-19 07:15:35,648 INFO Enhanced SRL enabled: True
2025-06-19 07:15:35,648 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:35,661 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:35,661 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:35,664 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:35,675 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1132216644305087
2025-06-19 07:15:35,676 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:35,676 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:35,685 INFO Using KL-based Causal Consistency Loss with weight: 0.8664331309918565
2025-06-19 07:15:35,685 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:35,685 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:38,070 INFO Graph assembled successfully.
2025-06-19 07:15:41,015 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:41,017 INFO Start graph assembling...
2025-06-19 07:15:42,991 INFO use_dual_path_srl: True
2025-06-19 07:15:42,991 INFO variant_type: hedge
2025-06-19 07:15:42,991 INFO use_enhanced_srl: True
2025-06-19 07:15:42,991 INFO Enhanced SRL enabled from config
2025-06-19 07:15:42,991 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:42,991 INFO SRL condition: True = True and True
2025-06-19 07:15:42,991 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:42,991 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:43,034 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:43,039 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:43,056 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:43,273 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:43,273 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:43,273 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:43,470 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:43,512 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:43,513 INFO Ca-TSU enabled: True
2025-06-19 07:15:43,513 INFO Enhanced SRL enabled: True
2025-06-19 07:15:43,513 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:43,526 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:43,526 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:43,529 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:43,540 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.9589382560819844
2025-06-19 07:15:43,541 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:43,541 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:43,550 INFO Using KL-based Causal Consistency Loss with weight: 0.2480602952879999
2025-06-19 07:15:43,550 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:43,550 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:45,910 INFO Graph assembled successfully.
2025-06-19 07:15:47,681 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:47,684 INFO Start graph assembling...
2025-06-19 07:15:49,655 INFO use_dual_path_srl: True
2025-06-19 07:15:49,655 INFO variant_type: hedge
2025-06-19 07:15:49,656 INFO use_enhanced_srl: True
2025-06-19 07:15:49,656 INFO Enhanced SRL enabled from config
2025-06-19 07:15:49,656 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:49,656 INFO SRL condition: True = True and True
2025-06-19 07:15:49,656 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:49,656 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:49,698 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:49,703 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:49,812 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:50,031 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:50,031 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:50,031 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:50,226 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:50,269 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:50,269 INFO Ca-TSU enabled: True
2025-06-19 07:15:50,269 INFO Enhanced SRL enabled: True
2025-06-19 07:15:50,269 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:50,283 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:50,283 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:50,286 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:50,297 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8458209181589221
2025-06-19 07:15:50,298 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:50,298 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:50,307 INFO Using KL-based Causal Consistency Loss with weight: 1.0854221386315386
2025-06-19 07:15:50,307 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:50,307 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:52,661 INFO Graph assembled successfully.
2025-06-19 07:15:54,154 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:15:54,155 INFO Start graph assembling...
2025-06-19 07:15:56,144 INFO use_dual_path_srl: True
2025-06-19 07:15:56,246 INFO variant_type: hedge
2025-06-19 07:15:56,247 INFO use_enhanced_srl: True
2025-06-19 07:15:56,247 INFO Enhanced SRL enabled from config
2025-06-19 07:15:56,247 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:15:56,247 INFO SRL condition: True = True and True
2025-06-19 07:15:56,247 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:15:56,247 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:15:56,302 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:15:56,306 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:15:56,325 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:15:56,546 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:15:56,546 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:15:56,546 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:15:56,843 INFO Using Temporal Attention (TAP)
2025-06-19 07:15:56,886 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:15:56,886 INFO Ca-TSU enabled: True
2025-06-19 07:15:56,886 INFO Enhanced SRL enabled: True
2025-06-19 07:15:56,886 INFO Noise-Aware Loss enabled: True
2025-06-19 07:15:56,899 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:56,899 INFO Adding auxiliary enhancement losses...
2025-06-19 07:15:56,902 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:15:56,913 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2271849206364406
2025-06-19 07:15:56,914 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:15:56,914 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:15:56,923 INFO Using KL-based Causal Consistency Loss with weight: 0.11458053213110247
2025-06-19 07:15:56,923 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:15:56,923 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:15:59,310 INFO Graph assembled successfully.
2025-06-19 07:16:00,825 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:00,826 INFO Start graph assembling...
2025-06-19 07:16:02,716 INFO use_dual_path_srl: True
2025-06-19 07:16:02,716 INFO variant_type: hedge
2025-06-19 07:16:02,716 INFO use_enhanced_srl: True
2025-06-19 07:16:02,716 INFO Enhanced SRL enabled from config
2025-06-19 07:16:02,716 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:02,716 INFO SRL condition: True = True and True
2025-06-19 07:16:02,716 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:02,716 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:02,759 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:02,764 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:02,781 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:03,095 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:03,095 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:03,095 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:03,292 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:03,335 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:03,335 INFO Ca-TSU enabled: True
2025-06-19 07:16:03,335 INFO Enhanced SRL enabled: True
2025-06-19 07:16:03,335 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:03,349 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:03,349 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:03,352 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:03,363 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5244662659191535
2025-06-19 07:16:03,364 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:03,364 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:03,373 INFO Using KL-based Causal Consistency Loss with weight: 0.5576495413769046
2025-06-19 07:16:03,373 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:03,373 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:05,730 INFO Graph assembled successfully.
2025-06-19 07:16:07,287 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:07,289 INFO Start graph assembling...
2025-06-19 07:16:09,252 INFO use_dual_path_srl: True
2025-06-19 07:16:09,252 INFO variant_type: hedge
2025-06-19 07:16:09,252 INFO use_enhanced_srl: True
2025-06-19 07:16:09,252 INFO Enhanced SRL enabled from config
2025-06-19 07:16:09,252 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:09,252 INFO SRL condition: True = True and True
2025-06-19 07:16:09,252 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:09,252 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:09,295 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:09,299 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:09,317 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:09,537 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:09,537 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:09,537 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:09,735 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:09,881 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:09,881 INFO Ca-TSU enabled: True
2025-06-19 07:16:09,881 INFO Enhanced SRL enabled: True
2025-06-19 07:16:09,881 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:09,895 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:09,895 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:09,898 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:09,908 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.24526799591393542
2025-06-19 07:16:09,909 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:09,909 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:09,918 INFO Using KL-based Causal Consistency Loss with weight: 0.13777350807654234
2025-06-19 07:16:09,918 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:09,918 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:12,171 INFO Graph assembled successfully.
2025-06-19 07:16:14,072 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:14,073 INFO Start graph assembling...
2025-06-19 07:16:15,967 INFO use_dual_path_srl: True
2025-06-19 07:16:17,071 INFO variant_type: hedge
2025-06-19 07:16:17,071 INFO use_enhanced_srl: True
2025-06-19 07:16:17,072 INFO Enhanced SRL enabled from config
2025-06-19 07:16:17,072 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:17,072 INFO SRL condition: True = True and True
2025-06-19 07:16:17,072 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:17,072 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:17,128 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:17,133 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:17,151 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:17,372 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:17,372 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:17,372 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:17,666 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:17,709 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:17,709 INFO Ca-TSU enabled: True
2025-06-19 07:16:17,709 INFO Enhanced SRL enabled: True
2025-06-19 07:16:17,709 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:17,723 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:17,723 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:17,726 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:17,737 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.20259154384536057
2025-06-19 07:16:17,737 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:17,737 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:17,747 INFO Using KL-based Causal Consistency Loss with weight: 0.4863602172749382
2025-06-19 07:16:17,747 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:17,747 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:19,984 INFO Graph assembled successfully.
2025-06-19 07:16:21,957 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:21,958 INFO Start graph assembling...
2025-06-19 07:16:23,851 INFO use_dual_path_srl: True
2025-06-19 07:16:23,851 INFO variant_type: hedge
2025-06-19 07:16:23,851 INFO use_enhanced_srl: True
2025-06-19 07:16:23,851 INFO Enhanced SRL enabled from config
2025-06-19 07:16:23,851 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:23,851 INFO SRL condition: True = True and True
2025-06-19 07:16:23,851 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:23,851 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:23,895 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:23,899 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:23,917 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:24,139 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:24,139 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:24,139 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:24,436 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:24,479 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:24,479 INFO Ca-TSU enabled: True
2025-06-19 07:16:24,479 INFO Enhanced SRL enabled: True
2025-06-19 07:16:24,479 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:24,493 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:24,493 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:24,496 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:24,506 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.33081368330398636
2025-06-19 07:16:24,507 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:24,507 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:24,516 INFO Using KL-based Causal Consistency Loss with weight: 0.12952217517756992
2025-06-19 07:16:24,516 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:24,516 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:26,906 INFO Graph assembled successfully.
2025-06-19 07:16:28,452 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:28,454 INFO Start graph assembling...
2025-06-19 07:16:30,360 INFO use_dual_path_srl: True
2025-06-19 07:16:31,690 INFO variant_type: hedge
2025-06-19 07:16:31,691 INFO use_enhanced_srl: True
2025-06-19 07:16:31,691 INFO Enhanced SRL enabled from config
2025-06-19 07:16:31,691 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:31,691 INFO SRL condition: True = True and True
2025-06-19 07:16:31,691 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:31,691 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:31,746 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:31,750 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:31,770 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:32,083 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:32,083 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:32,083 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:32,281 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:32,323 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:32,323 INFO Ca-TSU enabled: True
2025-06-19 07:16:32,323 INFO Enhanced SRL enabled: True
2025-06-19 07:16:32,323 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:32,337 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:32,337 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:32,341 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:32,351 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.23907452138760926
2025-06-19 07:16:32,352 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:32,352 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:32,361 INFO Using KL-based Causal Consistency Loss with weight: 0.19105634626827916
2025-06-19 07:16:32,361 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:32,361 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:34,742 INFO Graph assembled successfully.
2025-06-19 07:16:36,129 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:36,131 INFO Start graph assembling...
2025-06-19 07:16:38,114 INFO use_dual_path_srl: True
2025-06-19 07:16:38,114 INFO variant_type: hedge
2025-06-19 07:16:38,114 INFO use_enhanced_srl: True
2025-06-19 07:16:38,114 INFO Enhanced SRL enabled from config
2025-06-19 07:16:38,114 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:38,114 INFO SRL condition: True = True and True
2025-06-19 07:16:38,114 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:38,114 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:38,158 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:38,162 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:38,180 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:38,399 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:38,399 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:38,399 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:38,595 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:38,638 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:38,638 INFO Ca-TSU enabled: True
2025-06-19 07:16:38,638 INFO Enhanced SRL enabled: True
2025-06-19 07:16:38,638 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:38,651 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:38,652 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:38,654 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:38,665 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.05843804315721091
2025-06-19 07:16:38,666 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:38,666 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:38,776 INFO Using KL-based Causal Consistency Loss with weight: 0.9975023812828768
2025-06-19 07:16:38,776 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:38,776 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:41,034 INFO Graph assembled successfully.
2025-06-19 07:16:42,714 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:42,715 INFO Start graph assembling...
2025-06-19 07:16:44,627 INFO use_dual_path_srl: True
2025-06-19 07:16:44,627 INFO variant_type: hedge
2025-06-19 07:16:44,627 INFO use_enhanced_srl: True
2025-06-19 07:16:44,627 INFO Enhanced SRL enabled from config
2025-06-19 07:16:44,627 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:44,627 INFO SRL condition: True = True and True
2025-06-19 07:16:44,627 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:44,627 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:44,675 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:44,679 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:44,697 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:44,923 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:44,923 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:44,923 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:45,123 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:45,166 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:45,166 INFO Ca-TSU enabled: True
2025-06-19 07:16:45,166 INFO Enhanced SRL enabled: True
2025-06-19 07:16:45,167 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:45,180 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:45,180 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:45,183 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:45,194 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1541569125285383
2025-06-19 07:16:45,195 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:45,195 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:45,204 INFO Using KL-based Causal Consistency Loss with weight: 0.386672762793792
2025-06-19 07:16:45,204 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:45,204 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:47,549 INFO Graph assembled successfully.
2025-06-19 07:16:49,386 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:49,387 INFO Start graph assembling...
2025-06-19 07:16:51,278 INFO use_dual_path_srl: True
2025-06-19 07:16:51,278 INFO variant_type: hedge
2025-06-19 07:16:51,278 INFO use_enhanced_srl: True
2025-06-19 07:16:51,278 INFO Enhanced SRL enabled from config
2025-06-19 07:16:51,278 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:51,278 INFO SRL condition: True = True and True
2025-06-19 07:16:51,278 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:51,278 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:51,323 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:51,327 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:51,346 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:51,569 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:51,569 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:51,569 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:51,768 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:51,812 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:51,813 INFO Ca-TSU enabled: True
2025-06-19 07:16:51,813 INFO Enhanced SRL enabled: True
2025-06-19 07:16:51,813 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:51,827 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:51,827 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:51,830 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:51,841 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5752713073290308
2025-06-19 07:16:51,842 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:51,842 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:51,851 INFO Using KL-based Causal Consistency Loss with weight: 0.6886250178421747
2025-06-19 07:16:51,851 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:51,851 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:16:54,220 INFO Graph assembled successfully.
2025-06-19 07:16:55,659 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:16:55,661 INFO Start graph assembling...
2025-06-19 07:16:57,580 INFO use_dual_path_srl: True
2025-06-19 07:16:57,580 INFO variant_type: hedge
2025-06-19 07:16:57,580 INFO use_enhanced_srl: True
2025-06-19 07:16:57,580 INFO Enhanced SRL enabled from config
2025-06-19 07:16:57,580 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:16:57,580 INFO SRL condition: True = True and True
2025-06-19 07:16:57,580 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:16:57,580 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:16:57,625 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:16:57,629 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:16:57,648 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:16:57,870 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:16:57,870 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:16:57,871 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:16:58,069 INFO Using Temporal Attention (TAP)
2025-06-19 07:16:58,113 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:16:58,113 INFO Ca-TSU enabled: True
2025-06-19 07:16:58,113 INFO Enhanced SRL enabled: True
2025-06-19 07:16:58,113 INFO Noise-Aware Loss enabled: True
2025-06-19 07:16:58,126 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:58,127 INFO Adding auxiliary enhancement losses...
2025-06-19 07:16:58,130 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:16:58,140 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.07326328254180607
2025-06-19 07:16:58,141 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:16:58,141 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:16:58,151 INFO Using KL-based Causal Consistency Loss with weight: 0.14187898581204325
2025-06-19 07:16:58,151 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:16:58,151 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:00,536 INFO Graph assembled successfully.
2025-06-19 07:17:02,991 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:02,992 INFO Start graph assembling...
2025-06-19 07:17:04,913 INFO use_dual_path_srl: True
2025-06-19 07:17:04,913 INFO variant_type: hedge
2025-06-19 07:17:04,913 INFO use_enhanced_srl: True
2025-06-19 07:17:04,913 INFO Enhanced SRL enabled from config
2025-06-19 07:17:04,913 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:04,913 INFO SRL condition: True = True and True
2025-06-19 07:17:04,913 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:04,913 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:04,958 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:04,962 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:04,982 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:05,210 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:05,210 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:05,210 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:05,410 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:05,452 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:05,453 INFO Ca-TSU enabled: True
2025-06-19 07:17:05,453 INFO Enhanced SRL enabled: True
2025-06-19 07:17:05,453 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:05,467 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:05,467 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:05,470 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:05,480 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08024803193511129
2025-06-19 07:17:05,481 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:05,481 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:05,491 INFO Using KL-based Causal Consistency Loss with weight: 0.14872710387671373
2025-06-19 07:17:05,491 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:05,491 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:07,851 INFO Graph assembled successfully.
2025-06-19 07:17:09,426 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:09,428 INFO Start graph assembling...
2025-06-19 07:17:11,341 INFO use_dual_path_srl: True
2025-06-19 07:17:11,341 INFO variant_type: hedge
2025-06-19 07:17:11,341 INFO use_enhanced_srl: True
2025-06-19 07:17:11,342 INFO Enhanced SRL enabled from config
2025-06-19 07:17:11,342 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:11,342 INFO SRL condition: True = True and True
2025-06-19 07:17:11,342 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:11,342 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:11,386 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:11,391 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:11,410 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:11,638 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:11,638 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:11,638 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:11,839 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:11,882 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:11,882 INFO Ca-TSU enabled: True
2025-06-19 07:17:11,883 INFO Enhanced SRL enabled: True
2025-06-19 07:17:11,883 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:11,896 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:11,896 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:11,900 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:11,911 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1791714966955664
2025-06-19 07:17:11,912 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:11,912 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:11,921 INFO Using KL-based Causal Consistency Loss with weight: 0.7792257786778689
2025-06-19 07:17:11,921 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:11,921 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:14,288 INFO Graph assembled successfully.
2025-06-19 07:17:15,831 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:15,833 INFO Start graph assembling...
2025-06-19 07:17:17,715 INFO use_dual_path_srl: True
2025-06-19 07:17:17,715 INFO variant_type: hedge
2025-06-19 07:17:17,715 INFO use_enhanced_srl: True
2025-06-19 07:17:17,715 INFO Enhanced SRL enabled from config
2025-06-19 07:17:17,715 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:17,715 INFO SRL condition: True = True and True
2025-06-19 07:17:17,716 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:17,716 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:17,760 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:17,764 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:17,783 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:18,006 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:18,006 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:18,006 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:18,203 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:18,246 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:18,246 INFO Ca-TSU enabled: True
2025-06-19 07:17:18,246 INFO Enhanced SRL enabled: True
2025-06-19 07:17:18,246 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:18,260 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:18,260 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:18,263 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:18,274 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.05363642405937095
2025-06-19 07:17:18,274 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:18,274 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:18,284 INFO Using KL-based Causal Consistency Loss with weight: 0.4994200033095263
2025-06-19 07:17:18,284 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:18,284 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:20,630 INFO Graph assembled successfully.
2025-06-19 07:17:22,955 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:22,957 INFO Start graph assembling...
2025-06-19 07:17:24,847 INFO use_dual_path_srl: True
2025-06-19 07:17:24,847 INFO variant_type: hedge
2025-06-19 07:17:24,847 INFO use_enhanced_srl: True
2025-06-19 07:17:24,847 INFO Enhanced SRL enabled from config
2025-06-19 07:17:24,847 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:24,848 INFO SRL condition: True = True and True
2025-06-19 07:17:24,848 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:24,848 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:24,892 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:24,896 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:24,914 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:25,138 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:25,138 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:25,138 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:25,337 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:25,380 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:25,380 INFO Ca-TSU enabled: True
2025-06-19 07:17:25,380 INFO Enhanced SRL enabled: True
2025-06-19 07:17:25,381 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:25,394 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:25,394 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:25,397 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:25,408 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08484936959271665
2025-06-19 07:17:25,409 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:25,409 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:25,418 INFO Using KL-based Causal Consistency Loss with weight: 0.10855846675575834
2025-06-19 07:17:25,419 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:25,419 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:27,799 INFO Graph assembled successfully.
2025-06-19 07:17:29,142 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:29,143 INFO Start graph assembling...
2025-06-19 07:17:31,146 INFO use_dual_path_srl: True
2025-06-19 07:17:31,146 INFO variant_type: hedge
2025-06-19 07:17:31,146 INFO use_enhanced_srl: True
2025-06-19 07:17:31,146 INFO Enhanced SRL enabled from config
2025-06-19 07:17:31,146 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:31,146 INFO SRL condition: True = True and True
2025-06-19 07:17:31,146 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:31,147 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:31,190 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:31,194 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:31,212 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:31,525 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:31,525 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:31,525 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:31,721 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:32,301 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:32,301 INFO Ca-TSU enabled: True
2025-06-19 07:17:32,301 INFO Enhanced SRL enabled: True
2025-06-19 07:17:32,301 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:32,316 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:32,316 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:32,319 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:32,330 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.106590264360806
2025-06-19 07:17:32,331 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:32,331 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:32,340 INFO Using KL-based Causal Consistency Loss with weight: 0.8447371344668824
2025-06-19 07:17:32,340 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:32,340 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:34,695 INFO Graph assembled successfully.
2025-06-19 07:17:36,776 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:36,778 INFO Start graph assembling...
2025-06-19 07:17:38,775 INFO use_dual_path_srl: True
2025-06-19 07:17:38,775 INFO variant_type: hedge
2025-06-19 07:17:38,775 INFO use_enhanced_srl: True
2025-06-19 07:17:38,775 INFO Enhanced SRL enabled from config
2025-06-19 07:17:38,775 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:38,775 INFO SRL condition: True = True and True
2025-06-19 07:17:38,776 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:38,776 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:38,819 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:38,823 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:38,841 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:39,060 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:39,060 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:39,060 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:39,355 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:39,398 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:39,398 INFO Ca-TSU enabled: True
2025-06-19 07:17:39,398 INFO Enhanced SRL enabled: True
2025-06-19 07:17:39,398 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:39,412 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:39,412 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:39,415 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:39,425 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1611232847580816
2025-06-19 07:17:39,426 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:39,426 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:39,436 INFO Using KL-based Causal Consistency Loss with weight: 1.5235743808125384
2025-06-19 07:17:39,436 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:39,436 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:41,852 INFO Graph assembled successfully.
2025-06-19 07:17:44,142 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:44,144 INFO Start graph assembling...
2025-06-19 07:17:46,061 INFO use_dual_path_srl: True
2025-06-19 07:17:46,061 INFO variant_type: hedge
2025-06-19 07:17:46,061 INFO use_enhanced_srl: True
2025-06-19 07:17:46,061 INFO Enhanced SRL enabled from config
2025-06-19 07:17:46,061 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:46,061 INFO SRL condition: True = True and True
2025-06-19 07:17:46,061 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:46,061 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:46,105 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:46,109 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:46,127 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:46,346 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:46,346 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:46,346 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:46,633 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:46,676 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:46,676 INFO Ca-TSU enabled: True
2025-06-19 07:17:46,676 INFO Enhanced SRL enabled: True
2025-06-19 07:17:46,676 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:46,690 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:46,690 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:46,693 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:46,704 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3737391922289575
2025-06-19 07:17:46,704 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:46,704 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:46,714 INFO Using KL-based Causal Consistency Loss with weight: 0.20072924148511612
2025-06-19 07:17:46,714 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:46,714 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:49,052 INFO Graph assembled successfully.
2025-06-19 07:17:52,210 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:52,211 INFO Start graph assembling...
2025-06-19 07:17:54,099 INFO use_dual_path_srl: True
2025-06-19 07:17:54,126 INFO variant_type: hedge
2025-06-19 07:17:54,126 INFO use_enhanced_srl: True
2025-06-19 07:17:54,126 INFO Enhanced SRL enabled from config
2025-06-19 07:17:54,126 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:17:54,126 INFO SRL condition: True = True and True
2025-06-19 07:17:54,126 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:17:54,127 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:17:54,178 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:17:54,183 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:17:54,201 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:17:54,516 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:17:54,516 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:17:54,516 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:17:54,712 INFO Using Temporal Attention (TAP)
2025-06-19 07:17:54,755 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:17:54,755 INFO Ca-TSU enabled: True
2025-06-19 07:17:54,755 INFO Enhanced SRL enabled: True
2025-06-19 07:17:54,755 INFO Noise-Aware Loss enabled: True
2025-06-19 07:17:54,769 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:54,769 INFO Adding auxiliary enhancement losses...
2025-06-19 07:17:54,772 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:17:54,783 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.31694627653425256
2025-06-19 07:17:54,784 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:17:54,784 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:17:54,793 INFO Using KL-based Causal Consistency Loss with weight: 0.800586742030205
2025-06-19 07:17:54,793 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:17:54,793 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:17:57,171 INFO Graph assembled successfully.
2025-06-19 07:17:59,162 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:17:59,163 INFO Start graph assembling...
2025-06-19 07:18:01,191 INFO use_dual_path_srl: True
2025-06-19 07:18:01,192 INFO variant_type: hedge
2025-06-19 07:18:01,192 INFO use_enhanced_srl: True
2025-06-19 07:18:01,192 INFO Enhanced SRL enabled from config
2025-06-19 07:18:01,192 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:18:01,192 INFO SRL condition: True = True and True
2025-06-19 07:18:01,192 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:18:01,192 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:18:01,236 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:18:01,240 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:18:01,258 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:18:01,479 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:18:01,479 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:18:01,479 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:18:01,675 INFO Using Temporal Attention (TAP)
2025-06-19 07:18:01,824 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:18:01,824 INFO Ca-TSU enabled: True
2025-06-19 07:18:01,824 INFO Enhanced SRL enabled: True
2025-06-19 07:18:01,824 INFO Noise-Aware Loss enabled: True
2025-06-19 07:18:01,838 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:01,838 INFO Adding auxiliary enhancement losses...
2025-06-19 07:18:01,841 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:18:01,852 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.060285566716731326
2025-06-19 07:18:01,853 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:18:01,853 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:18:01,862 INFO Using KL-based Causal Consistency Loss with weight: 0.7495255569659048
2025-06-19 07:18:01,862 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:01,862 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:18:04,107 INFO Graph assembled successfully.
2025-06-19 07:18:05,572 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:18:05,574 INFO Start graph assembling...
2025-06-19 07:18:07,471 INFO use_dual_path_srl: True
2025-06-19 07:18:07,471 INFO variant_type: hedge
2025-06-19 07:18:07,471 INFO use_enhanced_srl: True
2025-06-19 07:18:07,471 INFO Enhanced SRL enabled from config
2025-06-19 07:18:07,471 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:18:07,471 INFO SRL condition: True = True and True
2025-06-19 07:18:07,471 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:18:07,471 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:18:07,517 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:18:07,521 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:18:07,539 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:18:07,764 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:18:07,765 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:18:07,765 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:18:07,961 INFO Using Temporal Attention (TAP)
2025-06-19 07:18:09,339 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:18:09,339 INFO Ca-TSU enabled: True
2025-06-19 07:18:09,339 INFO Enhanced SRL enabled: True
2025-06-19 07:18:09,339 INFO Noise-Aware Loss enabled: True
2025-06-19 07:18:09,453 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:09,453 INFO Adding auxiliary enhancement losses...
2025-06-19 07:18:09,456 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:18:09,467 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8084147882868992
2025-06-19 07:18:09,468 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:18:09,468 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:18:09,477 INFO Using KL-based Causal Consistency Loss with weight: 0.16887799519684552
2025-06-19 07:18:09,477 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:09,477 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:18:11,749 INFO Graph assembled successfully.
2025-06-19 07:18:15,400 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:18:15,402 INFO Start graph assembling...
2025-06-19 07:18:17,270 INFO use_dual_path_srl: True
2025-06-19 07:18:17,270 INFO variant_type: hedge
2025-06-19 07:18:17,270 INFO use_enhanced_srl: True
2025-06-19 07:18:17,270 INFO Enhanced SRL enabled from config
2025-06-19 07:18:17,270 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:18:17,270 INFO SRL condition: True = True and True
2025-06-19 07:18:17,270 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:18:17,270 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:18:17,314 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:18:17,318 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:18:17,337 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:18:17,559 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:18:17,559 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:18:17,559 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:18:17,757 INFO Using Temporal Attention (TAP)
2025-06-19 07:18:17,799 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:18:17,799 INFO Ca-TSU enabled: True
2025-06-19 07:18:17,799 INFO Enhanced SRL enabled: True
2025-06-19 07:18:17,799 INFO Noise-Aware Loss enabled: True
2025-06-19 07:18:17,906 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:17,906 INFO Adding auxiliary enhancement losses...
2025-06-19 07:18:17,909 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:18:17,919 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.25784437168391583
2025-06-19 07:18:17,920 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:18:17,920 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:18:17,930 INFO Using KL-based Causal Consistency Loss with weight: 0.2769415811145025
2025-06-19 07:18:17,930 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:17,930 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:18:20,152 INFO Graph assembled successfully.
2025-06-19 07:18:24,117 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:18:24,119 INFO Start graph assembling...
2025-06-19 07:18:26,010 INFO use_dual_path_srl: True
2025-06-19 07:18:26,010 INFO variant_type: hedge
2025-06-19 07:18:26,010 INFO use_enhanced_srl: True
2025-06-19 07:18:26,010 INFO Enhanced SRL enabled from config
2025-06-19 07:18:26,010 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:18:26,010 INFO SRL condition: True = True and True
2025-06-19 07:18:26,011 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:18:26,011 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:18:26,057 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:18:26,061 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:18:26,080 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:18:26,305 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:18:26,305 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:18:26,305 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:18:26,505 INFO Using Temporal Attention (TAP)
2025-06-19 07:18:26,548 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:18:26,548 INFO Ca-TSU enabled: True
2025-06-19 07:18:26,548 INFO Enhanced SRL enabled: True
2025-06-19 07:18:26,548 INFO Noise-Aware Loss enabled: True
2025-06-19 07:18:26,563 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:26,563 INFO Adding auxiliary enhancement losses...
2025-06-19 07:18:26,661 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:18:26,672 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.16278771300091655
2025-06-19 07:18:26,673 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:18:26,673 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:18:26,682 INFO Using KL-based Causal Consistency Loss with weight: 0.20842406341633712
2025-06-19 07:18:26,682 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:26,682 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:18:28,915 INFO Graph assembled successfully.
2025-06-19 07:18:33,826 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:18:33,828 INFO Start graph assembling...
2025-06-19 07:18:35,710 INFO use_dual_path_srl: True
2025-06-19 07:18:35,710 INFO variant_type: hedge
2025-06-19 07:18:35,710 INFO use_enhanced_srl: True
2025-06-19 07:18:35,710 INFO Enhanced SRL enabled from config
2025-06-19 07:18:35,710 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:18:35,710 INFO SRL condition: True = True and True
2025-06-19 07:18:35,711 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:18:35,711 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:18:35,755 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:18:35,759 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:18:35,778 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:18:36,000 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:18:36,000 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:18:36,000 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:18:36,197 INFO Using Temporal Attention (TAP)
2025-06-19 07:18:36,240 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:18:36,240 INFO Ca-TSU enabled: True
2025-06-19 07:18:36,240 INFO Enhanced SRL enabled: True
2025-06-19 07:18:36,240 INFO Noise-Aware Loss enabled: True
2025-06-19 07:18:36,254 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:36,254 INFO Adding auxiliary enhancement losses...
2025-06-19 07:18:36,258 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:18:36,363 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.9869473319289335
2025-06-19 07:18:36,364 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:18:36,364 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:18:36,374 INFO Using KL-based Causal Consistency Loss with weight: 0.17133010226003012
2025-06-19 07:18:36,374 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:18:36,374 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:18:38,602 INFO Graph assembled successfully.
2025-06-19 07:18:45,193 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:20:27,935 INFO Start graph assembling...
2025-06-19 07:20:30,729 INFO use_dual_path_srl: True
2025-06-19 07:20:30,729 INFO variant_type: hedge
2025-06-19 07:20:30,729 INFO use_enhanced_srl: True
2025-06-19 07:20:30,729 INFO Enhanced SRL enabled from config
2025-06-19 07:20:30,729 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:20:30,730 INFO SRL condition: True = True and True
2025-06-19 07:20:30,730 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:20:30,730 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:20:30,774 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:20:30,779 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:20:30,797 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:20:31,020 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:20:31,020 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:20:31,020 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:20:31,220 INFO Using Temporal Attention (TAP)
2025-06-19 07:20:31,264 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:20:31,264 INFO Ca-TSU enabled: True
2025-06-19 07:20:31,264 INFO Enhanced SRL enabled: True
2025-06-19 07:20:31,264 INFO Noise-Aware Loss enabled: True
2025-06-19 07:20:31,278 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:20:31,278 INFO Adding auxiliary enhancement losses...
2025-06-19 07:20:31,281 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:20:31,292 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.18467751440243613
2025-06-19 07:20:31,293 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:20:31,293 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:20:31,412 INFO Using KL-based Causal Consistency Loss with weight: 0.20606387172365012
2025-06-19 07:20:31,412 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:20:31,412 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:20:33,667 INFO Graph assembled successfully.
2025-06-19 07:21:14,515 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:21:14,517 INFO Start graph assembling...
2025-06-19 07:21:16,440 INFO use_dual_path_srl: True
2025-06-19 07:21:16,440 INFO variant_type: hedge
2025-06-19 07:21:16,440 INFO use_enhanced_srl: True
2025-06-19 07:21:16,440 INFO Enhanced SRL enabled from config
2025-06-19 07:21:16,440 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:21:16,440 INFO SRL condition: True = True and True
2025-06-19 07:21:16,440 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:21:16,440 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:21:16,485 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:21:16,489 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:21:16,508 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:21:16,736 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:21:16,736 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:21:16,736 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:21:16,936 INFO Using Temporal Attention (TAP)
2025-06-19 07:21:16,979 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:21:16,979 INFO Ca-TSU enabled: True
2025-06-19 07:21:16,979 INFO Enhanced SRL enabled: True
2025-06-19 07:21:16,979 INFO Noise-Aware Loss enabled: True
2025-06-19 07:21:16,993 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:21:16,993 INFO Adding auxiliary enhancement losses...
2025-06-19 07:21:16,996 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:21:17,007 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6153140211411248
2025-06-19 07:21:17,008 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:21:17,008 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:21:17,119 INFO Using KL-based Causal Consistency Loss with weight: 0.5692624362326474
2025-06-19 07:21:17,119 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:21:17,119 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:21:19,380 INFO Graph assembled successfully.
2025-06-19 07:23:41,804 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 07:25:56,400 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:25:56,405 INFO Start graph assembling...
2025-06-19 07:25:59,622 INFO use_dual_path_srl: True
2025-06-19 07:25:59,622 INFO variant_type: hedge
2025-06-19 07:25:59,622 INFO use_enhanced_srl: True
2025-06-19 07:25:59,622 INFO Enhanced SRL enabled from config
2025-06-19 07:25:59,623 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:25:59,623 INFO SRL condition: True = True and True
2025-06-19 07:25:59,623 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:25:59,623 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:25:59,691 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:25:59,698 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:25:59,726 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:26:00,075 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:26:00,075 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:26:00,075 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:26:00,472 INFO Using Temporal Attention (TAP)
2025-06-19 07:26:00,540 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:26:00,540 INFO Ca-TSU enabled: True
2025-06-19 07:26:00,540 INFO Enhanced SRL enabled: True
2025-06-19 07:26:00,540 INFO Noise-Aware Loss enabled: True
2025-06-19 07:26:00,562 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:26:00,562 INFO Adding auxiliary enhancement losses...
2025-06-19 07:26:00,567 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:26:00,584 INFO Using Noise-Awa2025-06-19 07:26:04,507 INFO use_dual_path_srl: True
2025-06-19 07:26:04,507 INFO variant_type: hedge
2025-06-19 07:26:04,507 INFO use_enhanced_srl: True
2025-06-19 07:26:04,508 INFO Enhanced SRL enabled from config
2025-06-19 07:26:04,508 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:26:04,508 INFO SRL condition: True = True and True
2025-06-19 07:26:04,508 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:26:04,508 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:26:04,551 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:26:04,555 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:26:04,572 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:26:04,786 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:26:04,786 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:26:04,786 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:26:05,058 INFO Using Temporal Attention (TAP)
2025-06-19 07:26:05,101 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:26:05,101 INFO Ca-TSU enabled: True
2025-06-19 07:26:05,101 INFO Enhanced SRL enabled: True
2025-06-19 07:26:05,101 INFO Noise-Aware Loss enabled: True
2025-06-19 07:26:05,114 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:26:05,114 INFO Adding auxiliary enhancement losses...
2025-06-19 07:26:05,117 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:26:05,128 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5
2025-06-19 07:26:05,128 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:26:05,129 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:26:05,137 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-19 07:26:05,137 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:26:05,138 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:26:07,411 INFO Graph assembled successfully.
                                                                      2025-06-19 07:28:39,156 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 07:29:47,497 INFO Word table initialized.
2025-06-19 07:29:47,537 INFO Model: all-hedge-gru_f97cce39, starting new session.
2025-06-19 07:33:06,287 INFO Word table initialized.
2025-06-19 07:33:12,135 ERROR Could not restore checkpoint: Unsuccessful TensorSliceReader constructor: Failed to find any matching files for /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_683ac293/D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_683ac293\sess-10
	 [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]
	 [[Node: save/RestoreV2_85/_159 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_588_save/RestoreV2_85", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2', defined at:
  File "src/Main.py", line 80, in <module>
    main()
  File "src/Main.py", line 57, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Unsuccessful TensorSliceReader constructor: Failed to find any matching files for /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_683ac293/D:\FinalYear\KLTN\PEN\PEN-main\PEN-main\checkpoints_tx_lf_dual_path\all-hedge-gru_683ac293\sess-10
	 [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]
	 [[Node: save/RestoreV2_85/_159 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_588_save/RestoreV2_85", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-19 07:34:49,761 INFO 	iter: 20, batch loss: 1.347937822341919, batch acc: 0.531250
2025-06-19 07:35:16,475 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 07:37:33,165 INFO 	iter: 40, batch loss: 0.9899464845657349, batch acc: 0.406250
2025-06-19 07:38:23,184 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 07:40:08,814 INFO 	iter: 60, batch loss: 0.7876123189926147, batch acc: 0.562500
2025-06-19 07:41:25,262 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 07:41:25,263 INFO Generating diagnostic plots...
2025-06-19 07:41:30,787 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 07:42:44,148 INFO Completed dev evaluation: size=420.0, acc=0.5429
2025-06-19 07:42:44,155 INFO 	Eval, eval loss: 0.7060347199440002, acc: 0.542857, mcc: -0.001512
2025-06-19 07:42:44,292 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:42:44,294 INFO Start graph assembling...
2025-06-19 07:42:47,178 INFO use_dual_path_srl: True
2025-06-19 07:42:47,178 INFO variant_type: hedge
2025-06-19 07:42:47,178 INFO use_enhanced_srl: True
2025-06-19 07:42:47,179 INFO Enhanced SRL enabled from config
2025-06-19 07:42:47,179 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:42:47,179 INFO SRL condition: True = True and True
2025-06-19 07:42:47,179 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:42:47,179 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:42:47,247 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:42:47,254 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:42:47,282 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:42:47,718 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:42:47,719 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:42:47,719 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:42:48,026 INFO Using Temporal Attention (TAP)
2025-06-19 07:42:48,093 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:42:48,093 INFO Ca-TSU enabled: True
2025-06-19 07:42:48,094 INFO Enhanced SRL enabled: True
2025-06-19 07:42:48,094 INFO Noise-Aware Loss enabled: True
2025-06-19 07:42:48,115 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:42:48,116 INFO Adding auxiliary enhancement losses...
2025-06-19 07:42:48,121 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:42:48,138 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.7460814213017074
2025-06-19 07:42:48,139 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:42:48,139 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:42:48,154 INFO Using KL-based Causal Consistency Loss with weight: 1.6500408399613231
2025-06-19 07:42:48,154 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:42:48,154 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:42:51,760 INFO Graph assembled successfully.
2025-06-19 07:43:13,275 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 07:43:13,882 INFO Word table initialized.
2025-06-19 07:43:13,884 INFO Model: all-hedge-gru_b531ec09, starting new session.
2025-06-19 07:45:54,329 INFO 	iter: 20, batch loss: 1.2556873559951782, batch acc: 0.718750
2025-06-19 07:46:19,209 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 07:48:29,878 INFO 	iter: 40, batch loss: 0.9210273623466492, batch acc: 0.531250
2025-06-19 07:49:19,558 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 07:51:05,142 INFO 	iter: 60, batch loss: 0.7744889855384827, batch acc: 0.500000
2025-06-19 07:52:19,714 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 07:52:19,714 INFO Generating diagnostic plots...
2025-06-19 07:52:24,157 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 07:53:25,245 INFO Completed dev evaluation: size=420.0, acc=0.4476
2025-06-19 07:53:25,252 INFO 	Eval, eval loss: 0.7577750086784363, acc: 0.447619, mcc: -0.044496
2025-06-19 07:53:25,393 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 07:53:25,395 INFO Start graph assembling...
2025-06-19 07:53:28,296 INFO use_dual_path_srl: True
2025-06-19 07:53:28,296 INFO variant_type: hedge
2025-06-19 07:53:28,296 INFO use_enhanced_srl: True
2025-06-19 07:53:28,296 INFO Enhanced SRL enabled from config
2025-06-19 07:53:28,296 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 07:53:28,296 INFO SRL condition: True = True and True
2025-06-19 07:53:28,296 INFO Using enhanced dual-path SRL architecture
2025-06-19 07:53:28,297 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 07:53:28,364 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 07:53:28,371 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 07:53:28,399 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 07:53:28,745 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 07:53:28,745 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 07:53:28,745 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 07:53:29,136 INFO Using Temporal Attention (TAP)
2025-06-19 07:53:29,203 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 07:53:29,203 INFO Ca-TSU enabled: True
2025-06-19 07:53:29,203 INFO Enhanced SRL enabled: True
2025-06-19 07:53:29,203 INFO Noise-Aware Loss enabled: True
2025-06-19 07:53:29,225 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 07:53:29,225 INFO Adding auxiliary enhancement losses...
2025-06-19 07:53:29,230 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 07:53:29,248 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09945073675641418
2025-06-19 07:53:29,249 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 07:53:29,249 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 07:53:29,264 INFO Using KL-based Causal Consistency Loss with weight: 0.6191633188380717
2025-06-19 07:53:29,264 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 07:53:29,264 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 07:53:32,854 INFO Graph assembled successfully.
2025-06-19 07:53:54,400 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 07:53:55,028 INFO Word table initialized.
2025-06-19 07:53:55,029 INFO Model: all-hedge-gru_57492a4c, starting new session.
2025-06-19 07:56:34,025 INFO 	iter: 20, batch loss: 1.312145471572876, batch acc: 0.562500
2025-06-19 07:56:59,136 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 07:59:15,752 INFO 	iter: 40, batch loss: 0.9348841905593872, batch acc: 0.656250
2025-06-19 08:00:06,747 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:01:58,367 INFO 	iter: 60, batch loss: 0.9114134907722473, batch acc: 0.500000
2025-06-19 08:03:13,225 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:03:13,225 INFO Generating diagnostic plots...
2025-06-19 08:03:17,633 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:04:19,806 INFO Completed dev evaluation: size=420.0, acc=0.5310
2025-06-19 08:04:19,812 INFO 	Eval, eval loss: 0.745800793170929, acc: 0.530952, mcc: -0.000145
2025-06-19 08:04:19,951 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:04:19,953 INFO Start graph assembling...
2025-06-19 08:04:22,830 INFO use_dual_path_srl: True
2025-06-19 08:04:22,830 INFO variant_type: hedge
2025-06-19 08:04:22,830 INFO use_enhanced_srl: True
2025-06-19 08:04:22,830 INFO Enhanced SRL enabled from config
2025-06-19 08:04:22,831 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:04:22,831 INFO SRL condition: True = True and True
2025-06-19 08:04:22,831 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:04:22,831 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:04:22,897 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:04:22,904 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:04:22,932 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:04:23,274 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:04:23,274 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:04:23,274 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:04:23,661 INFO Using Temporal Attention (TAP)
2025-06-19 08:04:23,730 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:04:23,730 INFO Ca-TSU enabled: True
2025-06-19 08:04:23,730 INFO Enhanced SRL enabled: True
2025-06-19 08:04:23,730 INFO Noise-Aware Loss enabled: True
2025-06-19 08:04:23,752 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:04:23,752 INFO Adding auxiliary enhancement losses...
2025-06-19 08:04:23,757 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:04:23,775 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.4506024066919985
2025-06-19 08:04:23,776 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:04:23,776 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:04:23,791 INFO Using KL-based Causal Consistency Loss with weight: 0.4527243377898904
2025-06-19 08:04:23,791 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:04:23,791 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:04:27,329 INFO Graph assembled successfully.
2025-06-19 08:04:48,984 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:04:49,607 INFO Word table initialized.
2025-06-19 08:04:49,609 INFO Model: all-hedge-gru_a002b4e6, starting new session.
2025-06-19 08:07:28,651 INFO 	iter: 20, batch loss: 1.4438177347183228, batch acc: 0.531250
2025-06-19 08:07:54,275 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 08:10:12,644 INFO 	iter: 40, batch loss: 0.974494993686676, batch acc: 0.437500
2025-06-19 08:11:03,496 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:12:54,298 INFO 	iter: 60, batch loss: 0.9376214146614075, batch acc: 0.343750
2025-06-19 08:14:09,390 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:14:09,390 INFO Generating diagnostic plots...
2025-06-19 08:14:13,805 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:15:19,228 INFO Completed dev evaluation: size=420.0, acc=0.5429
2025-06-19 08:15:19,235 INFO 	Eval, eval loss: 0.7492231130599976, acc: 0.542857, mcc: 0.030869
2025-06-19 08:15:19,382 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:15:19,385 INFO Start graph assembling...
2025-06-19 08:15:22,263 INFO use_dual_path_srl: True
2025-06-19 08:15:22,263 INFO variant_type: hedge
2025-06-19 08:15:22,263 INFO use_enhanced_srl: True
2025-06-19 08:15:22,264 INFO Enhanced SRL enabled from config
2025-06-19 08:15:22,264 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:15:22,264 INFO SRL condition: True = True and True
2025-06-19 08:15:22,264 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:15:22,264 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:15:22,330 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:15:22,337 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:15:22,365 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:15:22,712 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:15:22,712 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:15:22,712 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:15:23,102 INFO Using Temporal Attention (TAP)
2025-06-19 08:15:23,168 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:15:23,168 INFO Ca-TSU enabled: True
2025-06-19 08:15:23,168 INFO Enhanced SRL enabled: True
2025-06-19 08:15:23,169 INFO Noise-Aware Loss enabled: True
2025-06-19 08:15:23,190 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:15:23,190 INFO Adding auxiliary enhancement losses...
2025-06-19 08:15:23,195 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:15:23,212 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2316644514546762
2025-06-19 08:15:23,213 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:15:23,213 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:15:23,228 INFO Using KL-based Causal Consistency Loss with weight: 0.12800600532735698
2025-06-19 08:15:23,228 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:15:23,228 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:15:26,788 INFO Graph assembled successfully.
2025-06-19 08:15:48,447 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:15:49,057 INFO Word table initialized.
2025-06-19 08:15:49,057 INFO Model: all-hedge-gru_f87b4767, starting new session.
2025-06-19 08:18:27,942 INFO 	iter: 20, batch loss: 1.279263973236084, batch acc: 0.562500
2025-06-19 08:18:53,235 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 08:21:12,565 INFO 	iter: 40, batch loss: 0.9357905983924866, batch acc: 0.562500
2025-06-19 08:22:01,611 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:23:49,016 INFO 	iter: 60, batch loss: 0.8438236117362976, batch acc: 0.531250
2025-06-19 08:25:04,560 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:25:04,560 INFO Generating diagnostic plots...
2025-06-19 08:25:09,046 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:26:13,571 INFO Completed dev evaluation: size=420.0, acc=0.5286
2025-06-19 08:26:13,578 INFO 	Eval, eval loss: 0.7520628571510315, acc: 0.528571, mcc: -0.015899
2025-06-19 08:26:13,738 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:26:13,740 INFO Start graph assembling...
2025-06-19 08:26:16,660 INFO use_dual_path_srl: True
2025-06-19 08:26:16,660 INFO variant_type: hedge
2025-06-19 08:26:16,660 INFO use_enhanced_srl: True
2025-06-19 08:26:16,660 INFO Enhanced SRL enabled from config
2025-06-19 08:26:16,660 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:26:16,660 INFO SRL condition: True = True and True
2025-06-19 08:26:16,660 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:26:16,661 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:26:16,728 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:26:16,734 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:26:16,763 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:26:17,204 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:26:17,204 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:26:17,204 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:26:17,513 INFO Using Temporal Attention (TAP)
2025-06-19 08:26:17,580 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:26:17,580 INFO Ca-TSU enabled: True
2025-06-19 08:26:17,580 INFO Enhanced SRL enabled: True
2025-06-19 08:26:17,580 INFO Noise-Aware Loss enabled: True
2025-06-19 08:26:17,602 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:26:17,602 INFO Adding auxiliary enhancement losses...
2025-06-19 08:26:17,607 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:26:17,624 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06696069975917733
2025-06-19 08:26:17,625 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:26:17,625 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:26:17,640 INFO Using KL-based Causal Consistency Loss with weight: 0.8796138490573318
2025-06-19 08:26:17,640 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:26:17,640 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:26:21,223 INFO Graph assembled successfully.
2025-06-19 08:26:42,709 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:26:43,351 INFO Word table initialized.
2025-06-19 08:26:43,352 INFO Model: all-hedge-gru_b29100c6, starting new session.
2025-06-19 08:29:26,042 INFO 	iter: 20, batch loss: 1.3831229209899902, batch acc: 0.437500
2025-06-19 08:29:51,519 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 08:32:05,373 INFO 	iter: 40, batch loss: 1.0531973838806152, batch acc: 0.468750
2025-06-19 08:32:55,323 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:34:44,305 INFO 	iter: 60, batch loss: 0.918759822845459, batch acc: 0.437500
2025-06-19 08:35:59,403 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:35:59,403 INFO Generating diagnostic plots...
2025-06-19 08:36:03,797 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:37:06,088 INFO Completed dev evaluation: size=420.0, acc=0.5524
2025-06-19 08:37:06,095 INFO 	Eval, eval loss: 0.7665561437606812, acc: 0.552381, mcc: 0.197148
2025-06-19 08:37:06,246 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:37:06,248 INFO Start graph assembling...
2025-06-19 08:37:09,134 INFO use_dual_path_srl: True
2025-06-19 08:37:09,134 INFO variant_type: hedge
2025-06-19 08:37:09,134 INFO use_enhanced_srl: True
2025-06-19 08:37:09,134 INFO Enhanced SRL enabled from config
2025-06-19 08:37:09,134 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:37:09,134 INFO SRL condition: True = True and True
2025-06-19 08:37:09,134 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:37:09,134 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:37:09,201 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:37:09,207 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:37:09,235 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:37:09,667 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:37:09,667 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:37:09,667 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:37:09,972 INFO Using Temporal Attention (TAP)
2025-06-19 08:37:10,038 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:37:10,038 INFO Ca-TSU enabled: True
2025-06-19 08:37:10,038 INFO Enhanced SRL enabled: True
2025-06-19 08:37:10,039 INFO Noise-Aware Loss enabled: True
2025-06-19 08:37:10,060 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:37:10,060 INFO Adding auxiliary enhancement losses...
2025-06-19 08:37:10,066 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:37:10,083 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.0893003645958055
2025-06-19 08:37:10,084 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:37:10,084 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:37:10,099 INFO Using KL-based Causal Consistency Loss with weight: 0.6091103314031094
2025-06-19 08:37:10,099 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:37:10,099 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:37:13,637 INFO Graph assembled successfully.
2025-06-19 08:37:35,280 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:37:35,892 INFO Word table initialized.
2025-06-19 08:37:35,892 INFO Model: all-hedge-gru_c672e70b, starting new session.
2025-06-19 08:40:16,763 INFO 	iter: 20, batch loss: 1.2835272550582886, batch acc: 0.593750
2025-06-19 08:40:42,091 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 08:42:59,098 INFO 	iter: 40, batch loss: 0.968155562877655, batch acc: 0.593750
2025-06-19 08:43:48,715 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:45:59,054 INFO 	iter: 60, batch loss: 0.8142397999763489, batch acc: 0.562500
2025-06-19 08:47:16,901 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:47:16,902 INFO Generating diagnostic plots...
2025-06-19 08:47:21,384 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:48:23,661 INFO Completed dev evaluation: size=420.0, acc=0.4357
2025-06-19 08:48:23,668 INFO 	Eval, eval loss: 0.8915125131607056, acc: 0.435714, mcc: 0.052888
2025-06-19 08:48:23,871 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:48:23,874 INFO Start graph assembling...
2025-06-19 08:48:26,767 INFO use_dual_path_srl: True
2025-06-19 08:48:26,767 INFO variant_type: hedge
2025-06-19 08:48:26,767 INFO use_enhanced_srl: True
2025-06-19 08:48:26,767 INFO Enhanced SRL enabled from config
2025-06-19 08:48:26,767 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:48:26,767 INFO SRL condition: True = True and True
2025-06-19 08:48:26,767 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:48:26,767 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:48:26,834 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:48:26,840 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:48:26,868 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:48:27,304 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:48:27,304 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:48:27,304 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:48:27,608 INFO Using Temporal Attention (TAP)
2025-06-19 08:48:27,674 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:48:27,675 INFO Ca-TSU enabled: True
2025-06-19 08:48:27,675 INFO Enhanced SRL enabled: True
2025-06-19 08:48:27,675 INFO Noise-Aware Loss enabled: True
2025-06-19 08:48:27,696 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:48:27,696 INFO Adding auxiliary enhancement losses...
2025-06-19 08:48:27,702 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:48:27,718 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6593086321646012
2025-06-19 08:48:27,720 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:48:27,720 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:48:27,735 INFO Using KL-based Causal Consistency Loss with weight: 1.1672080799898263
2025-06-19 08:48:27,735 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:48:27,735 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:48:31,270 INFO Graph assembled successfully.
2025-06-19 08:48:52,848 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:48:53,483 INFO Word table initialized.
2025-06-19 08:48:53,484 INFO Model: all-hedge-gru_caa1f048, starting new session.
2025-06-19 08:51:33,791 INFO 	iter: 20, batch loss: 1.2735861539840698, batch acc: 0.593750
2025-06-19 08:51:59,119 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 08:54:16,158 INFO 	iter: 40, batch loss: 0.9478704929351807, batch acc: 0.531250
2025-06-19 08:55:06,232 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 08:56:53,554 INFO 	iter: 60, batch loss: 0.8357633948326111, batch acc: 0.531250
2025-06-19 08:58:08,687 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 08:58:08,687 INFO Generating diagnostic plots...
2025-06-19 08:58:13,109 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 08:59:13,417 INFO Completed dev evaluation: size=420.0, acc=0.6214
2025-06-19 08:59:13,424 INFO 	Eval, eval loss: 0.7265041470527649, acc: 0.621429, mcc: 0.184178
2025-06-19 08:59:13,563 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 08:59:13,565 INFO Start graph assembling...
2025-06-19 08:59:16,438 INFO use_dual_path_srl: True
2025-06-19 08:59:16,439 INFO variant_type: hedge
2025-06-19 08:59:16,440 INFO use_enhanced_srl: True
2025-06-19 08:59:16,440 INFO Enhanced SRL enabled from config
2025-06-19 08:59:16,440 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 08:59:16,440 INFO SRL condition: True = True and True
2025-06-19 08:59:16,440 INFO Using enhanced dual-path SRL architecture
2025-06-19 08:59:16,440 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 08:59:16,507 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 08:59:16,513 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 08:59:16,541 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 08:59:16,972 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 08:59:16,972 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 08:59:16,973 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 08:59:17,278 INFO Using Temporal Attention (TAP)
2025-06-19 08:59:17,345 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 08:59:17,345 INFO Ca-TSU enabled: True
2025-06-19 08:59:17,345 INFO Enhanced SRL enabled: True
2025-06-19 08:59:17,345 INFO Noise-Aware Loss enabled: True
2025-06-19 08:59:17,367 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 08:59:17,367 INFO Adding auxiliary enhancement losses...
2025-06-19 08:59:17,372 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 08:59:17,390 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.11670285911004272
2025-06-19 08:59:17,391 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 08:59:17,391 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 08:59:17,406 INFO Using KL-based Causal Consistency Loss with weight: 0.7180395647030267
2025-06-19 08:59:17,406 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 08:59:17,406 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 08:59:20,933 INFO Graph assembled successfully.
2025-06-19 08:59:42,526 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 08:59:43,139 INFO Word table initialized.
2025-06-19 08:59:43,140 INFO Model: all-hedge-gru_ef41ab82, starting new session.
2025-06-19 09:02:20,098 INFO 	iter: 20, batch loss: 1.3277654647827148, batch acc: 0.500000
2025-06-19 09:02:45,816 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:04:58,073 INFO 	iter: 40, batch loss: 0.9561672806739807, batch acc: 0.562500
2025-06-19 09:05:47,718 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 09:07:39,671 INFO 	iter: 60, batch loss: 0.8807007670402527, batch acc: 0.500000
2025-06-19 09:08:54,703 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 09:08:54,703 INFO Generating diagnostic plots...
2025-06-19 09:08:59,214 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 09:10:01,258 INFO Completed dev evaluation: size=420.0, acc=0.5167
2025-06-19 09:10:01,264 INFO 	Eval, eval loss: 0.785243034362793, acc: 0.516667, mcc: 0.112433
2025-06-19 09:10:01,405 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 09:10:01,407 INFO Start graph assembling...
2025-06-19 09:10:04,281 INFO use_dual_path_srl: True
2025-06-19 09:10:04,281 INFO variant_type: hedge
2025-06-19 09:10:04,281 INFO use_enhanced_srl: True
2025-06-19 09:10:04,281 INFO Enhanced SRL enabled from config
2025-06-19 09:10:04,281 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 09:10:04,281 INFO SRL condition: True = True and True
2025-06-19 09:10:04,281 INFO Using enhanced dual-path SRL architecture
2025-06-19 09:10:04,282 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 09:10:04,349 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 09:10:04,356 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 09:10:04,384 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 09:10:04,811 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 09:10:04,811 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 09:10:04,811 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 09:10:05,119 INFO Using Temporal Attention (TAP)
2025-06-19 09:10:05,186 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 09:10:05,186 INFO Ca-TSU enabled: True
2025-06-19 09:10:05,187 INFO Enhanced SRL enabled: True
2025-06-19 09:10:05,187 INFO Noise-Aware Loss enabled: True
2025-06-19 09:10:05,208 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 09:10:05,208 INFO Adding auxiliary enhancement losses...
2025-06-19 09:10:05,214 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 09:10:05,230 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3181595113532243
2025-06-19 09:10:05,232 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 09:10:05,232 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 09:10:05,246 INFO Using KL-based Causal Consistency Loss with weight: 0.11397005017049971
2025-06-19 09:10:05,246 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 09:10:05,246 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 09:10:08,788 INFO Graph assembled successfully.
2025-06-19 09:10:30,265 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 09:10:30,871 INFO Word table initialized.
2025-06-19 09:10:30,872 INFO Model: all-hedge-gru_bc2101f8, starting new session.
2025-06-19 09:13:09,216 INFO 	iter: 20, batch loss: 1.3009904623031616, batch acc: 0.656250
2025-06-19 09:13:34,564 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:15:47,080 INFO 	iter: 40, batch loss: 0.8632982969284058, batch acc: 0.718750
2025-06-19 09:16:37,100 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 09:18:24,475 INFO 	iter: 60, batch loss: 0.7913833260536194, batch acc: 0.500000
2025-06-19 09:19:39,930 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 09:19:39,931 INFO Generating diagnostic plots...
2025-06-19 09:19:44,323 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 09:20:46,365 INFO Completed dev evaluation: size=420.0, acc=0.5810
2025-06-19 09:20:46,372 INFO 	Eval, eval loss: 0.6943702101707458, acc: 0.580952, mcc: 0.007296
2025-06-19 09:20:46,513 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 09:20:46,515 INFO Start graph assembling...
2025-06-19 09:20:49,431 INFO use_dual_path_srl: True
2025-06-19 09:20:49,431 INFO variant_type: hedge
2025-06-19 09:20:49,431 INFO use_enhanced_srl: True
2025-06-19 09:20:49,431 INFO Enhanced SRL enabled from config
2025-06-19 09:20:49,432 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 09:20:49,432 INFO SRL condition: True = True and True
2025-06-19 09:20:49,432 INFO Using enhanced dual-path SRL architecture
2025-06-19 09:20:49,432 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 09:20:49,499 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 09:20:49,506 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 09:20:49,534 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 09:20:49,971 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 09:20:49,971 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 09:20:49,971 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 09:20:50,280 INFO Using Temporal Attention (TAP)
2025-06-19 09:20:50,347 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 09:20:50,347 INFO Ca-TSU enabled: True
2025-06-19 09:20:50,347 INFO Enhanced SRL enabled: True
2025-06-19 09:20:50,348 INFO Noise-Aware Loss enabled: True
2025-06-19 09:20:50,369 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 09:20:50,369 INFO Adding auxiliary enhancement losses...
2025-06-19 09:20:50,375 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 09:20:50,392 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10469279903121272
2025-06-19 09:20:50,393 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 09:20:50,393 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 09:20:50,408 INFO Using KL-based Causal Consistency Loss with weight: 0.21396625539975597
2025-06-19 09:20:50,408 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 09:20:50,408 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 09:20:53,983 INFO Graph assembled successfully.
2025-06-19 09:21:15,497 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 09:21:16,101 INFO Word table initialized.
2025-06-19 09:21:16,103 INFO Model: all-hedge-gru_23567687, starting new session.
2025-06-19 09:23:50,314 INFO 	iter: 20, batch loss: 1.3181835412979126, batch acc: 0.562500
2025-06-19 09:24:14,991 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:26:24,571 INFO 	iter: 40, batch loss: 1.0126557350158691, batch acc: 0.562500
2025-06-19 09:27:12,554 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 09:28:57,225 INFO 	iter: 60, batch loss: 0.8579971790313721, batch acc: 0.593750
2025-06-19 09:30:11,346 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 09:30:11,347 INFO Generating diagnostic plots...
2025-06-19 09:30:15,729 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 09:31:17,620 INFO Completed dev evaluation: size=420.0, acc=0.5571
2025-06-19 09:31:17,626 INFO 	Eval, eval loss: 0.749557375907898, acc: 0.557143, mcc: 0.101968
2025-06-19 09:31:17,767 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 09:31:17,769 INFO Start graph assembling...
2025-06-19 09:31:20,677 INFO use_dual_path_srl: True
2025-06-19 09:31:20,678 INFO variant_type: hedge
2025-06-19 09:31:20,678 INFO use_enhanced_srl: True
2025-06-19 09:31:20,678 INFO Enhanced SRL enabled from config
2025-06-19 09:31:20,678 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 09:31:20,678 INFO SRL condition: True = True and True
2025-06-19 09:31:20,678 INFO Using enhanced dual-path SRL architecture
2025-06-19 09:31:20,678 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 09:31:20,746 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 09:31:20,752 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 09:31:20,781 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 09:31:21,211 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 09:31:21,211 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 09:31:21,211 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 09:31:21,518 INFO Using Temporal Attention (TAP)
2025-06-19 09:31:21,585 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 09:31:21,586 INFO Ca-TSU enabled: True
2025-06-19 09:31:21,586 INFO Enhanced SRL enabled: True
2025-06-19 09:31:21,586 INFO Noise-Aware Loss enabled: True
2025-06-19 09:31:21,608 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 09:31:21,608 INFO Adding auxiliary enhancement losses...
2025-06-19 09:31:21,613 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 09:31:21,630 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.43490984210752415
2025-06-19 09:31:21,631 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 09:31:21,631 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 09:31:21,646 INFO Using KL-based Causal Consistency Loss with weight: 1.0533735334108045
2025-06-19 09:31:21,646 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 09:31:21,646 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 09:31:25,216 INFO Graph assembled successfully.
2025-06-19 09:31:46,760 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 09:31:47,366 INFO Word table initialized.
2025-06-19 09:31:47,367 INFO Model: all-hedge-gru_4e75a856, starting new session.
2025-06-19 09:34:23,467 INFO 	iter: 20, batch loss: 1.281553864479065, batch acc: 0.718750
2025-06-19 09:34:48,419 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:36:59,262 INFO 	iter: 40, batch loss: 0.9876542091369629, batch acc: 0.625000
2025-06-19 09:37:48,656 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 09:39:33,756 INFO 	iter: 60, batch loss: 0.9356220960617065, batch acc: 0.437500
2025-06-19 09:40:48,275 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 09:40:48,275 INFO Generating diagnostic plots...
2025-06-19 09:40:52,721 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 09:41:55,932 INFO Completed dev evaluation: size=420.0, acc=0.6143
2025-06-19 09:41:55,938 INFO 	Eval, eval loss: 0.7138016819953918, acc: 0.614286, mcc: 0.138137
2025-06-19 09:41:56,088 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 09:41:56,090 INFO Start graph assembling...
2025-06-19 09:41:59,090 INFO use_dual_path_srl: True
2025-06-19 09:41:59,090 INFO variant_type: hedge
2025-06-19 09:41:59,090 INFO use_enhanced_srl: True
2025-06-19 09:41:59,090 INFO Enhanced SRL enabled from config
2025-06-19 09:41:59,090 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 09:41:59,090 INFO SRL condition: True = True and True
2025-06-19 09:41:59,090 INFO Using enhanced dual-path SRL architecture
2025-06-19 09:41:59,090 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 09:41:59,158 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 09:41:59,165 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 09:41:59,193 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 09:41:59,645 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 09:41:59,646 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 09:41:59,646 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 09:41:59,960 INFO Using Temporal Attention (TAP)
2025-06-19 09:42:00,027 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 09:42:00,027 INFO Ca-TSU enabled: True
2025-06-19 09:42:00,027 INFO Enhanced SRL enabled: True
2025-06-19 09:42:00,027 INFO Noise-Aware Loss enabled: True
2025-06-19 09:42:00,051 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 09:42:00,051 INFO Adding auxiliary enhancement losses...
2025-06-19 09:42:00,056 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 09:42:00,076 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.11754428977784008
2025-06-19 09:42:00,077 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 09:42:00,077 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 09:42:00,093 INFO Using KL-based Causal Consistency Loss with weight: 0.3586072719845855
2025-06-19 09:42:00,093 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 09:42:00,093 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 09:42:03,776 INFO Graph assembled successfully.
2025-06-19 09:42:25,466 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 09:42:26,116 INFO Word table initialized.
2025-06-19 09:42:26,117 INFO Model: all-hedge-gru_e646815d, starting new session.
2025-06-19 09:45:04,679 INFO 	iter: 20, batch loss: 1.293337345123291, batch acc: 0.531250
2025-06-19 09:45:30,361 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:47:42,846 INFO 	iter: 40, batch loss: 0.9916858673095703, batch acc: 0.500000
2025-06-19 09:48:33,218 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 09:50:20,552 INFO 	iter: 60, batch loss: 0.8145506978034973, batch acc: 0.531250
2025-06-19 09:51:36,973 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 09:51:36,973 INFO Generating diagnostic plots...
2025-06-19 09:51:41,397 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 09:52:43,168 INFO Completed dev evaluation: size=420.0, acc=0.5405
2025-06-19 09:52:43,176 INFO 	Eval, eval loss: 0.7263275384902954, acc: 0.540476, mcc: 0.055598
2025-06-19 09:52:43,333 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 09:52:43,335 INFO Start graph assembling...
2025-06-19 09:52:46,215 INFO use_dual_path_srl: True
2025-06-19 09:52:46,215 INFO variant_type: hedge
2025-06-19 09:52:46,215 INFO use_enhanced_srl: True
2025-06-19 09:52:46,215 INFO Enhanced SRL enabled from config
2025-06-19 09:52:46,215 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 09:52:46,215 INFO SRL condition: True = True and True
2025-06-19 09:52:46,216 INFO Using enhanced dual-path SRL architecture
2025-06-19 09:52:46,216 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 09:52:46,283 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 09:52:46,289 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 09:52:46,318 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 09:52:46,751 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 09:52:46,751 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 09:52:46,751 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 09:52:47,061 INFO Using Temporal Attention (TAP)
2025-06-19 09:52:47,127 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 09:52:47,128 INFO Ca-TSU enabled: True
2025-06-19 09:52:47,128 INFO Enhanced SRL enabled: True
2025-06-19 09:52:47,128 INFO Noise-Aware Loss enabled: True
2025-06-19 09:52:47,149 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 09:52:47,149 INFO Adding auxiliary enhancement losses...
2025-06-19 09:52:47,155 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 09:52:47,172 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5275728723955814
2025-06-19 09:52:47,173 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 09:52:47,173 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 09:52:47,188 INFO Using KL-based Causal Consistency Loss with weight: 0.5925814548019864
2025-06-19 09:52:47,188 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 09:52:47,189 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 09:52:50,751 INFO Graph assembled successfully.
2025-06-19 09:53:12,434 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 09:53:13,046 INFO Word table initialized.
2025-06-19 09:53:13,047 INFO Model: all-hedge-gru_88286a0a, starting new session.
2025-06-19 09:55:51,486 INFO 	iter: 20, batch loss: 1.3350343704223633, batch acc: 0.656250
2025-06-19 09:56:17,177 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 09:58:29,957 INFO 	iter: 40, batch loss: 1.0552880764007568, batch acc: 0.375000
2025-06-19 09:59:20,086 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:01:08,448 INFO 	iter: 60, batch loss: 0.8298977017402649, batch acc: 0.562500
2025-06-19 10:02:24,071 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:02:24,072 INFO Generating diagnostic plots...
2025-06-19 10:02:28,496 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:03:31,265 INFO Completed dev evaluation: size=420.0, acc=0.4881
2025-06-19 10:03:31,272 INFO 	Eval, eval loss: 0.7884151339530945, acc: 0.488095, mcc: 0.035963
2025-06-19 10:03:31,422 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:03:31,424 INFO Start graph assembling...
2025-06-19 10:03:34,360 INFO use_dual_path_srl: True
2025-06-19 10:03:34,360 INFO variant_type: hedge
2025-06-19 10:03:34,360 INFO use_enhanced_srl: True
2025-06-19 10:03:34,361 INFO Enhanced SRL enabled from config
2025-06-19 10:03:34,361 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:03:34,361 INFO SRL condition: True = True and True
2025-06-19 10:03:34,361 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:03:34,361 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:03:34,428 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:03:34,435 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:03:34,463 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:03:34,902 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:03:34,902 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:03:34,902 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:03:35,212 INFO Using Temporal Attention (TAP)
2025-06-19 10:03:35,279 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:03:35,279 INFO Ca-TSU enabled: True
2025-06-19 10:03:35,279 INFO Enhanced SRL enabled: True
2025-06-19 10:03:35,280 INFO Noise-Aware Loss enabled: True
2025-06-19 10:03:35,301 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:03:35,302 INFO Adding auxiliary enhancement losses...
2025-06-19 10:03:35,307 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:03:35,324 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2581688180279486
2025-06-19 10:03:35,325 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:03:35,325 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:03:35,340 INFO Using KL-based Causal Consistency Loss with weight: 0.2953856994029518
2025-06-19 10:03:35,340 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:03:35,340 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:03:38,924 INFO Graph assembled successfully.
2025-06-19 10:04:00,675 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:04:01,311 INFO Word table initialized.
2025-06-19 10:04:01,312 INFO Model: all-hedge-gru_9a49c559, starting new session.
2025-06-19 10:06:39,192 INFO 	iter: 20, batch loss: 1.356410264968872, batch acc: 0.500000
2025-06-19 10:07:04,459 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 10:09:17,552 INFO 	iter: 40, batch loss: 0.9899398684501648, batch acc: 0.562500
2025-06-19 10:10:07,188 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:11:54,330 INFO 	iter: 60, batch loss: 0.8375997543334961, batch acc: 0.687500
2025-06-19 10:13:09,873 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:13:09,874 INFO Generating diagnostic plots...
2025-06-19 10:13:14,298 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:14:17,079 INFO Completed dev evaluation: size=420.0, acc=0.5357
2025-06-19 10:14:17,087 INFO 	Eval, eval loss: 0.7551292181015015, acc: 0.535714, mcc: -0.013670
2025-06-19 10:14:17,250 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:14:17,252 INFO Start graph assembling...
2025-06-19 10:14:20,183 INFO use_dual_path_srl: True
2025-06-19 10:14:20,183 INFO variant_type: hedge
2025-06-19 10:14:20,183 INFO use_enhanced_srl: True
2025-06-19 10:14:20,183 INFO Enhanced SRL enabled from config
2025-06-19 10:14:20,183 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:14:20,183 INFO SRL condition: True = True and True
2025-06-19 10:14:20,183 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:14:20,184 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:14:20,251 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:14:20,258 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:14:20,287 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:14:20,732 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:14:20,733 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:14:20,733 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:14:21,047 INFO Using Temporal Attention (TAP)
2025-06-19 10:14:21,114 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:14:21,115 INFO Ca-TSU enabled: True
2025-06-19 10:14:21,115 INFO Enhanced SRL enabled: True
2025-06-19 10:14:21,115 INFO Noise-Aware Loss enabled: True
2025-06-19 10:14:21,137 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:14:21,137 INFO Adding auxiliary enhancement losses...
2025-06-19 10:14:21,143 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:14:21,161 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10221435251154816
2025-06-19 10:14:21,162 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:14:21,162 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:14:21,177 INFO Using KL-based Causal Consistency Loss with weight: 0.16504021220152645
2025-06-19 10:14:21,177 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:14:21,178 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:14:24,769 INFO Graph assembled successfully.
2025-06-19 10:14:46,517 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:14:47,157 INFO Word table initialized.
2025-06-19 10:14:47,158 INFO Model: all-hedge-gru_e6a23734, starting new session.
2025-06-19 10:17:22,607 INFO 	iter: 20, batch loss: 1.364202857017517, batch acc: 0.531250
2025-06-19 10:17:47,152 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 10:19:57,811 INFO 	iter: 40, batch loss: 1.0139940977096558, batch acc: 0.468750
2025-06-19 10:20:45,936 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:22:31,577 INFO 	iter: 60, batch loss: 0.8260915279388428, batch acc: 0.531250
2025-06-19 10:23:45,724 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:23:45,724 INFO Generating diagnostic plots...
2025-06-19 10:23:50,204 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:24:52,101 INFO Completed dev evaluation: size=420.0, acc=0.5071
2025-06-19 10:24:52,108 INFO 	Eval, eval loss: 0.7757863998413086, acc: 0.507143, mcc: 0.097216
2025-06-19 10:24:52,263 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:24:52,265 INFO Start graph assembling...
2025-06-19 10:24:55,162 INFO use_dual_path_srl: True
2025-06-19 10:24:55,162 INFO variant_type: hedge
2025-06-19 10:24:55,162 INFO use_enhanced_srl: True
2025-06-19 10:24:55,162 INFO Enhanced SRL enabled from config
2025-06-19 10:24:55,162 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:24:55,162 INFO SRL condition: True = True and True
2025-06-19 10:24:55,163 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:24:55,163 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:24:55,230 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:24:55,236 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:24:55,265 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:24:55,700 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:24:55,700 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:24:55,700 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:24:56,005 INFO Using Temporal Attention (TAP)
2025-06-19 10:24:56,072 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:24:56,072 INFO Ca-TSU enabled: True
2025-06-19 10:24:56,072 INFO Enhanced SRL enabled: True
2025-06-19 10:24:56,072 INFO Noise-Aware Loss enabled: True
2025-06-19 10:24:56,093 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:24:56,094 INFO Adding auxiliary enhancement losses...
2025-06-19 10:24:56,099 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:24:56,116 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10348955729844916
2025-06-19 10:24:56,117 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:24:56,117 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:24:56,131 INFO Using KL-based Causal Consistency Loss with weight: 0.3153319463414833
2025-06-19 10:24:56,132 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:24:56,132 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:24:59,669 INFO Graph assembled successfully.
2025-06-19 10:25:21,728 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:25:22,351 INFO Word table initialized.
2025-06-19 10:25:22,352 INFO Model: all-hedge-gru_7ed05853, starting new session.
2025-06-19 10:27:57,623 INFO 	iter: 20, batch loss: 1.3380281925201416, batch acc: 0.656250
2025-06-19 10:28:22,366 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 10:30:32,324 INFO 	iter: 40, batch loss: 0.9917305111885071, batch acc: 0.468750
2025-06-19 10:31:21,325 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:33:07,184 INFO 	iter: 60, batch loss: 0.8221229910850525, batch acc: 0.562500
2025-06-19 10:34:20,528 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:34:20,528 INFO Generating diagnostic plots...
2025-06-19 10:34:25,097 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:35:26,709 INFO Completed dev evaluation: size=420.0, acc=0.5548
2025-06-19 10:35:26,716 INFO 	Eval, eval loss: 0.7497247457504272, acc: 0.554762, mcc: 0.072265
2025-06-19 10:35:26,884 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:35:26,887 INFO Start graph assembling...
2025-06-19 10:35:29,810 INFO use_dual_path_srl: True
2025-06-19 10:35:29,810 INFO variant_type: hedge
2025-06-19 10:35:29,810 INFO use_enhanced_srl: True
2025-06-19 10:35:29,810 INFO Enhanced SRL enabled from config
2025-06-19 10:35:29,810 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:35:29,810 INFO SRL condition: True = True and True
2025-06-19 10:35:29,811 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:35:29,811 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:35:29,879 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:35:29,885 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:35:29,914 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:35:30,354 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:35:30,354 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:35:30,354 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:35:30,662 INFO Using Temporal Attention (TAP)
2025-06-19 10:35:30,729 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:35:30,730 INFO Ca-TSU enabled: True
2025-06-19 10:35:30,730 INFO Enhanced SRL enabled: True
2025-06-19 10:35:30,730 INFO Noise-Aware Loss enabled: True
2025-06-19 10:35:30,752 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:35:30,752 INFO Adding auxiliary enhancement losses...
2025-06-19 10:35:30,758 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:35:30,775 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.30323581857189896
2025-06-19 10:35:30,776 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:35:30,776 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:35:30,791 INFO Using KL-based Causal Consistency Loss with weight: 1.8066225999535326
2025-06-19 10:35:30,791 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:35:30,791 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:35:34,394 INFO Graph assembled successfully.
2025-06-19 10:35:56,190 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:35:56,820 INFO Word table initialized.
2025-06-19 10:35:56,821 INFO Model: all-hedge-gru_57372968, starting new session.
2025-06-19 10:38:35,748 INFO 	iter: 20, batch loss: 1.3130686283111572, batch acc: 0.562500
2025-06-19 10:39:00,997 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 10:41:15,231 INFO 	iter: 40, batch loss: 0.9987537264823914, batch acc: 0.593750
2025-06-19 10:42:05,487 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:43:53,147 INFO 	iter: 60, batch loss: 0.841111958026886, batch acc: 0.468750
2025-06-19 10:45:09,762 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:45:09,762 INFO Generating diagnostic plots...
2025-06-19 10:45:14,088 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:46:16,627 INFO Completed dev evaluation: size=420.0, acc=0.5262
2025-06-19 10:46:16,635 INFO 	Eval, eval loss: 0.7442585825920105, acc: 0.526190, mcc: 0.054924
2025-06-19 10:46:16,794 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:46:16,797 INFO Start graph assembling...
2025-06-19 10:46:19,728 INFO use_dual_path_srl: True
2025-06-19 10:46:19,728 INFO variant_type: hedge
2025-06-19 10:46:19,728 INFO use_enhanced_srl: True
2025-06-19 10:46:19,728 INFO Enhanced SRL enabled from config
2025-06-19 10:46:19,728 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:46:19,728 INFO SRL condition: True = True and True
2025-06-19 10:46:19,728 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:46:19,729 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:46:19,796 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:46:19,803 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:46:19,832 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:46:20,271 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:46:20,272 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:46:20,272 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:46:20,580 INFO Using Temporal Attention (TAP)
2025-06-19 10:46:20,647 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:46:20,647 INFO Ca-TSU enabled: True
2025-06-19 10:46:20,647 INFO Enhanced SRL enabled: True
2025-06-19 10:46:20,647 INFO Noise-Aware Loss enabled: True
2025-06-19 10:46:20,669 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:46:20,669 INFO Adding auxiliary enhancement losses...
2025-06-19 10:46:20,675 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:46:20,692 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6138860863549992
2025-06-19 10:46:20,693 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:46:20,693 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:46:20,708 INFO Using KL-based Causal Consistency Loss with weight: 0.3584746333842024
2025-06-19 10:46:20,708 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:46:20,708 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:46:24,295 INFO Graph assembled successfully.
2025-06-19 10:46:46,259 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:46:46,897 INFO Word table initialized.
2025-06-19 10:46:46,897 INFO Model: all-hedge-gru_c79f5d93, starting new session.
2025-06-19 10:49:25,024 INFO 	iter: 20, batch loss: 1.387457251548767, batch acc: 0.593750
2025-06-19 10:49:51,051 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 10:52:03,914 INFO 	iter: 40, batch loss: 0.9852728843688965, batch acc: 0.531250
2025-06-19 10:52:54,234 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 10:54:42,246 INFO 	iter: 60, batch loss: 0.8288417458534241, batch acc: 0.531250
2025-06-19 10:55:59,221 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 10:55:59,222 INFO Generating diagnostic plots...
2025-06-19 10:56:03,673 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 10:57:05,248 INFO Completed dev evaluation: size=420.0, acc=0.6071
2025-06-19 10:57:05,256 INFO 	Eval, eval loss: 0.7108522653579712, acc: 0.607143, mcc: 0.109401
2025-06-19 10:57:05,400 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 10:57:05,402 INFO Start graph assembling...
2025-06-19 10:57:08,286 INFO use_dual_path_srl: True
2025-06-19 10:57:08,286 INFO variant_type: hedge
2025-06-19 10:57:08,286 INFO use_enhanced_srl: True
2025-06-19 10:57:08,286 INFO Enhanced SRL enabled from config
2025-06-19 10:57:08,286 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 10:57:08,286 INFO SRL condition: True = True and True
2025-06-19 10:57:08,286 INFO Using enhanced dual-path SRL architecture
2025-06-19 10:57:08,287 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 10:57:08,354 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 10:57:08,361 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 10:57:08,389 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 10:57:08,821 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 10:57:08,821 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 10:57:08,821 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 10:57:09,128 INFO Using Temporal Attention (TAP)
2025-06-19 10:57:09,194 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 10:57:09,194 INFO Ca-TSU enabled: True
2025-06-19 10:57:09,194 INFO Enhanced SRL enabled: True
2025-06-19 10:57:09,194 INFO Noise-Aware Loss enabled: True
2025-06-19 10:57:09,216 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 10:57:09,216 INFO Adding auxiliary enhancement losses...
2025-06-19 10:57:09,221 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 10:57:09,238 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08767434389054433
2025-06-19 10:57:09,239 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 10:57:09,239 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 10:57:09,254 INFO Using KL-based Causal Consistency Loss with weight: 0.2880672700696477
2025-06-19 10:57:09,254 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 10:57:09,254 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 10:57:12,814 INFO Graph assembled successfully.
2025-06-19 10:57:34,668 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 10:57:35,285 INFO Word table initialized.
2025-06-19 10:57:35,287 INFO Model: all-hedge-gru_4b869a31, starting new session.
2025-06-19 11:00:13,077 INFO 	iter: 20, batch loss: 1.230255126953125, batch acc: 0.656250
2025-06-19 11:00:38,274 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:02:50,950 INFO 	iter: 40, batch loss: 1.019918441772461, batch acc: 0.562500
2025-06-19 11:03:40,371 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:05:28,380 INFO 	iter: 60, batch loss: 0.8234713077545166, batch acc: 0.656250
2025-06-19 11:06:43,389 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 11:06:43,390 INFO Generating diagnostic plots...
2025-06-19 11:06:47,796 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 11:07:49,591 INFO Completed dev evaluation: size=420.0, acc=0.4690
2025-06-19 11:07:49,598 INFO 	Eval, eval loss: 0.8195787072181702, acc: 0.469048, mcc: 0.065130
2025-06-19 11:07:49,758 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 11:07:49,760 INFO Start graph assembling...
2025-06-19 11:07:52,645 INFO use_dual_path_srl: True
2025-06-19 11:07:52,645 INFO variant_type: hedge
2025-06-19 11:07:52,645 INFO use_enhanced_srl: True
2025-06-19 11:07:52,645 INFO Enhanced SRL enabled from config
2025-06-19 11:07:52,645 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 11:07:52,645 INFO SRL condition: True = True and True
2025-06-19 11:07:52,645 INFO Using enhanced dual-path SRL architecture
2025-06-19 11:07:52,645 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 11:07:52,712 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 11:07:52,719 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 11:07:52,747 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 11:07:53,177 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 11:07:53,177 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 11:07:53,177 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 11:07:53,492 INFO Using Temporal Attention (TAP)
2025-06-19 11:07:53,560 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 11:07:53,560 INFO Ca-TSU enabled: True
2025-06-19 11:07:53,561 INFO Enhanced SRL enabled: True
2025-06-19 11:07:53,561 INFO Noise-Aware Loss enabled: True
2025-06-19 11:07:53,584 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 11:07:53,584 INFO Adding auxiliary enhancement losses...
2025-06-19 11:07:53,588 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 11:07:53,606 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2565544099926234
2025-06-19 11:07:53,607 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 11:07:53,607 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 11:07:53,622 INFO Using KL-based Causal Consistency Loss with weight: 0.6089846503859784
2025-06-19 11:07:53,622 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 11:07:53,622 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 11:07:57,166 INFO Graph assembled successfully.
2025-06-19 11:08:18,724 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 11:08:19,340 INFO Word table initialized.
2025-06-19 11:08:19,341 INFO Model: all-hedge-gru_e7d43fd8, starting new session.
2025-06-19 11:10:58,639 INFO 	iter: 20, batch loss: 1.3358734846115112, batch acc: 0.562500
2025-06-19 11:11:23,954 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:13:37,116 INFO 	iter: 40, batch loss: 0.990108072757721, batch acc: 0.562500
2025-06-19 11:14:26,924 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:16:14,595 INFO 	iter: 60, batch loss: 0.8494179844856262, batch acc: 0.593750
2025-06-19 11:17:30,766 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 11:17:30,767 INFO Generating diagnostic plots...
2025-06-19 11:17:35,209 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 11:18:37,367 INFO Completed dev evaluation: size=420.0, acc=0.4738
2025-06-19 11:18:37,375 INFO 	Eval, eval loss: 0.7751284241676331, acc: 0.473810, mcc: -0.032697
2025-06-19 11:18:37,528 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 11:18:37,530 INFO Start graph assembling...
2025-06-19 11:18:40,473 INFO use_dual_path_srl: True
2025-06-19 11:18:40,473 INFO variant_type: hedge
2025-06-19 11:18:40,473 INFO use_enhanced_srl: True
2025-06-19 11:18:40,473 INFO Enhanced SRL enabled from config
2025-06-19 11:18:40,473 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 11:18:40,473 INFO SRL condition: True = True and True
2025-06-19 11:18:40,473 INFO Using enhanced dual-path SRL architecture
2025-06-19 11:18:40,474 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 11:18:40,542 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 11:18:40,548 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 11:18:40,577 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 11:18:41,017 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 11:18:41,017 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 11:18:41,017 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 11:18:41,326 INFO Using Temporal Attention (TAP)
2025-06-19 11:18:41,393 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 11:18:41,393 INFO Ca-TSU enabled: True
2025-06-19 11:18:41,393 INFO Enhanced SRL enabled: True
2025-06-19 11:18:41,393 INFO Noise-Aware Loss enabled: True
2025-06-19 11:18:41,416 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 11:18:41,416 INFO Adding auxiliary enhancement losses...
2025-06-19 11:18:41,421 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 11:18:41,438 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.24173114639745816
2025-06-19 11:18:41,439 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 11:18:41,439 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 11:18:41,454 INFO Using KL-based Causal Consistency Loss with weight: 0.5800279648709556
2025-06-19 11:18:41,454 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 11:18:41,454 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 11:18:45,050 INFO Graph assembled successfully.
2025-06-19 11:19:06,714 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 11:19:07,347 INFO Word table initialized.
2025-06-19 11:19:07,348 INFO Model: all-hedge-gru_0dacc024, starting new session.
2025-06-19 11:21:44,560 INFO 	iter: 20, batch loss: 1.2458381652832031, batch acc: 0.593750
2025-06-19 11:22:10,523 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:24:22,102 INFO 	iter: 40, batch loss: 0.9102230072021484, batch acc: 0.750000
2025-06-19 11:25:11,271 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:26:57,778 INFO 	iter: 60, batch loss: 0.8568300604820251, batch acc: 0.468750
2025-06-19 11:28:13,148 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 11:28:13,149 INFO Generating diagnostic plots...
2025-06-19 11:28:17,604 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 11:29:18,916 INFO Completed dev evaluation: size=420.0, acc=0.5714
2025-06-19 11:29:18,922 INFO 	Eval, eval loss: 0.7463038563728333, acc: 0.571429, mcc: 0.091452
2025-06-19 11:29:19,068 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 11:29:19,070 INFO Start graph assembling...
2025-06-19 11:29:21,980 INFO use_dual_path_srl: True
2025-06-19 11:29:21,980 INFO variant_type: hedge
2025-06-19 11:29:21,980 INFO use_enhanced_srl: True
2025-06-19 11:29:21,980 INFO Enhanced SRL enabled from config
2025-06-19 11:29:21,980 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 11:29:21,980 INFO SRL condition: True = True and True
2025-06-19 11:29:21,981 INFO Using enhanced dual-path SRL architecture
2025-06-19 11:29:21,981 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 11:29:22,048 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 11:29:22,055 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 11:29:22,084 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 11:29:22,520 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 11:29:22,520 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 11:29:22,520 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 11:29:22,829 INFO Using Temporal Attention (TAP)
2025-06-19 11:29:22,896 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 11:29:22,897 INFO Ca-TSU enabled: True
2025-06-19 11:29:22,897 INFO Enhanced SRL enabled: True
2025-06-19 11:29:22,897 INFO Noise-Aware Loss enabled: True
2025-06-19 11:29:22,919 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 11:29:22,919 INFO Adding auxiliary enhancement losses...
2025-06-19 11:29:22,924 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 11:29:22,941 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.7331650903710761
2025-06-19 11:29:22,942 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 11:29:22,942 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 11:29:22,957 INFO Using KL-based Causal Consistency Loss with weight: 0.9885205816264382
2025-06-19 11:29:22,957 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 11:29:22,957 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 11:29:26,543 INFO Graph assembled successfully.
2025-06-19 11:29:48,435 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 11:29:49,061 INFO Word table initialized.
2025-06-19 11:29:49,062 INFO Model: all-hedge-gru_90cde246, starting new session.
2025-06-19 11:32:26,125 INFO 	iter: 20, batch loss: 1.2494598627090454, batch acc: 0.656250
2025-06-19 11:32:51,806 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:35:03,990 INFO 	iter: 40, batch loss: 0.966116726398468, batch acc: 0.562500
2025-06-19 11:35:54,186 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:37:41,756 INFO 	iter: 60, batch loss: 0.8420504331588745, batch acc: 0.593750
2025-06-19 11:38:57,334 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 11:38:57,335 INFO Generating diagnostic plots...
2025-06-19 11:39:01,729 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 11:40:04,212 INFO Completed dev evaluation: size=420.0, acc=0.5976
2025-06-19 11:40:04,220 INFO 	Eval, eval loss: 0.7317273616790771, acc: 0.597619, mcc: 0.043050
2025-06-19 11:40:04,381 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 11:40:04,383 INFO Start graph assembling...
2025-06-19 11:40:07,298 INFO use_dual_path_srl: True
2025-06-19 11:40:07,298 INFO variant_type: hedge
2025-06-19 11:40:07,298 INFO use_enhanced_srl: True
2025-06-19 11:40:07,298 INFO Enhanced SRL enabled from config
2025-06-19 11:40:07,298 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 11:40:07,299 INFO SRL condition: True = True and True
2025-06-19 11:40:07,299 INFO Using enhanced dual-path SRL architecture
2025-06-19 11:40:07,299 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 11:40:07,367 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 11:40:07,373 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 11:40:07,402 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 11:40:07,837 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 11:40:07,837 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 11:40:07,838 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 11:40:08,147 INFO Using Temporal Attention (TAP)
2025-06-19 11:40:08,214 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 11:40:08,214 INFO Ca-TSU enabled: True
2025-06-19 11:40:08,214 INFO Enhanced SRL enabled: True
2025-06-19 11:40:08,214 INFO Noise-Aware Loss enabled: True
2025-06-19 11:40:08,236 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 11:40:08,237 INFO Adding auxiliary enhancement losses...
2025-06-19 11:40:08,241 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 11:40:08,258 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.13868117091343923
2025-06-19 11:40:08,259 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 11:40:08,259 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 11:40:08,274 INFO Using KL-based Causal Consistency Loss with weight: 1.8234954484169983
2025-06-19 11:40:08,274 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 11:40:08,274 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 11:40:11,869 INFO Graph assembled successfully.
2025-06-19 11:40:33,494 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 11:40:34,107 INFO Word table initialized.
2025-06-19 11:40:34,108 INFO Model: all-hedge-gru_419d1c4b, starting new session.
2025-06-19 11:43:14,174 INFO 	iter: 20, batch loss: 1.3383257389068604, batch acc: 0.562500
2025-06-19 11:43:39,774 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:45:53,090 INFO 	iter: 40, batch loss: 1.030409574508667, batch acc: 0.437500
2025-06-19 11:46:43,491 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:48:31,014 INFO 	iter: 60, batch loss: 0.8464247584342957, batch acc: 0.468750
2025-06-19 11:49:47,229 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 11:49:47,230 INFO Generating diagnostic plots...
2025-06-19 11:49:51,709 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 11:50:53,277 INFO Completed dev evaluation: size=420.0, acc=0.5976
2025-06-19 11:50:53,282 INFO 	Eval, eval loss: 0.7314841151237488, acc: 0.597619, mcc: 0.107708
2025-06-19 11:50:53,428 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 11:50:53,430 INFO Start graph assembling...
2025-06-19 11:50:56,355 INFO use_dual_path_srl: True
2025-06-19 11:50:56,356 INFO variant_type: hedge
2025-06-19 11:50:56,356 INFO use_enhanced_srl: True
2025-06-19 11:50:56,356 INFO Enhanced SRL enabled from config
2025-06-19 11:50:56,356 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 11:50:56,356 INFO SRL condition: True = True and True
2025-06-19 11:50:56,356 INFO Using enhanced dual-path SRL architecture
2025-06-19 11:50:56,356 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 11:50:56,424 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 11:50:56,430 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 11:50:56,458 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 11:50:56,896 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 11:50:56,897 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 11:50:56,897 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 11:50:57,207 INFO Using Temporal Attention (TAP)
2025-06-19 11:50:57,277 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 11:50:57,277 INFO Ca-TSU enabled: True
2025-06-19 11:50:57,277 INFO Enhanced SRL enabled: True
2025-06-19 11:50:57,277 INFO Noise-Aware Loss enabled: True
2025-06-19 11:50:57,300 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 11:50:57,301 INFO Adding auxiliary enhancement losses...
2025-06-19 11:50:57,305 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 11:50:57,323 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.051407201913209515
2025-06-19 11:50:57,324 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 11:50:57,324 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 11:50:57,339 INFO Using KL-based Causal Consistency Loss with weight: 0.4791997230588441
2025-06-19 11:50:57,340 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 11:50:57,340 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 11:51:00,929 INFO Graph assembled successfully.
2025-06-19 11:51:22,672 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 11:51:23,306 INFO Word table initialized.
2025-06-19 11:51:23,307 INFO Model: all-hedge-gru_e554d850, starting new session.
2025-06-19 11:54:02,103 INFO 	iter: 20, batch loss: 1.361493706703186, batch acc: 0.656250
2025-06-19 11:54:27,593 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 11:56:40,516 INFO 	iter: 40, batch loss: 0.9998574256896973, batch acc: 0.593750
2025-06-19 11:57:30,303 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 11:59:17,564 INFO 	iter: 60, batch loss: 0.8720589280128479, batch acc: 0.500000
2025-06-19 12:00:33,944 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:00:33,944 INFO Generating diagnostic plots...
2025-06-19 12:00:38,335 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:01:40,930 INFO Completed dev evaluation: size=420.0, acc=0.4952
2025-06-19 12:01:40,935 INFO 	Eval, eval loss: 0.7782915830612183, acc: 0.495238, mcc: -0.018741
2025-06-19 12:01:41,089 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:01:41,091 INFO Start graph assembling...
2025-06-19 12:01:44,009 INFO use_dual_path_srl: True
2025-06-19 12:01:44,009 INFO variant_type: hedge
2025-06-19 12:01:44,009 INFO use_enhanced_srl: True
2025-06-19 12:01:44,009 INFO Enhanced SRL enabled from config
2025-06-19 12:01:44,009 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:01:44,009 INFO SRL condition: True = True and True
2025-06-19 12:01:44,009 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:01:44,010 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:01:44,080 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:01:44,086 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:01:44,116 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:01:44,559 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:01:44,559 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:01:44,559 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:01:44,872 INFO Using Temporal Attention (TAP)
2025-06-19 12:01:44,939 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:01:44,939 INFO Ca-TSU enabled: True
2025-06-19 12:01:44,940 INFO Enhanced SRL enabled: True
2025-06-19 12:01:44,940 INFO Noise-Aware Loss enabled: True
2025-06-19 12:01:44,962 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:01:44,962 INFO Adding auxiliary enhancement losses...
2025-06-19 12:01:44,967 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:01:44,984 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09140851534993477
2025-06-19 12:01:44,985 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:01:44,986 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:01:45,000 INFO Using KL-based Causal Consistency Loss with weight: 0.1495682296759344
2025-06-19 12:01:45,001 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:01:45,001 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:01:48,602 INFO Graph assembled successfully.
2025-06-19 12:02:10,255 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:02:10,877 INFO Word table initialized.
2025-06-19 12:02:10,878 INFO Model: all-hedge-gru_78583d11, starting new session.
2025-06-19 12:04:51,690 INFO 	iter: 20, batch loss: 1.2822061777114868, batch acc: 0.687500
2025-06-19 12:05:17,256 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 12:07:32,432 INFO 	iter: 40, batch loss: 0.8904579877853394, batch acc: 0.593750
2025-06-19 12:08:22,942 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 12:10:11,700 INFO 	iter: 60, batch loss: 0.8701808452606201, batch acc: 0.375000
2025-06-19 12:11:28,324 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:11:28,325 INFO Generating diagnostic plots...
2025-06-19 12:11:32,995 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:12:34,767 INFO Completed dev evaluation: size=420.0, acc=0.5595
2025-06-19 12:12:34,772 INFO 	Eval, eval loss: 0.7039860486984253, acc: 0.559524, mcc: 0.092869
2025-06-19 12:12:34,917 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:12:34,919 INFO Start graph assembling...
2025-06-19 12:12:37,879 INFO use_dual_path_srl: True
2025-06-19 12:12:37,879 INFO variant_type: hedge
2025-06-19 12:12:37,880 INFO use_enhanced_srl: True
2025-06-19 12:12:37,880 INFO Enhanced SRL enabled from config
2025-06-19 12:12:37,880 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:12:37,880 INFO SRL condition: True = True and True
2025-06-19 12:12:37,880 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:12:37,880 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:12:37,948 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:12:37,955 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:12:37,983 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:12:38,422 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:12:38,423 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:12:38,423 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:12:38,742 INFO Using Temporal Attention (TAP)
2025-06-19 12:12:38,812 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:12:38,812 INFO Ca-TSU enabled: True
2025-06-19 12:12:38,813 INFO Enhanced SRL enabled: True
2025-06-19 12:12:38,813 INFO Noise-Aware Loss enabled: True
2025-06-19 12:12:38,837 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:12:38,837 INFO Adding auxiliary enhancement losses...
2025-06-19 12:12:38,842 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:12:38,859 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.05564540278399157
2025-06-19 12:12:38,860 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:12:38,861 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:12:38,875 INFO Using KL-based Causal Consistency Loss with weight: 0.24787159836999154
2025-06-19 12:12:38,876 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:12:38,876 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:12:42,519 INFO Graph assembled successfully.
2025-06-19 12:13:04,358 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:13:04,983 INFO Word table initialized.
2025-06-19 12:13:04,984 INFO Model: all-hedge-gru_b1ace5f9, starting new session.
2025-06-19 12:15:43,500 INFO 	iter: 20, batch loss: 1.4513829946517944, batch acc: 0.406250
2025-06-19 12:16:08,843 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 12:18:21,450 INFO 	iter: 40, batch loss: 0.9821778535842896, batch acc: 0.437500
2025-06-19 12:19:11,256 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 12:20:57,836 INFO 	iter: 60, batch loss: 0.9363862872123718, batch acc: 0.468750
2025-06-19 12:22:13,888 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:22:13,888 INFO Generating diagnostic plots...
2025-06-19 12:22:18,290 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:23:19,930 INFO Completed dev evaluation: size=420.0, acc=0.4976
2025-06-19 12:23:19,936 INFO 	Eval, eval loss: 0.785824179649353, acc: 0.497619, mcc: 0.011910
2025-06-19 12:23:20,094 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:23:20,097 INFO Start graph assembling...
2025-06-19 12:23:22,984 INFO use_dual_path_srl: True
2025-06-19 12:23:22,985 INFO variant_type: hedge
2025-06-19 12:23:22,985 INFO use_enhanced_srl: True
2025-06-19 12:23:22,985 INFO Enhanced SRL enabled from config
2025-06-19 12:23:22,985 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:23:22,985 INFO SRL condition: True = True and True
2025-06-19 12:23:22,985 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:23:22,985 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:23:23,052 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:23:23,059 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:23:23,087 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:23:23,522 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:23:23,522 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:23:23,522 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:23:23,828 INFO Using Temporal Attention (TAP)
2025-06-19 12:23:23,895 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:23:23,895 INFO Ca-TSU enabled: True
2025-06-19 12:23:23,895 INFO Enhanced SRL enabled: True
2025-06-19 12:23:23,896 INFO Noise-Aware Loss enabled: True
2025-06-19 12:23:23,918 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:23:23,918 INFO Adding auxiliary enhancement losses...
2025-06-19 12:23:23,923 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:23:23,939 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09497348708405047
2025-06-19 12:23:23,941 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:23:23,941 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:23:23,955 INFO Using KL-based Causal Consistency Loss with weight: 1.2886255148792987
2025-06-19 12:23:23,955 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:23:23,956 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:23:27,509 INFO Graph assembled successfully.
2025-06-19 12:23:49,264 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:23:49,908 INFO Word table initialized.
2025-06-19 12:23:49,909 INFO Model: all-hedge-gru_bf0973f0, starting new session.
2025-06-19 12:26:28,228 INFO 	iter: 20, batch loss: 1.306633710861206, batch acc: 0.531250
2025-06-19 12:26:53,514 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 12:29:05,927 INFO 	iter: 40, batch loss: 1.0679025650024414, batch acc: 0.468750
2025-06-19 12:29:55,530 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 12:31:42,814 INFO 	iter: 60, batch loss: 0.8314884901046753, batch acc: 0.593750
2025-06-19 12:32:58,542 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:32:58,542 INFO Generating diagnostic plots...
2025-06-19 12:33:03,017 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:34:05,378 INFO Completed dev evaluation: size=420.0, acc=0.5310
2025-06-19 12:34:05,383 INFO 	Eval, eval loss: 0.8126567006111145, acc: 0.530952, mcc: 0.201323
2025-06-19 12:34:05,529 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:34:05,531 INFO Start graph assembling...
2025-06-19 12:34:08,448 INFO use_dual_path_srl: True
2025-06-19 12:34:08,448 INFO variant_type: hedge
2025-06-19 12:34:08,448 INFO use_enhanced_srl: True
2025-06-19 12:34:08,448 INFO Enhanced SRL enabled from config
2025-06-19 12:34:08,448 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:34:08,448 INFO SRL condition: True = True and True
2025-06-19 12:34:08,448 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:34:08,448 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:34:08,516 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:34:08,523 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:34:08,551 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:34:08,989 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:34:08,990 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:34:08,990 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:34:09,299 INFO Using Temporal Attention (TAP)
2025-06-19 12:34:09,367 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:34:09,367 INFO Ca-TSU enabled: True
2025-06-19 12:34:09,367 INFO Enhanced SRL enabled: True
2025-06-19 12:34:09,367 INFO Noise-Aware Loss enabled: True
2025-06-19 12:34:09,390 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:34:09,390 INFO Adding auxiliary enhancement losses...
2025-06-19 12:34:09,395 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:34:09,412 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.1610968737340489
2025-06-19 12:34:09,413 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:34:09,413 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:34:09,428 INFO Using KL-based Causal Consistency Loss with weight: 1.6700198533646982
2025-06-19 12:34:09,428 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:34:09,428 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:34:13,025 INFO Graph assembled successfully.
2025-06-19 12:34:34,710 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:34:35,331 INFO Word table initialized.
2025-06-19 12:34:35,333 INFO Model: all-hedge-gru_3d3ca830, starting new session.
2025-06-19 12:37:13,540 INFO 	iter: 20, batch loss: 1.304537296295166, batch acc: 0.718750
2025-06-19 12:37:38,837 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 12:39:51,180 INFO 	iter: 40, batch loss: 0.9722414016723633, batch acc: 0.625000
2025-06-19 12:40:40,527 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 12:42:26,778 INFO 	iter: 60, batch loss: 0.7796339988708496, batch acc: 0.593750
2025-06-19 12:43:42,209 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:43:42,209 INFO Generating diagnostic plots...
2025-06-19 12:43:46,627 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:44:48,530 INFO Completed dev evaluation: size=420.0, acc=0.5762
2025-06-19 12:44:48,535 INFO 	Eval, eval loss: 0.7460073232650757, acc: 0.576190, mcc: 0.177302
2025-06-19 12:44:48,690 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:44:48,693 INFO Start graph assembling...
2025-06-19 12:44:51,620 INFO use_dual_path_srl: True
2025-06-19 12:44:51,620 INFO variant_type: hedge
2025-06-19 12:44:51,620 INFO use_enhanced_srl: True
2025-06-19 12:44:51,620 INFO Enhanced SRL enabled from config
2025-06-19 12:44:51,620 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:44:51,620 INFO SRL condition: True = True and True
2025-06-19 12:44:51,620 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:44:51,620 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:44:51,688 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:44:51,695 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:44:51,723 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:44:52,155 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:44:52,155 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:44:52,155 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:44:52,465 INFO Using Temporal Attention (TAP)
2025-06-19 12:44:52,533 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:44:52,534 INFO Ca-TSU enabled: True
2025-06-19 12:44:52,534 INFO Enhanced SRL enabled: True
2025-06-19 12:44:52,534 INFO Noise-Aware Loss enabled: True
2025-06-19 12:44:52,557 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:44:52,557 INFO Adding auxiliary enhancement losses...
2025-06-19 12:44:52,561 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:44:52,578 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-19 12:44:52,580 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:44:52,580 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:44:52,595 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-19 12:44:52,595 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:44:52,595 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:44:56,189 INFO Graph assembled successfully.
2025-06-19 12:45:17,693 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:45:18,322 INFO Word table initialized.
2025-06-19 12:45:18,323 INFO Model: all-hedge-gru_3a0bd0bb, starting new session.
2025-06-19 12:47:56,498 INFO 	iter: 20, batch loss: 1.309832215309143, batch acc: 0.562500
2025-06-19 12:48:21,953 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 12:50:34,734 INFO 	iter: 40, batch loss: 0.9203695058822632, batch acc: 0.593750
2025-06-19 12:51:24,626 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 12:53:13,017 INFO 	iter: 60, batch loss: 0.6691396832466125, batch acc: 0.718750
2025-06-19 12:54:28,077 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 12:54:28,077 INFO Generating diagnostic plots...
2025-06-19 12:54:32,571 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 12:55:35,384 INFO Completed dev evaluation: size=420.0, acc=0.6357
2025-06-19 12:55:35,389 INFO 	Eval, eval loss: 0.7054203748703003, acc: 0.635714, mcc: 0.210309
2025-06-19 12:55:35,542 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 12:55:35,545 INFO Start graph assembling...
2025-06-19 12:55:38,441 INFO use_dual_path_srl: True
2025-06-19 12:55:38,442 INFO variant_type: hedge
2025-06-19 12:55:38,442 INFO use_enhanced_srl: True
2025-06-19 12:55:38,442 INFO Enhanced SRL enabled from config
2025-06-19 12:55:38,442 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 12:55:38,442 INFO SRL condition: True = True and True
2025-06-19 12:55:38,442 INFO Using enhanced dual-path SRL architecture
2025-06-19 12:55:38,442 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 12:55:38,509 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 12:55:38,516 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 12:55:38,544 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 12:55:38,979 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 12:55:38,979 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 12:55:38,979 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 12:55:39,283 INFO Using Temporal Attention (TAP)
2025-06-19 12:55:39,350 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 12:55:39,350 INFO Ca-TSU enabled: True
2025-06-19 12:55:39,350 INFO Enhanced SRL enabled: True
2025-06-19 12:55:39,350 INFO Noise-Aware Loss enabled: True
2025-06-19 12:55:39,372 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 12:55:39,372 INFO Adding auxiliary enhancement losses...
2025-06-19 12:55:39,377 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 12:55:39,394 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08929131695710527
2025-06-19 12:55:39,395 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 12:55:39,395 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 12:55:39,410 INFO Using KL-based Causal Consistency Loss with weight: 0.2428919878528414
2025-06-19 12:55:39,410 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 12:55:39,410 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 12:55:42,954 INFO Graph assembled successfully.
2025-06-19 12:56:04,603 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 12:56:05,217 INFO Word table initialized.
2025-06-19 12:56:05,219 INFO Model: all-hedge-gru_d67bff63, starting new session.
2025-06-19 12:58:42,243 INFO 	iter: 20, batch loss: 1.375049114227295, batch acc: 0.531250
2025-06-19 12:59:07,574 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:01:19,614 INFO 	iter: 40, batch loss: 0.9684948921203613, batch acc: 0.562500
2025-06-19 13:02:10,234 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:03:56,967 INFO 	iter: 60, batch loss: 0.9337737560272217, batch acc: 0.468750
2025-06-19 13:05:13,014 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:05:13,015 INFO Generating diagnostic plots...
2025-06-19 13:05:17,394 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 13:06:19,802 INFO Completed dev evaluation: size=420.0, acc=0.4119
2025-06-19 13:06:19,808 INFO 	Eval, eval loss: 0.9286546111106873, acc: 0.411905, mcc: 0.069574
2025-06-19 13:06:19,961 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 13:06:19,963 INFO Start graph assembling...
2025-06-19 13:06:22,845 INFO use_dual_path_srl: True
2025-06-19 13:06:22,845 INFO variant_type: hedge
2025-06-19 13:06:22,845 INFO use_enhanced_srl: True
2025-06-19 13:06:22,845 INFO Enhanced SRL enabled from config
2025-06-19 13:06:22,845 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 13:06:22,845 INFO SRL condition: True = True and True
2025-06-19 13:06:22,845 INFO Using enhanced dual-path SRL architecture
2025-06-19 13:06:22,845 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 13:06:22,912 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 13:06:22,919 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 13:06:22,947 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 13:06:23,371 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 13:06:23,372 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 13:06:23,372 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 13:06:23,678 INFO Using Temporal Attention (TAP)
2025-06-19 13:06:23,744 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 13:06:23,744 INFO Ca-TSU enabled: True
2025-06-19 13:06:23,744 INFO Enhanced SRL enabled: True
2025-06-19 13:06:23,744 INFO Noise-Aware Loss enabled: True
2025-06-19 13:06:23,766 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 13:06:23,767 INFO Adding auxiliary enhancement losses...
2025-06-19 13:06:23,771 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 13:06:23,788 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5212222828985212
2025-06-19 13:06:23,789 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 13:06:23,789 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 13:06:23,804 INFO Using KL-based Causal Consistency Loss with weight: 0.6007158833055048
2025-06-19 13:06:23,804 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 13:06:23,804 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 13:06:27,353 INFO Graph assembled successfully.
2025-06-19 13:06:49,092 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 13:06:49,707 INFO Word table initialized.
2025-06-19 13:06:49,708 INFO Model: all-hedge-gru_2127f206, starting new session.
2025-06-19 13:09:28,378 INFO 	iter: 20, batch loss: 1.3450732231140137, batch acc: 0.593750
2025-06-19 13:09:53,623 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:12:06,921 INFO 	iter: 40, batch loss: 0.965986430644989, batch acc: 0.562500
2025-06-19 13:12:57,015 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:14:44,308 INFO 	iter: 60, batch loss: 0.8855777978897095, batch acc: 0.531250
2025-06-19 13:16:00,121 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:16:00,122 INFO Generating diagnostic plots...
2025-06-19 13:16:04,630 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 13:17:06,245 INFO Completed dev evaluation: size=420.0, acc=0.5786
2025-06-19 13:17:06,251 INFO 	Eval, eval loss: 0.7196816802024841, acc: 0.578571, mcc: 0.087169
2025-06-19 13:17:06,406 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 13:17:06,409 INFO Start graph assembling...
2025-06-19 13:17:09,349 INFO use_dual_path_srl: True
2025-06-19 13:17:09,349 INFO variant_type: hedge
2025-06-19 13:17:09,349 INFO use_enhanced_srl: True
2025-06-19 13:17:09,350 INFO Enhanced SRL enabled from config
2025-06-19 13:17:09,350 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 13:17:09,350 INFO SRL condition: True = True and True
2025-06-19 13:17:09,350 INFO Using enhanced dual-path SRL architecture
2025-06-19 13:17:09,350 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 13:17:09,417 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 13:17:09,424 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 13:17:09,452 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 13:17:09,889 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 13:17:09,889 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 13:17:09,889 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 13:17:10,197 INFO Using Temporal Attention (TAP)
2025-06-19 13:17:10,265 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 13:17:10,265 INFO Ca-TSU enabled: True
2025-06-19 13:17:10,265 INFO Enhanced SRL enabled: True
2025-06-19 13:17:10,265 INFO Noise-Aware Loss enabled: True
2025-06-19 13:17:10,287 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 13:17:10,288 INFO Adding auxiliary enhancement losses...
2025-06-19 13:17:10,292 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 13:17:10,309 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.24517745893819773
2025-06-19 13:17:10,311 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 13:17:10,311 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 13:17:10,325 INFO Using KL-based Causal Consistency Loss with weight: 0.6644015899876377
2025-06-19 13:17:10,326 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 13:17:10,326 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 13:17:13,910 INFO Graph assembled successfully.
2025-06-19 13:17:35,573 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 13:17:36,202 INFO Word table initialized.
2025-06-19 13:17:36,203 INFO Model: all-hedge-gru_f0126741, starting new session.
2025-06-19 13:20:14,675 INFO 	iter: 20, batch loss: 1.3434795141220093, batch acc: 0.687500
2025-06-19 13:20:40,104 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:22:53,607 INFO 	iter: 40, batch loss: 1.026621699333191, batch acc: 0.593750
2025-06-19 13:23:43,711 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:25:32,936 INFO 	iter: 60, batch loss: 0.8233494758605957, batch acc: 0.562500
2025-06-19 13:26:49,071 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:26:49,072 INFO Generating diagnostic plots...
2025-06-19 13:26:53,709 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 13:27:56,327 INFO Completed dev evaluation: size=420.0, acc=0.5643
2025-06-19 13:27:56,333 INFO 	Eval, eval loss: 0.7249206304550171, acc: 0.564286, mcc: 0.047211
2025-06-19 13:27:56,499 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 13:27:56,501 INFO Start graph assembling...
2025-06-19 13:27:59,426 INFO use_dual_path_srl: True
2025-06-19 13:27:59,426 INFO variant_type: hedge
2025-06-19 13:27:59,426 INFO use_enhanced_srl: True
2025-06-19 13:27:59,426 INFO Enhanced SRL enabled from config
2025-06-19 13:27:59,426 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 13:27:59,427 INFO SRL condition: True = True and True
2025-06-19 13:27:59,427 INFO Using enhanced dual-path SRL architecture
2025-06-19 13:27:59,427 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 13:27:59,494 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 13:27:59,501 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 13:27:59,530 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 13:27:59,974 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 13:27:59,974 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 13:27:59,974 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 13:28:00,283 INFO Using Temporal Attention (TAP)
2025-06-19 13:28:00,350 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 13:28:00,350 INFO Ca-TSU enabled: True
2025-06-19 13:28:00,350 INFO Enhanced SRL enabled: True
2025-06-19 13:28:00,350 INFO Noise-Aware Loss enabled: True
2025-06-19 13:28:00,373 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 13:28:00,373 INFO Adding auxiliary enhancement losses...
2025-06-19 13:28:00,378 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 13:28:00,395 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.33171546163368704
2025-06-19 13:28:00,396 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 13:28:00,396 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 13:28:00,411 INFO Using KL-based Causal Consistency Loss with weight: 0.11102038207315187
2025-06-19 13:28:00,411 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 13:28:00,411 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 13:28:03,992 INFO Graph assembled successfully.
2025-06-19 13:28:25,688 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 13:28:26,314 INFO Word table initialized.
2025-06-19 13:28:26,338 INFO Model: all-hedge-gru_3cec274e, starting new session.
2025-06-19 13:31:04,475 INFO 	iter: 20, batch loss: 1.2634888887405396, batch acc: 0.656250
2025-06-19 13:31:30,090 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:33:46,900 INFO 	iter: 40, batch loss: 0.9917638897895813, batch acc: 0.562500
2025-06-19 13:34:37,769 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:36:24,661 INFO 	iter: 60, batch loss: 0.8038924932479858, batch acc: 0.562500
2025-06-19 13:37:47,750 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:37:47,751 INFO Generating diagnostic plots...
2025-06-19 13:37:52,225 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 13:38:54,717 INFO Completed dev evaluation: size=420.0, acc=0.4714
2025-06-19 13:38:54,724 INFO 	Eval, eval loss: 0.789264440536499, acc: 0.471429, mcc: 0.008750
2025-06-19 13:38:54,888 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 13:38:54,890 INFO Start graph assembling...
2025-06-19 13:38:57,781 INFO use_dual_path_srl: True
2025-06-19 13:38:57,781 INFO variant_type: hedge
2025-06-19 13:38:57,781 INFO use_enhanced_srl: True
2025-06-19 13:38:57,781 INFO Enhanced SRL enabled from config
2025-06-19 13:38:57,781 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 13:38:57,781 INFO SRL condition: True = True and True
2025-06-19 13:38:57,782 INFO Using enhanced dual-path SRL architecture
2025-06-19 13:38:57,782 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 13:38:57,848 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 13:38:57,855 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 13:38:57,883 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 13:38:58,318 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 13:38:58,318 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 13:38:58,319 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 13:38:58,626 INFO Using Temporal Attention (TAP)
2025-06-19 13:38:58,693 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 13:38:58,693 INFO Ca-TSU enabled: True
2025-06-19 13:38:58,693 INFO Enhanced SRL enabled: True
2025-06-19 13:38:58,693 INFO Noise-Aware Loss enabled: True
2025-06-19 13:38:58,715 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 13:38:58,715 INFO Adding auxiliary enhancement losses...
2025-06-19 13:38:58,720 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 13:38:58,737 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3911418454058088
2025-06-19 13:38:58,738 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 13:38:58,738 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 13:38:58,753 INFO Using KL-based Causal Consistency Loss with weight: 1.6601962464321112
2025-06-19 13:38:58,753 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 13:38:58,753 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 13:39:02,311 INFO Graph assembled successfully.
2025-06-19 13:39:24,063 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 13:39:24,696 INFO Word table initialized.
2025-06-19 13:39:24,698 INFO Model: all-hedge-gru_e4a83390, starting new session.
2025-06-19 13:42:04,273 INFO 	iter: 20, batch loss: 1.3240315914154053, batch acc: 0.625000
2025-06-19 13:42:29,664 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:44:42,591 INFO 	iter: 40, batch loss: 0.952080249786377, batch acc: 0.500000
2025-06-19 13:45:33,120 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:47:20,063 INFO 	iter: 60, batch loss: 0.8389456868171692, batch acc: 0.437500
2025-06-19 13:48:37,084 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:48:37,085 INFO Generating diagnostic plots...
2025-06-19 13:48:41,498 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 13:49:43,877 INFO Completed dev evaluation: size=420.0, acc=0.4952
2025-06-19 13:49:43,883 INFO 	Eval, eval loss: 0.7748335599899292, acc: 0.495238, mcc: 0.021716
2025-06-19 13:49:44,034 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 13:49:44,036 INFO Start graph assembling...
2025-06-19 13:49:46,969 INFO use_dual_path_srl: True
2025-06-19 13:49:46,970 INFO variant_type: hedge
2025-06-19 13:49:46,970 INFO use_enhanced_srl: True
2025-06-19 13:49:46,970 INFO Enhanced SRL enabled from config
2025-06-19 13:49:46,970 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 13:49:46,970 INFO SRL condition: True = True and True
2025-06-19 13:49:46,970 INFO Using enhanced dual-path SRL architecture
2025-06-19 13:49:46,970 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 13:49:47,038 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 13:49:47,045 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 13:49:47,073 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 13:49:47,514 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 13:49:47,514 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 13:49:47,514 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 13:49:47,832 INFO Using Temporal Attention (TAP)
2025-06-19 13:49:47,899 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 13:49:47,899 INFO Ca-TSU enabled: True
2025-06-19 13:49:47,899 INFO Enhanced SRL enabled: True
2025-06-19 13:49:47,899 INFO Noise-Aware Loss enabled: True
2025-06-19 13:49:47,922 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 13:49:47,922 INFO Adding auxiliary enhancement losses...
2025-06-19 13:49:47,926 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 13:49:47,943 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.08516545365403388
2025-06-19 13:49:47,944 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 13:49:47,945 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 13:49:47,959 INFO Using KL-based Causal Consistency Loss with weight: 0.3620501074546032
2025-06-19 13:49:47,959 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 13:49:47,960 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 13:49:51,561 INFO Graph assembled successfully.
2025-06-19 13:50:13,478 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 13:50:14,102 INFO Word table initialized.
2025-06-19 13:50:14,109 INFO Model: all-hedge-gru_83b083ad, starting new session.
2025-06-19 13:52:50,772 INFO 	iter: 20, batch loss: 1.3479074239730835, batch acc: 0.500000
2025-06-19 13:53:15,664 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 13:55:27,607 INFO 	iter: 40, batch loss: 0.9804925322532654, batch acc: 0.562500
2025-06-19 13:56:17,341 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 13:58:04,057 INFO 	iter: 60, batch loss: 0.8636817336082458, batch acc: 0.562500
2025-06-19 13:59:18,921 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 13:59:18,921 INFO Generating diagnostic plots...
2025-06-19 13:59:23,395 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:00:25,674 INFO Completed dev evaluation: size=420.0, acc=0.5214
2025-06-19 14:00:25,679 INFO 	Eval, eval loss: 0.7713229656219482, acc: 0.521429, mcc: 0.047381
2025-06-19 14:00:25,827 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:00:25,829 INFO Start graph assembling...
2025-06-19 14:00:28,791 INFO use_dual_path_srl: True
2025-06-19 14:00:28,791 INFO variant_type: hedge
2025-06-19 14:00:28,791 INFO use_enhanced_srl: True
2025-06-19 14:00:28,791 INFO Enhanced SRL enabled from config
2025-06-19 14:00:28,791 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:00:28,791 INFO SRL condition: True = True and True
2025-06-19 14:00:28,792 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:00:28,792 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:00:28,859 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:00:28,866 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:00:28,895 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:00:29,332 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:00:29,332 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:00:29,332 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:00:29,646 INFO Using Temporal Attention (TAP)
2025-06-19 14:00:29,715 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:00:29,715 INFO Ca-TSU enabled: True
2025-06-19 14:00:29,715 INFO Enhanced SRL enabled: True
2025-06-19 14:00:29,715 INFO Noise-Aware Loss enabled: True
2025-06-19 14:00:29,738 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:00:29,739 INFO Adding auxiliary enhancement losses...
2025-06-19 14:00:29,743 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:00:29,761 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2630882746689972
2025-06-19 14:00:29,762 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:00:29,762 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:00:29,778 INFO Using KL-based Causal Consistency Loss with weight: 1.7546974047765171
2025-06-19 14:00:29,778 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:00:29,778 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:00:33,360 INFO Graph assembled successfully.
2025-06-19 14:00:54,857 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:00:55,508 INFO Word table initialized.
2025-06-19 14:00:55,510 INFO Model: all-hedge-gru_5f7af1fb, starting new session.
2025-06-19 14:03:32,691 INFO 	iter: 20, batch loss: 1.33028244972229, batch acc: 0.625000
2025-06-19 14:03:58,069 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 14:06:11,116 INFO 	iter: 40, batch loss: 1.0209399461746216, batch acc: 0.500000
2025-06-19 14:07:01,183 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 14:08:48,829 INFO 	iter: 60, batch loss: 0.8492998480796814, batch acc: 0.531250
2025-06-19 14:10:04,912 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 14:10:04,913 INFO Generating diagnostic plots...
2025-06-19 14:10:09,231 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:11:11,406 INFO Completed dev evaluation: size=420.0, acc=0.5381
2025-06-19 14:11:11,412 INFO 	Eval, eval loss: 0.7343471050262451, acc: 0.538095, mcc: 0.020771
2025-06-19 14:11:11,577 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:11:11,580 INFO Start graph assembling...
2025-06-19 14:11:14,464 INFO use_dual_path_srl: True
2025-06-19 14:11:14,464 INFO variant_type: hedge
2025-06-19 14:11:14,464 INFO use_enhanced_srl: True
2025-06-19 14:11:14,465 INFO Enhanced SRL enabled from config
2025-06-19 14:11:14,465 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:11:14,465 INFO SRL condition: True = True and True
2025-06-19 14:11:14,465 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:11:14,465 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:11:14,532 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:11:14,539 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:11:14,567 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:11:15,004 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:11:15,004 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:11:15,004 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:11:15,309 INFO Using Temporal Attention (TAP)
2025-06-19 14:11:15,375 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:11:15,375 INFO Ca-TSU enabled: True
2025-06-19 14:11:15,375 INFO Enhanced SRL enabled: True
2025-06-19 14:11:15,375 INFO Noise-Aware Loss enabled: True
2025-06-19 14:11:15,398 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:11:15,398 INFO Adding auxiliary enhancement losses...
2025-06-19 14:11:15,402 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:11:15,419 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.09355284200532481
2025-06-19 14:11:15,420 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:11:15,420 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:11:15,435 INFO Using KL-based Causal Consistency Loss with weight: 0.15908585753607637
2025-06-19 14:11:15,435 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:11:15,435 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:11:18,975 INFO Graph assembled successfully.
2025-06-19 14:11:40,489 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:11:41,137 INFO Word table initialized.
2025-06-19 14:11:41,242 INFO Model: all-hedge-gru_81255145, starting new session.
2025-06-19 14:14:16,280 INFO 	iter: 20, batch loss: 1.2795777320861816, batch acc: 0.625000
2025-06-19 14:14:41,519 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 14:16:51,777 INFO 	iter: 40, batch loss: 0.9982907176017761, batch acc: 0.593750
2025-06-19 14:17:40,866 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 14:19:26,711 INFO 	iter: 60, batch loss: 0.8360840082168579, batch acc: 0.406250
2025-06-19 14:20:40,665 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 14:20:40,666 INFO Generating diagnostic plots...
2025-06-19 14:20:45,045 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:21:47,567 INFO Completed dev evaluation: size=420.0, acc=0.4643
2025-06-19 14:21:47,572 INFO 	Eval, eval loss: 0.8009223341941833, acc: 0.464286, mcc: -0.028072
2025-06-19 14:21:47,717 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:21:47,719 INFO Start graph assembling...
2025-06-19 14:21:50,638 INFO use_dual_path_srl: True
2025-06-19 14:21:50,638 INFO variant_type: hedge
2025-06-19 14:21:50,638 INFO use_enhanced_srl: True
2025-06-19 14:21:50,638 INFO Enhanced SRL enabled from config
2025-06-19 14:21:50,638 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:21:50,639 INFO SRL condition: True = True and True
2025-06-19 14:21:50,639 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:21:50,639 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:21:50,706 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:21:50,713 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:21:50,742 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:21:51,175 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:21:51,176 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:21:51,176 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:21:51,485 INFO Using Temporal Attention (TAP)
2025-06-19 14:21:51,552 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:21:51,552 INFO Ca-TSU enabled: True
2025-06-19 14:21:51,552 INFO Enhanced SRL enabled: True
2025-06-19 14:21:51,552 INFO Noise-Aware Loss enabled: True
2025-06-19 14:21:51,575 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:21:51,575 INFO Adding auxiliary enhancement losses...
2025-06-19 14:21:51,580 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:21:51,597 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.10434697317522343
2025-06-19 14:21:51,598 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:21:51,598 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:21:51,613 INFO Using KL-based Causal Consistency Loss with weight: 0.4517067761266502
2025-06-19 14:21:51,614 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:21:51,614 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:21:55,198 INFO Graph assembled successfully.
2025-06-19 14:22:16,792 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:22:17,428 INFO Word table initialized.
2025-06-19 14:22:17,430 INFO Model: all-hedge-gru_e8e0d56a, starting new session.
2025-06-19 14:24:56,011 INFO 	iter: 20, batch loss: 1.340641975402832, batch acc: 0.593750
2025-06-19 14:25:21,580 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 14:27:34,633 INFO 	iter: 40, batch loss: 0.8898907899856567, batch acc: 0.656250
2025-06-19 14:28:25,166 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 14:30:12,718 INFO 	iter: 60, batch loss: 0.8511345982551575, batch acc: 0.500000
2025-06-19 14:31:29,298 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 14:31:29,298 INFO Generating diagnostic plots...
2025-06-19 14:31:33,761 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:32:35,092 INFO Completed dev evaluation: size=420.0, acc=0.5238
2025-06-19 14:32:35,097 INFO 	Eval, eval loss: 0.7672249674797058, acc: 0.523810, mcc: 0.011047
2025-06-19 14:32:35,253 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:32:35,256 INFO Start graph assembling...
2025-06-19 14:32:38,182 INFO use_dual_path_srl: True
2025-06-19 14:32:38,182 INFO variant_type: hedge
2025-06-19 14:32:38,182 INFO use_enhanced_srl: True
2025-06-19 14:32:38,183 INFO Enhanced SRL enabled from config
2025-06-19 14:32:38,183 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:32:38,183 INFO SRL condition: True = True and True
2025-06-19 14:32:38,183 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:32:38,183 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:32:38,251 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:32:38,257 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:32:38,286 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:32:38,730 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:32:38,731 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:32:38,731 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:32:39,041 INFO Using Temporal Attention (TAP)
2025-06-19 14:32:39,108 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:32:39,108 INFO Ca-TSU enabled: True
2025-06-19 14:32:39,108 INFO Enhanced SRL enabled: True
2025-06-19 14:32:39,108 INFO Noise-Aware Loss enabled: True
2025-06-19 14:32:39,130 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:32:39,130 INFO Adding auxiliary enhancement losses...
2025-06-19 14:32:39,135 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:32:39,152 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.15361214251985536
2025-06-19 14:32:39,153 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:32:39,153 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:32:39,168 INFO Using KL-based Causal Consistency Loss with weight: 0.11237836746756258
2025-06-19 14:32:39,168 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:32:39,168 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:32:42,751 INFO Graph assembled successfully.
2025-06-19 14:33:04,772 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:33:05,428 INFO Word table initialized.
2025-06-19 14:33:05,430 INFO Model: all-hedge-gru_803a301e, starting new session.
2025-06-19 14:35:44,618 INFO 	iter: 20, batch loss: 1.3472777605056763, batch acc: 0.406250
2025-06-19 14:36:09,939 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 14:38:23,507 INFO 	iter: 40, batch loss: 0.9985470175743103, batch acc: 0.437500
2025-06-19 14:39:13,742 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 14:41:01,705 INFO 	iter: 60, batch loss: 0.7930002808570862, batch acc: 0.718750
2025-06-19 14:42:17,972 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 14:42:17,972 INFO Generating diagnostic plots...
2025-06-19 14:42:22,340 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:43:24,732 INFO Completed dev evaluation: size=420.0, acc=0.5714
2025-06-19 14:43:24,738 INFO 	Eval, eval loss: 0.7166511416435242, acc: 0.571429, mcc: 0.074743
2025-06-19 14:43:24,897 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:43:24,899 INFO Start graph assembling...
2025-06-19 14:43:27,830 INFO use_dual_path_srl: True
2025-06-19 14:43:27,831 INFO variant_type: hedge
2025-06-19 14:43:27,831 INFO use_enhanced_srl: True
2025-06-19 14:43:27,831 INFO Enhanced SRL enabled from config
2025-06-19 14:43:27,831 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:43:27,831 INFO SRL condition: True = True and True
2025-06-19 14:43:27,831 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:43:27,831 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:43:27,899 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:43:27,906 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:43:27,934 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:43:28,369 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:43:28,369 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:43:28,369 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:43:28,678 INFO Using Temporal Attention (TAP)
2025-06-19 14:43:28,746 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:43:28,746 INFO Ca-TSU enabled: True
2025-06-19 14:43:28,746 INFO Enhanced SRL enabled: True
2025-06-19 14:43:28,746 INFO Noise-Aware Loss enabled: True
2025-06-19 14:43:28,769 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:43:28,769 INFO Adding auxiliary enhancement losses...
2025-06-19 14:43:28,774 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:43:28,791 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.9356181469078707
2025-06-19 14:43:28,792 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:43:28,792 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:43:28,807 INFO Using KL-based Causal Consistency Loss with weight: 0.2827355415607534
2025-06-19 14:43:28,807 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:43:28,807 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:43:32,400 INFO Graph assembled successfully.
2025-06-19 14:43:54,020 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:43:54,657 INFO Word table initialized.
2025-06-19 14:43:54,658 INFO Model: all-hedge-gru_82294800, starting new session.
2025-06-19 14:46:35,171 INFO 	iter: 20, batch loss: 1.3108611106872559, batch acc: 0.531250
2025-06-19 14:47:01,186 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 14:49:15,792 INFO 	iter: 40, batch loss: 0.942633867263794, batch acc: 0.531250
2025-06-19 14:50:07,029 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 14:51:56,106 INFO 	iter: 60, batch loss: 0.8177300095558167, batch acc: 0.593750
2025-06-19 14:53:13,324 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 14:53:13,324 INFO Generating diagnostic plots...
2025-06-19 14:53:17,842 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 14:54:18,909 INFO Completed dev evaluation: size=420.0, acc=0.4548
2025-06-19 14:54:18,914 INFO 	Eval, eval loss: 0.7935209274291992, acc: 0.454762, mcc: -0.126572
2025-06-19 14:54:19,071 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 14:54:19,073 INFO Start graph assembling...
2025-06-19 14:54:22,007 INFO use_dual_path_srl: True
2025-06-19 14:54:22,007 INFO variant_type: hedge
2025-06-19 14:54:22,007 INFO use_enhanced_srl: True
2025-06-19 14:54:22,007 INFO Enhanced SRL enabled from config
2025-06-19 14:54:22,008 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 14:54:22,008 INFO SRL condition: True = True and True
2025-06-19 14:54:22,008 INFO Using enhanced dual-path SRL architecture
2025-06-19 14:54:22,008 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 14:54:22,076 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 14:54:22,082 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 14:54:22,111 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 14:54:22,544 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 14:54:22,544 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 14:54:22,544 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 14:54:22,855 INFO Using Temporal Attention (TAP)
2025-06-19 14:54:22,924 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 14:54:22,924 INFO Ca-TSU enabled: True
2025-06-19 14:54:22,924 INFO Enhanced SRL enabled: True
2025-06-19 14:54:22,924 INFO Noise-Aware Loss enabled: True
2025-06-19 14:54:22,947 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 14:54:22,947 INFO Adding auxiliary enhancement losses...
2025-06-19 14:54:22,952 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 14:54:22,969 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.23182167088095723
2025-06-19 14:54:22,970 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 14:54:22,971 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 14:54:22,985 INFO Using KL-based Causal Consistency Loss with weight: 1.7834640396279804
2025-06-19 14:54:22,986 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 14:54:22,986 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 14:54:26,576 INFO Graph assembled successfully.
2025-06-19 14:54:48,273 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 14:54:48,923 INFO Word table initialized.
2025-06-19 14:54:48,925 INFO Model: all-hedge-gru_199f6c4d, starting new session.
2025-06-19 14:57:30,267 INFO 	iter: 20, batch loss: 1.4017990827560425, batch acc: 0.437500
2025-06-19 14:57:56,049 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:00:10,475 INFO 	iter: 40, batch loss: 0.880842924118042, batch acc: 0.750000
2025-06-19 15:01:01,473 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:02:49,919 INFO 	iter: 60, batch loss: 0.8574463725090027, batch acc: 0.500000
2025-06-19 15:04:06,715 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:04:06,715 INFO Generating diagnostic plots...
2025-06-19 15:04:11,236 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:05:12,418 INFO Completed dev evaluation: size=420.0, acc=0.5500
2025-06-19 15:05:12,424 INFO 	Eval, eval loss: 0.7425063848495483, acc: 0.550000, mcc: 0.068814
2025-06-19 15:05:12,581 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:05:12,583 INFO Start graph assembling...
2025-06-19 15:05:15,495 INFO use_dual_path_srl: True
2025-06-19 15:05:15,495 INFO variant_type: hedge
2025-06-19 15:05:15,496 INFO use_enhanced_srl: True
2025-06-19 15:05:15,496 INFO Enhanced SRL enabled from config
2025-06-19 15:05:15,496 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:05:15,496 INFO SRL condition: True = True and True
2025-06-19 15:05:15,496 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:05:15,496 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:05:15,564 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:05:15,570 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:05:15,599 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:05:16,038 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:05:16,039 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:05:16,039 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:05:16,348 INFO Using Temporal Attention (TAP)
2025-06-19 15:05:16,415 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:05:16,415 INFO Ca-TSU enabled: True
2025-06-19 15:05:16,415 INFO Enhanced SRL enabled: True
2025-06-19 15:05:16,415 INFO Noise-Aware Loss enabled: True
2025-06-19 15:05:16,437 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:05:16,438 INFO Adding auxiliary enhancement losses...
2025-06-19 15:05:16,442 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:05:16,459 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.30686993693747744
2025-06-19 15:05:16,460 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:05:16,461 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:05:16,475 INFO Using KL-based Causal Consistency Loss with weight: 0.42908002701380177
2025-06-19 15:05:16,475 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:05:16,476 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:05:20,065 INFO Graph assembled successfully.
2025-06-19 15:05:41,743 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:05:42,366 INFO Word table initialized.
2025-06-19 15:05:42,367 INFO Model: all-hedge-gru_e9edb16f, starting new session.
2025-06-19 15:08:21,660 INFO 	iter: 20, batch loss: 1.3276488780975342, batch acc: 0.468750
2025-06-19 15:08:47,110 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:11:00,694 INFO 	iter: 40, batch loss: 0.9541497230529785, batch acc: 0.375000
2025-06-19 15:11:50,945 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:13:38,200 INFO 	iter: 60, batch loss: 0.7643533945083618, batch acc: 0.750000
2025-06-19 15:14:54,648 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:14:54,648 INFO Generating diagnostic plots...
2025-06-19 15:14:59,129 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:16:02,052 INFO Completed dev evaluation: size=420.0, acc=0.5238
2025-06-19 15:16:02,058 INFO 	Eval, eval loss: 0.7443492412567139, acc: 0.523810, mcc: 0.069294
2025-06-19 15:16:02,220 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:16:02,222 INFO Start graph assembling...
2025-06-19 15:16:05,159 INFO use_dual_path_srl: True
2025-06-19 15:16:05,159 INFO variant_type: hedge
2025-06-19 15:16:05,159 INFO use_enhanced_srl: True
2025-06-19 15:16:05,159 INFO Enhanced SRL enabled from config
2025-06-19 15:16:05,159 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:16:05,159 INFO SRL condition: True = True and True
2025-06-19 15:16:05,159 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:16:05,159 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:16:05,227 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:16:05,233 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:16:05,262 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:16:05,698 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:16:05,698 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:16:05,698 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:16:06,007 INFO Using Temporal Attention (TAP)
2025-06-19 15:16:06,074 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:16:06,074 INFO Ca-TSU enabled: True
2025-06-19 15:16:06,074 INFO Enhanced SRL enabled: True
2025-06-19 15:16:06,074 INFO Noise-Aware Loss enabled: True
2025-06-19 15:16:06,096 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:16:06,097 INFO Adding auxiliary enhancement losses...
2025-06-19 15:16:06,101 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:16:06,118 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.3874382698980548
2025-06-19 15:16:06,119 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:16:06,120 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:16:06,134 INFO Using KL-based Causal Consistency Loss with weight: 0.14221372436899013
2025-06-19 15:16:06,134 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:16:06,134 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:16:09,747 INFO Graph assembled successfully.
2025-06-19 15:16:31,336 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:16:31,970 INFO Word table initialized.
2025-06-19 15:16:31,972 INFO Model: all-hedge-gru_4959470b, starting new session.
2025-06-19 15:19:10,259 INFO 	iter: 20, batch loss: 1.2561838626861572, batch acc: 0.625000
2025-06-19 15:19:35,682 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:21:48,232 INFO 	iter: 40, batch loss: 0.9456474184989929, batch acc: 0.531250
2025-06-19 15:22:38,444 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:24:25,100 INFO 	iter: 60, batch loss: 0.7656357288360596, batch acc: 0.531250
2025-06-19 15:25:40,791 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:25:40,791 INFO Generating diagnostic plots...
2025-06-19 15:25:45,170 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:26:46,542 INFO Completed dev evaluation: size=420.0, acc=0.4786
2025-06-19 15:26:46,547 INFO 	Eval, eval loss: 0.7591302990913391, acc: 0.478571, mcc: 0.069734
2025-06-19 15:26:46,699 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:26:46,701 INFO Start graph assembling...
2025-06-19 15:26:49,614 INFO use_dual_path_srl: True
2025-06-19 15:26:49,614 INFO variant_type: hedge
2025-06-19 15:26:49,614 INFO use_enhanced_srl: True
2025-06-19 15:26:49,614 INFO Enhanced SRL enabled from config
2025-06-19 15:26:49,614 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:26:49,614 INFO SRL condition: True = True and True
2025-06-19 15:26:49,614 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:26:49,614 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:26:49,682 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:26:49,689 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:26:49,717 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:26:50,148 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:26:50,149 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:26:50,149 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:26:50,457 INFO Using Temporal Attention (TAP)
2025-06-19 15:26:50,524 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:26:50,524 INFO Ca-TSU enabled: True
2025-06-19 15:26:50,524 INFO Enhanced SRL enabled: True
2025-06-19 15:26:50,524 INFO Noise-Aware Loss enabled: True
2025-06-19 15:26:50,547 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:26:50,547 INFO Adding auxiliary enhancement losses...
2025-06-19 15:26:50,552 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:26:50,568 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.9847279850252096
2025-06-19 15:26:50,570 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:26:50,570 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:26:50,585 INFO Using KL-based Causal Consistency Loss with weight: 0.14562378574091087
2025-06-19 15:26:50,585 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:26:50,585 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:26:54,162 INFO Graph assembled successfully.
2025-06-19 15:27:15,868 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:27:16,487 INFO Word table initialized.
2025-06-19 15:27:16,488 INFO Model: all-hedge-gru_ce9836f9, starting new session.
2025-06-19 15:29:56,317 INFO 	iter: 20, batch loss: 1.3549206256866455, batch acc: 0.687500
2025-06-19 15:30:21,999 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:32:35,254 INFO 	iter: 40, batch loss: 0.9815161824226379, batch acc: 0.531250
2025-06-19 15:33:25,424 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:35:12,911 INFO 	iter: 60, batch loss: 0.814351499080658, batch acc: 0.562500
2025-06-19 15:36:29,141 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:36:29,141 INFO Generating diagnostic plots...
2025-06-19 15:36:33,542 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:37:35,838 INFO Completed dev evaluation: size=420.0, acc=0.4833
2025-06-19 15:37:35,843 INFO 	Eval, eval loss: 0.8060951828956604, acc: 0.483333, mcc: -0.037598
2025-06-19 15:37:35,994 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:37:35,996 INFO Start graph assembling...
2025-06-19 15:37:38,926 INFO use_dual_path_srl: True
2025-06-19 15:37:38,926 INFO variant_type: hedge
2025-06-19 15:37:38,926 INFO use_enhanced_srl: True
2025-06-19 15:37:38,926 INFO Enhanced SRL enabled from config
2025-06-19 15:37:38,926 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:37:38,926 INFO SRL condition: True = True and True
2025-06-19 15:37:38,926 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:37:38,927 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:37:38,994 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:37:39,001 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:37:39,030 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:37:39,469 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:37:39,470 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:37:39,470 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:37:39,780 INFO Using Temporal Attention (TAP)
2025-06-19 15:37:39,847 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:37:39,847 INFO Ca-TSU enabled: True
2025-06-19 15:37:39,847 INFO Enhanced SRL enabled: True
2025-06-19 15:37:39,847 INFO Noise-Aware Loss enabled: True
2025-06-19 15:37:39,869 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:37:39,870 INFO Adding auxiliary enhancement losses...
2025-06-19 15:37:39,874 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:37:39,891 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.2901918571624127
2025-06-19 15:37:39,893 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:37:39,893 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:37:39,908 INFO Using KL-based Causal Consistency Loss with weight: 0.17774769504956794
2025-06-19 15:37:39,908 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:37:39,908 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:37:43,490 INFO Graph assembled successfully.
2025-06-19 15:38:05,142 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:38:05,770 INFO Word table initialized.
2025-06-19 15:38:05,771 INFO Model: all-hedge-gru_c817933b, starting new session.
2025-06-19 15:40:44,093 INFO 	iter: 20, batch loss: 1.2924250364303589, batch acc: 0.625000
2025-06-19 15:41:09,155 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:43:22,348 INFO 	iter: 40, batch loss: 0.9750772714614868, batch acc: 0.562500
2025-06-19 15:44:12,319 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:45:59,055 INFO 	iter: 60, batch loss: 1.0312962532043457, batch acc: 0.343750
2025-06-19 15:47:16,055 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:47:16,056 INFO Generating diagnostic plots...
2025-06-19 15:47:20,508 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:48:22,895 INFO Completed dev evaluation: size=420.0, acc=0.6000
2025-06-19 15:48:22,900 INFO 	Eval, eval loss: 0.7422834634780884, acc: 0.600000, mcc: 0.063358
2025-06-19 15:48:23,052 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:48:23,054 INFO Start graph assembling...
2025-06-19 15:48:26,016 INFO use_dual_path_srl: True
2025-06-19 15:48:26,016 INFO variant_type: hedge
2025-06-19 15:48:26,016 INFO use_enhanced_srl: True
2025-06-19 15:48:26,016 INFO Enhanced SRL enabled from config
2025-06-19 15:48:26,016 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:48:26,016 INFO SRL condition: True = True and True
2025-06-19 15:48:26,016 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:48:26,016 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:48:26,087 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:48:26,093 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:48:26,123 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:48:26,573 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:48:26,574 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:48:26,574 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:48:26,897 INFO Using Temporal Attention (TAP)
2025-06-19 15:48:26,969 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:48:26,969 INFO Ca-TSU enabled: True
2025-06-19 15:48:26,969 INFO Enhanced SRL enabled: True
2025-06-19 15:48:26,970 INFO Noise-Aware Loss enabled: True
2025-06-19 15:48:26,994 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:48:26,994 INFO Adding auxiliary enhancement losses...
2025-06-19 15:48:27,000 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:48:27,020 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.16965635778781604
2025-06-19 15:48:27,021 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:48:27,021 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:48:27,036 INFO Using KL-based Causal Consistency Loss with weight: 0.7465994632566179
2025-06-19 15:48:27,036 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:48:27,037 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:48:30,745 INFO Graph assembled successfully.
2025-06-19 15:48:52,397 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:48:53,022 INFO Word table initialized.
2025-06-19 15:48:53,023 INFO Model: all-hedge-gru_868e7efd, starting new session.
2025-06-19 15:51:32,482 INFO 	iter: 20, batch loss: 1.2413004636764526, batch acc: 0.750000
2025-06-19 15:51:57,708 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 15:54:11,686 INFO 	iter: 40, batch loss: 0.9364132881164551, batch acc: 0.625000
2025-06-19 15:55:02,250 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 15:56:50,568 INFO 	iter: 60, batch loss: 0.8153368830680847, batch acc: 0.656250
2025-06-19 15:58:06,794 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 15:58:06,796 INFO Generating diagnostic plots...
2025-06-19 15:58:11,212 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 15:59:13,244 INFO Completed dev evaluation: size=420.0, acc=0.5024
2025-06-19 15:59:13,250 INFO 	Eval, eval loss: 0.7695838212966919, acc: 0.502381, mcc: 0.006009
2025-06-19 15:59:13,420 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 15:59:13,422 INFO Start graph assembling...
2025-06-19 15:59:16,383 INFO use_dual_path_srl: True
2025-06-19 15:59:16,383 INFO variant_type: hedge
2025-06-19 15:59:16,383 INFO use_enhanced_srl: True
2025-06-19 15:59:16,383 INFO Enhanced SRL enabled from config
2025-06-19 15:59:16,383 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 15:59:16,383 INFO SRL condition: True = True and True
2025-06-19 15:59:16,383 INFO Using enhanced dual-path SRL architecture
2025-06-19 15:59:16,383 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 15:59:16,451 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 15:59:16,458 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 15:59:16,486 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 15:59:16,938 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 15:59:16,938 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 15:59:16,938 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 15:59:17,255 INFO Using Temporal Attention (TAP)
2025-06-19 15:59:17,324 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 15:59:17,324 INFO Ca-TSU enabled: True
2025-06-19 15:59:17,324 INFO Enhanced SRL enabled: True
2025-06-19 15:59:17,324 INFO Noise-Aware Loss enabled: True
2025-06-19 15:59:17,346 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 15:59:17,347 INFO Adding auxiliary enhancement losses...
2025-06-19 15:59:17,351 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 15:59:17,368 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.07913350921024083
2025-06-19 15:59:17,369 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 15:59:17,370 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 15:59:17,384 INFO Using KL-based Causal Consistency Loss with weight: 0.5672227547083019
2025-06-19 15:59:17,384 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 15:59:17,385 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 15:59:21,007 INFO Graph assembled successfully.
2025-06-19 15:59:42,580 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 15:59:43,202 INFO Word table initialized.
2025-06-19 15:59:43,203 INFO Model: all-hedge-gru_d5a86760, starting new session.
2025-06-19 16:02:22,258 INFO 	iter: 20, batch loss: 1.333106279373169, batch acc: 0.437500
2025-06-19 16:02:47,819 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 16:05:01,777 INFO 	iter: 40, batch loss: 0.9256687760353088, batch acc: 0.500000
2025-06-19 16:05:51,906 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 16:07:40,130 INFO 	iter: 60, batch loss: 0.743549108505249, batch acc: 0.625000
2025-06-19 16:08:56,009 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 16:08:56,009 INFO Generating diagnostic plots...
2025-06-19 16:09:00,333 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 16:10:02,622 INFO Completed dev evaluation: size=420.0, acc=0.5643
2025-06-19 16:10:02,628 INFO 	Eval, eval loss: 0.7438100576400757, acc: 0.564286, mcc: 0.060311
2025-06-19 16:10:02,799 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 16:10:02,802 INFO Start graph assembling...
2025-06-19 16:10:05,731 INFO use_dual_path_srl: True
2025-06-19 16:10:05,731 INFO variant_type: hedge
2025-06-19 16:10:05,731 INFO use_enhanced_srl: True
2025-06-19 16:10:05,731 INFO Enhanced SRL enabled from config
2025-06-19 16:10:05,731 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 16:10:05,731 INFO SRL condition: True = True and True
2025-06-19 16:10:05,732 INFO Using enhanced dual-path SRL architecture
2025-06-19 16:10:05,732 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 16:10:05,799 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 16:10:05,806 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 16:10:05,835 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 16:10:06,269 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 16:10:06,271 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 16:10:06,271 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 16:10:06,579 INFO Using Temporal Attention (TAP)
2025-06-19 16:10:06,648 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 16:10:06,649 INFO Ca-TSU enabled: True
2025-06-19 16:10:06,649 INFO Enhanced SRL enabled: True
2025-06-19 16:10:06,649 INFO Noise-Aware Loss enabled: True
2025-06-19 16:10:06,672 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 16:10:06,672 INFO Adding auxiliary enhancement losses...
2025-06-19 16:10:06,677 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 16:10:06,694 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.06953187890771348
2025-06-19 16:10:06,696 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 16:10:06,696 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 16:10:06,711 INFO Using KL-based Causal Consistency Loss with weight: 0.47973121834100524
2025-06-19 16:10:06,711 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 16:10:06,711 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 16:10:10,412 INFO Graph assembled successfully.
2025-06-19 16:10:32,134 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 16:10:32,770 INFO Word table initialized.
2025-06-19 16:10:32,771 INFO Model: all-hedge-gru_dd1b62ad, starting new session.
2025-06-19 16:13:11,824 INFO 	iter: 20, batch loss: 1.2321715354919434, batch acc: 0.656250
2025-06-19 16:13:37,114 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 16:15:50,346 INFO 	iter: 40, batch loss: 0.9408435225486755, batch acc: 0.593750
2025-06-19 16:16:40,274 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 16:18:26,875 INFO 	iter: 60, batch loss: 0.8132194876670837, batch acc: 0.718750
2025-06-19 16:19:42,410 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 16:19:42,410 INFO Generating diagnostic plots...
2025-06-19 16:19:46,745 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 16:20:49,321 INFO Completed dev evaluation: size=420.0, acc=0.6238
2025-06-19 16:20:49,327 INFO 	Eval, eval loss: 0.7129063010215759, acc: 0.623810, mcc: 0.119410
2025-06-19 16:20:49,487 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 16:20:49,489 INFO Start graph assembling...
2025-06-19 16:20:52,420 INFO use_dual_path_srl: True
2025-06-19 16:20:52,420 INFO variant_type: hedge
2025-06-19 16:20:52,420 INFO use_enhanced_srl: True
2025-06-19 16:20:52,420 INFO Enhanced SRL enabled from config
2025-06-19 16:20:52,420 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 16:20:52,421 INFO SRL condition: True = True and True
2025-06-19 16:20:52,421 INFO Using enhanced dual-path SRL architecture
2025-06-19 16:20:52,421 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 16:20:52,488 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 16:20:52,495 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 16:20:52,523 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 16:20:52,959 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 16:20:52,959 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 16:20:52,959 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 16:20:53,269 INFO Using Temporal Attention (TAP)
2025-06-19 16:20:53,336 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 16:20:53,336 INFO Ca-TSU enabled: True
2025-06-19 16:20:53,336 INFO Enhanced SRL enabled: True
2025-06-19 16:20:53,337 INFO Noise-Aware Loss enabled: True
2025-06-19 16:20:53,359 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 16:20:53,359 INFO Adding auxiliary enhancement losses...
2025-06-19 16:20:53,364 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 16:20:53,381 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.6600668028049939
2025-06-19 16:20:53,382 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 16:20:53,383 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 16:20:53,397 INFO Using KL-based Causal Consistency Loss with weight: 0.6696180235136964
2025-06-19 16:20:53,398 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 16:20:53,398 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 16:20:56,988 INFO Graph assembled successfully.
2025-06-19 16:21:18,594 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 16:21:19,225 INFO Word table initialized.
2025-06-19 16:21:19,225 INFO Model: all-hedge-gru_479f96c9, starting new session.
2025-06-19 16:23:59,226 INFO 	iter: 20, batch loss: 1.3415584564208984, batch acc: 0.500000
2025-06-19 16:24:24,508 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 16:26:37,100 INFO 	iter: 40, batch loss: 0.8971842527389526, batch acc: 0.531250
2025-06-19 16:27:26,922 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 16:29:14,104 INFO 	iter: 60, batch loss: 0.8182615041732788, batch acc: 0.468750
2025-06-19 16:30:29,811 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 16:30:29,811 INFO Generating diagnostic plots...
2025-06-19 16:30:34,275 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 16:31:35,638 INFO Completed dev evaluation: size=420.0, acc=0.5571
2025-06-19 16:31:35,645 INFO 	Eval, eval loss: 0.7357693910598755, acc: 0.557143, mcc: 0.003837
2025-06-19 16:38:22,362 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-19 16:38:22,363 INFO Configuration updated for full run.
2025-06-19 16:38:22,363 INFO   use_dual_path_srl: True
2025-06-19 16:38:22,363 INFO   use_enhanced_srl: True
2025-06-19 16:38:22,363 INFO   use_ca_tsu: True
2025-06-19 16:38:22,363 INFO   use_noise_aware_loss: True
2025-06-19 16:38:22,363 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-19 16:38:22,363 INFO   causal_loss_lambda (for Ca-TSU): 0.3
2025-06-19 16:38:22,363 INFO   noise_aware_weight (for SRL): 0.5
2025-06-19 16:38:22,363 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 16:38:22,365 INFO Start graph assembling...
2025-06-19 16:38:25,036 INFO use_dual_path_srl: True
2025-06-19 16:38:25,036 INFO variant_type: hedge
2025-06-19 16:38:25,036 INFO use_enhanced_srl: True
2025-06-19 16:38:25,036 INFO Enhanced SRL enabled from config
2025-06-19 16:38:25,036 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 16:38:25,036 INFO SRL condition: True = True and True
2025-06-19 16:38:25,037 INFO Using enhanced dual-path SRL architecture
2025-06-19 16:38:25,037 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 16:38:25,106 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 16:38:25,113 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 16:38:25,142 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 16:38:25,491 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 16:38:25,491 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 16:38:25,491 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 16:38:25,870 INFO Using Temporal Attention (TAP)
2025-06-19 16:38:25,938 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 16:38:25,939 INFO Ca-TSU enabled: True
2025-06-19 16:38:25,939 INFO Enhanced SRL enabled: True
2025-06-19 16:38:25,939 INFO Noise-Aware Loss enabled: True
2025-06-19 16:38:25,961 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 16:38:25,961 INFO Adding auxiliary enhancement losses...
2025-06-19 16:38:25,966 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 16:38:25,984 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.5
2025-06-19 16:38:25,985 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 16:38:25,985 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 16:38:26,003 INFO Using KL-based Causal Consistency Loss with weight: 0.3
2025-06-19 16:38:26,003 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 16:38:26,003 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 16:38:29,567 INFO Graph assembled successfully.
2025-06-19 16:38:51,322 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 16:39:15,390 INFO Word table initialized.
2025-06-19 16:39:15,390 INFO Model: all-hedge-gru_fd7f68aa, starting new session.
2025-06-19 16:44:08,519 INFO 	iter: 20, batch loss: 1.2568817138671875, batch acc: 0.687500
2025-06-19 16:47:30,762 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-19 16:47:30,762 INFO Configuration updated for full run.
2025-06-19 16:47:30,762 INFO   use_dual_path_srl: True
2025-06-19 16:47:30,762 INFO   use_enhanced_srl: True
2025-06-19 16:47:30,762 INFO   use_ca_tsu: True
2025-06-19 16:47:30,762 INFO   use_noise_aware_loss: True
2025-06-19 16:47:30,762 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-19 16:47:30,762 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-19 16:47:30,762 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-19 16:47:30,762 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-19 16:47:30,765 INFO Start graph assembling...
2025-06-19 16:47:33,411 INFO use_dual_path_srl: True
2025-06-19 16:47:33,412 INFO variant_type: hedge
2025-06-19 16:47:33,412 INFO use_enhanced_srl: True
2025-06-19 16:47:33,412 INFO Enhanced SRL enabled from config
2025-06-19 16:47:33,412 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-19 16:47:33,412 INFO SRL condition: True = True and True
2025-06-19 16:47:33,412 INFO Using enhanced dual-path SRL architecture
2025-06-19 16:47:33,412 INFO Creating Enhanced Dual-Path SRL module...
2025-06-19 16:47:33,480 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-19 16:47:33,487 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-19 16:47:33,515 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-19 16:47:33,861 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-19 16:47:33,861 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-19 16:47:33,861 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-19 16:47:34,247 INFO Using Temporal Attention (TAP)
2025-06-19 16:47:34,314 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-19 16:47:34,314 INFO Ca-TSU enabled: True
2025-06-19 16:47:34,315 INFO Enhanced SRL enabled: True
2025-06-19 16:47:34,315 INFO Noise-Aware Loss enabled: True
2025-06-19 16:47:34,336 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-19 16:47:34,337 INFO Adding auxiliary enhancement losses...
2025-06-19 16:47:34,341 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-19 16:47:34,358 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-19 16:47:34,359 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-19 16:47:34,360 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-19 16:47:34,374 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-19 16:47:34,374 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-19 16:47:34,374 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-19 16:47:37,901 INFO Graph assembled successfully.
2025-06-19 16:47:59,168 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 16:48:00,529 INFO Word table initialized.
2025-06-19 16:48:00,529 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-19 16:52:14,237 INFO 	iter: 20, batch loss: 1.2653700113296509, batch acc: 0.625000
2025-06-19 16:54:57,908 INFO 	iter: 40, batch loss: 0.9078408479690552, batch acc: 0.656250
2025-06-19 16:57:25,949 INFO 	iter: 60, batch loss: 0.8276029229164124, batch acc: 0.406250
2025-06-19 16:59:47,360 INFO 	iter: 80, batch loss: 0.7213101983070374, batch acc: 0.562500
2025-06-19 17:02:03,701 INFO 	iter: 100, batch loss: 0.7038890719413757, batch acc: 0.656250
2025-06-19 17:04:13,301 INFO 	iter: 120, batch loss: 0.6742438077926636, batch acc: 0.718750
2025-06-19 17:06:17,112 INFO 	iter: 140, batch loss: 0.7066805958747864, batch acc: 0.625000
2025-06-19 17:07:48,731 INFO Epoch 1 finished. Checkpoint saved.
2025-06-19 17:09:12,314 INFO 	iter: 160, batch loss: 0.5728528499603271, batch acc: 0.812500
2025-06-19 17:12:31,031 INFO 	iter: 180, batch loss: 0.3751300573348999, batch acc: 0.968750
2025-06-19 17:15:01,939 INFO 	iter: 200, batch loss: 0.3440283238887787, batch acc: 0.968750
2025-06-19 17:17:17,132 INFO 	iter: 220, batch loss: 0.3526109457015991, batch acc: 0.906250
2025-06-19 17:19:29,632 INFO 	iter: 240, batch loss: 0.4013301134109497, batch acc: 0.781250
2025-06-19 17:21:39,689 INFO 	iter: 260, batch loss: 0.3277072012424469, batch acc: 0.812500
2025-06-19 17:23:43,936 INFO 	iter: 280, batch loss: 0.46256497502326965, batch acc: 0.718750
2025-06-19 17:25:45,856 INFO 	iter: 300, batch loss: 0.4940676689147949, batch acc: 0.656250
2025-06-19 17:26:47,916 INFO Epoch 2 finished. Checkpoint saved.
2025-06-19 17:29:20,493 INFO 	iter: 320, batch loss: 0.3043629825115204, batch acc: 0.875000
2025-06-19 17:32:15,462 INFO 	iter: 340, batch loss: 0.3575200140476227, batch acc: 0.781250
2025-06-19 17:34:41,136 INFO 	iter: 360, batch loss: 0.3556138277053833, batch acc: 0.781250
2025-06-19 17:36:55,659 INFO 	iter: 380, batch loss: 0.3845002055168152, batch acc: 0.781250
2025-06-19 17:39:08,788 INFO 	iter: 400, batch loss: 0.34103909134864807, batch acc: 0.812500
2025-06-19 17:41:17,296 INFO 	iter: 420, batch loss: 0.39481598138809204, batch acc: 0.718750
2025-06-19 17:43:23,176 INFO 	iter: 440, batch loss: 0.6037826538085938, batch acc: 0.656250
2025-06-19 17:45:25,940 INFO 	iter: 460, batch loss: 0.332556813955307, batch acc: 0.812500
2025-06-19 17:45:57,722 INFO Epoch 3 finished. Checkpoint saved.
2025-06-19 17:49:17,933 INFO 	iter: 480, batch loss: 0.32656964659690857, batch acc: 0.750000
2025-06-19 17:52:03,890 INFO 	iter: 500, batch loss: 0.3018750846385956, batch acc: 0.906250
2025-06-19 17:54:28,340 INFO 	iter: 520, batch loss: 0.36091235280036926, batch acc: 0.750000
2025-06-19 17:56:45,078 INFO 	iter: 540, batch loss: 0.2617454528808594, batch acc: 0.812500
2025-06-19 17:58:58,919 INFO 	iter: 560, batch loss: 0.23827862739562988, batch acc: 0.843750
2025-06-19 18:01:07,415 INFO 	iter: 580, batch loss: 0.30338969826698303, batch acc: 0.875000
2025-06-19 18:03:12,523 INFO 	iter: 600, batch loss: 0.3469313681125641, batch acc: 0.812500
2025-06-19 18:05:17,133 INFO 	iter: 620, batch loss: 0.3606541156768799, batch acc: 0.781250
2025-06-19 18:05:18,754 INFO Epoch 4 finished. Checkpoint saved.
2025-06-19 18:09:26,601 INFO 	iter: 640, batch loss: 0.38564568758010864, batch acc: 0.718750
2025-06-19 18:12:03,590 INFO 	iter: 660, batch loss: 0.1336946338415146, batch acc: 0.968750
2025-06-19 18:14:25,474 INFO 	iter: 680, batch loss: 0.241500586271286, batch acc: 0.875000
2025-06-19 18:16:40,951 INFO 	iter: 700, batch loss: 0.27301153540611267, batch acc: 0.781250
2025-06-19 18:18:52,480 INFO 	iter: 720, batch loss: 0.24975401163101196, batch acc: 0.906250
2025-06-19 18:20:59,283 INFO 	iter: 740, batch loss: 0.3899076282978058, batch acc: 0.781250
2025-06-19 18:23:11,554 INFO 	iter: 760, batch loss: 0.41915568709373474, batch acc: 0.718750
2025-06-19 18:24:45,071 INFO Epoch 5 finished. Checkpoint saved.
2025-06-19 18:26:22,387 INFO 	iter: 780, batch loss: 0.27417802810668945, batch acc: 0.843750
2025-06-19 18:29:40,388 INFO 	iter: 800, batch loss: 0.45358243584632874, batch acc: 0.625000
2025-06-19 18:32:10,755 INFO 	iter: 820, batch loss: 0.5529519319534302, batch acc: 0.656250
2025-06-19 18:34:33,197 INFO 	iter: 840, batch loss: 0.23347049951553345, batch acc: 0.875000
2025-06-19 18:36:47,459 INFO 	iter: 860, batch loss: 0.2897842228412628, batch acc: 0.843750
2025-06-19 18:39:00,623 INFO 	iter: 880, batch loss: 0.15112054347991943, batch acc: 0.937500
2025-06-19 18:41:08,256 INFO 	iter: 900, batch loss: 0.2702822983264923, batch acc: 0.843750
2025-06-19 18:43:13,868 INFO 	iter: 920, batch loss: 0.5266435742378235, batch acc: 0.625000
2025-06-19 18:44:17,556 INFO Epoch 6 finished. Checkpoint saved.
2025-06-19 18:46:56,171 INFO 	iter: 940, batch loss: 0.366755872964859, batch acc: 0.781250
2025-06-19 18:49:46,294 INFO 	iter: 960, batch loss: 0.3787934482097626, batch acc: 0.781250
2025-06-19 18:52:14,736 INFO 	iter: 980, batch loss: 0.2918168008327484, batch acc: 0.875000
2025-06-19 18:54:34,678 INFO 	iter: 1000, batch loss: 0.34731724858283997, batch acc: 0.875000
2025-06-19 18:56:49,366 INFO 	iter: 1020, batch loss: 0.2516843378543854, batch acc: 0.875000
2025-06-19 18:59:02,731 INFO 	iter: 1040, batch loss: 0.2826188802719116, batch acc: 0.906250
2025-06-19 19:01:11,353 INFO 	iter: 1060, batch loss: 0.3812471330165863, batch acc: 0.718750
2025-06-19 19:03:18,126 INFO 	iter: 1080, batch loss: 0.2448529154062271, batch acc: 0.843750
2025-06-19 19:03:50,891 INFO Epoch 7 finished. Checkpoint saved.
2025-06-19 19:07:14,999 INFO 	iter: 1100, batch loss: 0.22710855305194855, batch acc: 0.875000
2025-06-19 19:10:00,793 INFO 	iter: 1120, batch loss: 0.28437235951423645, batch acc: 0.843750
2025-06-19 19:12:28,591 INFO 	iter: 1140, batch loss: 0.3955998420715332, batch acc: 0.718750
2025-06-19 19:14:46,275 INFO 	iter: 1160, batch loss: 0.3463082015514374, batch acc: 0.750000
2025-06-19 19:17:04,068 INFO 	iter: 1180, batch loss: 0.3937367796897888, batch acc: 0.750000
2025-06-19 19:19:16,511 INFO 	iter: 1200, batch loss: 0.4270976781845093, batch acc: 0.750000
2025-06-19 19:21:25,053 INFO 	iter: 1220, batch loss: 0.37758564949035645, batch acc: 0.656250
2025-06-19 19:23:32,197 INFO 	iter: 1240, batch loss: 0.22737427055835724, batch acc: 0.875000
2025-06-19 19:23:34,105 INFO Epoch 8 finished. Checkpoint saved.
2025-06-19 19:27:43,911 INFO 	iter: 1260, batch loss: 0.1425178200006485, batch acc: 0.968750
2025-06-19 19:30:21,070 INFO 	iter: 1280, batch loss: 0.2963545322418213, batch acc: 0.843750
2025-06-19 19:32:46,314 INFO 	iter: 1300, batch loss: 0.2775483727455139, batch acc: 0.781250
2025-06-19 19:35:07,318 INFO 	iter: 1320, batch loss: 0.22500483691692352, batch acc: 0.843750
2025-06-19 19:37:24,827 INFO 	iter: 1340, batch loss: 0.3829278349876404, batch acc: 0.781250
2025-06-19 19:39:36,190 INFO 	iter: 1360, batch loss: 0.20822244882583618, batch acc: 0.906250
2025-06-19 19:41:45,227 INFO 	iter: 1380, batch loss: 0.3176593482494354, batch acc: 0.812500
2025-06-19 19:43:22,412 INFO Epoch 9 finished. Checkpoint saved.
2025-06-19 19:44:59,293 INFO 	iter: 1400, batch loss: 0.10458870977163315, batch acc: 0.937500
2025-06-19 19:48:21,022 INFO 	iter: 1420, batch loss: 0.30090364813804626, batch acc: 0.843750
2025-06-19 19:50:57,802 INFO 	iter: 1440, batch loss: 0.3918628394603729, batch acc: 0.718750
2025-06-19 19:53:24,050 INFO 	iter: 1460, batch loss: 0.2868863344192505, batch acc: 0.843750
2025-06-19 19:55:45,374 INFO 	iter: 1480, batch loss: 0.25392451882362366, batch acc: 0.843750
2025-06-19 19:58:02,752 INFO 	iter: 1500, batch loss: 0.38021713495254517, batch acc: 0.718750
2025-06-19 20:00:16,434 INFO 	iter: 1520, batch loss: 0.14861959218978882, batch acc: 0.906250
2025-06-19 20:02:25,453 INFO 	iter: 1540, batch loss: 0.19793404638767242, batch acc: 0.906250
2025-06-19 20:03:31,049 INFO Epoch 10 finished. Checkpoint saved.
2025-06-19 20:03:31,049 INFO Generating diagnostic plots...
2025-06-19 20:03:36,432 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-19 20:05:37,896 INFO Completed dev evaluation: size=656.0, acc=0.9649
2025-06-19 20:05:37,903 INFO 	Eval, eval loss: 0.058413710445165634, acc: 0.964939, mcc: 0.930140
2025-06-19 20:05:58,898 INFO ASSEMBLE: word table #replacement: 19482
2025-06-19 20:06:00,558 INFO Word table init: done!
2025-06-19 20:06:01,010 INFO Model: all-hedge-gru_0c44b12c, session restored from latest checkpoint!
2025-06-19 20:06:01,011 INFO Start test phase...
2025-06-19 20:08:46,271 INFO Completed test evaluation: size=1008.0, acc=0.9335
2025-06-19 20:08:46,278 INFO 	Eval, eval loss: 0.08618289977312088, acc: 0.933532
2025-06-20 05:53:50,062 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 05:53:50,064 INFO Configuration updated for full run.
2025-06-20 05:53:50,064 INFO   use_dual_path_srl: True
2025-06-20 05:53:50,064 INFO   use_enhanced_srl: True
2025-06-20 05:53:50,064 INFO   use_ca_tsu: True
2025-06-20 05:53:50,064 INFO   use_noise_aware_loss: True
2025-06-20 05:53:50,064 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 05:53:50,064 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 05:53:50,064 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 05:53:50,065 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 05:53:50,067 INFO Start graph assembling...
2025-06-20 05:53:51,986 INFO use_dual_path_srl: True
2025-06-20 05:53:51,986 INFO variant_type: hedge
2025-06-20 05:53:51,986 INFO use_enhanced_srl: True
2025-06-20 05:53:51,987 INFO Enhanced SRL enabled from config
2025-06-20 05:53:51,987 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 05:53:51,987 INFO SRL condition: True = True and True
2025-06-20 05:53:51,987 INFO Using enhanced dual-path SRL architecture
2025-06-20 05:53:51,987 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 05:53:52,030 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-20 05:53:52,035 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-20 05:53:52,054 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-20 05:53:52,271 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 05:53:52,271 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 05:53:52,271 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 05:53:52,549 INFO Using Temporal Attention (TAP)
2025-06-20 05:53:52,592 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 05:53:52,592 INFO Ca-TSU enabled: True
2025-06-20 05:53:52,592 INFO Enhanced SRL enabled: True
2025-06-20 05:53:52,592 INFO Noise-Aware Loss enabled: True
2025-06-20 05:53:52,606 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-20 05:53:52,606 INFO Adding auxiliary enhancement losses...
2025-06-20 05:53:52,609 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-20 05:53:52,620 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-20 05:53:52,621 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 05:53:52,621 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 05:53:52,630 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 05:53:52,630 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 05:53:52,630 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 05:53:54,936 INFO Graph assembled successfully.
2025-06-20 05:55:40,690 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 05:56:47,698 INFO Word table init: done!
2025-06-20 05:56:49,439 INFO Model: all-hedge-gru_0c44b12c, session restored from latest checkpoint!
2025-06-20 05:56:49,439 INFO Start test phase...
2025-06-20 05:58:59,790 INFO Completed test evaluation: size=1008.0, acc=0.9444
2025-06-20 05:58:59,795 INFO 	Eval, eval loss: 0.0871400311589241, acc: 0.944444, mcc: 0.889604
2025-06-20 06:03:25,564 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 06:03:25,570 INFO Start graph assembling...
2025-06-20 06:03:44,385 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 06:03:45,807 INFO Word table init: done!
2025-06-20 06:03:45,808 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-20 06:03:45,808 INFO Epoch: 1/10 start
2025-06-20 06:05:26,582 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 06:05:26,584 INFO Start graph assembling...
2025-06-20 06:05:44,828 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 06:05:47,382 INFO Word table init: done!
2025-06-20 06:05:47,383 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-20 06:05:47,383 INFO Epoch: 1/10 start
2025-06-20 06:11:14,309 INFO 	iter: 20, batch loss: 7.668512344360352, batch acc: 0.468750
2025-06-20 06:15:02,309 INFO 	iter: 40, batch loss: 6.690454483032227, batch acc: 0.593750
2025-06-20 06:24:04,674 INFO 	iter: 60, batch loss: 4.49091911315918, batch acc: 0.593750
2025-06-20 06:30:30,658 INFO 	iter: 80, batch loss: 3.1544339656829834, batch acc: 0.531250
2025-06-20 06:32:57,546 INFO 	iter: 100, batch loss: 2.5363519191741943, batch acc: 0.812500
2025-06-20 06:35:24,666 INFO 	iter: 120, batch loss: 2.6880335807800293, batch acc: 0.593750
2025-06-20 06:37:48,414 INFO 	iter: 140, batch loss: 2.3617398738861084, batch acc: 0.531250
2025-06-20 06:39:34,438 INFO Epoch: loss: 4.084288, acc: 0.630040
2025-06-20 06:39:34,439 INFO Epoch: 2/10 start
2025-06-20 06:40:57,854 INFO 	iter: 160, batch loss: 2.125761032104492, batch acc: 0.718750
2025-06-20 06:44:08,187 INFO 	iter: 180, batch loss: 2.3374643325805664, batch acc: 0.562500
2025-06-20 06:46:59,316 INFO 	iter: 200, batch loss: 2.242126941680908, batch acc: 0.531250
2025-06-20 06:55:20,598 INFO 	iter: 220, batch loss: 2.051664352416992, batch acc: 0.531250
2025-06-20 06:58:01,223 INFO 	iter: 240, batch loss: 1.85251784324646, batch acc: 0.625000
2025-06-20 07:00:32,903 INFO 	iter: 260, batch loss: 1.7347097396850586, batch acc: 0.500000
2025-06-20 07:03:00,295 INFO 	iter: 280, batch loss: 1.6138849258422852, batch acc: 0.500000
2025-06-20 07:05:26,641 INFO 	iter: 300, batch loss: 1.517163634300232, batch acc: 0.593750
2025-06-20 07:06:40,808 INFO Epoch: loss: 1.922201, acc: 0.584677
2025-06-20 07:06:40,809 INFO Epoch: 3/10 start
2025-06-20 07:09:21,102 INFO 	iter: 320, batch loss: 1.4927194118499756, batch acc: 0.656250
2025-06-20 07:12:36,117 INFO 	iter: 340, batch loss: 1.373546838760376, batch acc: 0.500000
2025-06-20 07:15:26,229 INFO 	iter: 360, batch loss: 1.346524715423584, batch acc: 0.468750
2025-06-20 07:18:00,049 INFO 	iter: 380, batch loss: 1.2916913032531738, batch acc: 0.562500
2025-06-20 07:20:30,318 INFO 	iter: 400, batch loss: 1.3255205154418945, batch acc: 0.468750
2025-06-20 07:23:01,408 INFO 	iter: 420, batch loss: 1.2746620178222656, batch acc: 0.625000
2025-06-20 07:26:24,164 INFO 	iter: 440, batch loss: 1.286466121673584, batch acc: 0.593750
2025-06-20 07:28:52,832 INFO 	iter: 460, batch loss: 1.2184970378875732, batch acc: 0.531250
2025-06-20 07:29:30,185 INFO Epoch: loss: 1.359476, acc: 0.552419
2025-06-20 07:29:30,185 INFO Epoch: 4/10 start
2025-06-20 07:32:37,867 INFO 	iter: 480, batch loss: 1.2991782426834106, batch acc: 0.281250
2025-06-20 07:35:33,710 INFO 	iter: 500, batch loss: 1.1855504512786865, batch acc: 0.531250
2025-06-20 07:38:13,465 INFO 	iter: 520, batch loss: 1.1854664087295532, batch acc: 0.656250
2025-06-20 07:40:46,225 INFO 	iter: 540, batch loss: 1.1587121486663818, batch acc: 0.593750
2025-06-20 07:43:47,504 INFO 	iter: 560, batch loss: 1.1572377681732178, batch acc: 0.531250
2025-06-20 07:46:48,742 INFO 	iter: 580, batch loss: 1.1690027713775635, batch acc: 0.531250
2025-06-20 07:49:13,820 INFO 	iter: 600, batch loss: 1.1522893905639648, batch acc: 0.625000
2025-06-20 07:51:38,750 INFO 	iter: 620, batch loss: 1.1622358560562134, batch acc: 0.593750
2025-06-20 07:51:41,989 INFO Epoch: loss: 1.201087, acc: 0.531653
2025-06-20 07:51:41,989 INFO Epoch: 5/10 start
2025-06-20 07:56:37,229 INFO 	iter: 640, batch loss: 1.1671664714813232, batch acc: 0.500000
2025-06-20 07:59:27,454 INFO 	iter: 660, batch loss: 1.1692925691604614, batch acc: 0.406250
2025-06-20 08:02:03,906 INFO 	iter: 680, batch loss: 1.176271915435791, batch acc: 0.468750
2025-06-20 08:04:37,597 INFO 	iter: 700, batch loss: 1.038184642791748, batch acc: 0.718750
2025-06-20 08:07:10,604 INFO 	iter: 720, batch loss: 1.1005501747131348, batch acc: 0.625000
2025-06-20 08:09:38,545 INFO 	iter: 740, batch loss: 1.241742491722107, batch acc: 0.437500
2025-06-20 08:12:03,717 INFO 	iter: 760, batch loss: 1.1219604015350342, batch acc: 0.593750
2025-06-20 08:13:52,812 INFO Epoch: loss: 1.134281, acc: 0.541935
2025-06-20 08:13:52,813 INFO Epoch: 6/10 start
2025-06-20 08:15:08,047 INFO 	iter: 780, batch loss: 1.1279795169830322, batch acc: 0.562500
2025-06-20 08:18:31,363 INFO 	iter: 800, batch loss: 1.1163617372512817, batch acc: 0.531250
2025-06-20 08:21:19,460 INFO 	iter: 820, batch loss: 1.1336438655853271, batch acc: 0.468750
2025-06-20 08:24:01,162 INFO 	iter: 840, batch loss: 1.1020584106445312, batch acc: 0.500000
2025-06-20 08:27:37,526 INFO 	iter: 860, batch loss: 1.1065456867218018, batch acc: 0.500000
2025-06-20 08:30:07,951 INFO 	iter: 880, batch loss: 1.1309393644332886, batch acc: 0.531250
2025-06-20 08:32:35,835 INFO 	iter: 900, batch loss: 1.0684356689453125, batch acc: 0.562500
2025-06-20 08:35:01,328 INFO 	iter: 920, batch loss: 1.0370006561279297, batch acc: 0.718750
2025-06-20 08:36:15,979 INFO Epoch: loss: 1.106929, acc: 0.536290
2025-06-20 08:36:15,980 INFO Epoch: 7/10 start
2025-06-20 08:38:35,139 INFO 	iter: 940, batch loss: 1.0320929288864136, batch acc: 0.718750
2025-06-20 08:41:57,472 INFO 	iter: 960, batch loss: 1.0744941234588623, batch acc: 0.500000
2025-06-20 08:44:47,213 INFO 	iter: 980, batch loss: 1.1006032228469849, batch acc: 0.531250
2025-06-20 08:47:30,142 INFO 	iter: 1000, batch loss: 1.0955383777618408, batch acc: 0.531250
2025-06-20 08:50:10,081 INFO 	iter: 1020, batch loss: 1.0827972888946533, batch acc: 0.562500
2025-06-20 08:52:46,976 INFO 	iter: 1040, batch loss: 1.1025665998458862, batch acc: 0.531250
2025-06-20 08:55:21,419 INFO 	iter: 1060, batch loss: 1.074103832244873, batch acc: 0.500000
2025-06-20 08:58:50,205 INFO 	iter: 1080, batch loss: 1.0930218696594238, batch acc: 0.468750
2025-06-20 09:00:05,162 INFO Epoch: loss: 1.086499, acc: 0.549395
2025-06-20 09:00:05,162 INFO Epoch: 8/10 start
2025-06-20 09:03:20,983 INFO 	iter: 1100, batch loss: 1.069338083267212, batch acc: 0.531250
2025-06-20 09:06:24,288 INFO 	iter: 1120, batch loss: 1.0672169923782349, batch acc: 0.687500
2025-06-20 09:09:20,657 INFO 	iter: 1140, batch loss: 1.164324402809143, batch acc: 0.406250
2025-06-20 09:12:02,241 INFO 	iter: 1160, batch loss: 1.043829321861267, batch acc: 0.625000
2025-06-20 09:14:40,199 INFO 	iter: 1180, batch loss: 1.0350502729415894, batch acc: 0.531250
2025-06-20 09:17:14,920 INFO 	iter: 1200, batch loss: 1.0890529155731201, batch acc: 0.531250
2025-06-20 09:19:47,317 INFO 	iter: 1220, batch loss: 1.045263409614563, batch acc: 0.593750
2025-06-20 09:23:04,478 INFO 	iter: 1240, batch loss: 1.1067873239517212, batch acc: 0.468750
2025-06-20 09:23:07,541 INFO Epoch: loss: 1.081075, acc: 0.539718
2025-06-20 09:23:07,541 INFO Epoch: 9/10 start
2025-06-20 09:27:08,778 INFO 	iter: 1260, batch loss: 1.0525877475738525, batch acc: 0.656250
2025-06-20 09:32:26,754 INFO 	iter: 1280, batch loss: 1.092781662940979, batch acc: 0.437500
2025-06-20 09:37:08,773 INFO 	iter: 1300, batch loss: 1.0816550254821777, batch acc: 0.593750
2025-06-20 09:41:24,260 INFO 	iter: 1320, batch loss: 1.068288803100586, batch acc: 0.500000
2025-06-20 09:44:05,659 INFO 	iter: 1340, batch loss: 1.1537741422653198, batch acc: 0.406250
2025-06-20 09:47:29,336 INFO 	iter: 1360, batch loss: 1.0125930309295654, batch acc: 0.687500
2025-06-20 09:49:59,865 INFO 	iter: 1380, batch loss: 1.0758552551269531, batch acc: 0.531250
2025-06-20 09:51:52,964 INFO Epoch: loss: 1.068789, acc: 0.540323
2025-06-20 09:51:52,965 INFO Epoch: 10/10 start
2025-06-20 09:53:21,543 INFO 	iter: 1400, batch loss: 1.0711686611175537, batch acc: 0.500000
2025-06-20 09:56:42,062 INFO 	iter: 1420, batch loss: 1.0477564334869385, batch acc: 0.531250
2025-06-20 10:00:39,431 INFO 	iter: 1440, batch loss: 1.0408117771148682, batch acc: 0.562500
2025-06-20 10:03:21,041 INFO 	iter: 1460, batch loss: 1.052739143371582, batch acc: 0.593750
2025-06-20 10:05:59,549 INFO 	iter: 1480, batch loss: 1.0616095066070557, batch acc: 0.593750
2025-06-20 10:08:35,181 INFO 	iter: 1500, batch loss: 1.1117199659347534, batch acc: 0.437500
2025-06-20 10:11:08,087 INFO 	iter: 1520, batch loss: 1.0299532413482666, batch acc: 0.593750
2025-06-20 10:13:38,724 INFO 	iter: 1540, batch loss: 1.0601261854171753, batch acc: 0.625000
2025-06-20 10:14:55,173 INFO Epoch: loss: 1.066166, acc: 0.550403
2025-06-20 10:14:55,726 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, session restored!
2025-06-20 10:17:25,956 INFO Completed test evaluation: size=1008.0, acc=0.5446
2025-06-20 10:17:25,966 INFO 	Eval, eval loss: 1.0634357929229736, acc: 0.544643, mcc: -0.050739
2025-06-20 11:13:05,637 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 11:13:05,637 INFO Configuration updated for full run.
2025-06-20 11:13:05,638 INFO   use_dual_path_srl: True
2025-06-20 11:13:05,638 INFO   use_enhanced_srl: True
2025-06-20 11:13:05,638 INFO   use_ca_tsu: True
2025-06-20 11:13:05,638 INFO   use_noise_aware_loss: True
2025-06-20 11:13:05,638 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 11:13:05,638 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 11:13:05,638 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 11:13:05,638 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 11:13:05,643 INFO Start graph assembling...
2025-06-20 11:13:09,854 INFO use_dual_path_srl: True
2025-06-20 11:13:09,855 INFO variant_type: hedge
2025-06-20 11:13:09,855 INFO use_enhanced_srl: True
2025-06-20 11:13:09,855 INFO Enhanced SRL enabled from config
2025-06-20 11:13:09,855 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 11:13:09,855 INFO SRL condition: True = True and True
2025-06-20 11:13:09,855 INFO Using enhanced dual-path SRL architecture
2025-06-20 11:13:09,855 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 11:13:09,955 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-20 11:13:09,965 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-20 11:13:10,009 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-20 11:13:10,509 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 11:13:10,509 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 11:13:10,509 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 11:13:11,153 INFO Using Temporal Attention (TAP)
2025-06-20 11:13:11,256 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 11:13:11,256 INFO Ca-TSU enabled: True
2025-06-20 11:13:11,256 INFO Enhanced SRL enabled: True
2025-06-20 11:13:11,256 INFO Noise-Aware Loss enabled: True
2025-06-20 11:13:11,288 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-20 11:13:11,289 INFO Adding auxiliary enhancement losses...
2025-06-20 11:13:11,295 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-20 11:13:11,321 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-20 11:13:11,323 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 11:13:11,323 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 11:13:11,344 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 11:13:11,345 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 11:13:11,345 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 11:13:16,804 INFO Graph assembled successfully.
2025-06-20 11:13:58,831 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 11:20:48,756 INFO Word table initialized.
2025-06-20 11:20:50,431 ERROR Could not restore checkpoint: Assign requires shapes of both tensors to match. lhs shape= [50,300] rhs shape= [52,300]
	 [[Node: save/Assign_182 = Assign[T=DT_FLOAT, _class=["loc:@vmd_zh_rec_iter/z_posterior/hidden_for_z/W"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1, save/RestoreV2_182/_75)]]

Caused by op 'save/Assign_182', defined at:
  File "src/Main_tx_lf_dual_path.py", line 80, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 57, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 439, in _AddRestoreOps
    assign_ops.append(saveable.restore(tensors, shapes))
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 160, in restore
    self.op.get_shape().is_fully_defined())
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 276, in assign
    validate_shape=validate_shape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 57, in assign
    use_locking=use_locking, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): Assign requires shapes of both tensors to match. lhs shape= [50,300] rhs shape= [52,300]
	 [[Node: save/Assign_182 = Assign[T=DT_FLOAT, _class=["loc:@vmd_zh_rec_iter/z_posterior/hidden_for_z/W"], use_locking=true, validate_shape=true, _device="/job:localhost/replica:0/task:0/device:GPU:0"](vmd_zh_rec_iter/z_posterior/hidden_for_z/W/Adam_1, save/RestoreV2_182/_75)]]
. Starting new session.
2025-06-20 11:31:42,970 INFO 	iter: 1560, batch loss: 0.5137186050415039, batch acc: 0.781250
2025-06-20 11:36:36,544 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 11:36:36,544 INFO Configuration updated for full run.
2025-06-20 11:36:36,544 INFO   use_dual_path_srl: True
2025-06-20 11:36:36,545 INFO   use_enhanced_srl: True
2025-06-20 11:36:36,545 INFO   use_ca_tsu: True
2025-06-20 11:36:36,545 INFO   use_noise_aware_loss: True
2025-06-20 11:36:36,545 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 11:36:36,545 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 11:36:36,545 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 11:36:36,545 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 11:36:36,550 INFO Start graph assembling...
2025-06-20 11:36:40,426 INFO use_dual_path_srl: True
2025-06-20 11:36:40,426 INFO variant_type: hedge
2025-06-20 11:36:40,426 INFO use_enhanced_srl: True
2025-06-20 11:36:40,426 INFO Enhanced SRL enabled from config
2025-06-20 11:36:40,426 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 11:36:40,426 INFO SRL condition: True = True and True
2025-06-20 11:36:40,427 INFO Using enhanced dual-path SRL architecture
2025-06-20 11:36:40,427 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 11:36:40,517 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-20 11:36:40,526 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-20 11:36:40,563 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-20 11:36:41,038 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 11:36:41,039 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 11:36:41,039 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 11:36:41,648 INFO Using Temporal Attention (TAP)
2025-06-20 11:36:41,737 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 11:36:41,737 INFO Ca-TSU enabled: True
2025-06-20 11:36:41,737 INFO Enhanced SRL enabled: True
2025-06-20 11:36:41,737 INFO Noise-Aware Loss enabled: True
2025-06-20 11:36:41,765 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-20 11:36:41,765 INFO Adding auxiliary enhancement losses...
2025-06-20 11:36:41,772 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-20 11:36:41,794 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-20 11:36:41,795 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 11:36:41,795 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 11:36:41,814 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 11:36:41,814 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 11:36:41,814 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 11:36:46,985 INFO Graph assembled successfully.
2025-06-20 11:37:26,453 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 11:37:31,938 INFO Word table initialized.
2025-06-20 11:37:31,940 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-20 11:44:26,107 INFO 	iter: 20, batch loss: 1.2516682147979736, batch acc: 0.687500
2025-06-20 11:48:59,091 INFO 	iter: 40, batch loss: 0.974293053150177, batch acc: 0.562500
2025-06-20 11:53:02,800 INFO 	iter: 60, batch loss: 0.9264723658561707, batch acc: 0.468750
2025-06-20 12:35:45,162 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 12:35:45,163 INFO Configuration updated for full run.
2025-06-20 12:35:45,163 INFO   use_dual_path_srl: True
2025-06-20 12:35:45,163 INFO   use_enhanced_srl: True
2025-06-20 12:35:45,163 INFO   use_ca_tsu: True
2025-06-20 12:35:45,164 INFO   use_noise_aware_loss: True
2025-06-20 12:35:45,164 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 12:35:45,164 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 12:35:45,164 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 12:35:45,164 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 12:35:45,169 INFO Start graph assembling...
2025-06-20 12:35:46,921 INFO use_dual_path_srl: True
2025-06-20 12:35:46,921 INFO variant_type: hedge
2025-06-20 12:35:46,921 INFO use_enhanced_srl: True
2025-06-20 12:35:46,921 INFO Enhanced SRL enabled from config
2025-06-20 12:35:46,921 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 12:35:46,921 INFO SRL condition: True = True and True
2025-06-20 12:35:46,921 INFO Using enhanced dual-path SRL architecture
2025-06-20 12:35:46,922 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 12:35:46,966 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-20 12:35:46,970 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-20 12:35:46,988 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-20 12:35:47,210 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 12:35:47,211 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 12:35:47,211 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 12:35:47,629 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 12:35:47,629 INFO Ca-TSU enabled: True
2025-06-20 12:35:47,629 INFO Enhanced SRL enabled: True
2025-06-20 12:35:47,629 INFO Noise-Aware Loss enabled: True
2025-06-20 12:35:47,644 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 12:35:47,644 INFO Adding auxiliary enhancement losses...
2025-06-20 12:35:47,647 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-20 12:35:47,658 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-20 12:35:47,659 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 12:35:47,659 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 12:35:47,668 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 12:35:47,669 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 12:35:47,669 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 12:35:49,992 INFO Graph assembled successfully.
2025-06-20 12:36:13,266 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 12:36:16,817 INFO Word table initialized.
2025-06-20 12:36:18,165 ERROR Could not restore checkpoint: Key vmd_zh_rec/iter_body/z_post/z_posterior/hidden_for_z/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_188 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_188/tensor_names, save/RestoreV2_188/shape_and_slices)]]
	 [[Node: save/RestoreV2_164/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_694_save/RestoreV2_164", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_188', defined at:
  File "src/Main_tx_lf_dual_path.py", line 80, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 57, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key vmd_zh_rec/iter_body/z_post/z_posterior/hidden_for_z/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_188 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_188/tensor_names, save/RestoreV2_188/shape_and_slices)]]
	 [[Node: save/RestoreV2_164/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_694_save/RestoreV2_164", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-20 12:41:52,239 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 12:41:52,239 INFO Configuration updated for full run.
2025-06-20 12:41:52,239 INFO   use_dual_path_srl: True
2025-06-20 12:41:52,239 INFO   use_enhanced_srl: True
2025-06-20 12:41:52,239 INFO   use_ca_tsu: True
2025-06-20 12:41:52,239 INFO   use_noise_aware_loss: True
2025-06-20 12:41:52,239 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 12:41:52,239 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 12:41:52,239 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 12:41:52,240 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 12:41:52,241 INFO Start graph assembling...
2025-06-20 12:41:54,099 INFO use_dual_path_srl: True
2025-06-20 12:41:54,099 INFO variant_type: hedge
2025-06-20 12:41:54,099 INFO use_enhanced_srl: True
2025-06-20 12:41:54,099 INFO Enhanced SRL enabled from config
2025-06-20 12:41:54,099 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 12:41:54,099 INFO SRL condition: True = True and True
2025-06-20 12:41:54,099 INFO Using enhanced dual-path SRL architecture
2025-06-20 12:41:54,099 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 12:41:54,141 INFO Text to price predictor input shape: [None, 5, 100], target_dim: 3
2025-06-20 12:41:54,145 INFO 3D input reshaped to: [batch*time, features] = [-1, 100]
2025-06-20 12:41:54,163 INFO Predictions reshaped to: [batch, time, target_dim] = [Tensor("enhanced_dual_path_srl/text_driven_pathway/text_to_price_predictor/strided_slice:0", shape=(), dtype=int32, device=/device:GPU:0), seq_length, 3]
2025-06-20 12:41:54,377 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 12:41:54,377 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 12:41:54,377 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 12:41:54,735 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 12:41:54,735 INFO Ca-TSU enabled: True
2025-06-20 12:41:54,735 INFO Enhanced SRL enabled: True
2025-06-20 12:41:54,735 INFO Noise-Aware Loss enabled: True
2025-06-20 12:41:54,750 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 12:41:54,750 INFO Adding auxiliary enhancement losses...
2025-06-20 12:41:54,753 INFO Creating Noise-Aware Reliability Weights for Contrastive Loss...
2025-06-20 12:41:54,763 INFO Using Noise-Aware Contrastive Loss as SRL component with weight: 0.8787882448996054
2025-06-20 12:41:54,764 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 12:41:54,764 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 12:41:54,773 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 12:41:54,773 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 12:41:54,773 INFO Final loss components being optimized: ['base_generative_objective', 'noise_aware_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 12:41:57,001 INFO Graph assembled successfully.
2025-06-20 12:42:51,610 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 12:45:50,228 INFO Word table initialized.
2025-06-20 12:45:50,229 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-20 12:51:45,910 INFO 	iter: 20, batch loss: 3.7860684394836426, batch acc: 0.562500
2025-06-20 12:54:22,926 INFO 	iter: 40, batch loss: 2.310626745223999, batch acc: 0.750000
2025-06-20 12:56:28,089 INFO 	iter: 60, batch loss: 1.699265956878662, batch acc: 0.906250
2025-06-20 12:58:24,777 INFO 	iter: 80, batch loss: 1.6769648790359497, batch acc: 0.750000
2025-06-20 13:00:14,724 INFO 	iter: 100, batch loss: 1.5121028423309326, batch acc: 0.812500
2025-06-20 13:01:54,705 INFO 	iter: 120, batch loss: 1.4927101135253906, batch acc: 0.687500
2025-06-20 13:03:27,162 INFO 	iter: 140, batch loss: 1.4681520462036133, batch acc: 0.750000
2025-06-20 13:04:34,324 INFO Epoch: loss: 2.040732, acc: 0.707661
2025-06-20 13:04:34,324 INFO Epoch 1 finished. Checkpoint saved.
2025-06-20 13:05:39,107 INFO 	iter: 160, batch loss: 1.3523931503295898, batch acc: 0.687500
2025-06-20 13:08:57,045 INFO 	iter: 180, batch loss: 1.2110395431518555, batch acc: 0.656250
2025-06-20 13:10:45,532 INFO 	iter: 200, batch loss: 1.3106629848480225, batch acc: 0.687500
2025-06-20 13:12:22,554 INFO 	iter: 220, batch loss: 1.2799490690231323, batch acc: 0.562500
2025-06-20 13:14:10,506 INFO 	iter: 240, batch loss: 1.121330976486206, batch acc: 0.750000
2025-06-20 13:15:41,589 INFO 	iter: 260, batch loss: 0.9528768658638, batch acc: 0.687500
2025-06-20 13:17:08,714 INFO 	iter: 280, batch loss: 1.1161963939666748, batch acc: 0.656250
2025-06-20 13:18:34,063 INFO 	iter: 300, batch loss: 1.1042982339859009, batch acc: 0.593750
2025-06-20 13:19:18,761 INFO Epoch: loss: 1.201370, acc: 0.661694
2025-06-20 13:19:18,761 INFO Epoch 2 finished. Checkpoint saved.
2025-06-20 13:21:10,780 INFO 	iter: 320, batch loss: 0.8062536716461182, batch acc: 0.781250
2025-06-20 13:23:19,480 INFO 	iter: 340, batch loss: 0.9683508276939392, batch acc: 0.531250
2025-06-20 13:25:05,380 INFO 	iter: 360, batch loss: 0.9337631464004517, batch acc: 0.593750
2025-06-20 13:26:40,746 INFO 	iter: 380, batch loss: 1.0099748373031616, batch acc: 0.625000
2025-06-20 13:28:17,392 INFO 	iter: 400, batch loss: 0.976240336894989, batch acc: 0.625000
2025-06-20 13:29:48,830 INFO 	iter: 420, batch loss: 0.9075887203216553, batch acc: 0.531250
2025-06-20 13:31:16,686 INFO 	iter: 440, batch loss: 0.8647570610046387, batch acc: 0.562500
2025-06-20 13:32:44,720 INFO 	iter: 460, batch loss: 0.8569287657737732, batch acc: 0.562500
2025-06-20 13:33:09,761 INFO Epoch: loss: 0.925534, acc: 0.606452
2025-06-20 13:33:09,761 INFO Epoch 3 finished. Checkpoint saved.
2025-06-20 13:36:34,182 INFO 	iter: 480, batch loss: 0.6791032552719116, batch acc: 0.750000
2025-06-20 13:38:30,482 INFO 	iter: 500, batch loss: 0.9599437117576599, batch acc: 0.468750
2025-06-20 13:40:16,364 INFO 	iter: 520, batch loss: 0.9584231972694397, batch acc: 0.531250
2025-06-20 13:41:55,181 INFO 	iter: 540, batch loss: 0.9058765172958374, batch acc: 0.531250
2025-06-20 13:44:02,366 INFO 	iter: 560, batch loss: 0.9000459909439087, batch acc: 0.531250
2025-06-20 13:45:32,946 INFO 	iter: 580, batch loss: 0.8589228987693787, batch acc: 0.562500
2025-06-20 13:47:02,794 INFO 	iter: 600, batch loss: 0.943069577217102, batch acc: 0.531250
2025-06-20 13:48:31,356 INFO 	iter: 620, batch loss: 0.8152390122413635, batch acc: 0.718750
2025-06-20 13:48:34,487 INFO Epoch: loss: 0.871812, acc: 0.605645
2025-06-20 13:48:34,487 INFO Epoch 4 finished. Checkpoint saved.
2025-06-20 13:51:29,836 INFO 	iter: 640, batch loss: 0.8280839323997498, batch acc: 0.625000
2025-06-20 13:53:22,184 INFO 	iter: 660, batch loss: 0.7859962582588196, batch acc: 0.687500
2025-06-20 13:55:03,888 INFO 	iter: 680, batch loss: 0.8949375152587891, batch acc: 0.593750
2025-06-20 13:56:42,409 INFO 	iter: 700, batch loss: 0.7500657439231873, batch acc: 0.687500
2025-06-20 13:58:17,927 INFO 	iter: 720, batch loss: 0.89306640625, batch acc: 0.687500
2025-06-20 13:59:50,133 INFO 	iter: 740, batch loss: 0.7535457611083984, batch acc: 0.656250
2025-06-20 14:01:20,728 INFO 	iter: 760, batch loss: 1.007703185081482, batch acc: 0.531250
2025-06-20 14:02:28,762 INFO Epoch: loss: 0.826511, acc: 0.603024
2025-06-20 14:02:28,762 INFO Epoch 5 finished. Checkpoint saved.
2025-06-20 14:03:36,599 INFO 	iter: 780, batch loss: 0.8499236702919006, batch acc: 0.531250
2025-06-20 14:08:19,280 INFO 	iter: 800, batch loss: 0.7233395576477051, batch acc: 0.625000
2025-06-20 14:10:13,400 INFO 	iter: 820, batch loss: 0.7851874828338623, batch acc: 0.593750
2025-06-20 14:11:55,486 INFO 	iter: 840, batch loss: 0.7346054315567017, batch acc: 0.593750
2025-06-20 14:13:34,415 INFO 	iter: 860, batch loss: 0.709711492061615, batch acc: 0.656250
2025-06-20 14:15:09,929 INFO 	iter: 880, batch loss: 0.8622217178344727, batch acc: 0.687500
2025-06-20 14:16:43,667 INFO 	iter: 900, batch loss: 1.2734729051589966, batch acc: 0.656250
2025-06-20 14:18:14,986 INFO 	iter: 920, batch loss: 0.9276755452156067, batch acc: 0.437500
2025-06-20 14:19:01,719 INFO Epoch: loss: 0.845198, acc: 0.569960
2025-06-20 14:19:01,719 INFO Epoch 6 finished. Checkpoint saved.
2025-06-20 14:20:52,986 INFO 	iter: 940, batch loss: 0.8453581929206848, batch acc: 0.468750
2025-06-20 14:23:03,887 INFO 	iter: 960, batch loss: 0.8199899196624756, batch acc: 0.531250
2025-06-20 14:25:40,185 INFO 	iter: 980, batch loss: 0.7427578568458557, batch acc: 0.625000
2025-06-20 14:27:19,815 INFO 	iter: 1000, batch loss: 0.7741720080375671, batch acc: 0.531250
2025-06-20 14:29:32,487 INFO 	iter: 1020, batch loss: 0.9231709241867065, batch acc: 0.531250
2025-06-20 14:31:16,474 INFO 	iter: 1040, batch loss: 0.7675592303276062, batch acc: 0.625000
2025-06-20 14:32:54,211 INFO 	iter: 1060, batch loss: 0.7131145000457764, batch acc: 0.687500
2025-06-20 14:35:14,618 INFO 	iter: 1080, batch loss: 0.8824502229690552, batch acc: 0.562500
2025-06-20 14:35:42,723 INFO Epoch: loss: 0.818529, acc: 0.561895
2025-06-20 14:35:42,723 INFO Epoch 7 finished. Checkpoint saved.
2025-06-20 14:38:46,161 INFO 	iter: 1100, batch loss: 0.8335378766059875, batch acc: 0.593750
2025-06-20 14:40:58,686 INFO 	iter: 1120, batch loss: 0.7974777817726135, batch acc: 0.531250
2025-06-20 14:45:11,132 INFO 	iter: 1140, batch loss: 0.895928680896759, batch acc: 0.531250
2025-06-20 14:49:24,520 INFO 	iter: 1160, batch loss: 0.7922028303146362, batch acc: 0.531250
2025-06-20 14:53:30,671 INFO 	iter: 1180, batch loss: 0.7408102750778198, batch acc: 0.656250
2025-06-20 14:55:44,873 INFO 	iter: 1200, batch loss: 0.9062272310256958, batch acc: 0.406250
2025-06-20 14:57:17,959 INFO 	iter: 1220, batch loss: 0.834542453289032, batch acc: 0.625000
2025-06-20 14:58:50,376 INFO 	iter: 1240, batch loss: 0.803769588470459, batch acc: 0.500000
2025-06-20 14:58:53,887 INFO Epoch: loss: 0.812108, acc: 0.576210
2025-06-20 14:58:53,887 INFO Epoch 8 finished. Checkpoint saved.
2025-06-20 15:01:53,617 INFO 	iter: 1260, batch loss: 0.8528791069984436, batch acc: 0.406250
2025-06-20 15:03:59,761 INFO 	iter: 1280, batch loss: 0.8080412745475769, batch acc: 0.562500
2025-06-20 15:06:34,880 INFO 	iter: 1300, batch loss: 0.6717223525047302, batch acc: 0.687500
2025-06-20 15:08:16,888 INFO 	iter: 1320, batch loss: 0.7082280516624451, batch acc: 0.531250
2025-06-20 15:09:56,141 INFO 	iter: 1340, batch loss: 0.7998135089874268, batch acc: 0.531250
2025-06-20 15:11:32,989 INFO 	iter: 1360, batch loss: 0.8480408787727356, batch acc: 0.500000
2025-06-20 15:13:06,779 INFO 	iter: 1380, batch loss: 0.9379048943519592, batch acc: 0.562500
2025-06-20 15:14:16,880 INFO Epoch: loss: 0.805006, acc: 0.563105
2025-06-20 15:14:16,880 INFO Epoch 9 finished. Checkpoint saved.
2025-06-20 15:15:28,331 INFO 	iter: 1400, batch loss: 0.7288315296173096, batch acc: 0.656250
2025-06-20 15:17:52,824 INFO 	iter: 1420, batch loss: 0.8245745897293091, batch acc: 0.625000
2025-06-20 15:19:48,150 INFO 	iter: 1440, batch loss: 0.801089346408844, batch acc: 0.500000
2025-06-20 15:21:35,521 INFO 	iter: 1460, batch loss: 0.7734207510948181, batch acc: 0.437500
2025-06-20 15:23:17,210 INFO 	iter: 1480, batch loss: 0.6834955215454102, batch acc: 0.656250
2025-06-20 15:24:59,886 INFO 	iter: 1500, batch loss: 0.8437296748161316, batch acc: 0.562500
2025-06-20 15:26:36,192 INFO 	iter: 1520, batch loss: 0.850559651851654, batch acc: 0.531250
2025-06-20 15:28:11,689 INFO 	iter: 1540, batch loss: 0.8142194747924805, batch acc: 0.406250
2025-06-20 15:29:00,689 INFO Epoch: loss: 0.772641, acc: 0.571573
2025-06-20 15:29:00,689 INFO Epoch 10 finished. Checkpoint saved.
2025-06-20 15:29:00,689 INFO Generating diagnostic plots...
2025-06-20 15:29:05,289 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-20 15:30:55,939 INFO Completed dev evaluation: size=656.0, acc=0.5107
2025-06-20 15:30:55,943 INFO 	Eval, eval loss: 0.8077500462532043, acc: 0.510671, mcc: 0.018038
2025-06-20 15:31:10,868 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 15:31:12,353 INFO Word table init: done!
2025-06-20 15:31:14,153 INFO Model: all-hedge-gru_0c44b12c, session restored from latest checkpoint!
2025-06-20 15:31:14,153 INFO Start test phase...
2025-06-20 15:33:48,176 INFO Completed test evaluation: size=1008.0, acc=0.5417
2025-06-20 15:33:48,180 INFO 	Eval, eval loss: 0.7931657433509827, acc: 0.541667, mcc: 0.014664
2025-06-20 15:45:14,774 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 15:45:14,775 INFO Configuration updated for full run.
2025-06-20 15:45:14,775 INFO   use_dual_path_srl: True
2025-06-20 15:45:14,775 INFO   use_enhanced_srl: True
2025-06-20 15:45:14,775 INFO   use_ca_tsu: True
2025-06-20 15:45:14,775 INFO   use_noise_aware_loss: True
2025-06-20 15:45:14,775 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 15:45:14,775 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 15:45:14,775 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 15:45:14,776 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 15:45:14,780 INFO Start graph assembling...
2025-06-20 15:45:16,592 INFO use_dual_path_srl: True
2025-06-20 15:45:16,592 INFO variant_type: hedge
2025-06-20 15:45:16,592 INFO use_enhanced_srl: True
2025-06-20 15:45:16,592 INFO Enhanced SRL enabled from config
2025-06-20 15:45:16,592 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 15:45:16,592 INFO SRL condition: True = True and True
2025-06-20 15:45:16,592 INFO Using enhanced dual-path SRL architecture
2025-06-20 15:45:16,592 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 15:45:16,844 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 15:45:16,844 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 15:45:16,844 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 15:45:17,239 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 15:45:17,239 INFO Ca-TSU enabled: True
2025-06-20 15:45:17,239 INFO Enhanced SRL enabled: True
2025-06-20 15:45:17,239 INFO Noise-Aware Loss enabled: True
2025-06-20 15:45:17,254 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 15:45:17,254 INFO Adding auxiliary enhancement losses...
2025-06-20 15:45:17,258 INFO Creating standard Contrastive Loss component...
2025-06-20 15:45:17,259 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-20 15:45:17,260 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 15:45:17,260 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 15:45:17,270 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 15:45:17,270 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 15:45:17,270 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 15:45:19,495 INFO Graph assembled successfully.
2025-06-20 15:45:43,520 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 15:45:46,744 INFO Word table initialized.
2025-06-20 15:45:46,746 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-20 15:48:26,460 INFO Configuring model for full run with all enhancement modules enabled.
2025-06-20 15:48:26,460 INFO Configuration updated for full run.
2025-06-20 15:48:26,460 INFO   use_dual_path_srl: True
2025-06-20 15:48:26,460 INFO   use_enhanced_srl: True
2025-06-20 15:48:26,460 INFO   use_ca_tsu: True
2025-06-20 15:48:26,460 INFO   use_noise_aware_loss: True
2025-06-20 15:48:26,460 INFO   prediction_loss_weight (for SRL): 0.1
2025-06-20 15:48:26,460 INFO   causal_loss_lambda (for Ca-TSU): 0.45594244201742495
2025-06-20 15:48:26,460 INFO   noise_aware_weight (for SRL): 0.8787882448996054
2025-06-20 15:48:26,461 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 15:48:26,462 INFO Start graph assembling...
2025-06-20 15:48:27,042 INFO use_dual_path_srl: True
2025-06-20 15:48:27,042 INFO variant_type: hedge
2025-06-20 15:48:27,042 INFO use_enhanced_srl: True
2025-06-20 15:48:27,042 INFO Enhanced SRL enabled from config
2025-06-20 15:48:27,042 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 15:48:27,042 INFO SRL condition: True = True and True
2025-06-20 15:48:27,042 INFO Using enhanced dual-path SRL architecture
2025-06-20 15:48:27,042 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 15:48:27,289 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 15:48:27,289 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 15:48:27,289 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 15:48:27,584 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 15:48:27,584 INFO Ca-TSU enabled: True
2025-06-20 15:48:27,584 INFO Enhanced SRL enabled: True
2025-06-20 15:48:27,584 INFO Noise-Aware Loss enabled: True
2025-06-20 15:48:27,600 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 15:48:27,600 INFO Adding auxiliary enhancement losses...
2025-06-20 15:48:27,603 INFO Creating standard Contrastive Loss component...
2025-06-20 15:48:27,604 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-20 15:48:27,605 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 15:48:27,605 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 15:48:27,616 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 15:48:27,616 INFO Final loss after all components: Tensor("causal_consistency_component_kl/add_causal_loss_kl:0", dtype=float32, device=/device:GPU:0)
2025-06-20 15:48:27,616 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw']
2025-06-20 15:48:29,760 INFO Graph assembled successfully.
2025-06-20 15:48:46,382 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 15:48:47,799 INFO Word table initialized.
2025-06-20 15:48:47,800 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-20 15:51:55,437 INFO 	iter: 20, batch loss: 3.5197134017944336, batch acc: 0.656250
2025-06-20 15:53:52,180 INFO 	iter: 40, batch loss: 2.471132278442383, batch acc: 0.656250
2025-06-20 15:55:40,027 INFO 	iter: 60, batch loss: 1.9418718814849854, batch acc: 0.750000
2025-06-20 15:57:20,605 INFO 	iter: 80, batch loss: 1.4595028162002563, batch acc: 0.843750
2025-06-20 15:58:59,951 INFO 	iter: 100, batch loss: 1.5451992750167847, batch acc: 0.781250
2025-06-20 16:00:34,776 INFO 	iter: 120, batch loss: 1.646005392074585, batch acc: 0.718750
2025-06-20 16:02:06,657 INFO 	iter: 140, batch loss: 1.6745198965072632, batch acc: 0.687500
2025-06-20 16:03:15,568 INFO Epoch: loss: 2.040647, acc: 0.722581
2025-06-20 16:03:15,568 INFO Epoch 1 finished. Checkpoint saved.
2025-06-20 16:04:19,933 INFO 	iter: 160, batch loss: 1.414555311203003, batch acc: 0.843750
2025-06-20 16:07:54,920 INFO 	iter: 180, batch loss: 1.721387267112732, batch acc: 0.562500
2025-06-20 16:09:52,677 INFO 	iter: 200, batch loss: 1.4038254022598267, batch acc: 0.687500
2025-06-20 16:11:34,729 INFO 	iter: 220, batch loss: 1.285386323928833, batch acc: 0.781250
2025-06-20 16:13:14,396 INFO 	iter: 240, batch loss: 1.260661244392395, batch acc: 0.656250
2025-06-20 16:14:51,325 INFO 	iter: 260, batch loss: 1.2364261150360107, batch acc: 0.718750
2025-06-20 16:16:25,217 INFO 	iter: 280, batch loss: 1.3259443044662476, batch acc: 0.562500
2025-06-20 16:17:57,108 INFO 	iter: 300, batch loss: 1.1534088850021362, batch acc: 0.687500
2025-06-20 16:18:44,114 INFO Epoch: loss: 1.349340, acc: 0.671169
2025-06-20 16:18:44,114 INFO Epoch 2 finished. Checkpoint saved.
2025-06-20 16:20:42,650 INFO 	iter: 320, batch loss: 1.0961393117904663, batch acc: 0.781250
2025-06-20 16:23:02,867 INFO 	iter: 340, batch loss: 1.093543529510498, batch acc: 0.718750
2025-06-20 16:24:52,420 INFO 	iter: 360, batch loss: 1.095284342765808, batch acc: 0.718750
2025-06-20 16:26:37,377 INFO 	iter: 380, batch loss: 1.0156646966934204, batch acc: 0.750000
2025-06-20 16:28:17,349 INFO 	iter: 400, batch loss: 1.2190226316452026, batch acc: 0.625000
2025-06-20 16:29:54,949 INFO 	iter: 420, batch loss: 1.1192302703857422, batch acc: 0.687500
2025-06-20 16:31:29,762 INFO 	iter: 440, batch loss: 1.078629493713379, batch acc: 0.750000
2025-06-20 16:33:03,553 INFO 	iter: 460, batch loss: 1.1455905437469482, batch acc: 0.593750
2025-06-20 16:33:29,214 INFO Epoch: loss: 1.150956, acc: 0.630444
2025-06-20 16:33:29,214 INFO Epoch 3 finished. Checkpoint saved.
2025-06-20 16:37:02,765 INFO 	iter: 480, batch loss: 1.1101285219192505, batch acc: 0.593750
2025-06-20 16:39:09,825 INFO 	iter: 500, batch loss: 1.325102686882019, batch acc: 0.531250
2025-06-20 16:40:58,334 INFO 	iter: 520, batch loss: 1.0559722185134888, batch acc: 0.781250
2025-06-20 16:42:40,949 INFO 	iter: 540, batch loss: 1.0543866157531738, batch acc: 0.656250
2025-06-20 16:44:22,916 INFO 	iter: 560, batch loss: 1.031557559967041, batch acc: 0.687500
2025-06-20 16:46:01,818 INFO 	iter: 580, batch loss: 1.187125325202942, batch acc: 0.531250
2025-06-20 16:47:36,176 INFO 	iter: 600, batch loss: 1.1189558506011963, batch acc: 0.625000
2025-06-20 16:49:09,357 INFO 	iter: 620, batch loss: 1.0298051834106445, batch acc: 0.593750
2025-06-20 16:49:12,266 INFO Epoch: loss: 1.104793, acc: 0.613911
2025-06-20 16:49:12,266 INFO Epoch 4 finished. Checkpoint saved.
2025-06-20 16:52:14,989 INFO 	iter: 640, batch loss: 1.1127158403396606, batch acc: 0.625000
2025-06-20 16:54:17,961 INFO 	iter: 660, batch loss: 1.106163501739502, batch acc: 0.656250
2025-06-20 16:56:05,103 INFO 	iter: 680, batch loss: 1.1435726881027222, batch acc: 0.656250
2025-06-20 16:57:48,428 INFO 	iter: 700, batch loss: 0.9595462679862976, batch acc: 0.750000
2025-06-20 16:59:31,442 INFO 	iter: 720, batch loss: 1.0563253164291382, batch acc: 0.656250
2025-06-20 17:01:10,743 INFO 	iter: 740, batch loss: 1.1056666374206543, batch acc: 0.531250
2025-06-20 17:02:46,130 INFO 	iter: 760, batch loss: 1.1331901550292969, batch acc: 0.531250
2025-06-20 17:03:58,231 INFO Epoch: loss: 1.095217, acc: 0.610282
2025-06-20 17:03:58,231 INFO Epoch 5 finished. Checkpoint saved.
2025-06-20 17:05:09,178 INFO 	iter: 780, batch loss: 1.0240209102630615, batch acc: 0.625000
2025-06-20 17:08:48,086 INFO 	iter: 800, batch loss: 1.0636756420135498, batch acc: 0.531250
2025-06-20 17:10:54,318 INFO 	iter: 820, batch loss: 1.013445258140564, batch acc: 0.750000
2025-06-20 17:13:05,470 INFO 	iter: 840, batch loss: 1.1352430582046509, batch acc: 0.625000
2025-06-20 17:17:08,424 INFO 	iter: 860, batch loss: 1.0678143501281738, batch acc: 0.625000
2025-06-20 17:20:44,537 INFO 	iter: 880, batch loss: 1.0541901588439941, batch acc: 0.625000
2025-06-20 17:23:41,527 INFO 	iter: 900, batch loss: 1.1129661798477173, batch acc: 0.562500
2025-06-20 17:25:57,847 INFO 	iter: 920, batch loss: 1.086168885231018, batch acc: 0.531250
2025-06-20 17:27:31,974 INFO Epoch: loss: 1.078317, acc: 0.597379
2025-06-20 17:27:31,995 INFO Epoch 6 finished. Checkpoint saved.
2025-06-20 17:34:17,654 INFO 	iter: 940, batch loss: 1.041896939277649, batch acc: 0.625000
2025-06-20 17:38:10,978 INFO 	iter: 960, batch loss: 1.0134127140045166, batch acc: 0.656250
2025-06-20 17:43:55,563 INFO 	iter: 980, batch loss: 1.0242743492126465, batch acc: 0.656250
2025-06-20 17:46:24,568 INFO 	iter: 1000, batch loss: 1.0214663743972778, batch acc: 0.562500
2025-06-20 17:48:12,393 INFO 	iter: 1020, batch loss: 1.0765039920806885, batch acc: 0.531250
2025-06-20 17:49:54,886 INFO 	iter: 1040, batch loss: 1.0684512853622437, batch acc: 0.531250
2025-06-20 17:51:33,331 INFO 	iter: 1060, batch loss: 1.056472659111023, batch acc: 0.656250
2025-06-20 17:53:10,037 INFO 	iter: 1080, batch loss: 1.0372276306152344, batch acc: 0.593750
2025-06-20 17:53:36,578 INFO Epoch: loss: 1.070012, acc: 0.589315
2025-06-20 17:53:36,578 INFO Epoch 7 finished. Checkpoint saved.
2025-06-20 17:56:10,327 INFO 	iter: 1100, batch loss: 1.1245490312576294, batch acc: 0.531250
2025-06-20 17:58:23,460 INFO 	iter: 1120, batch loss: 1.0565396547317505, batch acc: 0.656250
2025-06-20 18:00:17,191 INFO 	iter: 1140, batch loss: 1.0821080207824707, batch acc: 0.562500
2025-06-20 18:02:03,702 INFO 	iter: 1160, batch loss: 1.071945309638977, batch acc: 0.468750
2025-06-20 18:03:49,377 INFO 	iter: 1180, batch loss: 1.0108721256256104, batch acc: 0.687500
2025-06-20 18:05:29,886 INFO 	iter: 1200, batch loss: 1.0660388469696045, batch acc: 0.562500
2025-06-20 18:07:09,211 INFO 	iter: 1220, batch loss: 1.070643663406372, batch acc: 0.531250
2025-06-20 18:08:49,210 INFO 	iter: 1240, batch loss: 1.0731098651885986, batch acc: 0.500000
2025-06-20 18:08:52,472 INFO Epoch: loss: 1.060083, acc: 0.594153
2025-06-20 18:08:52,472 INFO Epoch 8 finished. Checkpoint saved.
2025-06-20 18:13:05,806 INFO 	iter: 1260, batch loss: 1.1065417528152466, batch acc: 0.562500
2025-06-20 18:15:07,051 INFO 	iter: 1280, batch loss: 1.127876877784729, batch acc: 0.468750
2025-06-20 18:16:57,643 INFO 	iter: 1300, batch loss: 1.0237581729888916, batch acc: 0.562500
2025-06-20 18:18:44,142 INFO 	iter: 1320, batch loss: 1.041333556175232, batch acc: 0.625000
2025-06-20 18:20:31,229 INFO 	iter: 1340, batch loss: 1.100069284439087, batch acc: 0.593750
2025-06-20 18:22:13,496 INFO 	iter: 1360, batch loss: 1.0751538276672363, batch acc: 0.687500
2025-06-20 18:23:52,661 INFO 	iter: 1380, batch loss: 1.0001602172851562, batch acc: 0.687500
2025-06-20 18:25:08,632 INFO Epoch: loss: 1.060557, acc: 0.589919
2025-06-20 18:25:08,632 INFO Epoch 9 finished. Checkpoint saved.
2025-06-20 18:26:36,188 INFO 	iter: 1400, batch loss: 1.012122631072998, batch acc: 0.625000
2025-06-20 18:29:09,498 INFO 	iter: 1420, batch loss: 1.0920586585998535, batch acc: 0.500000
2025-06-20 18:31:27,783 INFO 	iter: 1440, batch loss: 1.0197086334228516, batch acc: 0.593750
2025-06-20 18:34:31,478 INFO 	iter: 1460, batch loss: 1.1098148822784424, batch acc: 0.500000
2025-06-20 18:36:17,782 INFO 	iter: 1480, batch loss: 1.0618175268173218, batch acc: 0.625000
2025-06-20 18:38:01,593 INFO 	iter: 1500, batch loss: 1.0640774965286255, batch acc: 0.625000
2025-06-20 18:39:43,356 INFO 	iter: 1520, batch loss: 1.1110361814498901, batch acc: 0.531250
2025-06-20 18:41:22,833 INFO 	iter: 1540, batch loss: 1.0101282596588135, batch acc: 0.625000
2025-06-20 18:43:13,362 INFO Epoch: loss: 1.055701, acc: 0.602419
2025-06-20 18:43:13,363 INFO Epoch 10 finished. Checkpoint saved.
2025-06-20 18:43:13,363 INFO Generating diagnostic plots...
2025-06-20 18:43:18,484 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-20 18:45:51,820 INFO Completed dev evaluation: size=656.0, acc=0.5076
2025-06-20 18:45:51,827 INFO 	Eval, eval loss: 1.1115212440490723, acc: 0.507622, mcc: 0.019108
2025-06-20 18:46:19,686 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 18:46:21,201 INFO Word table init: done!
2025-06-20 18:46:22,997 INFO Model: all-hedge-gru_0c44b12c, session restored from latest checkpoint!
2025-06-20 18:46:22,998 INFO Start test phase...
2025-06-20 18:48:18,467 INFO Completed test evaluation: size=1008.0, acc=0.5149
2025-06-20 18:48:18,474 INFO 	Eval, eval loss: 1.0894523859024048, acc: 0.514881, mcc: 0.014649
2025-06-20 18:58:00,003 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-20 18:58:00,003 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 18:58:00,003 INFO Using L2 regularization with lambda: 0.0001
2025-06-20 18:58:00,007 INFO Start graph assembling...
2025-06-20 18:58:00,962 INFO use_dual_path_srl: True
2025-06-20 18:58:00,962 INFO variant_type: hedge
2025-06-20 18:58:00,962 INFO use_enhanced_srl: True
2025-06-20 18:58:00,962 INFO Enhanced SRL enabled from config
2025-06-20 18:58:00,962 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 18:58:00,962 INFO SRL condition: True = True and True
2025-06-20 18:58:00,962 INFO Using enhanced dual-path SRL architecture
2025-06-20 18:58:00,962 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 18:58:01,373 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 18:58:01,374 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 18:58:01,374 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 18:58:01,844 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 18:58:01,844 INFO Ca-TSU enabled: True
2025-06-20 18:58:01,844 INFO Enhanced SRL enabled: True
2025-06-20 18:58:01,844 INFO Noise-Aware Loss enabled: True
2025-06-20 18:58:01,869 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 18:58:01,869 INFO Adding auxiliary enhancement losses...
2025-06-20 18:58:01,873 INFO Creating standard Contrastive Loss component...
2025-06-20 18:58:01,874 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-20 18:58:01,876 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 18:58:01,876 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 18:58:01,891 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 18:58:01,892 INFO Adding L2 regularization loss to total loss: Tensor("l2_regularization_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-20 18:58:01,892 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-20 18:58:01,892 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-20 18:58:05,350 INFO Graph assembled successfully.
2025-06-20 18:58:32,859 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 18:58:42,665 INFO Word table initialized.
2025-06-20 18:58:42,667 INFO Model: all-hedge-gru_0c44b12c, starting new session.
2025-06-20 19:05:53,625 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-20 19:05:53,625 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 19:10:52,521 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-20 19:10:52,521 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-20 19:10:52,521 INFO Using L2 regularization with lambda: 0.0001
2025-06-20 19:10:52,523 INFO Start graph assembling...
2025-06-20 19:10:53,351 INFO use_dual_path_srl: True
2025-06-20 19:10:53,352 INFO variant_type: hedge
2025-06-20 19:10:53,352 INFO use_enhanced_srl: True
2025-06-20 19:10:53,352 INFO Enhanced SRL enabled from config
2025-06-20 19:10:53,352 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-20 19:10:53,352 INFO SRL condition: True = True and True
2025-06-20 19:10:53,352 INFO Using enhanced dual-path SRL architecture
2025-06-20 19:10:53,352 INFO Creating Enhanced Dual-Path SRL module...
2025-06-20 19:10:53,748 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-20 19:10:53,749 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-20 19:10:53,749 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-20 19:10:54,197 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-20 19:10:54,197 INFO Ca-TSU enabled: True
2025-06-20 19:10:54,197 INFO Enhanced SRL enabled: True
2025-06-20 19:10:54,197 INFO Noise-Aware Loss enabled: True
2025-06-20 19:10:54,220 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-20 19:10:54,220 INFO Adding auxiliary enhancement losses...
2025-06-20 19:10:54,225 INFO Creating standard Contrastive Loss component...
2025-06-20 19:10:54,226 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-20 19:10:54,228 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-20 19:10:54,228 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-20 19:10:54,242 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-20 19:10:54,243 INFO Adding L2 regularization loss to total loss: Tensor("l2_regularization_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-20 19:10:54,243 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-20 19:10:54,243 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-20 19:10:57,499 INFO Graph assembled successfully.
2025-06-20 19:11:19,125 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 19:11:20,351 INFO Word table initialized.
2025-06-20 19:11:20,352 INFO Model: all-hedge-gru_0e42a2bb, starting new session.
2025-06-20 19:15:19,402 INFO 	iter: 20, batch loss: 3.5939087867736816, batch acc: 0.593750
2025-06-20 19:17:54,097 INFO 	iter: 40, batch loss: 2.3699212074279785, batch acc: 0.781250
2025-06-20 19:20:07,983 INFO 	iter: 60, batch loss: 1.802201271057129, batch acc: 0.718750
2025-06-20 19:22:20,131 INFO 	iter: 80, batch loss: 1.6365728378295898, batch acc: 0.812500
2025-06-20 19:24:25,977 INFO 	iter: 100, batch loss: 1.7024701833724976, batch acc: 0.687500
2025-06-20 19:26:27,904 INFO 	iter: 120, batch loss: 1.5470465421676636, batch acc: 0.875000
2025-06-20 19:28:27,140 INFO 	iter: 140, batch loss: 1.6873677968978882, batch acc: 0.718750
2025-06-20 19:29:55,310 INFO Epoch: loss: 2.049394, acc: 0.736089
2025-06-20 19:29:55,310 INFO Epoch 1 finished. Checkpoint saved.
2025-06-20 19:31:24,304 INFO 	iter: 160, batch loss: 1.5395358800888062, batch acc: 0.718750
2025-06-20 19:34:29,310 INFO 	iter: 180, batch loss: 1.616134524345398, batch acc: 0.593750
2025-06-20 19:36:57,883 INFO 	iter: 200, batch loss: 1.5765197277069092, batch acc: 0.656250
2025-06-20 19:39:11,155 INFO 	iter: 220, batch loss: 1.3529630899429321, batch acc: 0.687500
2025-06-20 19:41:20,032 INFO 	iter: 240, batch loss: 1.2452788352966309, batch acc: 0.687500
2025-06-20 19:43:27,905 INFO 	iter: 260, batch loss: 1.204475998878479, batch acc: 0.812500
2025-06-20 19:45:29,120 INFO 	iter: 280, batch loss: 1.2237857580184937, batch acc: 0.625000
2025-06-20 19:47:28,204 INFO 	iter: 300, batch loss: 1.183089256286621, batch acc: 0.687500
2025-06-20 19:48:27,701 INFO Epoch: loss: 1.365413, acc: 0.665524
2025-06-20 19:48:27,701 INFO Epoch 2 finished. Checkpoint saved.
2025-06-20 19:50:56,578 INFO 	iter: 320, batch loss: 1.211327314376831, batch acc: 0.718750
2025-06-20 19:53:42,328 INFO 	iter: 340, batch loss: 1.2114609479904175, batch acc: 0.687500
2025-06-20 19:56:08,357 INFO 	iter: 360, batch loss: 1.2569328546524048, batch acc: 0.625000
2025-06-20 19:58:20,506 INFO 	iter: 380, batch loss: 1.2731493711471558, batch acc: 0.625000
2025-06-20 20:00:28,553 INFO 	iter: 400, batch loss: 1.1982507705688477, batch acc: 0.656250
2025-06-20 20:02:35,711 INFO 	iter: 420, batch loss: 1.1476593017578125, batch acc: 0.625000
2025-06-20 20:04:38,198 INFO 	iter: 440, batch loss: 1.1970404386520386, batch acc: 0.562500
2025-06-20 20:06:37,874 INFO 	iter: 460, batch loss: 1.0876829624176025, batch acc: 0.718750
2025-06-20 20:07:08,603 INFO Epoch: loss: 1.166320, acc: 0.631452
2025-06-20 20:07:08,603 INFO Epoch 3 finished. Checkpoint saved.
2025-06-20 20:10:25,122 INFO 	iter: 480, batch loss: 1.221144437789917, batch acc: 0.500000
2025-06-20 20:13:09,139 INFO 	iter: 500, batch loss: 0.9559326767921448, batch acc: 0.718750
2025-06-20 20:15:31,102 INFO 	iter: 520, batch loss: 1.0663485527038574, batch acc: 0.656250
2025-06-20 20:17:41,608 INFO 	iter: 540, batch loss: 1.0914238691329956, batch acc: 0.593750
2025-06-20 20:19:50,198 INFO 	iter: 560, batch loss: 1.1314400434494019, batch acc: 0.687500
2025-06-20 20:21:57,460 INFO 	iter: 580, batch loss: 1.1762391328811646, batch acc: 0.656250
2025-06-20 20:23:59,730 INFO 	iter: 600, batch loss: 1.0478503704071045, batch acc: 0.656250
2025-06-20 20:26:00,306 INFO 	iter: 620, batch loss: 1.0802013874053955, batch acc: 0.687500
2025-06-20 20:26:01,846 INFO Epoch: loss: 1.110163, acc: 0.624798
2025-06-20 20:26:01,847 INFO Epoch 4 finished. Checkpoint saved.
2025-06-20 20:29:59,093 INFO 	iter: 640, batch loss: 1.0785741806030273, batch acc: 0.718750
2025-06-20 20:32:32,679 INFO 	iter: 660, batch loss: 1.1343837976455688, batch acc: 0.562500
2025-06-20 20:34:51,587 INFO 	iter: 680, batch loss: 1.1105637550354004, batch acc: 0.687500
2025-06-20 20:37:05,148 INFO 	iter: 700, batch loss: 1.0074255466461182, batch acc: 0.718750
2025-06-20 20:39:16,958 INFO 	iter: 720, batch loss: 1.0739482641220093, batch acc: 0.656250
2025-06-20 20:41:21,465 INFO 	iter: 740, batch loss: 1.0904895067214966, batch acc: 0.625000
2025-06-20 20:43:24,755 INFO 	iter: 760, batch loss: 1.149484634399414, batch acc: 0.625000
2025-06-20 20:44:57,136 INFO Epoch: loss: 1.094691, acc: 0.623992
2025-06-20 20:44:57,137 INFO Epoch 5 finished. Checkpoint saved.
2025-06-20 20:46:31,424 INFO 	iter: 780, batch loss: 0.9758590459823608, batch acc: 0.750000
2025-06-20 20:49:39,340 INFO 	iter: 800, batch loss: 1.0587444305419922, batch acc: 0.718750
2025-06-20 20:52:08,499 INFO 	iter: 820, batch loss: 1.1363976001739502, batch acc: 0.500000
2025-06-20 20:54:27,928 INFO 	iter: 840, batch loss: 1.149430751800537, batch acc: 0.468750
2025-06-20 20:56:41,592 INFO 	iter: 860, batch loss: 1.1568474769592285, batch acc: 0.656250
2025-06-20 20:58:51,670 INFO 	iter: 880, batch loss: 1.0755908489227295, batch acc: 0.625000
2025-06-20 21:00:57,712 INFO 	iter: 900, batch loss: 1.0372239351272583, batch acc: 0.562500
2025-06-20 21:03:02,293 INFO 	iter: 920, batch loss: 1.1126512289047241, batch acc: 0.593750
2025-06-20 21:04:04,426 INFO Epoch: loss: 1.092824, acc: 0.606250
2025-06-20 21:04:04,427 INFO Epoch 6 finished. Checkpoint saved.
2025-06-20 21:06:38,968 INFO 	iter: 940, batch loss: 1.1909173727035522, batch acc: 0.531250
2025-06-20 21:09:27,902 INFO 	iter: 960, batch loss: 1.1154817342758179, batch acc: 0.531250
2025-06-20 21:11:58,681 INFO 	iter: 980, batch loss: 1.1087636947631836, batch acc: 0.593750
2025-06-20 21:14:13,172 INFO 	iter: 1000, batch loss: 1.073211908340454, batch acc: 0.656250
2025-06-20 21:16:28,363 INFO 	iter: 1020, batch loss: 1.112568974494934, batch acc: 0.562500
2025-06-20 21:18:38,907 INFO 	iter: 1040, batch loss: 1.0883440971374512, batch acc: 0.656250
2025-06-20 21:20:44,034 INFO 	iter: 1060, batch loss: 1.1078099012374878, batch acc: 0.531250
2025-06-20 21:22:47,974 INFO 	iter: 1080, batch loss: 1.1336044073104858, batch acc: 0.531250
2025-06-20 21:23:19,722 INFO Epoch: loss: 1.080241, acc: 0.592540
2025-06-20 21:23:19,722 INFO Epoch 7 finished. Checkpoint saved.
2025-06-20 21:26:38,998 INFO 	iter: 1100, batch loss: 0.9747567772865295, batch acc: 0.718750
2025-06-20 21:29:29,366 INFO 	iter: 1120, batch loss: 1.0838727951049805, batch acc: 0.468750
2025-06-20 21:31:52,935 INFO 	iter: 1140, batch loss: 1.0784209966659546, batch acc: 0.687500
2025-06-20 21:34:09,105 INFO 	iter: 1160, batch loss: 0.9270808696746826, batch acc: 0.812500
2025-06-20 21:36:23,407 INFO 	iter: 1180, batch loss: 1.1961390972137451, batch acc: 0.406250
2025-06-20 21:38:33,115 INFO 	iter: 1200, batch loss: 0.9994933009147644, batch acc: 0.656250
2025-06-20 21:40:40,113 INFO 	iter: 1220, batch loss: 1.0442225933074951, batch acc: 0.500000
2025-06-20 21:42:44,924 INFO 	iter: 1240, batch loss: 0.9809406995773315, batch acc: 0.687500
2025-06-20 21:42:46,726 INFO Epoch: loss: 1.071719, acc: 0.592137
2025-06-20 21:42:46,726 INFO Epoch 8 finished. Checkpoint saved.
2025-06-20 21:46:54,866 INFO 	iter: 1260, batch loss: 1.0822117328643799, batch acc: 0.593750
2025-06-20 21:49:34,730 INFO 	iter: 1280, batch loss: 1.166121482849121, batch acc: 0.468750
2025-06-20 21:51:59,196 INFO 	iter: 1300, batch loss: 1.0068706274032593, batch acc: 0.593750
2025-06-20 21:54:14,736 INFO 	iter: 1320, batch loss: 1.0700455904006958, batch acc: 0.562500
2025-06-20 21:56:29,715 INFO 	iter: 1340, batch loss: 1.0420039892196655, batch acc: 0.531250
2025-06-20 21:58:39,605 INFO 	iter: 1360, batch loss: 1.0424556732177734, batch acc: 0.531250
2025-06-20 22:00:46,186 INFO 	iter: 1380, batch loss: 1.0486619472503662, batch acc: 0.625000
2025-06-20 22:02:20,486 INFO Epoch: loss: 1.062788, acc: 0.586089
2025-06-20 22:02:20,487 INFO Epoch 9 finished. Checkpoint saved.
2025-06-20 22:03:58,214 INFO 	iter: 1400, batch loss: 1.037225365638733, batch acc: 0.562500
2025-06-20 22:07:08,269 INFO 	iter: 1420, batch loss: 1.052776575088501, batch acc: 0.625000
2025-06-20 22:09:45,066 INFO 	iter: 1440, batch loss: 1.0060510635375977, batch acc: 0.593750
2025-06-20 22:12:06,540 INFO 	iter: 1460, batch loss: 1.063204288482666, batch acc: 0.531250
2025-06-20 22:14:24,687 INFO 	iter: 1480, batch loss: 1.0364421606063843, batch acc: 0.687500
2025-06-20 22:16:39,317 INFO 	iter: 1500, batch loss: 1.0228627920150757, batch acc: 0.562500
2025-06-20 22:18:49,669 INFO 	iter: 1520, batch loss: 1.0374433994293213, batch acc: 0.531250
2025-06-20 22:20:57,589 INFO 	iter: 1540, batch loss: 1.1019881963729858, batch acc: 0.531250
2025-06-20 22:22:02,370 INFO Epoch: loss: 1.058405, acc: 0.595161
2025-06-20 22:22:02,370 INFO Epoch 10 finished. Checkpoint saved.
2025-06-20 22:22:02,370 INFO Generating diagnostic plots...
2025-06-20 22:22:07,674 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-20 22:23:46,444 INFO Completed dev evaluation: size=656.0, acc=0.5274
2025-06-20 22:23:46,451 INFO 	Eval, eval loss: 1.0522221326828003, acc: 0.527439, mcc: 0.063252
2025-06-20 22:24:07,352 INFO ASSEMBLE: word table #replacement: 19482
2025-06-20 22:24:08,734 INFO Word table init: done!
2025-06-20 22:24:09,233 INFO Model: all-hedge-gru_0e42a2bb, session restored from latest checkpoint!
2025-06-20 22:24:09,233 INFO Start test phase...
2025-06-20 22:26:16,393 INFO Completed test evaluation: size=1008.0, acc=0.5258
2025-06-20 22:26:16,400 INFO 	Eval, eval loss: 1.1302043199539185, acc: 0.525794, mcc: 0.023648
2025-06-21 06:03:11,537 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 06:03:11,537 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 06:03:11,537 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 06:03:11,540 INFO Start graph assembling...
2025-06-21 06:03:12,468 INFO use_dual_path_srl: True
2025-06-21 06:03:12,469 INFO variant_type: hedge
2025-06-21 06:03:12,469 INFO use_enhanced_srl: True
2025-06-21 06:03:12,469 INFO Enhanced SRL enabled from config
2025-06-21 06:03:12,469 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 06:03:12,469 INFO SRL condition: True = True and True
2025-06-21 06:03:12,469 INFO Using enhanced dual-path SRL architecture
2025-06-21 06:03:12,469 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 06:03:12,866 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 06:03:12,866 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 06:03:12,866 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 06:09:22,678 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 06:09:22,679 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 06:09:22,679 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 06:09:22,681 INFO Start graph assembling...
2025-06-21 06:09:23,527 INFO use_dual_path_srl: True
2025-06-21 06:09:23,528 INFO variant_type: hedge
2025-06-21 06:09:23,528 INFO use_enhanced_srl: True
2025-06-21 06:09:23,528 INFO Enhanced SRL enabled from config
2025-06-21 06:09:23,528 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 06:09:23,528 INFO SRL condition: True = True and True
2025-06-21 06:09:23,528 INFO Using enhanced dual-path SRL architecture
2025-06-21 06:09:23,528 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 06:09:23,936 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 06:09:23,936 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 06:09:23,936 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 06:20:52,601 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 06:20:52,602 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 06:20:52,602 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 06:20:52,604 INFO Start graph assembling...
2025-06-21 06:20:53,429 INFO use_dual_path_srl: True
2025-06-21 06:20:53,429 INFO variant_type: hedge
2025-06-21 06:20:53,430 INFO use_enhanced_srl: True
2025-06-21 06:20:53,430 INFO Enhanced SRL enabled from config
2025-06-21 06:20:53,430 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 06:20:53,430 INFO SRL condition: True = True and True
2025-06-21 06:20:53,430 INFO Using enhanced dual-path SRL architecture
2025-06-21 06:20:53,430 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 06:20:53,826 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 06:20:53,826 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 06:20:53,826 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 06:20:54,272 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 06:20:54,272 INFO Ca-TSU enabled: True
2025-06-21 06:20:54,272 INFO Enhanced SRL enabled: True
2025-06-21 06:20:54,272 INFO Noise-Aware Loss enabled: True
2025-06-21 06:20:54,295 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 06:20:54,295 INFO Adding auxiliary enhancement losses...
2025-06-21 06:20:54,300 INFO Creating standard Contrastive Loss component...
2025-06-21 06:20:54,302 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 06:20:54,303 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 06:20:54,303 INFO Causal Loss KL Divergence: P(alpha_i) shape=(?, 5, 20), Q(omega_i) shape=<unknown>
2025-06-21 06:20:54,317 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 06:20:54,319 INFO Adding L2 regularization loss to total loss: Tensor("l2_regularization_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 06:20:54,319 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 06:20:54,319 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 06:20:57,594 INFO Graph assembled successfully.
2025-06-21 06:21:19,380 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 06:21:22,490 INFO Word table initialized.
2025-06-21 06:21:22,750 INFO Model: all-hedge-gru_0e42a2bb, session restored from checkpoint.
2025-06-21 06:50:14,839 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 06:50:14,839 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 06:50:14,839 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 06:50:14,842 INFO Start graph assembling...
2025-06-21 07:54:09,073 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 07:54:09,073 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 07:54:09,074 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 07:54:09,076 INFO Start graph assembling...
2025-06-21 08:02:28,121 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:02:28,121 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:02:28,121 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:02:28,124 INFO Start graph assembling...
2025-06-21 08:02:28,979 INFO use_dual_path_srl: True
2025-06-21 08:02:28,979 INFO variant_type: hedge
2025-06-21 08:02:28,979 INFO use_enhanced_srl: True
2025-06-21 08:02:28,980 INFO Enhanced SRL enabled from config
2025-06-21 08:02:28,980 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:02:28,980 INFO SRL condition: True = True and True
2025-06-21 08:02:28,980 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:02:28,980 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:02:29,394 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:02:29,394 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:02:29,394 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:07:34,258 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:07:34,258 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:07:34,258 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:07:34,260 INFO Start graph assembling...
2025-06-21 08:07:35,090 INFO use_dual_path_srl: True
2025-06-21 08:07:35,091 INFO variant_type: hedge
2025-06-21 08:07:35,091 INFO use_enhanced_srl: True
2025-06-21 08:07:35,091 INFO Enhanced SRL enabled from config
2025-06-21 08:07:35,091 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:07:35,091 INFO SRL condition: True = True and True
2025-06-21 08:07:35,091 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:07:35,091 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:07:35,491 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:07:35,491 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:07:35,492 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:14:58,051 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:14:58,051 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:14:58,051 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:14:58,054 INFO Start graph assembling...
2025-06-21 08:14:58,877 INFO use_dual_path_srl: True
2025-06-21 08:14:58,877 INFO variant_type: hedge
2025-06-21 08:14:58,877 INFO use_enhanced_srl: True
2025-06-21 08:14:58,877 INFO Enhanced SRL enabled from config
2025-06-21 08:14:58,877 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:14:58,877 INFO SRL condition: True = True and True
2025-06-21 08:14:58,877 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:14:58,877 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:14:59,274 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:14:59,274 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:14:59,275 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:22:04,293 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:22:04,293 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:22:04,293 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:22:04,295 INFO Start graph assembling...
2025-06-21 08:22:05,133 INFO use_dual_path_srl: True
2025-06-21 08:22:05,134 INFO variant_type: hedge
2025-06-21 08:22:05,134 INFO use_enhanced_srl: True
2025-06-21 08:22:05,134 INFO Enhanced SRL enabled from config
2025-06-21 08:22:05,134 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:22:05,134 INFO SRL condition: True = True and True
2025-06-21 08:22:05,134 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:22:05,134 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:22:05,538 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:22:05,538 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:22:05,538 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:28:28,150 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:28:28,150 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:28:28,151 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:28:28,153 INFO Start graph assembling...
2025-06-21 08:28:28,976 INFO use_dual_path_srl: True
2025-06-21 08:28:28,976 INFO variant_type: hedge
2025-06-21 08:28:28,976 INFO use_enhanced_srl: True
2025-06-21 08:28:28,976 INFO Enhanced SRL enabled from config
2025-06-21 08:28:28,976 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:28:28,976 INFO SRL condition: True = True and True
2025-06-21 08:28:28,976 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:28:28,976 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:28:29,373 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:28:29,373 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:28:29,373 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:32:04,244 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:32:04,245 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:32:04,245 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:32:04,247 INFO Start graph assembling...
2025-06-21 08:32:05,087 INFO use_dual_path_srl: True
2025-06-21 08:32:05,088 INFO variant_type: hedge
2025-06-21 08:32:05,088 INFO use_enhanced_srl: True
2025-06-21 08:32:05,088 INFO Enhanced SRL enabled from config
2025-06-21 08:32:05,088 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:32:05,088 INFO SRL condition: True = True and True
2025-06-21 08:32:05,088 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:32:05,088 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:32:05,493 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:32:05,493 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:32:05,493 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 08:53:59,170 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 08:53:59,170 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 08:53:59,171 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 08:53:59,173 INFO Start graph assembling...
2025-06-21 08:54:00,004 INFO use_dual_path_srl: True
2025-06-21 08:54:00,005 INFO variant_type: hedge
2025-06-21 08:54:00,005 INFO use_enhanced_srl: True
2025-06-21 08:54:00,005 INFO Enhanced SRL enabled from config
2025-06-21 08:54:00,005 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 08:54:00,005 INFO SRL condition: True = True and True
2025-06-21 08:54:00,005 INFO Using enhanced dual-path SRL architecture
2025-06-21 08:54:00,005 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 08:54:00,405 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 08:54:00,406 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 08:54:00,406 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 09:15:48,574 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 09:15:48,574 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 09:15:48,575 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 09:15:48,577 INFO Start graph assembling...
2025-06-21 09:15:49,406 INFO use_dual_path_srl: True
2025-06-21 09:15:49,406 INFO variant_type: hedge
2025-06-21 09:15:49,406 INFO use_enhanced_srl: True
2025-06-21 09:15:49,406 INFO Enhanced SRL enabled from config
2025-06-21 09:15:49,406 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 09:15:49,406 INFO SRL condition: True = True and True
2025-06-21 09:15:49,406 INFO Using enhanced dual-path SRL architecture
2025-06-21 09:15:49,406 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 09:15:49,801 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 09:15:49,802 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 09:15:49,802 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 09:19:38,431 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 09:19:38,431 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 09:19:38,432 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 09:19:38,434 INFO Start graph assembling...
2025-06-21 09:19:39,277 INFO use_dual_path_srl: True
2025-06-21 09:19:39,281 INFO variant_type: hedge
2025-06-21 09:19:39,281 INFO use_enhanced_srl: True
2025-06-21 09:19:39,281 INFO Enhanced SRL enabled from config
2025-06-21 09:19:39,281 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 09:19:39,282 INFO SRL condition: True = True and True
2025-06-21 09:19:39,282 INFO Using enhanced dual-path SRL architecture
2025-06-21 09:19:39,282 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 09:19:39,690 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 09:19:39,690 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 09:19:39,690 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 09:34:30,223 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 09:34:30,223 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 09:34:30,224 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 09:34:30,226 INFO Start graph assembling...
2025-06-21 09:34:31,067 INFO use_dual_path_srl: True
2025-06-21 09:34:31,074 INFO variant_type: hedge
2025-06-21 09:34:31,074 INFO use_enhanced_srl: True
2025-06-21 09:34:31,074 INFO Enhanced SRL enabled from config
2025-06-21 09:34:31,074 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 09:34:31,074 INFO SRL condition: True = True and True
2025-06-21 09:34:31,074 INFO Using enhanced dual-path SRL architecture
2025-06-21 09:34:31,074 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 09:34:31,496 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 09:34:31,497 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 09:34:31,497 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 09:34:31,904 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 09:34:31,905 INFO Ca-TSU enabled: True
2025-06-21 09:34:31,905 INFO Enhanced SRL enabled: True
2025-06-21 09:34:31,905 INFO Noise-Aware Loss enabled: True
2025-06-21 10:01:50,943 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 10:01:50,943 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 10:01:50,944 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 10:01:50,946 INFO Start graph assembling...
2025-06-21 10:01:51,764 INFO use_dual_path_srl: True
2025-06-21 10:01:51,764 INFO variant_type: hedge
2025-06-21 10:01:51,764 INFO use_enhanced_srl: True
2025-06-21 10:01:51,765 INFO Enhanced SRL enabled from config
2025-06-21 10:01:51,765 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 10:01:51,765 INFO SRL condition: True = True and True
2025-06-21 10:01:51,765 INFO Using enhanced dual-path SRL architecture
2025-06-21 10:01:51,765 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 10:01:52,167 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 10:01:52,167 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 10:01:52,167 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 10:01:52,578 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 10:01:52,578 INFO Ca-TSU enabled: True
2025-06-21 10:01:52,578 INFO Enhanced SRL enabled: True
2025-06-21 10:01:52,578 INFO Noise-Aware Loss enabled: True
2025-06-21 10:01:52,602 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:01:52,602 INFO Adding auxiliary enhancement losses...
2025-06-21 10:01:52,607 INFO Creating standard Contrastive Loss component...
2025-06-21 10:01:52,608 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 10:01:52,609 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 10:01:52,625 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 10:01:52,626 INFO Adding L2 regularization loss to total loss: Tensor("AddN:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 10:01:52,626 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:01:52,626 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 10:01:55,809 INFO Graph assembled successfully.
2025-06-21 10:02:17,567 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 10:02:20,249 INFO Word table initialized.
2025-06-21 10:02:20,525 ERROR Could not restore checkpoint: Key tda/v_i/linear/W/Adam not found in checkpoint
	 [[Node: save/RestoreV2_106 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_106/tensor_names, save/RestoreV2_106/shape_and_slices)]]
	 [[Node: save/RestoreV2_54/_143 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_506_save/RestoreV2_54", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_106', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key tda/v_i/linear/W/Adam not found in checkpoint
	 [[Node: save/RestoreV2_106 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_106/tensor_names, save/RestoreV2_106/shape_and_slices)]]
	 [[Node: save/RestoreV2_54/_143 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_506_save/RestoreV2_54", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 10:20:53,968 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 10:20:53,968 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 10:20:53,969 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 10:20:53,971 INFO Start graph assembling...
2025-06-21 10:20:54,793 INFO use_dual_path_srl: True
2025-06-21 10:20:54,793 INFO variant_type: hedge
2025-06-21 10:20:54,793 INFO use_enhanced_srl: True
2025-06-21 10:20:54,793 INFO Enhanced SRL enabled from config
2025-06-21 10:20:54,793 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 10:20:54,793 INFO SRL condition: True = True and True
2025-06-21 10:20:54,793 INFO Using enhanced dual-path SRL architecture
2025-06-21 10:20:54,793 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 10:20:55,189 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 10:20:55,189 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 10:20:55,189 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 10:20:55,587 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 10:20:55,587 INFO Ca-TSU enabled: True
2025-06-21 10:20:55,587 INFO Enhanced SRL enabled: True
2025-06-21 10:20:55,587 INFO Noise-Aware Loss enabled: True
2025-06-21 10:20:55,610 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:20:55,610 INFO Adding auxiliary enhancement losses...
2025-06-21 10:20:55,615 INFO Creating standard Contrastive Loss component...
2025-06-21 10:20:55,616 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 10:20:55,617 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 10:20:55,631 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 10:20:55,633 INFO Adding L2 regularization loss to total loss: Tensor("add_1:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 10:20:55,634 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:20:55,634 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 10:20:58,765 INFO Graph assembled successfully.
2025-06-21 10:21:20,548 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 10:21:21,911 INFO Word table initialized.
2025-06-21 10:21:22,105 ERROR Could not restore checkpoint: Key tda/v_i/linear/W/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_107 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_107/tensor_names, save/RestoreV2_107/shape_and_slices)]]
	 [[Node: save/RestoreV2_106/_25 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_388_save/RestoreV2_106", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_107', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key tda/v_i/linear/W/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_107 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_107/tensor_names, save/RestoreV2_107/shape_and_slices)]]
	 [[Node: save/RestoreV2_106/_25 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_388_save/RestoreV2_106", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 10:35:46,467 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 10:35:46,469 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 10:35:46,469 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 10:35:46,496 INFO Start graph assembling...
2025-06-21 10:35:47,494 INFO use_dual_path_srl: True
2025-06-21 10:35:47,494 INFO variant_type: hedge
2025-06-21 10:35:47,494 INFO use_enhanced_srl: True
2025-06-21 10:35:47,494 INFO Enhanced SRL enabled from config
2025-06-21 10:35:47,494 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 10:35:47,494 INFO SRL condition: True = True and True
2025-06-21 10:35:47,494 INFO Using enhanced dual-path SRL architecture
2025-06-21 10:35:47,494 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 10:35:47,748 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 10:35:47,748 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 10:35:47,748 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 10:35:47,998 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 10:35:47,998 INFO Ca-TSU enabled: True
2025-06-21 10:35:47,998 INFO Enhanced SRL enabled: True
2025-06-21 10:35:47,998 INFO Noise-Aware Loss enabled: True
2025-06-21 10:35:48,012 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:35:48,012 INFO Adding auxiliary enhancement losses...
2025-06-21 10:35:48,015 INFO Creating standard Contrastive Loss component...
2025-06-21 10:35:48,015 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 10:35:48,016 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 10:35:48,025 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 10:35:48,026 INFO Adding manually-handled L2 regularization loss to total loss: Tensor("add_1:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 10:35:48,026 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:35:48,026 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 10:35:50,024 INFO Graph assembled successfully.
2025-06-21 10:36:19,792 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 10:37:53,455 INFO Word table initialized.
2025-06-21 10:37:57,648 ERROR Could not restore checkpoint: Key vmd_zh_rec/z_prior/z_mu/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_182 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_182/tensor_names, save/RestoreV2_182/shape_and_slices)]]
	 [[Node: save/RestoreV2_54/_143 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_506_save/RestoreV2_54", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_182', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key vmd_zh_rec/z_prior/z_mu/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_182 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_182/tensor_names, save/RestoreV2_182/shape_and_slices)]]
	 [[Node: save/RestoreV2_54/_143 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_506_save/RestoreV2_54", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 10:49:39,547 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 10:49:39,547 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 10:49:39,548 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 10:49:39,549 INFO Start graph assembling...
2025-06-21 10:49:40,060 INFO use_dual_path_srl: True
2025-06-21 10:49:40,060 INFO variant_type: hedge
2025-06-21 10:49:40,060 INFO use_enhanced_srl: True
2025-06-21 10:49:40,060 INFO Enhanced SRL enabled from config
2025-06-21 10:49:40,060 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 10:49:40,060 INFO SRL condition: True = True and True
2025-06-21 10:49:40,060 INFO Using enhanced dual-path SRL architecture
2025-06-21 10:49:40,060 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 10:49:40,298 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 10:49:40,298 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 10:49:40,298 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 10:54:07,309 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 10:54:07,309 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 10:54:07,309 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 10:54:07,311 INFO Start graph assembling...
2025-06-21 10:54:07,817 INFO use_dual_path_srl: True
2025-06-21 10:54:07,817 INFO variant_type: hedge
2025-06-21 10:54:07,817 INFO use_enhanced_srl: True
2025-06-21 10:54:07,818 INFO Enhanced SRL enabled from config
2025-06-21 10:54:07,818 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 10:54:07,818 INFO SRL condition: True = True and True
2025-06-21 10:54:07,818 INFO Using enhanced dual-path SRL architecture
2025-06-21 10:54:07,818 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 10:54:08,053 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 10:54:08,053 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 10:54:08,053 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 10:54:08,311 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 10:54:08,311 INFO Ca-TSU enabled: True
2025-06-21 10:54:08,311 INFO Enhanced SRL enabled: True
2025-06-21 10:54:08,311 INFO Noise-Aware Loss enabled: True
2025-06-21 10:54:08,324 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:54:08,324 INFO Adding auxiliary enhancement losses...
2025-06-21 10:54:08,327 INFO Creating standard Contrastive Loss component...
2025-06-21 10:54:08,328 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 10:54:08,328 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 10:54:08,337 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 10:54:08,338 INFO Adding manually-handled L2 regularization loss to total loss: Tensor("add:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 10:54:08,338 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 10:54:08,338 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 10:54:10,349 INFO Graph assembled successfully.
2025-06-21 10:54:25,069 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 10:54:26,684 INFO Word table initialized.
2025-06-21 10:54:27,229 ERROR Could not restore checkpoint: Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_88/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_610_save/RestoreV2_88", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_194', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_88/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_610_save/RestoreV2_88", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 11:10:29,312 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 11:10:29,312 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 11:10:29,313 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 11:10:29,314 INFO Start graph assembling...
2025-06-21 11:10:29,823 INFO use_dual_path_srl: True
2025-06-21 11:10:29,823 INFO variant_type: hedge
2025-06-21 11:10:29,823 INFO use_enhanced_srl: True
2025-06-21 11:10:29,823 INFO Enhanced SRL enabled from config
2025-06-21 11:10:29,823 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 11:10:29,823 INFO SRL condition: True = True and True
2025-06-21 11:10:29,823 INFO Using enhanced dual-path SRL architecture
2025-06-21 11:10:29,823 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 11:10:30,059 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 11:10:30,059 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 11:10:30,059 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 11:10:30,316 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 11:10:30,316 INFO Ca-TSU enabled: True
2025-06-21 11:10:30,316 INFO Enhanced SRL enabled: True
2025-06-21 11:10:30,316 INFO Noise-Aware Loss enabled: True
2025-06-21 11:10:30,330 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:10:30,330 INFO Adding auxiliary enhancement losses...
2025-06-21 11:10:30,333 INFO Creating standard Contrastive Loss component...
2025-06-21 11:10:30,333 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 11:10:30,334 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 11:10:30,343 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 11:10:30,344 INFO Adding manually-handled L2 regularization loss to total loss: Tensor("add:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 11:10:30,344 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:10:30,344 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 11:10:32,386 INFO Graph assembled successfully.
2025-06-21 11:10:47,148 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 11:10:51,070 INFO Word table initialized.
2025-06-21 11:10:51,322 ERROR Could not restore checkpoint: Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_95/_347 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_734_save/RestoreV2_95", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_194', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_95/_347 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_734_save/RestoreV2_95", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 11:23:37,258 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 11:23:37,258 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 11:23:37,258 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 11:23:37,260 INFO Start graph assembling...
2025-06-21 11:23:37,772 INFO use_dual_path_srl: True
2025-06-21 11:23:37,773 INFO variant_type: hedge
2025-06-21 11:23:37,773 INFO use_enhanced_srl: True
2025-06-21 11:23:37,773 INFO Enhanced SRL enabled from config
2025-06-21 11:23:37,773 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 11:23:37,773 INFO SRL condition: True = True and True
2025-06-21 11:23:37,773 INFO Using enhanced dual-path SRL architecture
2025-06-21 11:23:37,773 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 11:23:38,008 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 11:23:38,008 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 11:23:38,008 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 11:23:38,271 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 11:23:38,271 INFO Ca-TSU enabled: True
2025-06-21 11:23:38,271 INFO Enhanced SRL enabled: True
2025-06-21 11:23:38,271 INFO Noise-Aware Loss enabled: True
2025-06-21 11:23:38,285 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:23:38,285 INFO Adding auxiliary enhancement losses...
2025-06-21 11:23:38,287 INFO Creating standard Contrastive Loss component...
2025-06-21 11:23:38,288 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 11:23:38,289 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 11:23:38,298 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 11:23:38,298 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 11:23:38,298 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:23:38,298 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 11:23:40,318 INFO Graph assembled successfully.
2025-06-21 11:23:55,169 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 11:23:59,863 INFO Word table initialized.
2025-06-21 11:24:00,085 ERROR Could not restore checkpoint: Key tda/v_d/linear/W not found in checkpoint
	 [[Node: save/RestoreV2_102 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_102/tensor_names, save/RestoreV2_102/shape_and_slices)]]
	 [[Node: save/RestoreV2_181/_113 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_500_save/RestoreV2_181", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_102', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key tda/v_d/linear/W not found in checkpoint
	 [[Node: save/RestoreV2_102 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_102/tensor_names, save/RestoreV2_102/shape_and_slices)]]
	 [[Node: save/RestoreV2_181/_113 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_500_save/RestoreV2_181", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 11:34:22,618 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 11:34:22,618 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 11:34:22,618 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 11:34:22,620 INFO Start graph assembling...
2025-06-21 11:34:23,130 INFO use_dual_path_srl: True
2025-06-21 11:34:23,130 INFO variant_type: hedge
2025-06-21 11:34:23,130 INFO use_enhanced_srl: True
2025-06-21 11:34:23,130 INFO Enhanced SRL enabled from config
2025-06-21 11:34:23,130 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 11:34:23,130 INFO SRL condition: True = True and True
2025-06-21 11:34:23,130 INFO Using enhanced dual-path SRL architecture
2025-06-21 11:34:23,130 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 11:34:23,365 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 11:34:23,365 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 11:34:23,365 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 11:34:23,628 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 11:34:23,628 INFO Ca-TSU enabled: True
2025-06-21 11:34:23,628 INFO Enhanced SRL enabled: True
2025-06-21 11:34:23,628 INFO Noise-Aware Loss enabled: True
2025-06-21 11:34:23,642 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:34:23,642 INFO Adding auxiliary enhancement losses...
2025-06-21 11:34:23,644 INFO Creating standard Contrastive Loss component...
2025-06-21 11:34:23,645 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 11:34:23,646 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 11:34:23,655 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 11:34:23,655 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 11:34:23,655 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:34:23,655 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 11:34:25,612 INFO Graph assembled successfully.
2025-06-21 11:34:40,513 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 11:34:43,555 INFO Word table initialized.
2025-06-21 11:34:43,780 ERROR Could not restore checkpoint: Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_88/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_610_save/RestoreV2_88", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_194', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key vmd_zh_rec/y/linear/b/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_194 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_194/tensor_names, save/RestoreV2_194/shape_and_slices)]]
	 [[Node: save/RestoreV2_88/_223 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_610_save/RestoreV2_88", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-21 11:40:36,456 INFO 	iter: 1560, batch loss: 17.974123001098633, batch acc: 0.531250
2025-06-21 11:44:08,492 INFO 	iter: 1580, batch loss: 5.957228183746338, batch acc: 0.437500
2025-06-21 11:48:33,071 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 11:48:33,071 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 11:48:33,072 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 11:48:33,075 INFO Start graph assembling...
2025-06-21 11:48:33,991 INFO use_dual_path_srl: True
2025-06-21 11:48:33,991 INFO variant_type: hedge
2025-06-21 11:48:33,991 INFO use_enhanced_srl: True
2025-06-21 11:48:33,991 INFO Enhanced SRL enabled from config
2025-06-21 11:48:33,991 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 11:48:33,991 INFO SRL condition: True = True and True
2025-06-21 11:48:33,991 INFO Using enhanced dual-path SRL architecture
2025-06-21 11:48:33,991 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 11:48:34,409 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 11:48:34,409 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 11:48:34,409 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 11:48:34,868 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 11:48:34,868 INFO Ca-TSU enabled: True
2025-06-21 11:48:34,868 INFO Enhanced SRL enabled: True
2025-06-21 11:48:34,868 INFO Noise-Aware Loss enabled: True
2025-06-21 11:48:34,892 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:48:34,892 INFO Adding auxiliary enhancement losses...
2025-06-21 11:48:34,898 INFO Creating standard Contrastive Loss component...
2025-06-21 11:48:34,899 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 11:48:34,900 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 11:48:34,916 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 11:48:34,917 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 11:48:34,917 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 11:48:34,917 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 11:48:38,217 INFO Graph assembled successfully.
2025-06-21 11:48:59,574 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 11:49:01,552 INFO Word table initialized.
2025-06-21 11:49:01,552 INFO Model: all-hedge-gru_0e42a2bb, starting new session.
2025-06-21 11:53:14,096 INFO 	iter: 20, batch loss: 3.7211625576019287, batch acc: 0.531250
2025-06-21 11:55:49,323 INFO 	iter: 40, batch loss: 2.411672353744507, batch acc: 0.718750
2025-06-21 11:58:05,892 INFO 	iter: 60, batch loss: 1.962022304534912, batch acc: 0.750000
2025-06-21 12:00:17,104 INFO 	iter: 80, batch loss: 1.7553699016571045, batch acc: 0.812500
2025-06-21 12:02:23,901 INFO 	iter: 100, batch loss: 1.7145682573318481, batch acc: 0.781250
2025-06-21 12:04:25,997 INFO 	iter: 120, batch loss: 1.7043064832687378, batch acc: 0.812500
2025-06-21 12:06:26,223 INFO 	iter: 140, batch loss: 1.6199051141738892, batch acc: 0.656250
2025-06-21 12:07:55,785 INFO Epoch: loss: 2.105760, acc: 0.729435
2025-06-21 12:07:55,786 INFO Epoch 1 finished. Checkpoint saved.
2025-06-21 12:09:29,480 INFO 	iter: 160, batch loss: 1.4776992797851562, batch acc: 0.750000
2025-06-21 12:12:39,773 INFO 	iter: 180, batch loss: 1.5244958400726318, batch acc: 0.781250
2025-06-21 12:15:10,402 INFO 	iter: 200, batch loss: 1.6105204820632935, batch acc: 0.593750
2025-06-21 12:17:28,276 INFO 	iter: 220, batch loss: 1.473012924194336, batch acc: 0.593750
2025-06-21 12:19:41,602 INFO 	iter: 240, batch loss: 1.260985016822815, batch acc: 0.812500
2025-06-21 12:21:53,407 INFO 	iter: 260, batch loss: 1.3995046615600586, batch acc: 0.531250
2025-06-21 12:23:57,952 INFO 	iter: 280, batch loss: 1.2452137470245361, batch acc: 0.593750
2025-06-21 12:26:00,208 INFO 	iter: 300, batch loss: 1.1429115533828735, batch acc: 0.750000
2025-06-21 12:27:01,290 INFO Epoch: loss: 1.394693, acc: 0.663306
2025-06-21 12:27:01,290 INFO Epoch 2 finished. Checkpoint saved.
2025-06-21 12:29:35,446 INFO 	iter: 320, batch loss: 1.0551270246505737, batch acc: 0.750000
2025-06-21 12:32:32,357 INFO 	iter: 340, batch loss: 1.2204583883285522, batch acc: 0.593750
2025-06-21 12:34:59,816 INFO 	iter: 360, batch loss: 1.0818134546279907, batch acc: 0.625000
2025-06-21 12:37:17,120 INFO 	iter: 380, batch loss: 1.259212851524353, batch acc: 0.500000
2025-06-21 12:39:30,498 INFO 	iter: 400, batch loss: 1.1455453634262085, batch acc: 0.625000
2025-06-21 12:41:37,083 INFO 	iter: 420, batch loss: 1.2249488830566406, batch acc: 0.625000
2025-06-21 12:43:40,766 INFO 	iter: 440, batch loss: 1.023505687713623, batch acc: 0.687500
2025-06-21 12:45:42,546 INFO 	iter: 460, batch loss: 1.1724200248718262, batch acc: 0.593750
2025-06-21 12:46:13,644 INFO Epoch: loss: 1.174150, acc: 0.622379
2025-06-21 12:46:13,644 INFO Epoch 3 finished. Checkpoint saved.
2025-06-21 12:49:42,702 INFO 	iter: 480, batch loss: 1.073298454284668, batch acc: 0.718750
2025-06-21 12:52:23,258 INFO 	iter: 500, batch loss: 1.245306372642517, batch acc: 0.437500
2025-06-21 12:54:46,288 INFO 	iter: 520, batch loss: 1.169256567955017, batch acc: 0.562500
2025-06-21 12:56:59,617 INFO 	iter: 540, batch loss: 1.043054223060608, batch acc: 0.718750
2025-06-21 12:59:12,261 INFO 	iter: 560, batch loss: 1.1221996545791626, batch acc: 0.687500
2025-06-21 13:01:19,665 INFO 	iter: 580, batch loss: 1.0896528959274292, batch acc: 0.593750
2025-06-21 13:03:22,366 INFO 	iter: 600, batch loss: 1.2266442775726318, batch acc: 0.531250
2025-06-21 13:05:24,340 INFO 	iter: 620, batch loss: 1.1050317287445068, batch acc: 0.718750
2025-06-21 13:05:25,946 INFO Epoch: loss: 1.113606, acc: 0.620968
2025-06-21 13:05:25,946 INFO Epoch 4 finished. Checkpoint saved.
2025-06-21 13:09:30,937 INFO 	iter: 640, batch loss: 1.1620334386825562, batch acc: 0.562500
2025-06-21 13:12:09,807 INFO 	iter: 660, batch loss: 1.0898418426513672, batch acc: 0.562500
2025-06-21 13:14:29,168 INFO 	iter: 680, batch loss: 1.0765044689178467, batch acc: 0.625000
2025-06-21 13:16:44,239 INFO 	iter: 700, batch loss: 1.0383527278900146, batch acc: 0.718750
2025-06-21 13:18:55,505 INFO 	iter: 720, batch loss: 1.1156131029129028, batch acc: 0.656250
2025-06-21 13:21:02,386 INFO 	iter: 740, batch loss: 1.2101597785949707, batch acc: 0.562500
2025-06-21 13:23:05,298 INFO 	iter: 760, batch loss: 1.0540062189102173, batch acc: 0.562500
2025-06-21 13:24:38,418 INFO Epoch: loss: 1.090699, acc: 0.619355
2025-06-21 13:24:38,419 INFO Epoch 5 finished. Checkpoint saved.
2025-06-21 13:26:21,522 INFO 	iter: 780, batch loss: 1.2175732851028442, batch acc: 0.531250
2025-06-21 13:29:28,599 INFO 	iter: 800, batch loss: 1.0569467544555664, batch acc: 0.656250
2025-06-21 13:31:58,421 INFO 	iter: 820, batch loss: 1.1382895708084106, batch acc: 0.593750
2025-06-21 13:34:18,195 INFO 	iter: 840, batch loss: 1.1011906862258911, batch acc: 0.562500
2025-06-21 13:36:33,260 INFO 	iter: 860, batch loss: 1.1503443717956543, batch acc: 0.593750
2025-06-21 13:38:45,464 INFO 	iter: 880, batch loss: 1.0945042371749878, batch acc: 0.437500
2025-06-21 13:40:56,821 INFO 	iter: 900, batch loss: 1.104761004447937, batch acc: 0.593750
2025-06-21 13:43:02,086 INFO 	iter: 920, batch loss: 0.9793881177902222, batch acc: 0.781250
2025-06-21 13:44:05,661 INFO Epoch: loss: 1.094650, acc: 0.594355
2025-06-21 13:44:05,661 INFO Epoch 6 finished. Checkpoint saved.
2025-06-21 13:46:41,829 INFO 	iter: 940, batch loss: 1.0694355964660645, batch acc: 0.750000
2025-06-21 13:49:35,919 INFO 	iter: 960, batch loss: 1.042136788368225, batch acc: 0.718750
2025-06-21 13:52:03,715 INFO 	iter: 980, batch loss: 1.0985132455825806, batch acc: 0.656250
2025-06-21 13:54:22,128 INFO 	iter: 1000, batch loss: 1.0407441854476929, batch acc: 0.656250
2025-06-21 13:56:37,264 INFO 	iter: 1020, batch loss: 1.159266471862793, batch acc: 0.562500
2025-06-21 13:58:50,760 INFO 	iter: 1040, batch loss: 1.1178420782089233, batch acc: 0.562500
2025-06-21 14:00:57,455 INFO 	iter: 1060, batch loss: 1.033839225769043, batch acc: 0.593750
2025-06-21 14:03:03,627 INFO 	iter: 1080, batch loss: 1.0830574035644531, batch acc: 0.531250
2025-06-21 14:03:36,196 INFO Epoch: loss: 1.087565, acc: 0.594355
2025-06-21 14:03:36,197 INFO Epoch 7 finished. Checkpoint saved.
2025-06-21 14:07:05,117 INFO 	iter: 1100, batch loss: 1.1201907396316528, batch acc: 0.531250
2025-06-21 14:09:48,556 INFO 	iter: 1120, batch loss: 1.0704938173294067, batch acc: 0.531250
2025-06-21 14:12:12,645 INFO 	iter: 1140, batch loss: 1.0854809284210205, batch acc: 0.531250
2025-06-21 14:14:32,512 INFO 	iter: 1160, batch loss: 1.0666495561599731, batch acc: 0.593750
2025-06-21 14:16:48,477 INFO 	iter: 1180, batch loss: 1.0154744386672974, batch acc: 0.562500
2025-06-21 14:19:00,165 INFO 	iter: 1200, batch loss: 1.0682789087295532, batch acc: 0.625000
2025-06-21 14:21:08,227 INFO 	iter: 1220, batch loss: 1.0876410007476807, batch acc: 0.625000
2025-06-21 14:23:14,381 INFO 	iter: 1240, batch loss: 0.9747201204299927, batch acc: 0.687500
2025-06-21 14:23:16,196 INFO Epoch: loss: 1.072436, acc: 0.585282
2025-06-21 14:23:16,196 INFO Epoch 8 finished. Checkpoint saved.
2025-06-21 14:27:24,896 INFO 	iter: 1260, batch loss: 1.1010916233062744, batch acc: 0.562500
2025-06-21 14:30:18,276 INFO 	iter: 1280, batch loss: 1.0494271516799927, batch acc: 0.593750
2025-06-21 14:32:40,175 INFO 	iter: 1300, batch loss: 1.0365214347839355, batch acc: 0.500000
2025-06-21 14:34:59,406 INFO 	iter: 1320, batch loss: 1.1647541522979736, batch acc: 0.375000
2025-06-21 14:37:15,887 INFO 	iter: 1340, batch loss: 1.0565593242645264, batch acc: 0.656250
2025-06-21 14:39:27,910 INFO 	iter: 1360, batch loss: 1.0303863286972046, batch acc: 0.687500
2025-06-21 14:41:36,071 INFO 	iter: 1380, batch loss: 1.1254500150680542, batch acc: 0.500000
2025-06-21 14:43:11,964 INFO Epoch: loss: 1.073150, acc: 0.582258
2025-06-21 14:43:11,965 INFO Epoch 9 finished. Checkpoint saved.
2025-06-21 14:44:52,785 INFO 	iter: 1400, batch loss: 1.0490264892578125, batch acc: 0.593750
2025-06-21 14:48:05,248 INFO 	iter: 1420, batch loss: 1.054918885231018, batch acc: 0.593750
2025-06-21 14:50:43,099 INFO 	iter: 1440, batch loss: 1.0561330318450928, batch acc: 0.687500
2025-06-21 14:53:07,896 INFO 	iter: 1460, batch loss: 1.049838662147522, batch acc: 0.531250
2025-06-21 14:55:24,119 INFO 	iter: 1480, batch loss: 1.0685899257659912, batch acc: 0.531250
2025-06-21 14:57:40,247 INFO 	iter: 1500, batch loss: 1.0982484817504883, batch acc: 0.656250
2025-06-21 14:59:53,124 INFO 	iter: 1520, batch loss: 1.0368609428405762, batch acc: 0.656250
2025-06-21 15:02:01,855 INFO 	iter: 1540, batch loss: 1.0056581497192383, batch acc: 0.625000
2025-06-21 15:03:06,592 INFO Epoch: loss: 1.058003, acc: 0.593347
2025-06-21 15:03:06,592 INFO Epoch 10 finished. Checkpoint saved.
2025-06-21 15:03:06,592 INFO Generating diagnostic plots...
2025-06-21 15:03:11,284 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-21 15:04:45,306 INFO Completed dev evaluation: size=656.0, acc=0.5351
2025-06-21 15:04:45,312 INFO 	Eval, eval loss: 1.0827009677886963, acc: 0.535061, mcc: 0.075072
2025-06-21 15:05:06,443 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 15:05:07,823 INFO Word table init: done!
2025-06-21 15:05:08,219 INFO Model: all-hedge-gru_0e42a2bb, session restored from latest checkpoint!
2025-06-21 15:05:08,220 INFO Start test phase...
2025-06-21 15:07:19,350 INFO Completed test evaluation: size=1008.0, acc=0.5615
2025-06-21 15:07:19,357 INFO 	Eval, eval loss: 1.0900474786758423, acc: 0.561508, mcc: -0.003493
2025-06-21 16:49:39,018 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 16:49:39,018 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 16:49:39,019 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 16:49:39,021 INFO Start graph assembling...
2025-06-21 16:49:39,949 INFO use_dual_path_srl: True
2025-06-21 16:49:39,949 INFO variant_type: hedge
2025-06-21 16:49:39,949 INFO use_enhanced_srl: True
2025-06-21 16:49:39,949 INFO Enhanced SRL enabled from config
2025-06-21 16:49:39,949 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 16:49:39,949 INFO SRL condition: True = True and True
2025-06-21 16:49:39,949 INFO Using enhanced dual-path SRL architecture
2025-06-21 16:49:39,949 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 16:49:40,367 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 16:49:40,367 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 16:49:40,367 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 16:49:40,824 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 16:49:40,825 INFO Ca-TSU enabled: True
2025-06-21 16:49:40,825 INFO Enhanced SRL enabled: True
2025-06-21 16:49:40,825 INFO Noise-Aware Loss enabled: True
2025-06-21 16:49:40,849 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 16:49:40,849 INFO Adding auxiliary enhancement losses...
2025-06-21 16:49:40,854 INFO Creating standard Contrastive Loss component...
2025-06-21 16:49:40,855 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 16:49:40,856 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 16:49:40,872 INFO Using KL-based Causal Consistency Loss with weight: 0.1
2025-06-21 16:49:40,873 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 16:49:40,873 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 16:49:40,873 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 16:49:44,206 INFO Graph assembled successfully.
2025-06-21 16:50:05,797 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 16:50:08,367 INFO Word table initialized.
2025-06-21 16:50:08,368 INFO Model: all-hedge-gru_45b8c7c1, starting new session.
2025-06-21 16:54:01,153 INFO 	iter: 20, batch loss: 0.8911136388778687, batch acc: 0.750000
2025-06-21 16:56:34,579 INFO 	iter: 40, batch loss: 0.9653815031051636, batch acc: 0.718750
2025-06-21 16:58:53,306 INFO 	iter: 60, batch loss: 0.761081337928772, batch acc: 0.812500
2025-06-21 17:01:04,609 INFO 	iter: 80, batch loss: 0.5707865357398987, batch acc: 0.937500
2025-06-21 17:03:15,340 INFO 	iter: 100, batch loss: 0.47323277592658997, batch acc: 0.968750
2025-06-21 17:05:17,884 INFO 	iter: 120, batch loss: 0.48955684900283813, batch acc: 0.968750
2025-06-21 17:07:18,862 INFO 	iter: 140, batch loss: 0.5233333110809326, batch acc: 0.937500
2025-06-21 17:08:49,055 INFO Epoch: loss: 0.687249, acc: 0.872177
2025-06-21 17:10:02,131 INFO Completed dev evaluation: size=656.0, acc=0.4954
2025-06-21 17:13:51,379 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 17:13:51,379 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 17:13:51,380 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 17:13:51,382 INFO Start graph assembling...
2025-06-21 17:13:52,214 INFO use_dual_path_srl: True
2025-06-21 17:13:52,214 INFO variant_type: hedge
2025-06-21 17:13:52,214 INFO use_enhanced_srl: True
2025-06-21 17:13:52,214 INFO Enhanced SRL enabled from config
2025-06-21 17:13:52,214 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 17:13:52,214 INFO SRL condition: True = True and True
2025-06-21 17:13:52,214 INFO Using enhanced dual-path SRL architecture
2025-06-21 17:13:52,214 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 17:13:52,617 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 17:13:52,617 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 17:13:52,617 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 17:13:53,058 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 17:13:53,058 INFO Ca-TSU enabled: True
2025-06-21 17:13:53,058 INFO Enhanced SRL enabled: True
2025-06-21 17:13:53,058 INFO Noise-Aware Loss enabled: True
2025-06-21 17:13:53,082 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 17:13:53,082 INFO Adding auxiliary enhancement losses...
2025-06-21 17:13:53,086 INFO Creating standard Contrastive Loss component...
2025-06-21 17:13:53,087 INFO Using standard Contrastive Loss as SRL component with weight: 0.1
2025-06-21 17:13:53,089 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 17:13:53,104 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 17:13:53,105 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 17:13:53,105 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 17:13:53,105 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 17:13:56,327 INFO Graph assembled successfully.
2025-06-21 17:14:17,406 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 17:14:18,976 INFO Word table initialized.
2025-06-21 17:14:18,976 INFO Model: all-hedge-gru_4cdd8001, starting new session.
2025-06-21 17:18:20,492 INFO 	iter: 20, batch loss: 1.1229339838027954, batch acc: 0.531250
2025-06-21 17:20:48,879 INFO 	iter: 40, batch loss: 1.1677253246307373, batch acc: 0.625000
2025-06-21 17:23:01,588 INFO 	iter: 60, batch loss: 0.8426716923713684, batch acc: 0.812500
2025-06-21 17:25:10,492 INFO 	iter: 80, batch loss: 0.5732688903808594, batch acc: 0.968750
2025-06-21 17:27:17,320 INFO 	iter: 100, batch loss: 0.5619885921478271, batch acc: 0.968750
2025-06-21 17:29:17,559 INFO 	iter: 120, batch loss: 0.4329366385936737, batch acc: 1.000000
2025-06-21 17:31:14,469 INFO 	iter: 140, batch loss: 0.6198045015335083, batch acc: 0.906250
2025-06-21 17:32:41,490 INFO Epoch: loss: 0.732538, acc: 0.838306
2025-06-21 17:33:52,864 INFO Completed dev evaluation: size=656.0, acc=0.5152
2025-06-21 17:33:52,889 INFO 	Eval, eval loss: 1.3139688968658447, acc: 0.515244, mcc: 0.029202
2025-06-21 17:33:52,889 INFO New best dev MCC: 0.0292. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_4cdd8001/best_model/model
2025-06-21 17:35:28,536 INFO 	iter: 160, batch loss: 0.5138410329818726, batch acc: 0.937500
2025-06-21 17:38:37,746 INFO 	iter: 180, batch loss: 0.6398233771324158, batch acc: 0.906250
2025-06-21 17:41:07,526 INFO 	iter: 200, batch loss: 0.515731155872345, batch acc: 0.937500
2025-06-21 17:43:21,600 INFO 	iter: 220, batch loss: 0.5095668435096741, batch acc: 0.937500
2025-06-21 17:45:31,292 INFO 	iter: 240, batch loss: 0.4804877042770386, batch acc: 0.968750
2025-06-21 17:47:38,094 INFO 	iter: 260, batch loss: 0.5631956458091736, batch acc: 0.968750
2025-06-21 17:49:37,826 INFO 	iter: 280, batch loss: 0.5160442590713501, batch acc: 1.000000
2025-06-21 17:51:36,262 INFO 	iter: 300, batch loss: 0.7171387076377869, batch acc: 0.906250
2025-06-21 17:52:35,763 INFO Epoch: loss: 0.566706, acc: 0.933871
2025-06-21 17:53:50,402 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-21 17:53:50,405 INFO 	Eval, eval loss: 1.3983948230743408, acc: 0.504573, mcc: 0.013596
2025-06-21 17:53:50,405 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-21 17:56:21,940 INFO 	iter: 320, batch loss: 0.556892991065979, batch acc: 0.968750
2025-06-21 17:59:06,372 INFO 	iter: 340, batch loss: 0.5192862153053284, batch acc: 0.937500
2025-06-21 18:01:29,786 INFO 	iter: 360, batch loss: 0.5203031897544861, batch acc: 0.937500
2025-06-21 18:03:42,290 INFO 	iter: 380, batch loss: 0.5889701843261719, batch acc: 0.937500
2025-06-21 18:05:50,708 INFO 	iter: 400, batch loss: 0.47728776931762695, batch acc: 1.000000
2025-06-21 18:11:30,684 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 18:11:30,684 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 18:11:30,685 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 18:11:30,687 INFO Start graph assembling...
2025-06-21 18:11:31,521 INFO use_dual_path_srl: True
2025-06-21 18:11:31,521 INFO variant_type: hedge
2025-06-21 18:11:31,521 INFO use_enhanced_srl: True
2025-06-21 18:11:31,521 INFO Enhanced SRL enabled from config
2025-06-21 18:11:31,522 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 18:11:31,522 INFO SRL condition: True = True and True
2025-06-21 18:11:31,522 INFO Using enhanced dual-path SRL architecture
2025-06-21 18:11:31,522 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 18:11:31,928 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 18:11:31,928 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 18:11:31,929 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 18:11:32,371 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 18:11:32,371 INFO Ca-TSU enabled: True
2025-06-21 18:11:32,371 INFO Enhanced SRL enabled: True
2025-06-21 18:11:32,371 INFO Noise-Aware Loss enabled: True
2025-06-21 18:11:32,394 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 18:11:32,394 INFO Adding auxiliary enhancement losses...
2025-06-21 18:13:45,566 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 18:13:45,566 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 18:13:45,567 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 18:13:45,569 INFO Start graph assembling...
2025-06-21 18:13:46,422 INFO use_dual_path_srl: True
2025-06-21 18:13:46,423 INFO variant_type: hedge
2025-06-21 18:13:46,423 INFO use_enhanced_srl: True
2025-06-21 18:13:46,423 INFO Enhanced SRL enabled from config
2025-06-21 18:13:46,423 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 18:13:46,423 INFO SRL condition: True = True and True
2025-06-21 18:13:46,423 INFO Using enhanced dual-path SRL architecture
2025-06-21 18:13:46,423 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 18:13:46,826 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 18:13:46,826 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 18:13:46,826 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 18:13:47,276 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 18:13:47,276 INFO Ca-TSU enabled: True
2025-06-21 18:13:47,276 INFO Enhanced SRL enabled: True
2025-06-21 18:13:47,276 INFO Noise-Aware Loss enabled: True
2025-06-21 18:13:47,301 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 18:13:47,301 INFO Adding auxiliary enhancement losses...
2025-06-21 18:13:47,306 INFO Creating standard Contrastive Loss component...
2025-06-21 18:13:47,307 INFO Using Predictive SRL Loss for each pathway with weight: 0.01
2025-06-21 18:13:47,308 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 18:13:47,325 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 18:13:47,326 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 18:13:47,326 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 18:13:47,326 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 18:13:50,548 INFO Graph assembled successfully.
2025-06-21 18:14:11,631 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 18:14:13,004 INFO Word table initialized.
2025-06-21 18:14:13,012 INFO Model: all-hedge-gru_1779e847, starting new session.
2025-06-21 18:18:13,139 INFO 	iter: 20, batch loss: 1.224778652191162, batch acc: 0.437500
2025-06-21 18:20:48,016 INFO 	iter: 40, batch loss: 1.015283226966858, batch acc: 0.656250
2025-06-21 18:23:05,282 INFO 	iter: 60, batch loss: 0.7523662447929382, batch acc: 0.875000
2025-06-21 18:25:18,895 INFO 	iter: 80, batch loss: 0.5954527258872986, batch acc: 1.000000
2025-06-21 18:27:35,946 INFO 	iter: 100, batch loss: 0.6022242307662964, batch acc: 0.937500
2025-06-21 18:29:39,504 INFO 	iter: 120, batch loss: 0.5190727114677429, batch acc: 0.968750
2025-06-21 18:31:41,569 INFO 	iter: 140, batch loss: 0.6309696435928345, batch acc: 0.875000
2025-06-21 18:33:13,141 INFO Epoch: loss: 0.736104, acc: 0.839919
2025-06-21 18:34:27,138 INFO Completed dev evaluation: size=656.0, acc=0.5274
2025-06-21 18:34:27,142 INFO 	Eval, eval loss: 1.1810247898101807, acc: 0.527439, mcc: 0.055350
2025-06-21 18:34:27,142 INFO New best dev MCC: 0.0553. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_1779e847/best_model/model
2025-06-21 18:36:00,288 INFO 	iter: 160, batch loss: 0.49163100123405457, batch acc: 0.968750
2025-06-21 18:38:14,097 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 18:38:14,097 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 18:38:14,098 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 18:38:14,100 INFO Start graph assembling...
2025-06-21 18:38:14,956 INFO use_dual_path_srl: True
2025-06-21 18:38:14,957 INFO variant_type: hedge
2025-06-21 18:38:14,957 INFO use_enhanced_srl: True
2025-06-21 18:38:14,957 INFO Enhanced SRL enabled from config
2025-06-21 18:38:14,957 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 18:38:14,957 INFO SRL condition: True = True and True
2025-06-21 18:38:14,957 INFO Using enhanced dual-path SRL architecture
2025-06-21 18:38:14,958 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 18:38:15,356 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 18:38:15,356 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 18:38:15,356 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-21 18:57:34,492 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 18:57:34,492 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 18:57:34,493 INFO Using L2 regularization with lambda: 1e-05
2025-06-21 18:57:34,495 INFO Start graph assembling...
2025-06-21 18:57:35,324 INFO use_dual_path_srl: True
2025-06-21 18:57:35,325 INFO variant_type: hedge
2025-06-21 18:57:35,325 INFO use_enhanced_srl: True
2025-06-21 18:57:35,325 INFO Enhanced SRL enabled from config
2025-06-21 18:57:35,325 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 18:57:35,325 INFO SRL condition: True = True and True
2025-06-21 18:57:35,325 INFO Using enhanced dual-path SRL architecture
2025-06-21 18:57:35,325 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 18:57:35,725 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 18:57:35,725 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 18:57:35,731 INFO Adding noise with stddev: 0.05
2025-06-21 18:57:35,733 INFO Final VMD input tensor: denoising_input/input_noise_switch/Merge:0 with shape (?, 5, 100)
2025-06-21 18:57:36,173 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 18:57:36,173 INFO Ca-TSU enabled: True
2025-06-21 18:57:36,173 INFO Enhanced SRL enabled: True
2025-06-21 18:57:36,173 INFO Noise-Aware Loss enabled: True
2025-06-21 18:57:36,196 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 18:57:36,196 INFO Adding auxiliary enhancement losses...
2025-06-21 18:57:36,201 INFO Creating standard Contrastive Loss component...
2025-06-21 18:57:36,202 INFO Using Predictive SRL Loss for each pathway with weight: 0.01
2025-06-21 18:57:36,203 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 18:57:36,218 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 18:57:36,219 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 18:57:36,219 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 18:57:36,219 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 18:57:39,444 INFO Graph assembled successfully.
2025-06-21 18:58:00,935 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 18:58:02,292 INFO Word table initialized.
2025-06-21 18:58:02,293 INFO Model: all-hedge-gru_cdf8840a, starting new session.
2025-06-21 19:01:47,137 INFO 	iter: 20, batch loss: 1.1118055582046509, batch acc: 0.531250
2025-06-21 19:04:20,601 INFO 	iter: 40, batch loss: 1.0133140087127686, batch acc: 0.781250
2025-06-21 19:06:33,927 INFO 	iter: 60, batch loss: 0.7252156734466553, batch acc: 0.937500
2025-06-21 19:08:40,763 INFO 	iter: 80, batch loss: 0.5710623860359192, batch acc: 0.937500
2025-06-21 19:10:47,501 INFO 	iter: 100, batch loss: 0.5437105894088745, batch acc: 0.906250
2025-06-21 19:12:46,585 INFO 	iter: 120, batch loss: 0.515583872795105, batch acc: 0.937500
2025-06-21 19:14:43,597 INFO 	iter: 140, batch loss: 0.5369992256164551, batch acc: 0.937500
2025-06-21 19:16:11,208 INFO Epoch: loss: 0.718121, acc: 0.843750
2025-06-21 19:17:23,186 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-21 19:17:23,189 INFO 	Eval, eval loss: 1.4254181385040283, acc: 0.486280, mcc: -0.026501
2025-06-21 19:17:23,189 INFO New best dev MCC: -0.0265. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_cdf8840a/best_model/model
2025-06-21 19:18:58,821 INFO 	iter: 160, batch loss: 0.4473235011100769, batch acc: 1.000000
2025-06-21 19:50:43,061 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 19:50:43,062 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 19:50:43,062 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 19:50:43,065 INFO Start graph assembling...
2025-06-21 19:50:43,949 INFO use_dual_path_srl: True
2025-06-21 19:50:43,950 INFO variant_type: hedge
2025-06-21 19:50:43,950 INFO use_enhanced_srl: True
2025-06-21 19:50:43,950 INFO Enhanced SRL enabled from config
2025-06-21 19:50:43,950 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 19:50:43,950 INFO SRL condition: True = True and True
2025-06-21 19:50:43,950 INFO Using enhanced dual-path SRL architecture
2025-06-21 19:50:43,950 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 19:50:44,362 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 19:50:44,362 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 19:50:44,368 INFO Adding noise with stddev: 0.05
2025-06-21 19:50:44,370 INFO Final VMD input tensor: denoising_input/input_noise_switch/Merge:0 with shape (?, 5, 100)
2025-06-21 19:50:44,815 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 19:50:44,815 INFO Ca-TSU enabled: True
2025-06-21 19:50:44,815 INFO Enhanced SRL enabled: True
2025-06-21 19:50:44,815 INFO Noise-Aware Loss enabled: False
2025-06-21 19:50:44,839 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 19:50:44,839 INFO Adding auxiliary enhancement losses...
2025-06-21 19:50:44,844 INFO Creating standard Contrastive Loss component...
2025-06-21 19:50:44,845 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-21 19:50:44,846 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 19:50:44,863 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 19:50:44,864 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 19:50:44,864 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 19:50:44,864 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 19:50:48,183 INFO Graph assembled successfully.
2025-06-21 19:51:10,024 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 19:51:11,512 INFO Word table initialized.
2025-06-21 19:51:11,514 INFO Model: all-hedge-gru_2cfaa30f, starting new session.
2025-06-21 19:55:11,075 INFO 	iter: 20, batch loss: 3.0353901386260986, batch acc: 0.750000
2025-06-21 19:57:37,052 INFO 	iter: 40, batch loss: 2.411020278930664, batch acc: 0.687500
2025-06-21 19:59:51,545 INFO 	iter: 60, batch loss: 1.4810667037963867, batch acc: 0.937500
2025-06-21 20:01:57,051 INFO 	iter: 80, batch loss: 1.474747896194458, batch acc: 0.750000
2025-06-21 20:04:01,525 INFO 	iter: 100, batch loss: 1.4920916557312012, batch acc: 0.718750
2025-06-21 20:06:02,160 INFO 	iter: 120, batch loss: 1.2895307540893555, batch acc: 0.812500
2025-06-21 20:07:59,196 INFO 	iter: 140, batch loss: 1.346828579902649, batch acc: 0.781250
2025-06-21 20:09:26,572 INFO Epoch: loss: 1.803413, acc: 0.717944
2025-06-21 20:10:39,978 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-21 20:10:39,981 INFO 	Eval, eval loss: 1.453580617904663, acc: 0.512195, mcc: 0.033204
2025-06-21 20:10:39,981 INFO New best dev MCC: 0.0332. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_2cfaa30f/best_model/model
2025-06-21 20:12:21,584 INFO 	iter: 160, batch loss: 1.3577319383621216, batch acc: 0.718750
2025-06-21 20:15:16,752 INFO 	iter: 180, batch loss: 1.321327567100525, batch acc: 0.656250
2025-06-21 20:17:41,917 INFO 	iter: 200, batch loss: 1.2638657093048096, batch acc: 0.656250
2025-06-21 20:19:56,544 INFO 	iter: 220, batch loss: 1.1055134534835815, batch acc: 0.718750
2025-06-21 20:22:03,678 INFO 	iter: 240, batch loss: 1.0291776657104492, batch acc: 0.718750
2025-06-21 20:24:08,545 INFO 	iter: 260, batch loss: 1.0066841840744019, batch acc: 0.750000
2025-06-21 20:26:09,164 INFO 	iter: 280, batch loss: 1.077234148979187, batch acc: 0.593750
2025-06-21 20:28:08,202 INFO 	iter: 300, batch loss: 0.9587500095367432, batch acc: 0.656250
2025-06-21 20:29:07,951 INFO Epoch: loss: 1.141336, acc: 0.661290
2025-06-21 20:30:23,321 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-21 20:30:23,325 INFO 	Eval, eval loss: 1.01870858669281, acc: 0.496951, mcc: 0.016863
2025-06-21 20:30:23,325 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-21 20:32:47,098 INFO 	iter: 320, batch loss: 0.8168638944625854, batch acc: 0.812500
2025-06-21 20:35:41,543 INFO 	iter: 340, batch loss: 0.829816460609436, batch acc: 0.656250
2025-06-21 20:37:59,060 INFO 	iter: 360, batch loss: 0.8829807639122009, batch acc: 0.687500
2025-06-21 20:38:42,683 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-21 20:38:42,683 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-21 20:38:42,683 INFO Using L2 regularization with lambda: 0.0001
2025-06-21 20:38:42,685 INFO Start graph assembling...
2025-06-21 20:38:43,201 INFO use_dual_path_srl: True
2025-06-21 20:38:43,202 INFO variant_type: hedge
2025-06-21 20:38:43,202 INFO use_enhanced_srl: True
2025-06-21 20:38:43,202 INFO Enhanced SRL enabled from config
2025-06-21 20:38:43,202 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-21 20:38:43,202 INFO SRL condition: True = True and True
2025-06-21 20:38:43,202 INFO Using enhanced dual-path SRL architecture
2025-06-21 20:38:43,202 INFO Creating Enhanced Dual-Path SRL module...
2025-06-21 20:38:43,439 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-21 20:38:43,439 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-21 20:38:43,442 INFO Adding noise with stddev: 0.05
2025-06-21 20:38:43,443 INFO Final VMD input tensor: denoising_input/input_noise_switch/Merge:0 with shape (?, 5, 100)
2025-06-21 20:38:43,704 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-21 20:38:43,704 INFO Applying label smoothing with alpha=0.1
2025-06-21 20:38:43,705 INFO Ca-TSU enabled: True
2025-06-21 20:38:43,705 INFO Enhanced SRL enabled: True
2025-06-21 20:38:43,705 INFO Noise-Aware Loss enabled: False
2025-06-21 20:38:43,719 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-21 20:38:43,719 INFO Adding auxiliary enhancement losses...
2025-06-21 20:38:43,722 INFO Creating standard Contrastive Loss component...
2025-06-21 20:38:43,723 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-21 20:38:43,723 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-21 20:38:43,732 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-21 20:38:43,733 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-21 20:38:43,733 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-21 20:38:43,733 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-21 20:38:45,711 INFO Graph assembled successfully.
2025-06-21 20:39:00,406 INFO ASSEMBLE: word table #replacement: 19482
2025-06-21 20:39:02,646 INFO Word table initialized.
2025-06-21 20:39:02,656 INFO Model: all-hedge-gru_d18a7c20, starting new session.
2025-06-21 20:41:51,744 INFO 	iter: 20, batch loss: 2.93670392036438, batch acc: 0.625000
2025-06-21 20:43:40,065 INFO 	iter: 40, batch loss: 2.0709104537963867, batch acc: 0.718750
2025-06-21 20:45:14,881 INFO 	iter: 60, batch loss: 1.5977424383163452, batch acc: 0.687500
2025-06-21 20:46:45,464 INFO 	iter: 80, batch loss: 1.4842619895935059, batch acc: 0.750000
2025-06-21 20:48:13,835 INFO 	iter: 100, batch loss: 1.355470061302185, batch acc: 0.781250
2025-06-21 20:49:38,512 INFO 	iter: 120, batch loss: 1.25950026512146, batch acc: 0.843750
2025-06-21 20:51:00,188 INFO 	iter: 140, batch loss: 1.3950859308242798, batch acc: 0.625000
2025-06-21 20:52:01,920 INFO Epoch: loss: 1.720732, acc: 0.682258
2025-06-21 20:52:56,809 INFO Completed dev evaluation: size=656.0, acc=0.4756
2025-06-21 20:52:56,811 INFO 	Eval, eval loss: 1.3934580087661743, acc: 0.475610, mcc: -0.042615
2025-06-21 20:52:56,811 INFO New best dev MCC: -0.0426. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_d18a7c20/best_model/model
2025-06-21 20:54:02,894 INFO 	iter: 160, batch loss: 1.4360792636871338, batch acc: 0.468750
2025-06-21 20:56:19,724 INFO 	iter: 180, batch loss: 1.1090582609176636, batch acc: 0.718750
2025-06-21 20:58:05,439 INFO 	iter: 200, batch loss: 1.1389827728271484, batch acc: 0.750000
2025-06-21 20:59:39,163 INFO 	iter: 220, batch loss: 1.097935676574707, batch acc: 0.687500
2025-06-21 21:01:10,208 INFO 	iter: 240, batch loss: 1.0134562253952026, batch acc: 0.656250
2025-06-21 21:02:37,698 INFO 	iter: 260, batch loss: 1.0794761180877686, batch acc: 0.593750
2025-06-21 21:04:02,073 INFO 	iter: 280, batch loss: 0.9504600167274475, batch acc: 0.562500
2025-06-21 21:05:24,535 INFO 	iter: 300, batch loss: 0.8868745565414429, batch acc: 0.687500
2025-06-21 21:06:06,766 INFO Epoch: loss: 1.097840, acc: 0.611089
2025-06-21 21:07:02,316 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-21 21:07:02,318 INFO 	Eval, eval loss: 0.9442594051361084, acc: 0.487805, mcc: -0.009854
2025-06-21 21:07:02,318 INFO New best dev MCC: -0.0099. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_d18a7c20/best_model/model
2025-06-21 21:08:55,301 INFO 	iter: 320, batch loss: 0.9844388961791992, batch acc: 0.406250
2025-06-21 21:11:00,625 INFO 	iter: 340, batch loss: 0.9109551906585693, batch acc: 0.500000
2025-06-21 21:12:45,989 INFO 	iter: 360, batch loss: 0.8695785999298096, batch acc: 0.656250
2025-06-21 21:14:19,596 INFO 	iter: 380, batch loss: 0.8560509085655212, batch acc: 0.656250
2025-06-21 21:15:51,552 INFO 	iter: 400, batch loss: 0.8771635293960571, batch acc: 0.625000
2025-06-21 21:17:25,151 INFO 	iter: 420, batch loss: 0.9311545491218567, batch acc: 0.468750
2025-06-21 21:18:49,584 INFO 	iter: 440, batch loss: 0.8048915266990662, batch acc: 0.656250
2025-06-21 21:20:13,247 INFO 	iter: 460, batch loss: 0.8845335245132446, batch acc: 0.531250
2025-06-21 21:20:36,865 INFO Epoch: loss: 0.874074, acc: 0.591935
2025-06-21 21:21:35,657 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-21 21:21:35,659 INFO 	Eval, eval loss: 0.8882025480270386, acc: 0.496951, mcc: 0.080647
2025-06-21 21:21:35,660 INFO New best dev MCC: 0.0806. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_d18a7c20/best_model/model
2025-06-21 21:24:00,207 INFO 	iter: 480, batch loss: 0.8281142711639404, batch acc: 0.625000
2025-06-21 21:25:58,375 INFO 	iter: 500, batch loss: 0.8799604773521423, batch acc: 0.625000
2025-06-21 21:27:36,470 INFO 	iter: 520, batch loss: 0.8314254283905029, batch acc: 0.656250
2025-06-21 21:29:10,843 INFO 	iter: 540, batch loss: 0.7797538638114929, batch acc: 0.656250
2025-06-21 21:30:43,892 INFO 	iter: 560, batch loss: 0.8494460582733154, batch acc: 0.500000
2025-06-21 21:32:12,237 INFO 	iter: 580, batch loss: 0.8761515617370605, batch acc: 0.500000
2025-06-21 21:33:37,768 INFO 	iter: 600, batch loss: 0.87836092710495, batch acc: 0.437500
2025-06-21 21:35:02,108 INFO 	iter: 620, batch loss: 0.8378538489341736, batch acc: 0.656250
2025-06-21 21:35:05,053 INFO Epoch: loss: 0.837870, acc: 0.570161
2025-06-21 21:36:06,728 INFO Completed dev evaluation: size=656.0, acc=0.4832
2025-06-21 21:36:06,730 INFO 	Eval, eval loss: 0.8420937657356262, acc: 0.483232, mcc: -0.036292
2025-06-21 21:36:06,730 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-21 21:39:02,932 INFO 	iter: 640, batch loss: 0.7691022157669067, batch acc: 0.687500
2025-06-21 21:40:53,901 INFO 	iter: 660, batch loss: 0.8706221580505371, batch acc: 0.531250
2025-06-21 21:42:34,436 INFO 	iter: 680, batch loss: 0.7541491985321045, batch acc: 0.625000
2025-06-21 21:44:08,667 INFO 	iter: 700, batch loss: 0.8106780648231506, batch acc: 0.625000
2025-06-21 21:45:41,884 INFO 	iter: 720, batch loss: 0.8378584384918213, batch acc: 0.531250
2025-06-21 21:47:10,570 INFO 	iter: 740, batch loss: 0.9007818102836609, batch acc: 0.406250
2025-06-21 21:48:37,181 INFO 	iter: 760, batch loss: 0.8632766008377075, batch acc: 0.531250
2025-06-21 21:49:42,417 INFO Epoch: loss: 0.811404, acc: 0.575000
2025-06-21 21:50:46,331 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-21 21:50:46,333 INFO 	Eval, eval loss: 0.8251652717590332, acc: 0.489329, mcc: 0.020947
2025-06-21 21:50:46,333 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-21 21:51:56,912 INFO 	iter: 780, batch loss: 0.7670148611068726, batch acc: 0.593750
2025-06-21 21:54:15,923 INFO 	iter: 800, batch loss: 0.8224217891693115, batch acc: 0.562500
2025-06-21 21:56:03,186 INFO 	iter: 820, batch loss: 0.8061898946762085, batch acc: 0.468750
2025-06-21 21:57:41,357 INFO 	iter: 840, batch loss: 0.78298020362854, batch acc: 0.562500
2025-06-21 21:59:17,912 INFO 	iter: 860, batch loss: 0.778422474861145, batch acc: 0.562500
2025-06-21 22:00:51,252 INFO 	iter: 880, batch loss: 0.786452054977417, batch acc: 0.562500
2025-06-21 22:02:20,171 INFO 	iter: 900, batch loss: 0.7783210277557373, batch acc: 0.593750
2025-06-21 22:03:47,498 INFO 	iter: 920, batch loss: 0.7802488207817078, batch acc: 0.656250
2025-06-21 22:04:32,465 INFO Epoch: loss: 0.798026, acc: 0.564919
2025-06-21 22:05:39,827 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-21 22:05:39,830 INFO 	Eval, eval loss: 0.8125627040863037, acc: 0.487805, mcc: None
2025-06-22 04:15:33,854 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 04:15:33,855 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 04:15:33,855 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 04:15:33,857 INFO Start graph assembling...
2025-06-22 04:15:34,414 INFO use_dual_path_srl: True
2025-06-22 04:15:34,414 INFO variant_type: hedge
2025-06-22 04:15:34,414 INFO use_enhanced_srl: True
2025-06-22 04:15:34,414 INFO Enhanced SRL enabled from config
2025-06-22 04:15:34,414 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 04:15:34,414 INFO SRL condition: True = True and True
2025-06-22 04:15:34,414 INFO Using enhanced dual-path SRL architecture
2025-06-22 04:15:34,414 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 04:15:34,675 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 04:15:34,675 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 04:15:34,675 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 04:15:34,955 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-22 04:15:34,977 INFO Applying label smoothing with alpha=0.1
2025-06-22 04:15:34,978 INFO Ca-TSU enabled: True
2025-06-22 04:15:34,978 INFO Enhanced SRL enabled: True
2025-06-22 04:15:34,978 INFO Noise-Aware Loss enabled: False
2025-06-22 04:15:34,993 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-22 04:15:34,993 INFO Adding auxiliary enhancement losses...
2025-06-22 04:15:34,996 INFO Creating standard Contrastive Loss component...
2025-06-22 04:15:34,997 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-22 04:15:34,998 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-22 04:15:35,007 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-22 04:15:35,008 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-22 04:15:35,008 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-22 04:15:35,008 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-22 04:15:37,141 INFO Graph assembled successfully.
2025-06-22 04:15:52,682 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 04:15:55,012 INFO Word table initialized.
2025-06-22 04:15:55,013 INFO Model: all-hedge-gru_87bd0e78, starting new session.
2025-06-22 04:18:04,777 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 04:18:04,777 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 04:18:04,778 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 04:18:04,779 INFO Start graph assembling...
2025-06-22 04:18:05,333 INFO use_dual_path_srl: True
2025-06-22 04:18:05,334 INFO variant_type: hedge
2025-06-22 04:18:05,334 INFO use_enhanced_srl: True
2025-06-22 04:18:05,334 INFO Enhanced SRL enabled from config
2025-06-22 04:18:05,334 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 04:18:05,334 INFO SRL condition: True = True and True
2025-06-22 04:18:05,334 INFO Using enhanced dual-path SRL architecture
2025-06-22 04:18:05,334 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 04:18:05,588 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 04:18:05,588 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 04:18:05,588 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 04:18:05,865 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-22 04:18:05,865 INFO Applying label smoothing with alpha=0.1
2025-06-22 04:18:05,866 INFO Ca-TSU enabled: True
2025-06-22 04:18:05,866 INFO Enhanced SRL enabled: True
2025-06-22 04:18:05,866 INFO Noise-Aware Loss enabled: False
2025-06-22 04:18:05,881 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-22 04:18:05,881 INFO Adding auxiliary enhancement losses...
2025-06-22 04:18:05,884 INFO Creating standard Contrastive Loss component...
2025-06-22 04:18:05,885 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-22 04:18:05,885 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-22 04:18:05,895 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-22 04:18:05,896 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-22 04:18:05,896 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-22 04:18:05,896 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-22 04:18:07,988 INFO Graph assembled successfully.
2025-06-22 04:18:23,709 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 04:18:25,262 INFO Word table initialized.
2025-06-22 04:18:25,263 INFO Model: all-hedge-gru_87bd0e78, starting new session.
2025-06-22 04:21:17,968 INFO 	iter: 20, batch loss: 3.0715088844299316, batch acc: 0.531250
2025-06-22 04:23:10,573 INFO 	iter: 40, batch loss: 2.0520482063293457, batch acc: 0.781250
2025-06-22 04:24:46,626 INFO 	iter: 60, batch loss: 1.5836400985717773, batch acc: 0.781250
2025-06-22 04:26:18,925 INFO 	iter: 80, batch loss: 1.2917194366455078, batch acc: 0.843750
2025-06-22 04:27:51,659 INFO 	iter: 100, batch loss: 1.4057186841964722, batch acc: 0.687500
2025-06-22 04:29:18,994 INFO 	iter: 120, batch loss: 1.2380061149597168, batch acc: 0.750000
2025-06-22 04:30:44,876 INFO 	iter: 140, batch loss: 1.284718632698059, batch acc: 0.687500
2025-06-22 04:31:48,755 INFO Epoch: loss: 1.701274, acc: 0.671371
2025-06-22 04:32:44,266 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-22 04:32:44,268 INFO 	Eval, eval loss: 1.3017706871032715, acc: 0.509146, mcc: 0.027236
2025-06-22 04:32:44,268 INFO New best dev MCC: 0.0272. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 04:33:52,663 INFO 	iter: 160, batch loss: 1.2034270763397217, batch acc: 0.812500
2025-06-22 04:36:11,174 INFO 	iter: 180, batch loss: 1.2113972902297974, batch acc: 0.593750
2025-06-22 04:37:59,227 INFO 	iter: 200, batch loss: 1.1248708963394165, batch acc: 0.531250
2025-06-22 04:39:38,170 INFO 	iter: 220, batch loss: 1.0518862009048462, batch acc: 0.656250
2025-06-22 04:41:13,445 INFO 	iter: 240, batch loss: 1.080391526222229, batch acc: 0.500000
2025-06-22 04:42:45,342 INFO 	iter: 260, batch loss: 0.9976232051849365, batch acc: 0.593750
2025-06-22 04:44:12,647 INFO 	iter: 280, batch loss: 0.935634970664978, batch acc: 0.531250
2025-06-22 04:45:38,454 INFO 	iter: 300, batch loss: 0.9847174882888794, batch acc: 0.468750
2025-06-22 04:46:22,702 INFO Epoch: loss: 1.067176, acc: 0.605645
2025-06-22 04:47:22,286 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-22 04:47:22,288 INFO 	Eval, eval loss: 0.9305039048194885, acc: 0.509146, mcc: 0.029970
2025-06-22 04:47:22,288 INFO New best dev MCC: 0.0300. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 04:49:15,680 INFO 	iter: 320, batch loss: 0.92576003074646, batch acc: 0.531250
2025-06-22 04:51:17,644 INFO 	iter: 340, batch loss: 0.8612419962882996, batch acc: 0.687500
2025-06-22 04:53:03,414 INFO 	iter: 360, batch loss: 0.9197038412094116, batch acc: 0.531250
2025-06-22 04:54:42,904 INFO 	iter: 380, batch loss: 0.8368233442306519, batch acc: 0.656250
2025-06-22 04:56:18,361 INFO 	iter: 400, batch loss: 0.8992186784744263, batch acc: 0.531250
2025-06-22 04:57:51,069 INFO 	iter: 420, batch loss: 0.8193973302841187, batch acc: 0.687500
2025-06-22 04:59:20,455 INFO 	iter: 440, batch loss: 0.8466212749481201, batch acc: 0.656250
2025-06-22 05:03:18,596 INFO 	iter: 460, batch loss: 0.8551324009895325, batch acc: 0.625000
2025-06-22 05:03:42,321 INFO Epoch: loss: 0.863142, acc: 0.604839
2025-06-22 05:04:46,398 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-22 05:04:46,401 INFO 	Eval, eval loss: 0.8543235659599304, acc: 0.496951, mcc: 0.008286
2025-06-22 05:04:46,401 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 05:07:07,810 INFO 	iter: 480, batch loss: 0.8425605297088623, batch acc: 0.562500
2025-06-22 05:09:07,742 INFO 	iter: 500, batch loss: 0.7973533868789673, batch acc: 0.593750
2025-06-22 05:10:51,712 INFO 	iter: 520, batch loss: 0.8233464360237122, batch acc: 0.562500
2025-06-22 05:12:30,284 INFO 	iter: 540, batch loss: 0.8898774981498718, batch acc: 0.406250
2025-06-22 05:14:04,525 INFO 	iter: 560, batch loss: 0.8134815096855164, batch acc: 0.687500
2025-06-22 05:15:37,147 INFO 	iter: 580, batch loss: 0.853162944316864, batch acc: 0.500000
2025-06-22 05:17:05,963 INFO 	iter: 600, batch loss: 0.870683491230011, batch acc: 0.468750
2025-06-22 05:18:32,554 INFO 	iter: 620, batch loss: 0.8227168321609497, batch acc: 0.531250
2025-06-22 05:18:35,469 INFO Epoch: loss: 0.826139, acc: 0.570766
2025-06-22 05:19:39,767 INFO Completed dev evaluation: size=656.0, acc=0.4985
2025-06-22 05:19:39,769 INFO 	Eval, eval loss: 0.8211814165115356, acc: 0.498476, mcc: 0.016516
2025-06-22 05:19:39,769 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-22 05:22:37,876 INFO 	iter: 640, batch loss: 0.772968053817749, batch acc: 0.718750
2025-06-22 05:24:31,255 INFO 	iter: 660, batch loss: 0.795378565788269, batch acc: 0.687500
2025-06-22 05:26:12,324 INFO 	iter: 680, batch loss: 0.778674840927124, batch acc: 0.687500
2025-06-22 05:27:51,379 INFO 	iter: 700, batch loss: 0.7982892394065857, batch acc: 0.562500
2025-06-22 05:29:27,420 INFO 	iter: 720, batch loss: 0.7350672483444214, batch acc: 0.781250
2025-06-22 05:30:58,971 INFO 	iter: 740, batch loss: 0.8543217778205872, batch acc: 0.437500
2025-06-22 05:32:28,228 INFO 	iter: 760, batch loss: 0.8396480083465576, batch acc: 0.437500
2025-06-22 05:33:35,384 INFO Epoch: loss: 0.804437, acc: 0.560282
2025-06-22 05:34:42,980 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-22 05:34:42,983 INFO 	Eval, eval loss: 0.8047453761100769, acc: 0.496951, mcc: -0.000762
2025-06-22 05:34:42,983 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-22 05:34:42,983 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-22 05:34:42,983 INFO Generating diagnostic plots...
2025-06-22 05:34:46,622 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-22 05:34:46,623 INFO Best performance on development set:
2025-06-22 09:58:16,218 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 09:58:16,218 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 09:58:16,219 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 09:58:16,222 INFO Start graph assembling...
2025-06-22 09:58:16,691 INFO use_dual_path_srl: True
2025-06-22 09:58:16,691 INFO variant_type: hedge
2025-06-22 09:58:16,691 INFO use_enhanced_srl: True
2025-06-22 09:58:16,691 INFO Enhanced SRL enabled from config
2025-06-22 09:58:16,691 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 09:58:16,691 INFO SRL condition: True = True and True
2025-06-22 09:58:16,691 INFO Using enhanced dual-path SRL architecture
2025-06-22 09:58:16,691 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 09:58:17,169 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 09:58:17,169 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 09:58:17,169 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 09:58:17,603 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-22 09:58:17,603 INFO Applying label smoothing with alpha=0.1
2025-06-22 09:58:17,604 INFO Ca-TSU enabled: True
2025-06-22 09:58:17,605 INFO Enhanced SRL enabled: True
2025-06-22 09:58:17,605 INFO Noise-Aware Loss enabled: False
2025-06-22 09:58:17,628 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-22 09:58:17,628 INFO Adding auxiliary enhancement losses...
2025-06-22 09:58:17,632 INFO Creating standard Contrastive Loss component...
2025-06-22 09:58:17,633 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-22 09:58:17,634 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-22 09:58:17,649 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-22 09:58:17,651 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-22 09:58:17,651 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-22 09:58:17,651 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-22 09:58:20,830 INFO Graph assembled successfully.
2025-06-22 09:58:42,588 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 09:58:44,474 INFO Word table initialized.
2025-06-22 09:58:44,958 INFO Model: all-hedge-gru_87bd0e78, session restored from checkpoint.
2025-06-22 10:02:46,108 INFO 	iter: 780, batch loss: 0.7959209084510803, batch acc: 0.531250
2025-06-22 10:05:09,873 INFO 	iter: 800, batch loss: 0.7551385164260864, batch acc: 0.593750
2025-06-22 10:07:21,636 INFO 	iter: 820, batch loss: 0.77602618932724, batch acc: 0.656250
2025-06-22 10:09:25,685 INFO 	iter: 840, batch loss: 0.7585890293121338, batch acc: 0.562500
2025-06-22 10:11:28,760 INFO 	iter: 860, batch loss: 0.7932140827178955, batch acc: 0.562500
2025-06-22 10:13:26,524 INFO 	iter: 880, batch loss: 0.7555298209190369, batch acc: 0.687500
2025-06-22 10:15:21,689 INFO 	iter: 900, batch loss: 0.778799831867218, batch acc: 0.500000
2025-06-22 10:16:47,610 INFO Epoch: loss: 0.791658, acc: 0.567339
2025-06-22 10:18:00,201 INFO Completed dev evaluation: size=656.0, acc=0.5030
2025-06-22 10:18:00,204 INFO 	Eval, eval loss: 0.8021557331085205, acc: 0.503049, mcc: 0.019642
2025-06-22 10:18:00,204 INFO New best dev MCC: 0.0196. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 10:19:20,907 INFO 	iter: 920, batch loss: 0.8040540218353271, batch acc: 0.562500
2025-06-22 10:22:29,170 INFO 	iter: 940, batch loss: 0.7078409194946289, batch acc: 0.687500
2025-06-22 10:24:51,849 INFO 	iter: 960, batch loss: 0.8557000756263733, batch acc: 0.468750
2025-06-22 10:27:02,444 INFO 	iter: 980, batch loss: 0.7673742175102234, batch acc: 0.625000
2025-06-22 10:29:07,734 INFO 	iter: 1000, batch loss: 0.742333173751831, batch acc: 0.750000
2025-06-22 10:31:09,772 INFO 	iter: 1020, batch loss: 0.7772598266601562, batch acc: 0.625000
2025-06-22 10:33:06,410 INFO 	iter: 1040, batch loss: 0.7491357922554016, batch acc: 0.656250
2025-06-22 10:35:02,478 INFO 	iter: 1060, batch loss: 0.7459414601325989, batch acc: 0.562500
2025-06-22 10:35:59,761 INFO Epoch: loss: 0.787922, acc: 0.573589
2025-06-22 10:37:14,590 INFO Completed dev evaluation: size=656.0, acc=0.5000
2025-06-22 10:37:14,593 INFO 	Eval, eval loss: 0.7963958382606506, acc: 0.500000, mcc: 0.031079
2025-06-22 10:37:14,593 INFO New best dev MCC: 0.0311. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 10:39:36,303 INFO 	iter: 1080, batch loss: 0.7454760074615479, batch acc: 0.625000
2025-06-22 10:42:25,375 INFO 	iter: 1100, batch loss: 0.7724418044090271, batch acc: 0.656250
2025-06-22 10:44:43,496 INFO 	iter: 1120, batch loss: 0.7218635082244873, batch acc: 0.812500
2025-06-22 10:46:50,603 INFO 	iter: 1140, batch loss: 0.8254166841506958, batch acc: 0.531250
2025-06-22 10:48:57,232 INFO 	iter: 1160, batch loss: 0.8421471118927002, batch acc: 0.500000
2025-06-22 10:50:59,497 INFO 	iter: 1180, batch loss: 0.7770546078681946, batch acc: 0.562500
2025-06-22 10:52:59,113 INFO 	iter: 1200, batch loss: 0.7866811156272888, batch acc: 0.437500
2025-06-22 10:54:55,666 INFO 	iter: 1220, batch loss: 0.8281039595603943, batch acc: 0.437500
2025-06-22 10:55:25,708 INFO Epoch: loss: 0.786727, acc: 0.558468
2025-06-22 10:56:44,066 INFO Completed dev evaluation: size=656.0, acc=0.4909
2025-06-22 10:56:44,069 INFO 	Eval, eval loss: 0.7915276288986206, acc: 0.490854, mcc: 0.015913
2025-06-22 10:56:44,069 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 10:59:54,098 INFO 	iter: 1240, batch loss: 0.7594563961029053, batch acc: 0.625000
2025-06-22 11:02:32,930 INFO 	iter: 1260, batch loss: 0.8358758091926575, batch acc: 0.468750
2025-06-22 11:04:46,461 INFO 	iter: 1280, batch loss: 0.8020090460777283, batch acc: 0.500000
2025-06-22 11:06:56,902 INFO 	iter: 1300, batch loss: 0.7841108441352844, batch acc: 0.562500
2025-06-22 11:09:05,353 INFO 	iter: 1320, batch loss: 0.8015769124031067, batch acc: 0.437500
2025-06-22 11:11:07,098 INFO 	iter: 1340, batch loss: 0.7900874018669128, batch acc: 0.562500
2025-06-22 11:13:06,847 INFO 	iter: 1360, batch loss: 0.7904449105262756, batch acc: 0.531250
2025-06-22 11:15:04,195 INFO 	iter: 1380, batch loss: 0.7503244876861572, batch acc: 0.687500
2025-06-22 11:15:05,958 INFO Epoch: loss: 0.779812, acc: 0.563911
2025-06-22 11:16:26,418 INFO Completed dev evaluation: size=656.0, acc=0.5152
2025-06-22 11:16:26,421 INFO 	Eval, eval loss: 0.7889427542686462, acc: 0.515244, mcc: 0.062519
2025-06-22 11:16:26,421 INFO New best dev MCC: 0.0625. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 11:20:23,399 INFO 	iter: 1400, batch loss: 0.7906429767608643, batch acc: 0.562500
2025-06-22 11:22:52,899 INFO 	iter: 1420, batch loss: 0.7845435738563538, batch acc: 0.468750
2025-06-22 11:25:08,604 INFO 	iter: 1440, batch loss: 0.7720789909362793, batch acc: 0.625000
2025-06-22 11:27:17,659 INFO 	iter: 1460, batch loss: 0.8120689392089844, batch acc: 0.375000
2025-06-22 11:29:26,216 INFO 	iter: 1480, batch loss: 0.8119378089904785, batch acc: 0.531250
2025-06-22 11:31:27,570 INFO 	iter: 1500, batch loss: 0.7867243885993958, batch acc: 0.562500
2025-06-22 11:33:28,287 INFO 	iter: 1520, batch loss: 0.7110247015953064, batch acc: 0.656250
2025-06-22 11:34:57,795 INFO Epoch: loss: 0.778838, acc: 0.553226
2025-06-22 11:36:23,385 INFO Completed dev evaluation: size=656.0, acc=0.5152
2025-06-22 11:36:23,388 INFO 	Eval, eval loss: 0.7801821827888489, acc: 0.515244, mcc: 0.055718
2025-06-22 11:36:23,388 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 11:38:03,366 INFO 	iter: 1540, batch loss: 0.7719545364379883, batch acc: 0.500000
2025-06-22 11:41:00,621 INFO 	iter: 1560, batch loss: 0.7694821953773499, batch acc: 0.531250
2025-06-22 11:43:27,384 INFO 	iter: 1580, batch loss: 0.820530354976654, batch acc: 0.468750
2025-06-22 11:45:41,452 INFO 	iter: 1600, batch loss: 0.7628574967384338, batch acc: 0.562500
2025-06-22 11:47:53,485 INFO 	iter: 1620, batch loss: 0.7685135006904602, batch acc: 0.500000
2025-06-22 11:50:01,211 INFO 	iter: 1640, batch loss: 0.8057267069816589, batch acc: 0.468750
2025-06-22 11:52:02,553 INFO 	iter: 1660, batch loss: 0.7994421124458313, batch acc: 0.468750
2025-06-22 11:54:03,717 INFO 	iter: 1680, batch loss: 0.7778728008270264, batch acc: 0.562500
2025-06-22 11:55:04,663 INFO Epoch: loss: 0.775766, acc: 0.550403
2025-06-22 11:56:31,189 INFO Completed dev evaluation: size=656.0, acc=0.4954
2025-06-22 11:56:31,192 INFO 	Eval, eval loss: 0.7801886200904846, acc: 0.495427, mcc: 0.006007
2025-06-22 11:56:31,192 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-22 11:58:59,709 INFO 	iter: 1700, batch loss: 0.7785773873329163, batch acc: 0.562500
2025-06-22 12:01:42,725 INFO 	iter: 1720, batch loss: 0.7851266264915466, batch acc: 0.437500
2025-06-22 12:04:09,541 INFO 	iter: 1740, batch loss: 0.691813051700592, batch acc: 0.781250
2025-06-22 12:06:25,693 INFO 	iter: 1760, batch loss: 0.8424731492996216, batch acc: 0.375000
2025-06-22 12:08:35,741 INFO 	iter: 1780, batch loss: 0.8010544180870056, batch acc: 0.406250
2025-06-22 12:10:41,723 INFO 	iter: 1800, batch loss: 0.7873728275299072, batch acc: 0.500000
2025-06-22 12:12:44,516 INFO 	iter: 1820, batch loss: 0.7328547835350037, batch acc: 0.656250
2025-06-22 12:14:44,959 INFO 	iter: 1840, batch loss: 0.7342261075973511, batch acc: 0.750000
2025-06-22 12:15:17,273 INFO Epoch: loss: 0.774639, acc: 0.558669
2025-06-22 12:16:45,757 INFO Completed dev evaluation: size=656.0, acc=0.5381
2025-06-22 12:16:45,759 INFO 	Eval, eval loss: 0.7761337161064148, acc: 0.538110, mcc: 0.155656
2025-06-22 12:16:45,759 INFO New best dev MCC: 0.1557. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 12:20:06,023 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 12:20:06,023 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 12:20:06,024 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 12:20:06,027 INFO Start graph assembling...
2025-06-22 12:20:06,427 INFO use_dual_path_srl: True
2025-06-22 12:20:06,427 INFO variant_type: hedge
2025-06-22 12:20:06,427 INFO use_enhanced_srl: True
2025-06-22 12:20:06,427 INFO Enhanced SRL enabled from config
2025-06-22 12:20:06,427 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 12:20:06,427 INFO SRL condition: True = True and True
2025-06-22 12:20:06,427 INFO Using enhanced dual-path SRL architecture
2025-06-22 12:20:06,427 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 12:20:06,871 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 12:20:06,871 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 12:20:06,871 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 12:20:07,315 INFO Building Adaptive Temporal Attention (ATA) module and Final Loss...
2025-06-22 12:20:07,315 INFO Applying label smoothing with alpha=0.1
2025-06-22 12:20:07,317 INFO Ca-TSU enabled: True
2025-06-22 12:20:07,317 INFO Enhanced SRL enabled: True
2025-06-22 12:20:07,317 INFO Noise-Aware Loss enabled: False
2025-06-22 12:20:07,340 INFO Using Generative Base Loss (Likelihood + KL Objective): Tensor("generative_ata_loss/Mean:0", dtype=float32, device=/device:GPU:0)
2025-06-22 12:20:07,341 INFO Adding auxiliary enhancement losses...
2025-06-22 12:20:07,345 INFO Creating standard Contrastive Loss component...
2025-06-22 12:20:07,346 INFO Using Predictive SRL Loss for each pathway with weight: 0.1
2025-06-22 12:20:07,348 INFO Creating Causal Consistency Loss component (KL Divergence)...
2025-06-22 12:20:07,363 INFO Using KL-based Causal Consistency Loss with weight: 0.45594244201742495
2025-06-22 12:20:07,364 INFO Adding L2 regularization loss to total loss: Tensor("total_l2_loss:0", shape=(), dtype=float32, device=/device:GPU:0)
2025-06-22 12:20:07,364 INFO Final loss after all components: Tensor("add_l2_loss:0", dtype=float32, device=/device:GPU:0)
2025-06-22 12:20:07,364 INFO Final loss components being optimized: ['base_generative_objective', 'enhanced_srl_loss_raw', 'causal_consistency_loss_raw', 'l2_loss']
2025-06-22 12:20:10,601 INFO Graph assembled successfully.
2025-06-22 12:20:31,344 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 12:20:33,550 INFO Word table initialized.
2025-06-22 12:20:33,551 INFO Model: all-hedge-gru_87bd0e78, starting new session.
2025-06-22 12:24:24,657 INFO 	iter: 20, batch loss: 3.1491544246673584, batch acc: 0.562500
2025-06-22 12:26:51,376 INFO 	iter: 40, batch loss: 2.296830415725708, batch acc: 0.593750
2025-06-22 12:29:06,178 INFO 	iter: 60, batch loss: 1.7997615337371826, batch acc: 0.718750
2025-06-22 12:31:11,464 INFO 	iter: 80, batch loss: 1.5996555089950562, batch acc: 0.656250
2025-06-22 12:33:14,235 INFO 	iter: 100, batch loss: 1.4275953769683838, batch acc: 0.687500
2025-06-22 12:35:10,752 INFO 	iter: 120, batch loss: 1.2898926734924316, batch acc: 0.781250
2025-06-22 12:37:05,667 INFO 	iter: 140, batch loss: 1.281294584274292, batch acc: 0.781250
2025-06-22 12:38:31,195 INFO Epoch: loss: 1.824126, acc: 0.696371
2025-06-22 12:39:42,567 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-22 12:39:42,571 INFO 	Eval, eval loss: 1.3660244941711426, acc: 0.509146, mcc: 0.033122
2025-06-22 12:39:42,571 INFO New best dev MCC: 0.0331. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 12:41:19,307 INFO 	iter: 160, batch loss: 1.2625501155853271, batch acc: 0.593750
2025-06-22 12:44:18,112 INFO 	iter: 180, batch loss: 1.2748335599899292, batch acc: 0.625000
2025-06-22 12:46:38,912 INFO 	iter: 200, batch loss: 1.2171975374221802, batch acc: 0.625000
2025-06-22 12:48:48,903 INFO 	iter: 220, batch loss: 1.1339597702026367, batch acc: 0.656250
2025-06-22 12:50:53,922 INFO 	iter: 240, batch loss: 1.1323223114013672, batch acc: 0.562500
2025-06-22 12:52:56,830 INFO 	iter: 260, batch loss: 0.9530813097953796, batch acc: 0.718750
2025-06-22 12:54:54,140 INFO 	iter: 280, batch loss: 0.9997228384017944, batch acc: 0.593750
2025-06-22 12:56:49,351 INFO 	iter: 300, batch loss: 0.9709163904190063, batch acc: 0.593750
2025-06-22 12:57:47,616 INFO Epoch: loss: 1.121010, acc: 0.618750
2025-06-22 12:59:01,959 INFO Completed dev evaluation: size=656.0, acc=0.5168
2025-06-22 12:59:01,962 INFO 	Eval, eval loss: 0.9582859873771667, acc: 0.516768, mcc: 0.070649
2025-06-22 12:59:01,962 INFO New best dev MCC: 0.0706. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 13:01:31,080 INFO 	iter: 320, batch loss: 0.831699788570404, batch acc: 0.750000
2025-06-22 13:04:13,496 INFO 	iter: 340, batch loss: 0.8995622396469116, batch acc: 0.562500
2025-06-22 13:06:35,232 INFO 	iter: 360, batch loss: 0.8198043704032898, batch acc: 0.656250
2025-06-22 13:08:43,206 INFO 	iter: 380, batch loss: 0.8536761403083801, batch acc: 0.656250
2025-06-22 13:10:48,704 INFO 	iter: 400, batch loss: 0.819786787033081, batch acc: 0.718750
2025-06-22 13:12:51,122 INFO 	iter: 420, batch loss: 0.9415563344955444, batch acc: 0.500000
2025-06-22 13:14:49,397 INFO 	iter: 440, batch loss: 0.8619307279586792, batch acc: 0.625000
2025-06-22 13:16:45,130 INFO 	iter: 460, batch loss: 0.8457489609718323, batch acc: 0.625000
2025-06-22 13:17:17,146 INFO Epoch: loss: 0.893326, acc: 0.600403
2025-06-22 13:18:32,763 INFO Completed dev evaluation: size=656.0, acc=0.4939
2025-06-22 13:18:32,766 INFO 	Eval, eval loss: 0.8863774538040161, acc: 0.493902, mcc: 0.007155
2025-06-22 13:18:32,766 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 13:21:46,704 INFO 	iter: 480, batch loss: 0.8125651478767395, batch acc: 0.656250
2025-06-22 13:24:22,217 INFO 	iter: 500, batch loss: 0.8148031234741211, batch acc: 0.562500
2025-06-22 13:26:40,447 INFO 	iter: 520, batch loss: 0.8811375498771667, batch acc: 0.531250
2025-06-22 13:28:48,215 INFO 	iter: 540, batch loss: 0.8141874074935913, batch acc: 0.593750
2025-06-22 13:30:55,925 INFO 	iter: 560, batch loss: 0.8216697573661804, batch acc: 0.625000
2025-06-22 13:32:57,398 INFO 	iter: 580, batch loss: 0.8065854907035828, batch acc: 0.625000
2025-06-22 13:34:55,855 INFO 	iter: 600, batch loss: 0.8899040818214417, batch acc: 0.500000
2025-06-22 13:36:53,035 INFO 	iter: 620, batch loss: 0.8349486589431763, batch acc: 0.625000
2025-06-22 13:36:54,621 INFO Epoch: loss: 0.842237, acc: 0.578629
2025-06-22 13:38:25,396 INFO Completed dev evaluation: size=656.0, acc=0.5274
2025-06-22 13:38:25,399 INFO 	Eval, eval loss: 0.852761447429657, acc: 0.527439, mcc: 0.088029
2025-06-22 13:38:25,399 INFO New best dev MCC: 0.0880. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 13:42:22,200 INFO 	iter: 640, batch loss: 0.8078761696815491, batch acc: 0.687500
2025-06-22 13:44:49,677 INFO 	iter: 660, batch loss: 0.7816885113716125, batch acc: 0.593750
2025-06-22 13:47:06,413 INFO 	iter: 680, batch loss: 0.9195387363433838, batch acc: 0.281250
2025-06-22 13:49:17,593 INFO 	iter: 700, batch loss: 0.8242966532707214, batch acc: 0.531250
2025-06-22 13:51:25,556 INFO 	iter: 720, batch loss: 0.8050073981285095, batch acc: 0.625000
2025-06-22 13:53:27,086 INFO 	iter: 740, batch loss: 0.8170894384384155, batch acc: 0.625000
2025-06-22 13:55:27,498 INFO 	iter: 760, batch loss: 0.8616191148757935, batch acc: 0.625000
2025-06-22 13:56:57,163 INFO Epoch: loss: 0.817778, acc: 0.586290
2025-06-22 13:58:19,149 INFO Completed dev evaluation: size=656.0, acc=0.5030
2025-06-22 13:58:19,151 INFO 	Eval, eval loss: 0.8340767025947571, acc: 0.503049, mcc: 0.025460
2025-06-22 13:58:19,151 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 13:59:49,866 INFO 	iter: 780, batch loss: 0.9013765454292297, batch acc: 0.468750
2025-06-22 14:02:54,762 INFO 	iter: 800, batch loss: 0.7476706504821777, batch acc: 0.687500
2025-06-22 14:05:21,091 INFO 	iter: 820, batch loss: 0.8140689730644226, batch acc: 0.625000
2025-06-22 14:07:48,442 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 14:07:48,442 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 14:07:48,443 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 14:07:48,445 INFO Start graph assembling...
2025-06-22 14:07:48,850 INFO use_dual_path_srl: True
2025-06-22 14:07:48,850 INFO variant_type: hedge
2025-06-22 14:07:48,850 INFO use_enhanced_srl: True
2025-06-22 14:07:48,850 INFO Enhanced SRL enabled from config
2025-06-22 14:07:48,850 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 14:07:48,850 INFO SRL condition: True = True and True
2025-06-22 14:07:48,850 INFO Using enhanced dual-path SRL architecture
2025-06-22 14:07:48,850 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 14:07:49,291 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 14:07:49,291 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 14:07:49,291 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 14:07:49,732 INFO Building ATA module using model variant: hedge
2025-06-22 14:07:49,732 INFO Applying label smoothing with alpha=0.1
2025-06-22 14:07:49,788 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32, device=/device:GPU:0), Explainability: Tensor("generative_ata/Add_1:0", dtype=float32, device=/device:GPU:0)
2025-06-22 14:07:49,789 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32, device=/device:GPU:0)
2025-06-22 14:07:53,069 INFO Graph assembled successfully.
2025-06-22 14:08:14,319 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 14:08:16,441 INFO Word table initialized.
2025-06-22 14:08:16,661 INFO Model: all-hedge-gru_87bd0e78, session restored from checkpoint.
2025-06-22 14:10:01,641 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 14:10:01,641 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 14:10:01,641 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 14:10:01,644 INFO Start graph assembling...
2025-06-22 14:10:02,042 INFO use_dual_path_srl: True
2025-06-22 14:10:02,042 INFO variant_type: hedge
2025-06-22 14:10:02,042 INFO use_enhanced_srl: True
2025-06-22 14:10:02,042 INFO Enhanced SRL enabled from config
2025-06-22 14:10:02,042 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 14:10:02,042 INFO SRL condition: True = True and True
2025-06-22 14:10:02,042 INFO Using enhanced dual-path SRL architecture
2025-06-22 14:10:02,042 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 14:10:02,488 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 14:10:02,488 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 14:10:02,488 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 14:10:02,932 INFO Building ATA module using model variant: hedge
2025-06-22 14:10:02,932 INFO Applying label smoothing with alpha=0.1
2025-06-22 14:10:02,989 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32, device=/device:GPU:0), Explainability: Tensor("generative_ata/Add_1:0", dtype=float32, device=/device:GPU:0)
2025-06-22 14:10:02,990 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32, device=/device:GPU:0)
2025-06-22 14:10:06,290 INFO Graph assembled successfully.
2025-06-22 14:10:27,447 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 14:10:28,838 INFO Word table initialized.
2025-06-22 14:10:28,839 INFO Model: all-hedge-gru_87bd0e78, starting new session.
2025-06-22 14:14:29,004 INFO 	iter: 20, batch loss: 4.116755485534668, batch acc: 0.687500
2025-06-22 14:16:57,564 INFO 	iter: 40, batch loss: 3.2377970218658447, batch acc: 0.625000
2025-06-22 14:19:10,182 INFO 	iter: 60, batch loss: 2.7647006511688232, batch acc: 0.875000
2025-06-22 14:21:18,738 INFO 	iter: 80, batch loss: 2.6188316345214844, batch acc: 0.656250
2025-06-22 14:23:24,461 INFO 	iter: 100, batch loss: 2.3827781677246094, batch acc: 0.656250
2025-06-22 14:25:25,109 INFO 	iter: 120, batch loss: 2.142847776412964, batch acc: 0.687500
2025-06-22 14:27:23,119 INFO 	iter: 140, batch loss: 2.144792079925537, batch acc: 0.687500
2025-06-22 14:28:50,997 INFO Epoch: loss: 2.817070, acc: 0.679435
2025-06-22 14:30:03,022 INFO Completed dev evaluation: size=656.0, acc=0.5030
2025-06-22 14:30:03,026 INFO 	Eval, eval loss: 2.5284433364868164, acc: 0.503049, mcc: 0.015745
2025-06-22 14:30:03,026 INFO New best dev MCC: 0.0157. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 14:31:39,438 INFO 	iter: 160, batch loss: 2.6343977451324463, batch acc: 0.750000
2025-06-22 14:34:47,151 INFO 	iter: 180, batch loss: 2.523689031600952, batch acc: 0.718750
2025-06-22 14:37:13,219 INFO 	iter: 200, batch loss: 2.5176050662994385, batch acc: 0.656250
2025-06-22 14:39:28,086 INFO 	iter: 220, batch loss: 2.2555840015411377, batch acc: 0.562500
2025-06-22 14:41:36,779 INFO 	iter: 240, batch loss: 2.2927510738372803, batch acc: 0.531250
2025-06-22 14:43:42,287 INFO 	iter: 260, batch loss: 2.1545069217681885, batch acc: 0.500000
2025-06-22 14:45:42,463 INFO 	iter: 280, batch loss: 1.9323924779891968, batch acc: 0.500000
2025-06-22 14:47:41,562 INFO 	iter: 300, batch loss: 1.5997973680496216, batch acc: 0.593750
2025-06-22 14:48:40,550 INFO Epoch: loss: 2.172137, acc: 0.631855
2025-06-22 14:50:05,120 INFO Completed dev evaluation: size=656.0, acc=0.4954
2025-06-22 14:50:05,123 INFO 	Eval, eval loss: 2.1583263874053955, acc: 0.495427, mcc: 0.008550
2025-06-22 14:50:05,123 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 14:52:35,159 INFO 	iter: 320, batch loss: 2.239483118057251, batch acc: 0.625000
2025-06-22 14:55:26,611 INFO 	iter: 340, batch loss: 2.2003796100616455, batch acc: 0.656250
2025-06-22 14:57:51,040 INFO 	iter: 360, batch loss: 2.0628232955932617, batch acc: 0.812500
2025-06-22 15:00:04,699 INFO 	iter: 380, batch loss: 2.151940107345581, batch acc: 0.625000
2025-06-22 15:02:14,847 INFO 	iter: 400, batch loss: 2.0842154026031494, batch acc: 0.437500
2025-06-22 15:04:19,974 INFO 	iter: 420, batch loss: 1.9639166593551636, batch acc: 0.656250
2025-06-22 15:06:20,563 INFO 	iter: 440, batch loss: 1.7103955745697021, batch acc: 0.656250
2025-06-22 15:08:19,520 INFO 	iter: 460, batch loss: 1.3337441682815552, batch acc: 0.625000
2025-06-22 15:08:49,872 INFO Epoch: loss: 1.971857, acc: 0.588710
2025-06-22 15:10:07,219 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-22 15:10:07,222 INFO 	Eval, eval loss: 2.087217092514038, acc: 0.487805, mcc: -0.006700
2025-06-22 15:10:07,222 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-22 15:13:24,347 INFO 	iter: 480, batch loss: 2.256044626235962, batch acc: 0.625000
2025-06-22 15:16:08,337 INFO 	iter: 500, batch loss: 2.107827663421631, batch acc: 0.406250
2025-06-22 15:18:29,915 INFO 	iter: 520, batch loss: 2.0314009189605713, batch acc: 0.562500
2025-06-22 15:20:42,773 INFO 	iter: 540, batch loss: 1.922288179397583, batch acc: 0.468750
2025-06-22 15:22:53,973 INFO 	iter: 560, batch loss: 1.842287302017212, batch acc: 0.500000
2025-06-22 15:24:59,843 INFO 	iter: 580, batch loss: 1.723074197769165, batch acc: 0.750000
2025-06-22 15:27:02,050 INFO 	iter: 600, batch loss: 1.4660648107528687, batch acc: 0.750000
2025-06-22 15:29:02,196 INFO 	iter: 620, batch loss: 1.2271453142166138, batch acc: 0.531250
2025-06-22 15:29:03,776 INFO Epoch: loss: 1.925223, acc: 0.576815
2025-06-22 15:30:23,316 INFO Completed dev evaluation: size=656.0, acc=0.4909
2025-06-22 15:30:23,319 INFO 	Eval, eval loss: 2.0500805377960205, acc: 0.490854, mcc: 0.006077
2025-06-22 15:30:23,319 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-22 15:30:23,319 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-22 15:30:23,319 INFO Generating diagnostic plots...
2025-06-22 15:30:28,071 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-22 15:30:28,072 INFO Best performance on development set:
2025-06-22 17:16:04,044 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 17:16:04,045 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 17:16:04,045 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 17:16:04,048 INFO Start graph assembling...
2025-06-22 17:16:04,449 INFO use_dual_path_srl: True
2025-06-22 17:16:04,449 INFO variant_type: hedge
2025-06-22 17:16:04,449 INFO use_enhanced_srl: True
2025-06-22 17:16:04,449 INFO Enhanced SRL enabled from config
2025-06-22 17:16:04,449 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 17:16:04,449 INFO SRL condition: True = True and True
2025-06-22 17:16:04,449 INFO Using enhanced dual-path SRL architecture
2025-06-22 17:16:04,449 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 17:16:04,732 INFO Created TD pathway with MSIN cell: h_TD shape = (?, 5, 100)
2025-06-22 18:17:45,744 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 18:17:45,745 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 18:17:45,745 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 18:17:45,747 INFO Start graph assembling...
2025-06-22 18:17:45,997 INFO use_dual_path_srl: True
2025-06-22 18:17:45,997 INFO variant_type: hedge
2025-06-22 18:17:45,997 INFO use_enhanced_srl: True
2025-06-22 18:17:45,997 INFO Enhanced SRL enabled from config
2025-06-22 18:17:45,997 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 18:17:45,997 INFO SRL condition: True = True and True
2025-06-22 18:17:45,997 INFO Using enhanced dual-path SRL architecture
2025-06-22 18:17:45,997 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 18:17:46,250 INFO Created TD pathway with MSIN cell: h_TD shape = (?, 5, 100)
2025-06-22 18:27:17,836 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 18:27:17,836 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 18:27:17,836 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 18:27:17,838 INFO Start graph assembling...
2025-06-22 18:27:18,082 INFO use_dual_path_srl: True
2025-06-22 18:27:18,082 INFO variant_type: hedge
2025-06-22 18:27:18,082 INFO use_enhanced_srl: True
2025-06-22 18:27:18,082 INFO Enhanced SRL enabled from config
2025-06-22 18:27:18,082 INFO Dual-path SRL automatically enabled for Enhanced SRL
2025-06-22 18:27:18,082 INFO SRL condition: True = True and True
2025-06-22 18:27:18,082 INFO Using enhanced dual-path SRL architecture
2025-06-22 18:27:18,082 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 18:27:18,299 INFO Created TD pathway with MSIN cell: h_TD shape = (?, 5, 100)
2025-06-22 18:27:18,536 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 18:27:18,536 INFO Enhanced dual-path output found - using h_enhanced_dual_path
2025-06-22 18:27:18,536 INFO Final VMD input tensor: enhanced_dual_path_srl/pathway_fusion/add_6:0 with shape (?, 5, 100)
2025-06-22 18:27:18,821 INFO Building ATA module using model variant: hedge
2025-06-22 18:27:18,822 INFO Applying label smoothing with alpha=0.1
2025-06-22 18:27:18,852 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32, device=/device:GPU:0), Explainability: Tensor("generative_ata/Add:0", dtype=float32, device=/device:GPU:0)
2025-06-22 18:27:18,853 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32, device=/device:GPU:0)
2025-06-22 18:27:21,435 INFO Graph assembled successfully.
2025-06-22 18:28:06,632 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 18:28:23,587 INFO Word table initialized.
2025-06-22 18:28:28,793 ERROR Could not restore checkpoint: Key enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/dense/bias not found in checkpoint
	 [[Node: save/RestoreV2_16 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_16/tensor_names, save/RestoreV2_16/shape_and_slices)]]
	 [[Node: save/RestoreV2_153/_271 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_726_save/RestoreV2_153", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_16', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key enhanced_dual_path_srl/price_driven_pathway/daily_pd_processing/dense/bias not found in checkpoint
	 [[Node: save/RestoreV2_16 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_16/tensor_names, save/RestoreV2_16/shape_and_slices)]]
	 [[Node: save/RestoreV2_153/_271 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_726_save/RestoreV2_153", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-22 18:55:19,490 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 18:55:19,490 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 18:55:19,491 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 18:55:19,493 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-22 18:55:19,502 INFO Placeholders created
2025-06-22 18:55:19,504 INFO Word embeddings created
2025-06-22 18:55:19,509 INFO Message embedding layer input created
2025-06-22 18:55:19,689 INFO Message embeddings created with BiGRU
2025-06-22 18:55:19,777 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 100)
2025-06-22 18:55:19,777 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 18:55:19,777 INFO Using MSIN cell for text-driven pathway with shape handling
2025-06-22 18:55:20,082 INFO Created TD pathway with MSIN-like cell: h_TD shape = (?, 5, 100)
2025-06-22 18:55:20,274 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 18:55:20,274 INFO Enhanced Dual-Path SRL created. Shape: (?, 5, 100)
2025-06-22 18:55:20,481 INFO VMD (DRG) created
2025-06-22 18:55:20,537 INFO Temporal Attention Prediction (TAP) created
2025-06-22 18:55:20,537 INFO Building ATA module using model variant: hedge
2025-06-22 18:55:20,537 INFO Applying label smoothing with alpha=0.1
2025-06-22 18:55:20,566 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-22 18:55:20,567 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-22 18:55:20,567 INFO ATA loss module created
2025-06-22 18:55:23,266 INFO Optimizer created
2025-06-22 18:55:23,268 INFO ---------- Graph assembly completed ----------
2025-06-22 18:55:40,038 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 18:55:42,516 INFO Word table initialized.
2025-06-22 18:55:42,728 ERROR Could not restore checkpoint: Key enhanced_dual_path_srl/text_driven_pathway/daily_td_processing/msin_gating/text_new/kernel/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_87 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_87/tensor_names, save/RestoreV2_87/shape_and_slices)]]
	 [[Node: save/RestoreV2_80/_201 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_614_save/RestoreV2_80", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_87', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key enhanced_dual_path_srl/text_driven_pathway/daily_td_processing/msin_gating/text_new/kernel/Adam_1 not found in checkpoint
	 [[Node: save/RestoreV2_87 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_87/tensor_names, save/RestoreV2_87/shape_and_slices)]]
	 [[Node: save/RestoreV2_80/_201 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_614_save/RestoreV2_80", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-22 18:58:45,586 INFO 	iter: 640, batch loss: 17.21588134765625, batch acc: 0.468750
2025-06-22 19:01:02,514 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-22 19:01:02,514 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-22 19:01:02,515 INFO Using L2 regularization with lambda: 0.0001
2025-06-22 19:01:02,516 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-22 19:01:02,525 INFO Placeholders created
2025-06-22 19:01:02,526 INFO Word embeddings created
2025-06-22 19:01:02,530 INFO Message embedding layer input created
2025-06-22 19:01:02,673 INFO Message embeddings created with BiGRU
2025-06-22 19:01:02,747 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 100)
2025-06-22 19:01:02,747 INFO Creating Enhanced Dual-Path SRL module...
2025-06-22 19:01:02,748 INFO Using MSIN cell for text-driven pathway with shape handling
2025-06-22 19:01:03,078 INFO Created TD pathway with MSIN-like cell: h_TD shape = (?, 5, 100)
2025-06-22 19:01:03,281 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-22 19:01:03,282 INFO Enhanced Dual-Path SRL created. Shape: (?, 5, 100)
2025-06-22 19:01:03,491 INFO VMD (DRG) created
2025-06-22 19:01:03,547 INFO Temporal Attention Prediction (TAP) created
2025-06-22 19:01:03,547 INFO Building ATA module using model variant: hedge
2025-06-22 19:01:03,547 INFO Applying label smoothing with alpha=0.1
2025-06-22 19:01:03,575 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-22 19:01:03,576 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-22 19:01:03,576 INFO ATA loss module created
2025-06-22 19:01:06,253 INFO Optimizer created
2025-06-22 19:01:06,254 INFO ---------- Graph assembly completed ----------
2025-06-22 19:01:22,238 INFO ASSEMBLE: word table #replacement: 19482
2025-06-22 19:01:23,762 INFO Word table initialized.
2025-06-22 19:01:23,763 INFO Model: all-hedge-gru_87bd0e78, starting new session.
2025-06-22 19:04:23,462 INFO 	iter: 20, batch loss: 4.334346294403076, batch acc: 0.531250
2025-06-22 19:06:14,745 INFO 	iter: 40, batch loss: 3.21628737449646, batch acc: 0.718750
2025-06-22 19:07:53,151 INFO 	iter: 60, batch loss: 2.8034183979034424, batch acc: 0.843750
2025-06-22 19:09:27,856 INFO 	iter: 80, batch loss: 2.7722232341766357, batch acc: 0.687500
2025-06-22 19:11:02,523 INFO 	iter: 100, batch loss: 2.4837417602539062, batch acc: 0.750000
2025-06-22 19:12:33,618 INFO 	iter: 120, batch loss: 2.2578611373901367, batch acc: 0.781250
2025-06-22 19:14:00,369 INFO 	iter: 140, batch loss: 2.076829671859741, batch acc: 0.562500
2025-06-22 19:15:05,691 INFO Epoch: loss: 2.885411, acc: 0.685081
2025-06-22 19:16:05,482 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-22 19:16:05,484 INFO 	Eval, eval loss: 2.6348071098327637, acc: 0.504573, mcc: 0.008189
2025-06-22 19:16:05,484 INFO New best dev MCC: 0.0082. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 19:17:19,482 INFO 	iter: 160, batch loss: 2.590269088745117, batch acc: 0.687500
2025-06-22 19:19:38,486 INFO 	iter: 180, batch loss: 2.6928672790527344, batch acc: 0.625000
2025-06-22 19:21:30,507 INFO 	iter: 200, batch loss: 2.3274776935577393, batch acc: 0.625000
2025-06-22 19:23:07,990 INFO 	iter: 220, batch loss: 2.3433711528778076, batch acc: 0.531250
2025-06-22 19:24:43,561 INFO 	iter: 240, batch loss: 2.1836459636688232, batch acc: 0.468750
2025-06-22 19:26:18,216 INFO 	iter: 260, batch loss: 2.054750919342041, batch acc: 0.468750
2025-06-22 19:27:48,468 INFO 	iter: 280, batch loss: 2.0278358459472656, batch acc: 0.468750
2025-06-22 19:29:17,014 INFO 	iter: 300, batch loss: 1.8141720294952393, batch acc: 0.625000
2025-06-22 19:30:02,605 INFO Epoch: loss: 2.212139, acc: 0.633669
2025-06-22 19:38:00,055 INFO Completed dev evaluation: size=656.0, acc=0.5351
2025-06-22 19:38:00,058 INFO 	Eval, eval loss: 2.182116746902466, acc: 0.535061, mcc: 0.073164
2025-06-22 19:38:00,058 INFO New best dev MCC: 0.0732. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_87bd0e78/best_model/model
2025-06-22 19:39:48,657 INFO 	iter: 320, batch loss: 2.2277956008911133, batch acc: 0.656250
2025-06-22 19:42:08,316 INFO 	iter: 340, batch loss: 2.324134111404419, batch acc: 0.562500
2025-06-22 19:43:54,727 INFO 	iter: 360, batch loss: 2.120981454849243, batch acc: 0.500000
2025-06-22 19:45:37,332 INFO 	iter: 380, batch loss: 1.887135624885559, batch acc: 0.625000
2025-06-22 19:47:13,636 INFO 	iter: 400, batch loss: 1.9662269353866577, batch acc: 0.687500
2025-06-22 19:53:12,151 INFO 	iter: 420, batch loss: 1.79052734375, batch acc: 0.593750
2025-06-22 19:59:32,253 INFO 	iter: 440, batch loss: 1.5727258920669556, batch acc: 0.687500
2025-06-22 20:05:29,467 INFO 	iter: 460, batch loss: 1.2907347679138184, batch acc: 0.812500
2025-06-22 20:07:00,775 INFO Epoch: loss: 1.991400, acc: 0.592742
2025-06-22 20:13:25,923 INFO Completed dev evaluation: size=656.0, acc=0.5213
2025-06-22 20:13:25,975 INFO 	Eval, eval loss: 2.0980989933013916, acc: 0.521341, mcc: 0.036090
2025-06-22 20:13:25,975 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-22 20:25:44,120 INFO 	iter: 480, batch loss: 2.0881121158599854, batch acc: 0.500000
2025-06-22 20:27:47,119 INFO 	iter: 500, batch loss: 2.254375457763672, batch acc: 0.593750
2025-06-22 20:29:33,343 INFO 	iter: 520, batch loss: 1.9332294464111328, batch acc: 0.750000
2025-06-22 20:31:13,295 INFO 	iter: 540, batch loss: 2.1829652786254883, batch acc: 0.406250
2025-06-22 20:32:51,845 INFO 	iter: 560, batch loss: 2.036402940750122, batch acc: 0.500000
2025-06-22 20:36:38,290 INFO 	iter: 580, batch loss: 1.7265558242797852, batch acc: 0.625000
2025-06-22 20:42:48,439 INFO 	iter: 600, batch loss: 1.6280592679977417, batch acc: 0.593750
2025-06-22 20:48:28,514 INFO 	iter: 620, batch loss: 1.142349123954773, batch acc: 0.500000
2025-06-22 20:48:42,593 INFO Epoch: loss: 1.934284, acc: 0.589718
2025-06-22 20:54:57,026 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-22 20:54:57,075 INFO 	Eval, eval loss: 2.0629191398620605, acc: 0.512195, mcc: 0.032983
2025-06-22 20:54:57,075 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-22 21:22:20,692 INFO 	iter: 640, batch loss: 2.2151453495025635, batch acc: 0.625000
2025-06-22 21:33:50,057 INFO 	iter: 660, batch loss: 2.0370991230010986, batch acc: 0.593750
2025-06-22 21:41:55,306 INFO 	iter: 680, batch loss: 1.9516572952270508, batch acc: 0.781250
2025-06-22 21:43:37,476 INFO 	iter: 700, batch loss: 1.8727071285247803, batch acc: 0.656250
2025-06-22 21:45:15,527 INFO 	iter: 720, batch loss: 1.9533464908599854, batch acc: 0.500000
2025-06-22 21:46:50,812 INFO 	iter: 740, batch loss: 1.8047723770141602, batch acc: 0.562500
2025-06-22 21:55:12,744 INFO 	iter: 760, batch loss: 1.5288389921188354, batch acc: 0.562500
2025-06-22 21:56:22,730 INFO Epoch: loss: 1.911635, acc: 0.590121
2025-06-22 21:57:33,915 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-22 21:57:33,918 INFO 	Eval, eval loss: 2.0445423126220703, acc: 0.486280, mcc: -0.036745
2025-06-22 21:57:33,918 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-22 21:57:33,918 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-22 21:57:33,918 INFO Generating diagnostic plots...
2025-06-22 21:57:37,746 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-22 21:57:37,747 INFO Best performance on development set:
2025-06-23 07:16:09,850 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 07:16:09,850 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 07:16:09,850 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 07:16:09,852 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 07:16:09,860 INFO Placeholders created
2025-06-23 07:16:09,862 INFO Word embeddings created
2025-06-23 07:16:09,865 INFO Message embedding layer input created
2025-06-23 07:16:10,011 INFO Message embeddings created with BiGRU
2025-06-23 07:16:10,087 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 07:16:10,087 INFO Creating Enhanced Dual-Path SRL module...
2025-06-23 07:16:10,087 INFO Using MSIN cell for text-driven pathway with shape handling
2025-06-23 07:16:10,394 INFO Created TD pathway with MSIN-like cell: h_TD shape = (?, 5, 64)
2025-06-23 07:16:10,583 INFO Enhanced Dual-Path SRL module created successfully.
2025-06-23 07:16:10,583 INFO Enhanced Dual-Path SRL created. Shape: (?, 5, 64)
2025-06-23 07:16:10,788 INFO VMD (DRG) created
2025-06-23 07:16:10,843 INFO Temporal Attention Prediction (TAP) created
2025-06-23 07:16:10,844 INFO Building ATA module using model variant: hedge
2025-06-23 07:16:10,844 INFO Applying label smoothing with alpha=0.2
2025-06-23 07:16:10,871 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 07:16:10,872 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 07:16:10,872 INFO ATA loss module created
2025-06-23 07:16:13,476 INFO Optimizer created
2025-06-23 07:16:13,477 INFO ---------- Graph assembly completed ----------
2025-06-23 07:16:31,168 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 07:16:58,305 INFO Word table initialized.
2025-06-23 07:16:58,394 INFO Model: all-hedge-gru_a996f639, starting new session.
2025-06-23 07:42:22,221 INFO 	iter: 20, batch loss: 3.0382041931152344, batch acc: 0.468750
2025-06-23 07:50:08,042 INFO 	iter: 40, batch loss: 2.8670074939727783, batch acc: 0.593750
2025-06-23 07:53:54,475 INFO 	iter: 60, batch loss: 2.961483955383301, batch acc: 0.687500
2025-06-23 07:55:30,069 INFO 	iter: 80, batch loss: 2.6054389476776123, batch acc: 0.656250
2025-06-23 07:59:12,127 INFO 	iter: 100, batch loss: 2.461430072784424, batch acc: 0.750000
2025-06-23 08:09:22,772 INFO 	iter: 120, batch loss: 2.318025827407837, batch acc: 0.718750
2025-06-23 08:13:02,663 INFO 	iter: 140, batch loss: 1.9965609312057495, batch acc: 0.781250
2025-06-23 08:14:22,987 INFO Epoch: loss: 2.583928, acc: 0.656855
2025-06-23 08:22:02,561 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-23 08:22:02,574 INFO 	Eval, eval loss: 2.5096843242645264, acc: 0.486280, mcc: -0.020394
2025-06-23 08:22:02,575 INFO New best dev MCC: -0.0204. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_a996f639/best_model/model
2025-06-23 08:23:13,261 INFO 	iter: 160, batch loss: 2.298999309539795, batch acc: 0.968750
2025-06-23 08:27:57,940 INFO 	iter: 180, batch loss: 2.342529773712158, batch acc: 0.750000
2025-06-23 08:31:59,674 INFO 	iter: 200, batch loss: 2.0576207637786865, batch acc: 0.875000
2025-06-23 08:35:48,154 INFO 	iter: 220, batch loss: 2.1239521503448486, batch acc: 0.750000
2025-06-23 08:39:32,861 INFO 	iter: 240, batch loss: 2.1557295322418213, batch acc: 0.906250
2025-06-23 08:43:20,152 INFO 	iter: 260, batch loss: 2.1200249195098877, batch acc: 0.781250
2025-06-23 08:44:46,795 INFO 	iter: 280, batch loss: 1.8467590808868408, batch acc: 0.812500
2025-06-23 08:48:28,238 INFO 	iter: 300, batch loss: 1.7054508924484253, batch acc: 0.875000
2025-06-23 08:49:11,744 INFO Epoch: loss: 2.131334, acc: 0.801815
2025-06-23 08:58:51,069 INFO Completed dev evaluation: size=656.0, acc=0.5213
2025-06-23 08:58:51,808 INFO 	Eval, eval loss: 2.3372087478637695, acc: 0.521341, mcc: 0.057364
2025-06-23 08:58:51,808 INFO New best dev MCC: 0.0574. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_a996f639/best_model/model
2025-06-23 09:04:34,044 INFO 	iter: 320, batch loss: 2.41312837600708, batch acc: 0.750000
2025-06-23 09:08:47,227 INFO 	iter: 340, batch loss: 2.2482850551605225, batch acc: 0.750000
2025-06-23 09:12:37,116 INFO 	iter: 360, batch loss: 2.2788517475128174, batch acc: 0.687500
2025-06-23 09:16:20,926 INFO 	iter: 380, batch loss: 2.116337776184082, batch acc: 0.875000
2025-06-23 09:18:58,812 INFO 	iter: 400, batch loss: 2.0993382930755615, batch acc: 0.656250
2025-06-23 09:21:33,055 INFO 	iter: 420, batch loss: 1.96257746219635, batch acc: 0.718750
2025-06-23 09:25:04,961 INFO 	iter: 440, batch loss: 2.131540536880493, batch acc: 0.656250
2025-06-23 09:35:05,444 INFO 	iter: 460, batch loss: 1.6432467699050903, batch acc: 0.625000
2025-06-23 09:35:28,466 INFO Epoch: loss: 2.070990, acc: 0.757056
2025-06-23 09:38:38,638 INFO Completed dev evaluation: size=656.0, acc=0.4909
2025-06-23 09:38:38,641 INFO 	Eval, eval loss: 2.2901716232299805, acc: 0.490854, mcc: -0.009127
2025-06-23 09:38:38,641 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 09:45:45,064 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 09:45:45,064 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 09:45:45,064 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 09:45:45,066 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 09:45:45,074 INFO Placeholders created
2025-06-23 09:45:45,076 INFO Word embeddings created
2025-06-23 09:45:45,079 INFO Message embedding layer input created
2025-06-23 09:45:45,221 INFO Message embeddings created with BiGRU
2025-06-23 09:45:45,297 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 09:49:23,353 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 09:49:23,354 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 09:49:23,354 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 09:49:23,356 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 09:49:23,364 INFO Placeholders created
2025-06-23 09:49:23,366 INFO Word embeddings created
2025-06-23 09:49:23,369 INFO Message embedding layer input created
2025-06-23 09:49:23,515 INFO Message embeddings created with BiGRU
2025-06-23 09:49:23,591 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 09:49:23,846 INFO Simple Dual-Path SRL created. Shape: (?, 5, 64)
2025-06-23 09:49:24,053 INFO VMD (DRG) created
2025-06-23 09:49:24,110 INFO Temporal Attention Prediction (TAP) created
2025-06-23 09:49:24,111 INFO Building ATA module using model variant: hedge
2025-06-23 09:49:24,111 INFO Applying label smoothing with alpha=0.2
2025-06-23 09:49:24,139 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 09:49:24,139 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 09:49:24,140 INFO ATA loss module created
2025-06-23 09:49:26,168 INFO Optimizer created
2025-06-23 09:49:26,169 INFO ---------- Graph assembly completed ----------
2025-06-23 09:49:41,294 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 09:49:44,285 INFO Word table initialized.
2025-06-23 09:49:45,445 ERROR Could not restore checkpoint: Key simplified_dual_path_srl/price_driven_pathway/h_PD_bn/beta not found in checkpoint
	 [[Node: save/RestoreV2_37 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_37/tensor_names, save/RestoreV2_37/shape_and_slices)]]
	 [[Node: save/RestoreV2_73/_197 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_576_save/RestoreV2_73", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]

Caused by op 'save/RestoreV2_37', defined at:
  File "src/Main_tx_lf_dual_path.py", line 56, in <module>
    main()
  File "src/Main_tx_lf_dual_path.py", line 33, in main
    executor = Executor(Model)
  File "/media02/tvquy/PEN/src/Executor_tx_lf_dual_path.py", line 47, in __init__
    self.saver = tf.train.Saver()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1218, in __init__
    self.build()
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1227, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1263, in _build
    build_save=build_save, build_restore=build_restore)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 751, in _build_internal
    restore_sequentially, reshape)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 427, in _AddRestoreOps
    tensors = self.restore_op(filename_tensor, saveable, preferred_shard)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 267, in restore_op
    [spec.tensor.dtype])[0])
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1021, in restore_v2
    shape_and_slices=shape_and_slices, dtypes=dtypes, name=name)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/media02/tvquy/miniconda/envs/kien_py36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

NotFoundError (see above for traceback): Key simplified_dual_path_srl/price_driven_pathway/h_PD_bn/beta not found in checkpoint
	 [[Node: save/RestoreV2_37 = RestoreV2[dtypes=[DT_FLOAT], _device="/job:localhost/replica:0/task:0/device:CPU:0"](_arg_save/Const_0_0, save/RestoreV2_37/tensor_names, save/RestoreV2_37/shape_and_slices)]]
	 [[Node: save/RestoreV2_73/_197 = _Recv[client_terminated=false, recv_device="/job:localhost/replica:0/task:0/device:GPU:0", send_device="/job:localhost/replica:0/task:0/device:CPU:0", send_device_incarnation=1, tensor_name="edge_576_save/RestoreV2_73", tensor_type=DT_FLOAT, _device="/job:localhost/replica:0/task:0/device:GPU:0"]()]]
. Starting new session.
2025-06-23 09:56:53,997 INFO 	iter: 480, batch loss: 8.554430961608887, batch acc: 0.656250
2025-06-23 10:00:45,869 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 10:00:45,869 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 10:00:45,870 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 10:00:45,872 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 10:00:45,880 INFO Placeholders created
2025-06-23 10:00:45,881 INFO Word embeddings created
2025-06-23 10:00:45,885 INFO Message embedding layer input created
2025-06-23 10:00:46,029 INFO Message embeddings created with BiGRU
2025-06-23 10:00:46,105 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 10:00:46,359 INFO Simple Dual-Path SRL created. Shape: (?, 5, 64)
2025-06-23 10:00:46,563 INFO VMD (DRG) created
2025-06-23 10:00:46,620 INFO Temporal Attention Prediction (TAP) created
2025-06-23 10:00:46,620 INFO Building ATA module using model variant: hedge
2025-06-23 10:00:46,620 INFO Applying label smoothing with alpha=0.2
2025-06-23 10:00:46,648 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 10:00:46,649 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 10:00:46,649 INFO ATA loss module created
2025-06-23 10:00:48,655 INFO Optimizer created
2025-06-23 10:00:48,656 INFO ---------- Graph assembly completed ----------
2025-06-23 10:01:04,468 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 10:03:10,326 INFO Word table initialized.
2025-06-23 10:03:10,328 INFO Model: all-hedge-gru_a996f639, starting new session.
2025-06-23 10:12:42,972 INFO 	iter: 20, batch loss: 3.148578405380249, batch acc: 0.625000
2025-06-23 10:17:20,046 INFO 	iter: 40, batch loss: 3.312840461730957, batch acc: 0.500000
2025-06-23 10:21:26,250 INFO 	iter: 60, batch loss: 3.0864505767822266, batch acc: 0.500000
2025-06-23 10:23:07,662 INFO 	iter: 80, batch loss: 3.202380657196045, batch acc: 0.500000
2025-06-23 10:24:50,629 INFO 	iter: 100, batch loss: 2.9062905311584473, batch acc: 0.531250
2025-06-23 10:26:23,257 INFO 	iter: 120, batch loss: 2.7046492099761963, batch acc: 0.562500
2025-06-23 10:27:54,680 INFO 	iter: 140, batch loss: 2.409385919570923, batch acc: 0.656250
2025-06-23 10:29:01,726 INFO Epoch: loss: 2.924043, acc: 0.560685
2025-06-23 10:30:03,704 INFO Completed dev evaluation: size=656.0, acc=0.5107
2025-06-23 10:30:03,706 INFO 	Eval, eval loss: 2.6278467178344727, acc: 0.510671, mcc: 0.023924
2025-06-23 10:30:03,706 INFO New best dev MCC: 0.0239. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_a996f639/best_model/model
2025-06-23 10:31:29,111 INFO 	iter: 160, batch loss: 2.8280763626098633, batch acc: 0.593750
2025-06-23 10:34:01,901 INFO 	iter: 180, batch loss: 2.625974416732788, batch acc: 0.750000
2025-06-23 10:42:38,349 INFO 	iter: 200, batch loss: 2.6490440368652344, batch acc: 0.625000
2025-06-23 10:44:26,008 INFO 	iter: 220, batch loss: 2.4971530437469482, batch acc: 0.781250
2025-06-23 10:46:10,418 INFO 	iter: 240, batch loss: 2.4175262451171875, batch acc: 0.718750
2025-06-23 10:47:51,850 INFO 	iter: 260, batch loss: 2.244586706161499, batch acc: 0.812500
2025-06-23 10:49:24,522 INFO 	iter: 280, batch loss: 1.9958438873291016, batch acc: 0.656250
2025-06-23 10:50:55,028 INFO 	iter: 300, batch loss: 1.919278860092163, batch acc: 0.750000
2025-06-23 10:51:40,650 INFO Epoch: loss: 2.408583, acc: 0.689113
2025-06-23 10:52:47,615 INFO Completed dev evaluation: size=656.0, acc=0.5030
2025-06-23 10:52:47,618 INFO 	Eval, eval loss: 2.3334414958953857, acc: 0.503049, mcc: 0.010580
2025-06-23 10:52:47,618 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 10:55:04,699 INFO 	iter: 320, batch loss: 2.3348686695098877, batch acc: 0.593750
2025-06-23 10:57:34,769 INFO 	iter: 340, batch loss: 2.351205825805664, batch acc: 0.656250
2025-06-23 10:59:18,088 INFO 	iter: 360, batch loss: 2.0806944370269775, batch acc: 0.843750
2025-06-23 11:00:50,116 INFO 	iter: 380, batch loss: 2.319626569747925, batch acc: 0.718750
2025-06-23 11:02:20,548 INFO 	iter: 400, batch loss: 2.215402126312256, batch acc: 0.687500
2025-06-23 11:03:51,161 INFO 	iter: 420, batch loss: 1.9970664978027344, batch acc: 0.718750
2025-06-23 11:05:18,985 INFO 	iter: 440, batch loss: 2.012591600418091, batch acc: 0.656250
2025-06-23 11:16:56,006 INFO 	iter: 460, batch loss: 1.687337040901184, batch acc: 0.687500
2025-06-23 11:17:20,702 INFO Epoch: loss: 2.203271, acc: 0.690927
2025-06-23 11:18:28,719 INFO Completed dev evaluation: size=656.0, acc=0.4848
2025-06-23 11:18:28,723 INFO 	Eval, eval loss: 2.257425546646118, acc: 0.484756, mcc: -0.023894
2025-06-23 11:18:28,723 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-23 11:21:06,544 INFO 	iter: 480, batch loss: 2.1873514652252197, batch acc: 0.718750
2025-06-23 11:22:58,993 INFO 	iter: 500, batch loss: 2.2822492122650146, batch acc: 0.750000
2025-06-23 11:24:40,965 INFO 	iter: 520, batch loss: 2.2642624378204346, batch acc: 0.750000
2025-06-23 11:26:22,815 INFO 	iter: 540, batch loss: 2.09328293800354, batch acc: 0.625000
2025-06-23 11:28:04,611 INFO 	iter: 560, batch loss: 2.0903449058532715, batch acc: 0.687500
2025-06-23 11:29:41,722 INFO 	iter: 580, batch loss: 1.9797875881195068, batch acc: 0.687500
2025-06-23 11:31:14,625 INFO 	iter: 600, batch loss: 1.8773099184036255, batch acc: 0.781250
2025-06-23 11:32:46,182 INFO 	iter: 620, batch loss: 1.6545881032943726, batch acc: 0.468750
2025-06-23 11:32:48,823 INFO Epoch: loss: 2.115980, acc: 0.652016
2025-06-23 11:33:59,144 INFO Completed dev evaluation: size=656.0, acc=0.4695
2025-06-23 11:33:59,146 INFO 	Eval, eval loss: 2.186924934387207, acc: 0.469512, mcc: -0.055919
2025-06-23 11:33:59,146 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-23 11:33:59,146 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-23 11:33:59,146 INFO Generating diagnostic plots...
2025-06-23 11:34:02,599 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-23 11:34:02,605 INFO Best performance on development set:
2025-06-23 12:30:49,034 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 12:30:49,034 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 12:30:49,035 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 12:30:49,038 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 12:30:49,053 INFO Placeholders created
2025-06-23 12:30:49,056 INFO Word embeddings created
2025-06-23 12:30:49,062 INFO Message embedding layer input created
2025-06-23 12:30:49,315 INFO Message embeddings created with BiGRU
2025-06-23 12:30:49,439 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 12:30:49,794 INFO Simple Dual-Path SRL created. Shape: (?, 5, 64)
2025-06-23 12:30:50,118 INFO VMD (DRG) created
2025-06-23 12:30:50,210 INFO Temporal Attention Prediction (TAP) created
2025-06-23 12:30:50,211 INFO Building ATA module using model variant: hedge
2025-06-23 12:30:50,211 INFO Applying label smoothing with alpha=0.2
2025-06-23 12:30:50,260 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 12:30:50,261 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 12:30:50,261 INFO ATA loss module created
2025-06-23 12:30:53,369 INFO Optimizer created
2025-06-23 12:30:53,371 INFO ---------- Graph assembly completed ----------
2025-06-23 12:31:14,987 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 12:31:16,601 INFO Word table initialized.
2025-06-23 12:31:17,038 INFO Model: all-hedge-gru_a996f639, session restored from checkpoint.
2025-06-23 12:35:35,090 INFO 	iter: 640, batch loss: 1.1223325729370117, batch acc: 0.593750
2025-06-23 12:37:20,131 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 12:37:20,131 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 12:37:20,132 INFO Using L2 regularization with lambda: 0.0005
2025-06-23 12:37:20,135 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 12:37:20,150 INFO Placeholders created
2025-06-23 12:37:20,153 INFO Word embeddings created
2025-06-23 12:37:20,160 INFO Message embedding layer input created
2025-06-23 12:37:20,424 INFO Message embeddings created with BiGRU
2025-06-23 12:37:20,549 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 64)
2025-06-23 12:37:20,928 INFO Simple Dual-Path SRL created. Shape: (?, 5, 64)
2025-06-23 12:37:21,262 INFO VMD (DRG) created
2025-06-23 12:37:21,355 INFO Temporal Attention Prediction (TAP) created
2025-06-23 12:37:21,355 INFO Building ATA module using model variant: hedge
2025-06-23 12:37:21,355 INFO Applying label smoothing with alpha=0.2
2025-06-23 12:37:21,405 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 12:37:21,406 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 12:37:21,406 INFO ATA loss module created
2025-06-23 12:37:24,594 INFO Optimizer created
2025-06-23 12:37:24,596 INFO ---------- Graph assembly completed ----------
2025-06-23 12:37:45,863 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 12:37:47,533 INFO Word table initialized.
2025-06-23 12:37:47,534 INFO Model: all-hedge-gru_a996f639, starting new session.
2025-06-23 12:41:38,612 INFO 	iter: 20, batch loss: 1.5685487985610962, batch acc: 0.468750
2025-06-23 12:44:13,553 INFO 	iter: 40, batch loss: 1.7974153757095337, batch acc: 0.593750
2025-06-23 12:46:28,601 INFO 	iter: 60, batch loss: 1.7301576137542725, batch acc: 0.406250
2025-06-23 12:48:37,572 INFO 	iter: 80, batch loss: 1.7077888250350952, batch acc: 0.500000
2025-06-23 12:50:45,412 INFO 	iter: 100, batch loss: 1.5116918087005615, batch acc: 0.468750
2025-06-23 12:52:47,263 INFO 	iter: 120, batch loss: 1.4348775148391724, batch acc: 0.625000
2025-06-23 12:54:17,359 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 12:54:17,359 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 12:54:17,360 INFO Using L2 regularization with lambda: 0.0001
2025-06-23 12:54:17,362 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 12:54:17,375 INFO Placeholders created
2025-06-23 12:54:17,378 INFO Word embeddings created
2025-06-23 12:54:17,384 INFO Message embedding layer input created
2025-06-23 12:54:17,615 INFO Message embeddings created with BiGRU
2025-06-23 12:54:17,738 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 100)
2025-06-23 12:54:18,095 INFO Simple Dual-Path SRL created. Shape: (?, 5, 100)
2025-06-23 12:54:18,421 INFO VMD (DRG) created
2025-06-23 12:54:18,513 INFO Temporal Attention Prediction (TAP) created
2025-06-23 12:54:18,513 INFO Building ATA module using model variant: hedge
2025-06-23 12:54:18,513 INFO Applying label smoothing with alpha=0.1
2025-06-23 12:54:18,560 INFO Generative loss created - Prediction: Tensor("generative_ata/Neg:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 12:54:18,561 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 12:54:18,561 INFO ATA loss module created
2025-06-23 12:54:21,681 INFO Optimizer created
2025-06-23 12:54:21,683 INFO ---------- Graph assembly completed ----------
2025-06-23 12:54:42,456 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 12:54:43,953 INFO Word table initialized.
2025-06-23 12:54:43,954 INFO Model: all-hedge-gru_3beaf1c7, starting new session.
2025-06-23 12:54:46,404 INFO 	iter: 140, batch loss: 1.2028403282165527, batch acc: 0.531250
2025-06-23 12:56:15,927 INFO Epoch: loss: 1.497394, acc: 0.565121
2025-06-23 12:57:29,148 INFO Completed dev evaluation: size=656.0, acc=0.4985
2025-06-23 12:57:29,151 INFO 	Eval, eval loss: 1.3409513235092163, acc: 0.498476, mcc: 0.000451
2025-06-23 12:57:29,152 INFO New best dev MCC: 0.0005. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_a996f639/best_model/model
2025-06-23 12:58:43,467 INFO 	iter: 20, batch loss: 1.5956687927246094, batch acc: 0.593750
2025-06-23 12:58:59,700 INFO 	iter: 160, batch loss: 1.35888671875, batch acc: 0.718750
2025-06-23 13:01:08,788 INFO 	iter: 40, batch loss: 1.605266809463501, batch acc: 0.562500
2025-06-23 13:02:07,805 INFO 	iter: 180, batch loss: 1.359487771987915, batch acc: 0.718750
2025-06-23 13:03:22,577 INFO 	iter: 60, batch loss: 1.3844192028045654, batch acc: 0.656250
2025-06-23 13:04:33,202 INFO 	iter: 200, batch loss: 1.3430715799331665, batch acc: 0.531250
2025-06-23 13:05:31,495 INFO 	iter: 80, batch loss: 1.251198172569275, batch acc: 0.781250
2025-06-23 13:06:47,098 INFO 	iter: 220, batch loss: 1.2469942569732666, batch acc: 0.687500
2025-06-23 13:07:39,480 INFO 	iter: 100, batch loss: 1.1216261386871338, batch acc: 0.812500
2025-06-23 13:08:58,274 INFO 	iter: 240, batch loss: 1.156639814376831, batch acc: 0.718750
2025-06-23 13:09:42,210 INFO 	iter: 120, batch loss: 0.9566657543182373, batch acc: 0.906250
2025-06-23 13:11:07,586 INFO 	iter: 260, batch loss: 1.179083228111267, batch acc: 0.531250
2025-06-23 13:11:42,850 INFO 	iter: 140, batch loss: 0.8755479454994202, batch acc: 0.906250
2025-06-23 13:13:10,437 INFO 	iter: 280, batch loss: 1.0780302286148071, batch acc: 0.687500
2025-06-23 13:13:11,978 INFO Epoch: loss: 1.233863, acc: 0.746976
2025-06-23 13:14:24,595 INFO Completed dev evaluation: size=656.0, acc=0.5229
2025-06-23 13:14:24,598 INFO 	Eval, eval loss: 1.1967625617980957, acc: 0.522866, mcc: 0.052042
2025-06-23 13:14:24,599 INFO New best dev MCC: 0.0520. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_3beaf1c7/best_model/model
2025-06-23 13:15:10,616 INFO 	iter: 300, batch loss: 1.0603307485580444, batch acc: 0.812500
2025-06-23 13:16:08,154 INFO 	iter: 160, batch loss: 1.0787653923034668, batch acc: 0.812500
2025-06-23 13:16:11,353 INFO Epoch: loss: 1.229342, acc: 0.700806
2025-06-23 13:17:27,507 INFO Completed dev evaluation: size=656.0, acc=0.4802
2025-06-23 13:17:27,510 INFO 	Eval, eval loss: 1.1902925968170166, acc: 0.480183, mcc: -0.033949
2025-06-23 13:17:27,510 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 13:18:59,778 INFO 	iter: 180, batch loss: 1.1037495136260986, batch acc: 0.812500
2025-06-23 13:19:52,672 INFO 	iter: 320, batch loss: 1.2764338254928589, batch acc: 0.781250
2025-06-23 13:21:27,952 INFO 	iter: 200, batch loss: 0.9309816956520081, batch acc: 0.906250
2025-06-23 13:22:42,318 INFO 	iter: 340, batch loss: 1.2044237852096558, batch acc: 0.718750
2025-06-23 13:23:40,392 INFO 	iter: 220, batch loss: 1.001922607421875, batch acc: 0.812500
2025-06-23 13:25:05,311 INFO 	iter: 360, batch loss: 1.283270001411438, batch acc: 0.562500
2025-06-23 13:25:51,534 INFO 	iter: 240, batch loss: 0.9506236910820007, batch acc: 0.843750
2025-06-23 13:27:16,623 INFO 	iter: 380, batch loss: 1.1624897718429565, batch acc: 0.687500
2025-06-23 13:27:59,902 INFO 	iter: 260, batch loss: 0.9928112626075745, batch acc: 0.781250
2025-06-23 13:29:28,519 INFO 	iter: 400, batch loss: 1.1311297416687012, batch acc: 0.625000
2025-06-23 13:30:03,250 INFO 	iter: 280, batch loss: 1.0358319282531738, batch acc: 0.781250
2025-06-23 13:31:34,583 INFO 	iter: 420, batch loss: 1.1502352952957153, batch acc: 0.593750
2025-06-23 13:32:03,767 INFO 	iter: 300, batch loss: 0.877008855342865, batch acc: 0.718750
2025-06-23 13:33:03,944 INFO Epoch: loss: 0.959027, acc: 0.823589
2025-06-23 13:33:37,453 INFO 	iter: 440, batch loss: 0.9928534626960754, batch acc: 0.750000
2025-06-23 13:34:19,650 INFO Completed dev evaluation: size=656.0, acc=0.5152
2025-06-23 13:34:19,653 INFO 	Eval, eval loss: 1.1468024253845215, acc: 0.515244, mcc: 0.027988
2025-06-23 13:34:19,653 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 13:35:38,281 INFO 	iter: 460, batch loss: 0.9146161079406738, batch acc: 0.625000
2025-06-23 13:36:09,547 INFO Epoch: loss: 1.119023, acc: 0.700605
2025-06-23 13:36:45,865 INFO 	iter: 320, batch loss: 1.0368266105651855, batch acc: 0.687500
2025-06-23 13:37:28,525 INFO Completed dev evaluation: size=656.0, acc=0.5076
2025-06-23 13:37:28,528 INFO 	Eval, eval loss: 1.1455254554748535, acc: 0.507622, mcc: 0.027261
2025-06-23 13:37:28,528 INFO New best dev MCC: 0.0273. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_a996f639/best_model/model
2025-06-23 13:39:35,103 INFO 	iter: 340, batch loss: 1.0442012548446655, batch acc: 0.812500
2025-06-23 13:40:43,679 INFO 	iter: 480, batch loss: 1.1850324869155884, batch acc: 0.843750
2025-06-23 13:42:00,067 INFO 	iter: 360, batch loss: 0.9391142129898071, batch acc: 0.812500
2025-06-23 13:43:26,148 INFO 	iter: 500, batch loss: 1.1520119905471802, batch acc: 0.687500
2025-06-23 13:44:14,734 INFO 	iter: 380, batch loss: 0.9376693964004517, batch acc: 0.718750
2025-06-23 13:45:45,398 INFO 	iter: 520, batch loss: 1.0684046745300293, batch acc: 0.750000
2025-06-23 13:46:25,254 INFO 	iter: 400, batch loss: 0.9398972988128662, batch acc: 0.718750
2025-06-23 13:47:58,277 INFO 	iter: 540, batch loss: 1.0669761896133423, batch acc: 0.687500
2025-06-23 13:48:33,210 INFO 	iter: 420, batch loss: 0.7849499583244324, batch acc: 0.906250
2025-06-23 13:50:08,932 INFO 	iter: 560, batch loss: 1.0262322425842285, batch acc: 0.812500
2025-06-23 13:50:37,113 INFO 	iter: 440, batch loss: 0.9362593293190002, batch acc: 0.750000
2025-06-23 13:52:16,009 INFO 	iter: 580, batch loss: 1.0627199411392212, batch acc: 0.750000
2025-06-23 13:52:39,277 INFO 	iter: 460, batch loss: 0.8942905068397522, batch acc: 0.781250
2025-06-23 13:53:10,586 INFO Epoch: loss: 0.923187, acc: 0.784274
2025-06-23 13:54:19,825 INFO 	iter: 600, batch loss: 0.9601418972015381, batch acc: 0.593750
2025-06-23 13:54:29,563 INFO Completed dev evaluation: size=656.0, acc=0.4802
2025-06-23 13:54:29,565 INFO 	Eval, eval loss: 1.0934851169586182, acc: 0.480183, mcc: -0.036527
2025-06-23 13:54:29,565 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-23 13:56:21,184 INFO 	iter: 620, batch loss: 0.6689391136169434, batch acc: 0.687500
2025-06-23 13:56:22,737 INFO Epoch: loss: 1.073726, acc: 0.669960
2025-06-23 13:57:39,088 INFO 	iter: 480, batch loss: 0.9576040506362915, batch acc: 0.718750
2025-06-23 13:57:45,020 INFO Completed dev evaluation: size=656.0, acc=0.4756
2025-06-23 13:57:45,022 INFO 	Eval, eval loss: 1.1131336688995361, acc: 0.475610, mcc: -0.043989
2025-06-23 13:57:45,022 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 14:00:18,932 INFO 	iter: 500, batch loss: 0.9755873084068298, batch acc: 0.718750
2025-06-23 14:20:40,150 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 14:20:40,150 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 14:20:40,151 INFO Using L2 regularization with lambda: 0.0001
2025-06-23 14:20:40,153 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 14:20:40,169 INFO Placeholders created
2025-06-23 14:20:40,172 INFO Word embeddings created
2025-06-23 14:20:40,178 INFO Message embedding layer input created
2025-06-23 14:20:40,446 INFO Message embeddings created with BiGRU
2025-06-23 14:20:40,588 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 100)
2025-06-23 14:20:40,936 INFO Simple Dual-Path SRL created. Shape: (?, 5, 100)
2025-06-23 14:20:41,256 INFO VMD (DRG) created
2025-06-23 14:20:41,346 INFO Temporal Attention Prediction (TAP) created
2025-06-23 14:20:41,346 INFO Building ATA module using model variant: hedge
2025-06-23 14:20:41,346 INFO Applying label smoothing with alpha=0.1
2025-06-23 14:20:41,398 INFO Generative loss created - Prediction: Tensor("generative_ata/Mean:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 14:20:41,399 INFO Final loss function constructed: Tensor("final_loss_with_l2_reg:0", dtype=float32)
2025-06-23 14:20:41,399 INFO ATA loss module created
2025-06-23 14:20:44,433 INFO Optimizer created
2025-06-23 14:20:44,435 INFO ---------- Graph assembly completed ----------
2025-06-23 14:21:05,518 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 14:21:07,933 INFO Word table initialized.
2025-06-23 14:21:07,940 INFO Model: all-hedge-gru_94a2673b, starting new session.
2025-06-23 14:25:00,143 INFO 	iter: 20, batch loss: 1.7812248468399048, batch acc: 0.562500
2025-06-23 14:27:34,827 INFO 	iter: 40, batch loss: 1.6216919422149658, batch acc: 0.500000
2025-06-23 14:29:53,716 INFO 	iter: 60, batch loss: 1.3813670873641968, batch acc: 0.843750
2025-06-23 14:32:04,919 INFO 	iter: 80, batch loss: 1.219022512435913, batch acc: 0.906250
2025-06-23 14:34:12,831 INFO 	iter: 100, batch loss: 1.1481943130493164, batch acc: 0.906250
2025-06-23 14:36:16,197 INFO 	iter: 120, batch loss: 1.0979121923446655, batch acc: 0.843750
2025-06-23 14:38:18,143 INFO 	iter: 140, batch loss: 0.9910773634910583, batch acc: 0.906250
2025-06-23 14:39:48,890 INFO Epoch: loss: 1.288742, acc: 0.798790
2025-06-23 14:41:02,302 INFO Completed dev evaluation: size=656.0, acc=0.5290
2025-06-23 14:41:02,305 INFO 	Eval, eval loss: 1.396115779876709, acc: 0.528963, mcc: 0.060157
2025-06-23 14:41:02,305 INFO New best dev MCC: 0.0602. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_94a2673b/best_model/model
2025-06-23 14:42:03,117 INFO Starting a full run. Model configuration will be loaded from the JSON config file.
2025-06-23 14:42:03,117 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 14:42:03,118 INFO Using L2 regularization with lambda: 0.0001
2025-06-23 14:42:03,120 INFO ---------- Assembling graph for Model_tx_lf_dual_path ----------
2025-06-23 14:42:03,133 INFO Placeholders created
2025-06-23 14:42:03,135 INFO Word embeddings created
2025-06-23 14:42:03,141 INFO Message embedding layer input created
2025-06-23 14:42:03,369 INFO Message embeddings created with BiGRU
2025-06-23 14:42:03,491 INFO Ca-TSU corpus embeddings created. Shape: (?, 5, 100)
2025-06-23 14:42:03,853 INFO Simple Dual-Path SRL created. Shape: (?, 5, 100)
2025-06-23 14:42:04,178 INFO VMD (DRG) created
2025-06-23 14:42:04,269 INFO Temporal Attention Prediction (TAP) created
2025-06-23 14:42:04,269 INFO Building ATA module using model variant: hedge
2025-06-23 14:42:04,320 INFO Generative loss created - Prediction: Tensor("generative_ata/Mean:0", dtype=float32), Explainability: Tensor("generative_ata/Add:0", dtype=float32)
2025-06-23 14:42:04,320 INFO Final loss function constructed: Tensor("generative_ata/add_8:0", dtype=float32)
2025-06-23 14:42:04,320 INFO ATA loss module created
2025-06-23 14:42:07,383 INFO Optimizer created
2025-06-23 14:42:07,384 INFO ---------- Graph assembly completed ----------
2025-06-23 14:42:29,073 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 14:42:30,383 INFO Word table initialized.
2025-06-23 14:42:30,383 INFO Model: all-hedge-gru_477fcf32, starting new session.
2025-06-23 14:42:39,724 INFO 	iter: 160, batch loss: 1.145813226699829, batch acc: 0.906250
2025-06-23 14:45:40,665 INFO 	iter: 180, batch loss: 1.0767847299575806, batch acc: 0.906250
2025-06-23 14:46:25,697 INFO 	iter: 20, batch loss: 1.6491308212280273, batch acc: 0.562500
2025-06-23 14:48:10,378 INFO 	iter: 200, batch loss: 0.9956658482551575, batch acc: 0.906250
2025-06-23 14:48:51,066 INFO 	iter: 40, batch loss: 1.4969136714935303, batch acc: 0.750000
2025-06-23 14:50:26,113 INFO 	iter: 220, batch loss: 1.1118786334991455, batch acc: 0.843750
2025-06-23 14:51:02,694 INFO 	iter: 60, batch loss: 1.3535864353179932, batch acc: 0.781250
2025-06-23 14:52:38,439 INFO 	iter: 240, batch loss: 1.0768502950668335, batch acc: 0.906250
2025-06-23 14:53:08,998 INFO 	iter: 80, batch loss: 1.2207454442977905, batch acc: 0.937500
2025-06-23 14:54:48,052 INFO 	iter: 260, batch loss: 1.0867818593978882, batch acc: 0.843750
2025-06-23 14:55:12,488 INFO 	iter: 100, batch loss: 1.0920641422271729, batch acc: 0.906250
2025-06-23 14:56:52,081 INFO 	iter: 280, batch loss: 1.0657825469970703, batch acc: 0.812500
2025-06-23 14:57:12,456 INFO 	iter: 120, batch loss: 1.0739960670471191, batch acc: 0.875000
2025-06-23 14:58:54,295 INFO 	iter: 300, batch loss: 0.8932371139526367, batch acc: 0.875000
2025-06-23 14:59:09,447 INFO 	iter: 140, batch loss: 0.9181894063949585, batch acc: 0.937500
2025-06-23 14:59:55,524 INFO Epoch: loss: 1.091320, acc: 0.866129
2025-06-23 15:00:36,433 INFO Epoch: loss: 1.257556, acc: 0.796774
2025-06-23 15:01:12,723 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-23 15:01:12,725 INFO 	Eval, eval loss: 1.3192423582077026, acc: 0.489329, mcc: -0.020110
2025-06-23 15:01:12,725 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 15:01:47,261 INFO Completed dev evaluation: size=656.0, acc=0.5457
2025-06-23 15:01:47,263 INFO 	Eval, eval loss: 1.3303512334823608, acc: 0.545732, mcc: 0.095400
2025-06-23 15:01:47,263 INFO New best dev MCC: 0.0954. Saving best model to /media02/tvquy/PEN/checkpoints_tx_lf_dual_path/all-hedge-gru_477fcf32/best_model/model
2025-06-23 15:03:24,149 INFO 	iter: 160, batch loss: 1.246065616607666, batch acc: 0.875000
2025-06-23 15:03:44,369 INFO 	iter: 320, batch loss: 1.2811634540557861, batch acc: 0.843750
2025-06-23 15:06:19,126 INFO 	iter: 180, batch loss: 1.043290138244629, batch acc: 0.875000
2025-06-23 15:06:34,116 INFO 	iter: 340, batch loss: 1.1400667428970337, batch acc: 0.843750
2025-06-23 15:08:42,639 INFO 	iter: 200, batch loss: 1.136489748954773, batch acc: 0.906250
2025-06-23 15:08:57,828 INFO 	iter: 360, batch loss: 1.1127190589904785, batch acc: 0.906250
2025-06-23 15:10:53,716 INFO 	iter: 220, batch loss: 1.1221134662628174, batch acc: 0.781250
2025-06-23 15:11:14,773 INFO 	iter: 380, batch loss: 1.1671594381332397, batch acc: 0.906250
2025-06-23 15:13:04,837 INFO 	iter: 240, batch loss: 1.128258466720581, batch acc: 0.843750
2025-06-23 15:13:28,232 INFO 	iter: 400, batch loss: 1.107115387916565, batch acc: 0.812500
2025-06-23 15:15:10,149 INFO 	iter: 260, batch loss: 0.9783852100372314, batch acc: 0.937500
2025-06-23 15:15:37,982 INFO 	iter: 420, batch loss: 0.9797748923301697, batch acc: 0.875000
2025-06-23 15:17:09,754 INFO 	iter: 280, batch loss: 0.9624931812286377, batch acc: 0.906250
2025-06-23 15:17:43,628 INFO 	iter: 440, batch loss: 0.9001674056053162, batch acc: 0.812500
2025-06-23 15:19:08,298 INFO 	iter: 300, batch loss: 0.9082184433937073, batch acc: 0.906250
2025-06-23 15:19:47,268 INFO 	iter: 460, batch loss: 0.9303797483444214, batch acc: 0.843750
2025-06-23 15:20:07,622 INFO Epoch: loss: 1.063147, acc: 0.874395
2025-06-23 15:20:19,255 INFO Epoch: loss: 1.086881, acc: 0.843145
2025-06-23 15:21:22,335 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 15:21:22,337 INFO 	Eval, eval loss: 1.3248796463012695, acc: 0.512195, mcc: 0.026577
2025-06-23 15:21:22,337 INFO Dev MCC did not improve. Current patience: 1/3
2025-06-23 15:21:38,002 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-23 15:21:38,004 INFO 	Eval, eval loss: 1.401248812675476, acc: 0.489329, mcc: -0.017240
2025-06-23 15:21:38,004 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-23 15:23:47,958 INFO 	iter: 320, batch loss: 1.0652334690093994, batch acc: 0.906250
2025-06-23 15:24:57,643 INFO 	iter: 480, batch loss: 1.1780171394348145, batch acc: 0.750000
2025-06-23 15:26:38,004 INFO 	iter: 340, batch loss: 1.0608878135681152, batch acc: 0.875000
2025-06-23 15:27:36,212 INFO 	iter: 500, batch loss: 1.0390855073928833, batch acc: 0.875000
2025-06-23 15:29:00,359 INFO 	iter: 360, batch loss: 1.1999046802520752, batch acc: 0.812500
2025-06-23 15:30:00,242 INFO 	iter: 520, batch loss: 1.020057201385498, batch acc: 0.968750
2025-06-23 15:31:09,558 INFO 	iter: 380, batch loss: 1.2733204364776611, batch acc: 0.750000
2025-06-23 15:32:15,756 INFO 	iter: 540, batch loss: 1.210991621017456, batch acc: 0.812500
2025-06-23 15:33:17,376 INFO 	iter: 400, batch loss: 1.2618839740753174, batch acc: 0.843750
2025-06-23 15:34:30,410 INFO 	iter: 560, batch loss: 1.1324272155761719, batch acc: 0.812500
2025-06-23 15:35:20,987 INFO 	iter: 420, batch loss: 1.0911171436309814, batch acc: 0.812500
2025-06-23 15:36:40,366 INFO 	iter: 580, batch loss: 1.0282152891159058, batch acc: 0.843750
2025-06-23 15:37:21,358 INFO 	iter: 440, batch loss: 1.0485907793045044, batch acc: 0.812500
2025-06-23 15:38:46,520 INFO 	iter: 600, batch loss: 1.0488269329071045, batch acc: 0.687500
2025-06-23 15:39:20,521 INFO 	iter: 460, batch loss: 0.9614695310592651, batch acc: 0.875000
2025-06-23 15:39:50,705 INFO Epoch: loss: 1.073962, acc: 0.843548
2025-06-23 15:40:51,757 INFO 	iter: 620, batch loss: 0.8036622405052185, batch acc: 0.812500
2025-06-23 15:40:53,165 INFO Epoch: loss: 1.115353, acc: 0.797782
2025-06-23 15:41:08,814 INFO Completed dev evaluation: size=656.0, acc=0.4909
2025-06-23 15:41:08,816 INFO 	Eval, eval loss: 1.3404123783111572, acc: 0.490854, mcc: -0.011270
2025-06-23 15:41:08,817 INFO Dev MCC did not improve. Current patience: 2/3
2025-06-23 15:42:15,340 INFO Completed dev evaluation: size=656.0, acc=0.4924
2025-06-23 15:42:15,342 INFO 	Eval, eval loss: 1.4046622514724731, acc: 0.492378, mcc: -0.004066
2025-06-23 15:42:15,342 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-23 15:42:15,342 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-23 15:42:15,342 INFO Generating diagnostic plots...
2025-06-23 15:42:19,851 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-23 15:42:19,852 INFO Best performance on development set:
2025-06-23 15:44:19,400 INFO 	iter: 480, batch loss: 1.1884162425994873, batch acc: 0.812500
2025-06-23 15:47:05,217 INFO 	iter: 500, batch loss: 1.1636438369750977, batch acc: 0.718750
2025-06-23 15:49:24,868 INFO 	iter: 520, batch loss: 1.1571433544158936, batch acc: 0.781250
2025-06-23 15:51:37,234 INFO 	iter: 540, batch loss: 1.1847736835479736, batch acc: 0.750000
2025-06-23 15:53:45,871 INFO 	iter: 560, batch loss: 1.2120945453643799, batch acc: 0.812500
2025-06-23 15:55:51,851 INFO 	iter: 580, batch loss: 1.0182194709777832, batch acc: 0.875000
2025-06-23 15:57:54,775 INFO 	iter: 600, batch loss: 1.048311710357666, batch acc: 0.781250
2025-06-23 15:59:54,764 INFO 	iter: 620, batch loss: 0.871487021446228, batch acc: 0.593750
2025-06-23 15:59:56,267 INFO Epoch: loss: 1.112212, acc: 0.791532
2025-06-23 16:01:15,942 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 16:01:15,944 INFO 	Eval, eval loss: 1.3253172636032104, acc: 0.512195, mcc: 0.035063
2025-06-23 16:01:15,944 INFO Dev MCC did not improve. Current patience: 3/3
2025-06-23 16:01:15,944 INFO Early stopping triggered after 3 epochs with no improvement.
2025-06-23 16:01:15,944 INFO Generating diagnostic plots...
2025-06-23 16:01:20,375 INFO Diagnostic plots saved to results/model_test/component_plots
2025-06-23 16:01:20,375 INFO Best performance on development set:
2025-06-23 16:40:43,598 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 16:40:43,603 INFO Start graph assembling...
2025-06-23 16:52:17,892 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 16:52:17,896 INFO Start graph assembling...
2025-06-23 16:54:53,238 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 16:54:53,240 INFO Start graph assembling...
2025-06-23 16:58:25,008 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 16:58:25,011 INFO Start graph assembling...
2025-06-23 17:01:12,294 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 17:01:12,296 INFO Start graph assembling...
2025-06-23 17:14:35,429 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 17:14:35,432 INFO Start graph assembling...
2025-06-23 17:54:01,147 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 17:54:01,152 INFO Start graph assembling...
2025-06-23 17:54:28,281 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 17:54:30,489 INFO Word table init: done!
2025-06-23 17:54:31,630 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, session restored!
2025-06-23 17:54:31,630 INFO Epoch: 1/10 start
2025-06-23 18:28:54,268 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 18:28:54,272 INFO Start graph assembling...
2025-06-23 18:29:21,199 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 18:29:23,410 INFO Word table init: done!
2025-06-23 18:29:23,411 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-23 18:29:23,411 INFO Epoch: 1/10 start
2025-06-23 18:58:33,837 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 18:58:33,840 INFO Start graph assembling...
2025-06-23 19:03:36,471 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 19:03:36,474 INFO Start graph assembling...
2025-06-23 19:04:02,745 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 19:04:04,594 INFO Word table init: done!
2025-06-23 19:04:04,594 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-23 19:04:04,594 INFO Epoch: 1/10 start
2025-06-23 19:21:17,525 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 19:21:17,528 INFO Start graph assembling...
2025-06-23 19:23:58,066 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 19:23:58,069 INFO Start graph assembling...
2025-06-23 19:33:28,064 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 19:33:28,067 INFO Start graph assembling...
2025-06-23 19:41:24,923 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-23 19:41:24,927 INFO Start graph assembling...
2025-06-23 19:41:53,237 INFO ASSEMBLE: word table #replacement: 19482
2025-06-23 19:41:55,382 INFO Word table init: done!
2025-06-23 19:41:55,383 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-23 19:41:55,383 INFO Epoch: 1/10 start
2025-06-23 19:47:17,991 INFO 	iter: 20, batch loss: 7.271849155426025, batch acc: 0.531250
2025-06-23 19:47:17,992 INFO --- Epoch 1, Batch 20 ---
2025-06-23 19:47:17,992 INFO Total Loss: 7.271849155426025
2025-06-23 19:47:17,992 INFO Causal Consistency Loss: -0.009103527292609215
2025-06-23 19:47:17,992 INFO Accuracy: 0.5312
2025-06-23 19:47:17,992 INFO MCC: 0.0164
2025-06-23 19:47:17,992 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9865523 0.05      0.05      0.05      0.05     ]
2025-06-23 19:47:17,992 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.0600379  0.04947169 0.04947169 0.04947169 0.04947169]
2025-06-23 19:49:08,044 INFO Completed dev evaluation: size=656.0, acc=0.5015
2025-06-23 19:49:08,048 INFO 	Eval, eval loss: 7.1992645263671875, acc: 0.501524, mcc: 0.018226
2025-06-23 19:52:59,575 INFO 	iter: 40, batch loss: 6.314579486846924, batch acc: 0.625000
2025-06-23 19:52:59,575 INFO --- Epoch 1, Batch 40 ---
2025-06-23 19:52:59,576 INFO Total Loss: 6.314579486846924
2025-06-23 19:52:59,576 INFO Causal Consistency Loss: -0.030879363417625427
2025-06-23 19:52:59,576 INFO Accuracy: 0.6250
2025-06-23 19:52:59,576 INFO MCC: 0.2431
2025-06-23 19:52:59,576 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.4340616 0.5767545 0.05      0.05      0.05     ]
2025-06-23 19:52:59,576 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.07660263 0.07814309 0.04695857 0.04695857 0.04695857]
2025-06-23 19:54:50,845 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-23 19:54:50,848 INFO 	Eval, eval loss: 5.924112319946289, acc: 0.504573, mcc: 0.043215
2025-06-23 19:58:29,914 INFO 	iter: 60, batch loss: 4.164187431335449, batch acc: 0.625000
2025-06-23 19:58:29,915 INFO --- Epoch 1, Batch 60 ---
2025-06-23 19:58:29,915 INFO Total Loss: 4.164187431335449
2025-06-23 19:58:29,915 INFO Causal Consistency Loss: -0.05640249326825142
2025-06-23 19:58:29,915 INFO Accuracy: 0.6250
2025-06-23 19:58:29,915 INFO MCC: 0.2549
2025-06-23 19:58:29,915 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.5052749  0.2990799  0.29495174 0.25735232 0.27409837]
2025-06-23 19:58:29,916 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.14745556 0.1159687  0.09987868 0.13046294 0.06450654]
2025-06-23 20:00:22,189 INFO Completed dev evaluation: size=656.0, acc=0.4954
2025-06-23 20:00:22,194 INFO 	Eval, eval loss: 3.8707852363586426, acc: 0.495427, mcc: -0.004255
2025-06-23 20:03:57,410 INFO 	iter: 80, batch loss: 1.5351606607437134, batch acc: 0.437500
2025-06-23 20:03:57,411 INFO --- Epoch 1, Batch 80 ---
2025-06-23 20:03:57,411 INFO Total Loss: 1.5351606607437134
2025-06-23 20:03:57,411 INFO Causal Consistency Loss: -0.06166761741042137
2025-06-23 20:03:57,411 INFO Accuracy: 0.4375
2025-06-23 20:03:57,411 INFO MCC: -0.2182
2025-06-23 20:03:57,411 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.8094793  0.64652604 0.05       0.05       0.05      ]
2025-06-23 20:03:57,412 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.39375442 0.37538412 0.01282564 0.01282564 0.01282564]
2025-06-23 20:05:49,421 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 20:05:49,423 INFO 	Eval, eval loss: 1.3708312511444092, acc: 0.487805, mcc: None
2025-06-23 20:09:23,538 INFO 	iter: 100, batch loss: 1.016864538192749, batch acc: 0.593750
2025-06-23 20:09:23,539 INFO --- Epoch 1, Batch 100 ---
2025-06-23 20:09:23,539 INFO Total Loss: 1.016864538192749
2025-06-23 20:09:23,539 INFO Causal Consistency Loss: -0.06979083269834518
2025-06-23 20:09:23,539 INFO Accuracy: 0.5938
2025-06-23 20:09:23,539 INFO MCC: 0.2085
2025-06-23 20:09:23,540 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.16692008 0.23482192 0.15649281 0.96298724 0.21336201]
2025-06-23 20:09:23,540 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.13533466 0.13560665 0.12775503 0.11480863 0.14158702]
2025-06-23 20:11:17,478 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 20:11:17,481 INFO 	Eval, eval loss: 1.0242893695831299, acc: 0.487805, mcc: None
2025-06-23 20:14:43,572 INFO 	iter: 120, batch loss: 0.9864619970321655, batch acc: 0.625000
2025-06-23 20:14:43,573 INFO --- Epoch 1, Batch 120 ---
2025-06-23 20:14:43,573 INFO Total Loss: 0.9864619970321655
2025-06-23 20:14:43,573 INFO Causal Consistency Loss: -0.0756358802318573
2025-06-23 20:14:43,573 INFO Accuracy: 0.6250
2025-06-23 20:14:43,573 INFO MCC: 0.1741
2025-06-23 20:14:43,574 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 20:14:43,574 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.3190683  0.37141982 0.0171951  0.0171951  0.0171951 ]
2025-06-23 20:16:39,350 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-23 20:16:39,353 INFO 	Eval, eval loss: 1.0057555437088013, acc: 0.489329, mcc: 0.038132
2025-06-23 20:20:05,855 INFO 	iter: 140, batch loss: 0.9915117621421814, batch acc: 0.468750
2025-06-23 20:20:05,856 INFO --- Epoch 1, Batch 140 ---
2025-06-23 20:20:05,856 INFO Total Loss: 0.9915117621421814
2025-06-23 20:20:05,856 INFO Causal Consistency Loss: -0.09997173398733139
2025-06-23 20:20:05,856 INFO Accuracy: 0.4688
2025-06-23 20:20:05,856 INFO MCC: 0.0170
2025-06-23 20:20:05,857 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.14708832 0.28657222 0.16643834 0.8569434  0.23067549]
2025-06-23 20:20:05,857 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.04938443 0.05391067 0.04625512 0.05234175 0.0544057 ]
2025-06-23 20:22:03,029 INFO Completed dev evaluation: size=656.0, acc=0.5061
2025-06-23 20:22:03,032 INFO 	Eval, eval loss: 0.988435685634613, acc: 0.506098, mcc: -0.006363
2025-06-23 20:24:37,492 INFO Epoch: loss: 3.156606, acc: 0.524798
2025-06-23 20:24:37,493 INFO Epoch: 2/10 start
2025-06-23 20:26:35,581 INFO 	iter: 160, batch loss: 1.002302646636963, batch acc: 0.593750
2025-06-23 20:26:35,582 INFO --- Epoch 2, Batch 160 ---
2025-06-23 20:26:35,582 INFO Total Loss: 1.002302646636963
2025-06-23 20:26:35,582 INFO Causal Consistency Loss: -0.0662926584482193
2025-06-23 20:26:35,582 INFO Accuracy: 0.5938
2025-06-23 20:26:35,582 INFO MCC: 0.0380
2025-06-23 20:26:35,582 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.5984121  0.99995756 0.5677817  0.05       0.05      ]
2025-06-23 20:26:35,583 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.2162997  0.29837632 0.2104712  0.01616781 0.01616781]
2025-06-23 20:28:37,256 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 20:28:37,259 INFO 	Eval, eval loss: 0.9901820421218872, acc: 0.512195, mcc: None
2025-06-23 20:33:06,241 INFO 	iter: 180, batch loss: 0.9452600479125977, batch acc: 0.625000
2025-06-23 20:33:06,242 INFO --- Epoch 2, Batch 180 ---
2025-06-23 20:33:06,242 INFO Total Loss: 0.9452600479125977
2025-06-23 20:33:06,242 INFO Causal Consistency Loss: -0.07660630345344543
2025-06-23 20:33:06,242 INFO Accuracy: 0.6250
2025-06-23 20:33:06,242 INFO MCC: 0.2887
2025-06-23 20:33:06,242 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 20:33:06,242 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.54074335 0.0241714  0.0241714  0.0241714  0.0241714 ]
2025-06-23 20:35:06,318 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 20:35:06,321 INFO 	Eval, eval loss: 0.9760609865188599, acc: 0.487805, mcc: -0.006217
2025-06-23 20:39:02,188 INFO 	iter: 200, batch loss: 0.9957008361816406, batch acc: 0.375000
2025-06-23 20:39:02,188 INFO --- Epoch 2, Batch 200 ---
2025-06-23 20:39:02,188 INFO Total Loss: 0.9957008361816406
2025-06-23 20:39:02,189 INFO Causal Consistency Loss: -0.0878976508975029
2025-06-23 20:39:02,189 INFO Accuracy: 0.3750
2025-06-23 20:39:02,189 INFO MCC: -0.2431
2025-06-23 20:39:02,189 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 20:39:02,189 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.3547204  0.36091423 0.01579807 0.01579807 0.01579807]
2025-06-23 20:41:03,965 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 20:41:03,967 INFO 	Eval, eval loss: 0.9746658205986023, acc: 0.512195, mcc: None
2025-06-23 20:44:47,629 INFO 	iter: 220, batch loss: 0.9612139463424683, batch acc: 0.500000
2025-06-23 20:44:47,630 INFO --- Epoch 2, Batch 220 ---
2025-06-23 20:44:47,630 INFO Total Loss: 0.9612139463424683
2025-06-23 20:44:47,630 INFO Causal Consistency Loss: -0.0867389366030693
2025-06-23 20:44:47,630 INFO Accuracy: 0.5000
2025-06-23 20:44:47,630 INFO MCC: 0.0120
2025-06-23 20:44:47,631 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.         0.9948761  1.         0.81781083 0.7628204 ]
2025-06-23 20:44:47,631 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.15258451 0.13317871 0.16540383 0.16267103 0.16142593]
2025-06-23 20:46:50,747 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 20:46:50,749 INFO 	Eval, eval loss: 0.9649971127510071, acc: 0.512195, mcc: None
2025-06-23 20:50:31,863 INFO 	iter: 240, batch loss: 1.0074912309646606, batch acc: 0.406250
2025-06-23 20:50:31,863 INFO --- Epoch 2, Batch 240 ---
2025-06-23 20:50:31,863 INFO Total Loss: 1.0074912309646606
2025-06-23 20:50:31,864 INFO Causal Consistency Loss: -0.08621727675199509
2025-06-23 20:50:31,864 INFO Accuracy: 0.4062
2025-06-23 20:50:31,864 INFO MCC: 0.0000
2025-06-23 20:50:31,864 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 20:50:31,864 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.46296975 0.02826475 0.02826475 0.02826475 0.02826475]
2025-06-23 20:52:36,269 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 20:52:36,272 INFO 	Eval, eval loss: 0.9837586283683777, acc: 0.487805, mcc: None
2025-06-23 20:56:16,143 INFO 	iter: 260, batch loss: 0.9578685164451599, batch acc: 0.375000
2025-06-23 20:56:16,144 INFO --- Epoch 2, Batch 260 ---
2025-06-23 20:56:16,144 INFO Total Loss: 0.9578685164451599
2025-06-23 20:56:16,144 INFO Causal Consistency Loss: -0.10191067308187485
2025-06-23 20:56:16,144 INFO Accuracy: 0.3750
2025-06-23 20:56:16,144 INFO MCC: -0.1698
2025-06-23 20:56:16,144 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.7967693  0.7827954  0.9482358  0.75478727 0.566262  ]
2025-06-23 20:56:16,144 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.08600338 0.10975134 0.11335169 0.10648305 0.09868729]
2025-06-23 20:58:25,929 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 20:58:25,930 INFO 	Eval, eval loss: 0.9819676280021667, acc: 0.512195, mcc: None
2025-06-23 21:02:02,246 INFO 	iter: 280, batch loss: 0.9565982818603516, batch acc: 0.500000
2025-06-23 21:02:02,247 INFO --- Epoch 2, Batch 280 ---
2025-06-23 21:02:02,248 INFO Total Loss: 0.9565982818603516
2025-06-23 21:02:02,248 INFO Causal Consistency Loss: -0.1127394437789917
2025-06-23 21:02:02,248 INFO Accuracy: 0.5000
2025-06-23 21:02:02,248 INFO MCC: 0.0000
2025-06-23 21:02:02,248 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 21:02:02,248 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.33953747 0.33397087 0.01813843 0.01813843 0.01813843]
2025-06-23 21:04:09,437 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-23 21:04:09,440 INFO 	Eval, eval loss: 0.975396454334259, acc: 0.489329, mcc: 0.038132
2025-06-23 21:07:43,555 INFO 	iter: 300, batch loss: 0.9385471940040588, batch acc: 0.531250
2025-06-23 21:07:43,556 INFO --- Epoch 2, Batch 300 ---
2025-06-23 21:07:43,556 INFO Total Loss: 0.9385471940040588
2025-06-23 21:07:43,556 INFO Causal Consistency Loss: -0.12424138933420181
2025-06-23 21:07:43,556 INFO Accuracy: 0.5312
2025-06-23 21:07:43,556 INFO MCC: 0.2837
2025-06-23 21:07:43,556 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   1.   1.   0.05]
2025-06-23 21:07:43,556 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.21498871 0.21295024 0.18541232 0.22270018 0.01024678]
2025-06-23 21:09:52,104 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:09:52,106 INFO 	Eval, eval loss: 0.9872219562530518, acc: 0.487805, mcc: None
2025-06-23 21:11:39,845 INFO Epoch: loss: 0.967073, acc: 0.504839
2025-06-23 21:11:39,846 INFO Epoch: 3/10 start
2025-06-23 21:14:52,373 INFO 	iter: 320, batch loss: 1.016872525215149, batch acc: 0.468750
2025-06-23 21:14:52,374 INFO --- Epoch 3, Batch 320 ---
2025-06-23 21:14:52,374 INFO Total Loss: 1.016872525215149
2025-06-23 21:14:52,374 INFO Causal Consistency Loss: -0.0757678896188736
2025-06-23 21:14:52,374 INFO Accuracy: 0.4688
2025-06-23 21:14:52,374 INFO MCC: -0.1072
2025-06-23 21:14:52,374 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9978783  1.         0.9999696  1.         0.99977773]
2025-06-23 21:14:52,375 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.11801268 0.11309984 0.15203491 0.03124992 0.1279616 ]
2025-06-23 21:17:02,554 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:17:02,556 INFO 	Eval, eval loss: 0.970708429813385, acc: 0.487805, mcc: None
2025-06-23 21:21:26,296 INFO 	iter: 340, batch loss: 0.9561282396316528, batch acc: 0.593750
2025-06-23 21:21:26,297 INFO --- Epoch 3, Batch 340 ---
2025-06-23 21:21:26,297 INFO Total Loss: 0.9561282396316528
2025-06-23 21:21:26,297 INFO Causal Consistency Loss: -0.0896383598446846
2025-06-23 21:21:26,297 INFO Accuracy: 0.5938
2025-06-23 21:21:26,297 INFO MCC: 0.2037
2025-06-23 21:21:26,297 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9174755 0.943144  1.        0.9999999 0.9001246]
2025-06-23 21:21:26,298 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.10803834 0.11188189 0.1140637  0.06754859 0.11341773]
2025-06-23 21:23:38,052 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:23:38,055 INFO 	Eval, eval loss: 0.981512188911438, acc: 0.487805, mcc: None
2025-06-23 21:27:41,620 INFO 	iter: 360, batch loss: 0.9707807302474976, batch acc: 0.468750
2025-06-23 21:27:41,620 INFO --- Epoch 3, Batch 360 ---
2025-06-23 21:27:41,621 INFO Total Loss: 0.9707807302474976
2025-06-23 21:27:41,621 INFO Causal Consistency Loss: -0.09318887442350388
2025-06-23 21:27:41,621 INFO Accuracy: 0.4688
2025-06-23 21:27:41,621 INFO MCC: 0.0000
2025-06-23 21:27:41,621 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99999964 1.         0.4466064  0.99999976 0.972763  ]
2025-06-23 21:27:41,621 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17363587 0.1868224  0.08667438 0.18868737 0.1230436 ]
2025-06-23 21:29:59,072 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 21:29:59,075 INFO 	Eval, eval loss: 0.963925838470459, acc: 0.512195, mcc: None
2025-06-23 21:33:52,392 INFO 	iter: 380, batch loss: 0.9343044757843018, batch acc: 0.500000
2025-06-23 21:33:52,393 INFO --- Epoch 3, Batch 380 ---
2025-06-23 21:33:52,393 INFO Total Loss: 0.9343044757843018
2025-06-23 21:33:52,393 INFO Causal Consistency Loss: -0.11064542829990387
2025-06-23 21:33:52,393 INFO Accuracy: 0.5000
2025-06-23 21:33:52,393 INFO MCC: 0.0000
2025-06-23 21:33:52,394 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99998987 1.         1.         0.99995756 0.05      ]
2025-06-23 21:33:52,394 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.22225632 0.19006388 0.22160418 0.20041607 0.01035372]
2025-06-23 21:36:06,358 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:36:06,361 INFO 	Eval, eval loss: 0.9700002074241638, acc: 0.487805, mcc: None
2025-06-23 21:39:52,820 INFO 	iter: 400, batch loss: 0.9650879502296448, batch acc: 0.375000
2025-06-23 21:39:52,821 INFO --- Epoch 3, Batch 400 ---
2025-06-23 21:39:52,821 INFO Total Loss: 0.9650879502296448
2025-06-23 21:39:52,821 INFO Causal Consistency Loss: -0.09591810405254364
2025-06-23 21:39:52,821 INFO Accuracy: 0.3750
2025-06-23 21:39:52,821 INFO MCC: -0.2697
2025-06-23 21:39:52,822 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 21:39:52,822 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.35577098 0.34124717 0.01683232 0.01683232 0.01683232]
2025-06-23 21:42:08,557 INFO Completed dev evaluation: size=656.0, acc=0.5137
2025-06-23 21:42:08,560 INFO 	Eval, eval loss: 0.9671905040740967, acc: 0.513720, mcc: 0.040038
2025-06-23 21:45:54,666 INFO 	iter: 420, batch loss: 0.9453045129776001, batch acc: 0.468750
2025-06-23 21:45:54,666 INFO --- Epoch 3, Batch 420 ---
2025-06-23 21:45:54,667 INFO Total Loss: 0.9453045129776001
2025-06-23 21:45:54,667 INFO Causal Consistency Loss: -0.113129161298275
2025-06-23 21:45:54,667 INFO Accuracy: 0.4688
2025-06-23 21:45:54,667 INFO MCC: 0.0000
2025-06-23 21:45:54,667 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 21:45:54,668 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5146803  0.02554314 0.02554314 0.02554314 0.02554314]
2025-06-23 21:48:11,842 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:48:11,844 INFO 	Eval, eval loss: 0.980135440826416, acc: 0.487805, mcc: None
2025-06-23 21:51:54,395 INFO 	iter: 440, batch loss: 0.9236802458763123, batch acc: 0.468750
2025-06-23 21:51:54,395 INFO --- Epoch 3, Batch 440 ---
2025-06-23 21:51:54,396 INFO Total Loss: 0.9236802458763123
2025-06-23 21:51:54,396 INFO Causal Consistency Loss: -0.1295192688703537
2025-06-23 21:51:54,396 INFO Accuracy: 0.4688
2025-06-23 21:51:54,396 INFO MCC: -0.2425
2025-06-23 21:51:54,396 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 21:51:54,396 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5200274  0.02526172 0.02526172 0.02526172 0.02526172]
2025-06-23 21:54:13,085 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 21:54:13,086 INFO 	Eval, eval loss: 0.9635639190673828, acc: 0.487805, mcc: None
2025-06-23 21:57:54,296 INFO 	iter: 460, batch loss: 0.900823175907135, batch acc: 0.562500
2025-06-23 21:57:54,297 INFO --- Epoch 3, Batch 460 ---
2025-06-23 21:57:54,297 INFO Total Loss: 0.900823175907135
2025-06-23 21:57:54,297 INFO Causal Consistency Loss: -0.15569739043712616
2025-06-23 21:57:54,297 INFO Accuracy: 0.5625
2025-06-23 21:57:54,297 INFO MCC: 0.2182
2025-06-23 21:57:54,298 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 21:57:54,298 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5169461  0.02542389 0.02542389 0.02542389 0.02542389]
2025-06-23 22:00:16,982 INFO Completed dev evaluation: size=656.0, acc=0.5046
2025-06-23 22:00:16,985 INFO 	Eval, eval loss: 0.9738131761550903, acc: 0.504573, mcc: -0.029267
2025-06-23 22:01:14,242 INFO Epoch: loss: 0.950600, acc: 0.505444
2025-06-23 22:01:14,242 INFO Epoch: 4/10 start
2025-06-23 22:05:42,613 INFO 	iter: 480, batch loss: 0.9693710207939148, batch acc: 0.500000
2025-06-23 22:05:42,614 INFO --- Epoch 4, Batch 480 ---
2025-06-23 22:05:42,614 INFO Total Loss: 0.9693710207939148
2025-06-23 22:05:42,614 INFO Causal Consistency Loss: -0.08044441789388657
2025-06-23 22:05:42,614 INFO Accuracy: 0.5000
2025-06-23 22:05:42,614 INFO MCC: 0.0000
2025-06-23 22:05:42,615 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9400055  0.98305607 0.05       0.05       0.05      ]
2025-06-23 22:05:42,615 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.35541865 0.33179137 0.01737722 0.01737722 0.01737722]
2025-06-23 22:08:04,201 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-23 22:08:04,205 INFO 	Eval, eval loss: 0.9625895619392395, acc: 0.489329, mcc: 0.038132
2025-06-23 22:12:29,926 INFO 	iter: 500, batch loss: 0.9737836718559265, batch acc: 0.437500
2025-06-23 22:12:29,926 INFO --- Epoch 4, Batch 500 ---
2025-06-23 22:12:29,927 INFO Total Loss: 0.9737836718559265
2025-06-23 22:12:29,927 INFO Causal Consistency Loss: -0.07747820764780045
2025-06-23 22:12:29,927 INFO Accuracy: 0.4375
2025-06-23 22:12:29,927 INFO MCC: 0.1486
2025-06-23 22:12:29,927 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 22:12:29,927 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.33413354 0.35740888 0.01713653 0.01713653 0.01713653]
2025-06-23 22:14:53,549 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 22:14:53,551 INFO 	Eval, eval loss: 0.9735766649246216, acc: 0.487805, mcc: None
2025-06-23 22:18:58,767 INFO 	iter: 520, batch loss: 0.9992923140525818, batch acc: 0.437500
2025-06-23 22:18:58,768 INFO --- Epoch 4, Batch 520 ---
2025-06-23 22:18:58,768 INFO Total Loss: 0.9992923140525818
2025-06-23 22:18:58,768 INFO Causal Consistency Loss: -0.09428924322128296
2025-06-23 22:18:58,768 INFO Accuracy: 0.4375
2025-06-23 22:18:58,768 INFO MCC: 0.0000
2025-06-23 22:18:58,768 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99749666 0.99999785 0.9999974  0.9815243  1.        ]
2025-06-23 22:18:58,768 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17738022 0.18135391 0.16554908 0.17934157 0.16465719]
2025-06-23 22:21:24,030 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 22:21:24,031 INFO 	Eval, eval loss: 0.9689736366271973, acc: 0.512195, mcc: None
2025-06-23 22:25:25,465 INFO 	iter: 540, batch loss: 0.9530688524246216, batch acc: 0.593750
2025-06-23 22:25:25,466 INFO --- Epoch 4, Batch 540 ---
2025-06-23 22:25:25,466 INFO Total Loss: 0.9530688524246216
2025-06-23 22:25:25,466 INFO Causal Consistency Loss: -0.09346186369657516
2025-06-23 22:25:25,466 INFO Accuracy: 0.5938
2025-06-23 22:25:25,466 INFO MCC: 0.2130
2025-06-23 22:25:25,467 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 22:25:25,467 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.51077366 0.02574875 0.02574875 0.02574875 0.02574875]
2025-06-23 22:27:55,512 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 22:27:55,515 INFO 	Eval, eval loss: 0.9689937233924866, acc: 0.487805, mcc: None
2025-06-23 22:31:59,914 INFO 	iter: 560, batch loss: 0.9932749271392822, batch acc: 0.437500
2025-06-23 22:31:59,915 INFO --- Epoch 4, Batch 560 ---
2025-06-23 22:31:59,915 INFO Total Loss: 0.9932749271392822
2025-06-23 22:31:59,915 INFO Causal Consistency Loss: -0.1018211618065834
2025-06-23 22:31:59,915 INFO Accuracy: 0.4375
2025-06-23 22:31:59,915 INFO MCC: 0.0000
2025-06-23 22:31:59,916 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 22:31:59,916 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.35053635 0.3456109  0.01688071 0.01688071 0.01688071]
2025-06-23 22:34:35,165 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 22:34:35,168 INFO 	Eval, eval loss: 0.9911038279533386, acc: 0.487805, mcc: None
2025-06-23 22:38:41,170 INFO 	iter: 580, batch loss: 0.9535177946090698, batch acc: 0.437500
2025-06-23 22:38:41,171 INFO --- Epoch 4, Batch 580 ---
2025-06-23 22:38:41,171 INFO Total Loss: 0.9535177946090698
2025-06-23 22:38:41,171 INFO Causal Consistency Loss: -0.11080967634916306
2025-06-23 22:38:41,171 INFO Accuracy: 0.4375
2025-06-23 22:38:41,171 INFO MCC: 0.0000
2025-06-23 22:38:41,171 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9956334  0.98060226 0.9979526  1.         0.9682552 ]
2025-06-23 22:38:41,172 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.0505936  0.04992078 0.04978548 0.05196106 0.05093784]
2025-06-23 22:41:21,082 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 22:41:21,085 INFO 	Eval, eval loss: 0.9684966802597046, acc: 0.512195, mcc: None
2025-06-23 22:45:14,543 INFO 	iter: 600, batch loss: 0.9247511029243469, batch acc: 0.687500
2025-06-23 22:45:14,544 INFO --- Epoch 4, Batch 600 ---
2025-06-23 22:45:14,544 INFO Total Loss: 0.9247511029243469
2025-06-23 22:45:14,544 INFO Causal Consistency Loss: -0.11507876217365265
2025-06-23 22:45:14,544 INFO Accuracy: 0.6875
2025-06-23 22:45:14,544 INFO MCC: 0.2187
2025-06-23 22:45:14,544 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999809  1.         0.9999633  0.99878865 0.9999995 ]
2025-06-23 22:45:14,545 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.07607652 0.07831159 0.07645079 0.07423262 0.07590627]
2025-06-23 22:47:54,645 INFO Completed dev evaluation: size=656.0, acc=0.4939
2025-06-23 22:47:54,646 INFO 	Eval, eval loss: 0.9697213768959045, acc: 0.493902, mcc: 0.052861
2025-06-23 22:51:54,476 INFO 	iter: 620, batch loss: 0.8565029501914978, batch acc: 0.656250
2025-06-23 22:51:54,477 INFO --- Epoch 4, Batch 620 ---
2025-06-23 22:51:54,477 INFO Total Loss: 0.8565029501914978
2025-06-23 22:51:54,477 INFO Causal Consistency Loss: -0.15934793651103973
2025-06-23 22:51:54,477 INFO Accuracy: 0.6562
2025-06-23 22:51:54,477 INFO MCC: 0.0000
2025-06-23 22:51:54,478 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.         0.99989414 0.9989542  0.9999999  1.        ]
2025-06-23 22:51:54,478 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.07736357 0.07672743 0.07702118 0.07653067 0.07754429]
2025-06-23 22:54:32,912 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 22:54:32,914 INFO 	Eval, eval loss: 0.9782161712646484, acc: 0.487805, mcc: None
2025-06-23 22:54:33,308 INFO Epoch: loss: 0.950465, acc: 0.505242
2025-06-23 22:54:33,308 INFO Epoch: 5/10 start
2025-06-23 23:01:03,284 INFO 	iter: 640, batch loss: 0.9613310694694519, batch acc: 0.562500
2025-06-23 23:01:03,284 INFO --- Epoch 5, Batch 640 ---
2025-06-23 23:01:03,284 INFO Total Loss: 0.9613310694694519
2025-06-23 23:01:03,284 INFO Causal Consistency Loss: -0.0775163546204567
2025-06-23 23:01:03,284 INFO Accuracy: 0.5625
2025-06-23 23:01:03,285 INFO MCC: 0.0240
2025-06-23 23:01:03,285 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 23:01:03,285 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.48927966 0.02688002 0.02688002 0.02688002 0.02688002]
2025-06-23 23:03:48,485 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-23 23:03:48,488 INFO 	Eval, eval loss: 0.9645971655845642, acc: 0.486280, mcc: -0.024254
2025-06-23 23:08:51,282 INFO 	iter: 660, batch loss: 0.9508147835731506, batch acc: 0.531250
2025-06-23 23:08:51,283 INFO --- Epoch 5, Batch 660 ---
2025-06-23 23:08:51,283 INFO Total Loss: 0.9508147835731506
2025-06-23 23:08:51,283 INFO Causal Consistency Loss: -0.08602874726057053
2025-06-23 23:08:51,283 INFO Accuracy: 0.5312
2025-06-23 23:08:51,283 INFO MCC: 0.0000
2025-06-23 23:08:51,284 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   1.   0.05 0.05]
2025-06-23 23:08:51,284 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.23516175 0.2650532  0.25845975 0.0141956  0.0141956 ]
2025-06-23 23:11:38,098 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 23:11:38,101 INFO 	Eval, eval loss: 0.980999231338501, acc: 0.487805, mcc: None
2025-06-23 23:16:13,874 INFO 	iter: 680, batch loss: 0.9610479474067688, batch acc: 0.468750
2025-06-23 23:16:13,875 INFO --- Epoch 5, Batch 680 ---
2025-06-23 23:16:13,875 INFO Total Loss: 0.9610479474067688
2025-06-23 23:16:13,875 INFO Causal Consistency Loss: -0.09185605496168137
2025-06-23 23:16:13,875 INFO Accuracy: 0.4688
2025-06-23 23:16:13,875 INFO MCC: -0.0249
2025-06-23 23:16:13,876 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.         0.9996822  0.99958557 0.05       0.05      ]
2025-06-23 23:16:13,876 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.26457652 0.25977853 0.258438   0.01277688 0.01277688]
2025-06-23 23:18:51,438 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 23:18:51,440 INFO 	Eval, eval loss: 0.9653384685516357, acc: 0.512195, mcc: None
2025-06-23 23:23:16,266 INFO 	iter: 700, batch loss: 0.9809226989746094, batch acc: 0.406250
2025-06-23 23:23:16,267 INFO --- Epoch 5, Batch 700 ---
2025-06-23 23:23:16,267 INFO Total Loss: 0.9809226989746094
2025-06-23 23:23:16,267 INFO Causal Consistency Loss: -0.08540748059749603
2025-06-23 23:23:16,267 INFO Accuracy: 0.4062
2025-06-23 23:23:16,267 INFO MCC: -0.0586
2025-06-23 23:23:16,267 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 23:23:16,267 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.50268096 0.02617469 0.02617469 0.02617469 0.02617469]
2025-06-23 23:26:05,703 INFO Completed dev evaluation: size=656.0, acc=0.5061
2025-06-23 23:26:05,706 INFO 	Eval, eval loss: 0.9698686003684998, acc: 0.506098, mcc: -0.012534
2025-06-23 23:30:21,193 INFO 	iter: 720, batch loss: 0.94610995054245, batch acc: 0.562500
2025-06-23 23:30:21,194 INFO --- Epoch 5, Batch 720 ---
2025-06-23 23:30:21,194 INFO Total Loss: 0.94610995054245
2025-06-23 23:30:21,194 INFO Causal Consistency Loss: -0.08778935670852661
2025-06-23 23:30:21,194 INFO Accuracy: 0.5625
2025-06-23 23:30:21,194 INFO MCC: 0.0325
2025-06-23 23:30:21,194 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-23 23:30:21,195 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5070804  0.02594314 0.02594314 0.02594314 0.02594314]
2025-06-23 23:33:11,917 INFO Completed dev evaluation: size=656.0, acc=0.5107
2025-06-23 23:33:11,919 INFO 	Eval, eval loss: 0.9672257304191589, acc: 0.510671, mcc: -0.020947
2025-06-23 23:37:28,982 INFO 	iter: 740, batch loss: 0.9406405091285706, batch acc: 0.343750
2025-06-23 23:37:28,983 INFO --- Epoch 5, Batch 740 ---
2025-06-23 23:37:28,983 INFO Total Loss: 0.9406405091285706
2025-06-23 23:37:28,983 INFO Causal Consistency Loss: -0.12432757765054703
2025-06-23 23:37:28,983 INFO Accuracy: 0.3438
2025-06-23 23:37:28,983 INFO MCC: -0.1938
2025-06-23 23:37:28,984 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-23 23:37:28,984 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.3458049  0.3487554  0.01696887 0.01696887 0.01696887]
2025-06-23 23:40:14,199 INFO Completed dev evaluation: size=656.0, acc=0.5107
2025-06-23 23:40:14,202 INFO 	Eval, eval loss: 0.9704945087432861, acc: 0.510671, mcc: 0.012783
2025-06-23 23:44:22,592 INFO 	iter: 760, batch loss: 0.9043225049972534, batch acc: 0.593750
2025-06-23 23:44:22,593 INFO --- Epoch 5, Batch 760 ---
2025-06-23 23:44:22,593 INFO Total Loss: 0.9043225049972534
2025-06-23 23:44:22,593 INFO Causal Consistency Loss: -0.141046404838562
2025-06-23 23:44:22,593 INFO Accuracy: 0.5938
2025-06-23 23:44:22,593 INFO MCC: 0.0000
2025-06-23 23:44:22,593 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999969  0.9995602  0.99998045 0.9999639  0.9922896 ]
2025-06-23 23:44:22,594 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.09494363 0.09496611 0.09533653 0.09415227 0.09623203]
2025-06-23 23:47:17,406 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-23 23:47:17,409 INFO 	Eval, eval loss: 0.9682939052581787, acc: 0.487805, mcc: None
2025-06-23 23:50:23,107 INFO Epoch: loss: 0.947507, acc: 0.513710
2025-06-23 23:50:23,108 INFO Epoch: 6/10 start
2025-06-23 23:52:24,856 INFO 	iter: 780, batch loss: 0.9720086455345154, batch acc: 0.531250
2025-06-23 23:52:24,857 INFO --- Epoch 6, Batch 780 ---
2025-06-23 23:52:24,857 INFO Total Loss: 0.9720086455345154
2025-06-23 23:52:24,857 INFO Causal Consistency Loss: -0.08191927522420883
2025-06-23 23:52:24,857 INFO Accuracy: 0.5312
2025-06-23 23:52:24,857 INFO MCC: 0.0861
2025-06-23 23:52:24,857 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99985623 0.9999999  1.         0.9999665  0.9999318 ]
2025-06-23 23:52:24,858 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.05455817 0.05378785 0.05712342 0.05671054 0.05518713]
2025-06-23 23:55:16,524 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-23 23:55:16,527 INFO 	Eval, eval loss: 0.9712353348731995, acc: 0.512195, mcc: None
2025-06-24 00:00:37,086 INFO 	iter: 800, batch loss: 0.9536334276199341, batch acc: 0.593750
2025-06-24 00:00:37,087 INFO --- Epoch 6, Batch 800 ---
2025-06-24 00:00:37,087 INFO Total Loss: 0.9536334276199341
2025-06-24 00:00:37,087 INFO Causal Consistency Loss: -0.07945859432220459
2025-06-24 00:00:37,087 INFO Accuracy: 0.5938
2025-06-24 00:00:37,087 INFO MCC: 0.0000
2025-06-24 00:00:37,087 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 00:00:37,087 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.49278048 0.02669577 0.02669577 0.02669577 0.02669577]
2025-06-24 00:03:25,680 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 00:03:25,682 INFO 	Eval, eval loss: 0.9844961762428284, acc: 0.487805, mcc: None
2025-06-24 00:07:59,588 INFO 	iter: 820, batch loss: 0.9527663588523865, batch acc: 0.406250
2025-06-24 00:07:59,588 INFO --- Epoch 6, Batch 820 ---
2025-06-24 00:07:59,588 INFO Total Loss: 0.9527663588523865
2025-06-24 00:07:59,588 INFO Causal Consistency Loss: -0.09386678785085678
2025-06-24 00:07:59,588 INFO Accuracy: 0.4062
2025-06-24 00:07:59,588 INFO MCC: -0.2749
2025-06-24 00:07:59,589 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 00:07:59,589 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5110659  0.02573337 0.02573337 0.02573337 0.02573337]
2025-06-24 00:10:58,385 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 00:10:58,388 INFO 	Eval, eval loss: 0.9719161987304688, acc: 0.512195, mcc: None
2025-06-24 00:15:18,925 INFO 	iter: 840, batch loss: 0.9538633227348328, batch acc: 0.468750
2025-06-24 00:15:18,926 INFO --- Epoch 6, Batch 840 ---
2025-06-24 00:15:18,926 INFO Total Loss: 0.9538633227348328
2025-06-24 00:15:18,926 INFO Causal Consistency Loss: -0.0909009575843811
2025-06-24 00:15:18,926 INFO Accuracy: 0.4688
2025-06-24 00:15:18,926 INFO MCC: 0.0000
2025-06-24 00:15:18,926 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   1.   0.05 0.05]
2025-06-24 00:15:18,926 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.2583177  0.25540924 0.2631634  0.0131241  0.0131241 ]
2025-06-24 00:18:17,927 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 00:18:17,931 INFO 	Eval, eval loss: 0.9662181735038757, acc: 0.487805, mcc: None
2025-06-24 00:22:43,499 INFO 	iter: 860, batch loss: 0.9464706778526306, batch acc: 0.531250
2025-06-24 00:22:43,500 INFO --- Epoch 6, Batch 860 ---
2025-06-24 00:22:43,500 INFO Total Loss: 0.9464706778526306
2025-06-24 00:22:43,500 INFO Causal Consistency Loss: -0.10468333214521408
2025-06-24 00:22:43,500 INFO Accuracy: 0.5312
2025-06-24 00:22:43,500 INFO MCC: 0.0000
2025-06-24 00:22:43,501 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.         1.         0.98410183 0.99991786 0.98957354]
2025-06-24 00:22:43,501 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.13012163 0.13138504 0.13123322 0.13019285 0.13158451]
2025-06-24 00:25:39,405 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 00:25:39,408 INFO 	Eval, eval loss: 0.9629902839660645, acc: 0.512195, mcc: None
2025-06-24 00:29:58,421 INFO 	iter: 880, batch loss: 0.9474563598632812, batch acc: 0.468750
2025-06-24 00:29:58,422 INFO --- Epoch 6, Batch 880 ---
2025-06-24 00:29:58,422 INFO Total Loss: 0.9474563598632812
2025-06-24 00:29:58,422 INFO Causal Consistency Loss: -0.1009579673409462
2025-06-24 00:29:58,422 INFO Accuracy: 0.4688
2025-06-24 00:29:58,422 INFO MCC: 0.0000
2025-06-24 00:29:58,423 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.        0.9975884 0.9977329 1.        1.       ]
2025-06-24 00:29:58,423 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.1724986  0.1729306  0.17242613 0.17455897 0.17834078]
2025-06-24 00:33:02,526 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 00:33:02,529 INFO 	Eval, eval loss: 0.9703736305236816, acc: 0.487805, mcc: None
2025-06-24 00:37:16,163 INFO 	iter: 900, batch loss: 0.9457736015319824, batch acc: 0.500000
2025-06-24 00:37:16,164 INFO --- Epoch 6, Batch 900 ---
2025-06-24 00:37:16,164 INFO Total Loss: 0.9457736015319824
2025-06-24 00:37:16,164 INFO Causal Consistency Loss: -0.1231236457824707
2025-06-24 00:37:16,164 INFO Accuracy: 0.5000
2025-06-24 00:37:16,164 INFO MCC: -0.0206
2025-06-24 00:37:16,164 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999472  0.99997973 1.         0.98030204 0.9997019 ]
2025-06-24 00:37:16,164 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.08783923 0.08574612 0.08791382 0.08582114 0.08867568]
2025-06-24 00:40:17,339 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 00:40:17,342 INFO 	Eval, eval loss: 0.9777649641036987, acc: 0.512195, mcc: None
2025-06-24 00:44:35,528 INFO 	iter: 920, batch loss: 0.891312837600708, batch acc: 0.500000
2025-06-24 00:44:35,528 INFO --- Epoch 6, Batch 920 ---
2025-06-24 00:44:35,529 INFO Total Loss: 0.891312837600708
2025-06-24 00:44:35,529 INFO Causal Consistency Loss: -0.14098094403743744
2025-06-24 00:44:35,529 INFO Accuracy: 0.5000
2025-06-24 00:44:35,529 INFO MCC: 0.0000
2025-06-24 00:44:35,529 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 00:44:35,529 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5142177  0.02556749 0.02556749 0.02556749 0.02556749]
2025-06-24 00:47:38,882 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 00:47:38,883 INFO 	Eval, eval loss: 0.9662665128707886, acc: 0.487805, mcc: None
2025-06-24 00:49:44,309 INFO Epoch: loss: 0.946003, acc: 0.505040
2025-06-24 00:49:44,311 INFO Epoch: 7/10 start
2025-06-24 00:53:26,073 INFO 	iter: 940, batch loss: 0.947757363319397, batch acc: 0.656250
2025-06-24 00:53:26,073 INFO --- Epoch 7, Batch 940 ---
2025-06-24 00:53:26,073 INFO Total Loss: 0.947757363319397
2025-06-24 00:53:26,073 INFO Causal Consistency Loss: -0.072564497590065
2025-06-24 00:53:26,073 INFO Accuracy: 0.6562
2025-06-24 00:53:26,074 INFO MCC: 0.2319
2025-06-24 00:53:26,074 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 00:53:26,074 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.51765496 0.02538658 0.02538658 0.02538658 0.02538658]
2025-06-24 00:56:34,755 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 00:56:34,758 INFO 	Eval, eval loss: 0.9720534086227417, acc: 0.487805, mcc: None
2025-06-24 01:01:36,548 INFO 	iter: 960, batch loss: 0.976078987121582, batch acc: 0.437500
2025-06-24 01:01:36,549 INFO --- Epoch 7, Batch 960 ---
2025-06-24 01:01:36,549 INFO Total Loss: 0.976078987121582
2025-06-24 01:01:36,549 INFO Causal Consistency Loss: -0.08446502685546875
2025-06-24 01:01:36,549 INFO Accuracy: 0.4375
2025-06-24 01:01:36,549 INFO MCC: -0.1890
2025-06-24 01:01:36,550 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9996935  0.99999964 1.         0.99498403 0.9998504 ]
2025-06-24 01:01:36,550 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.11240367 0.1183629  0.11942764 0.11644366 0.11651672]
2025-06-24 01:04:44,824 INFO Completed dev evaluation: size=656.0, acc=0.4909
2025-06-24 01:04:44,827 INFO 	Eval, eval loss: 0.9730504155158997, acc: 0.490854, mcc: 0.053967
2025-06-24 01:09:23,526 INFO 	iter: 980, batch loss: 0.9459334015846252, batch acc: 0.593750
2025-06-24 01:09:23,527 INFO --- Epoch 7, Batch 980 ---
2025-06-24 01:09:23,527 INFO Total Loss: 0.9459334015846252
2025-06-24 01:09:23,527 INFO Causal Consistency Loss: -0.08774729073047638
2025-06-24 01:09:23,527 INFO Accuracy: 0.5938
2025-06-24 01:09:23,527 INFO MCC: 0.2749
2025-06-24 01:09:23,527 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999982 1.        0.9999964 0.9999893 1.       ]
2025-06-24 01:09:23,528 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.14958616 0.15100051 0.14757973 0.14707518 0.14910145]
2025-06-24 01:12:20,021 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 01:12:20,022 INFO 	Eval, eval loss: 0.9653269648551941, acc: 0.512195, mcc: None
2025-06-24 01:16:55,468 INFO 	iter: 1000, batch loss: 0.9594912528991699, batch acc: 0.468750
2025-06-24 01:16:55,468 INFO --- Epoch 7, Batch 1000 ---
2025-06-24 01:16:55,469 INFO Total Loss: 0.9594912528991699
2025-06-24 01:16:55,469 INFO Causal Consistency Loss: -0.09670843183994293
2025-06-24 01:16:55,469 INFO Accuracy: 0.4688
2025-06-24 01:16:55,469 INFO MCC: 0.0000
2025-06-24 01:16:55,469 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999974  1.         0.99999726 1.         1.        ]
2025-06-24 01:16:55,469 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17569609 0.17485772 0.17383708 0.17536376 0.17013332]
2025-06-24 01:20:07,226 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 01:20:07,229 INFO 	Eval, eval loss: 0.9734130501747131, acc: 0.487805, mcc: None
2025-06-24 01:24:31,019 INFO 	iter: 1020, batch loss: 0.9376112818717957, batch acc: 0.687500
2025-06-24 01:24:31,020 INFO --- Epoch 7, Batch 1020 ---
2025-06-24 01:24:31,020 INFO Total Loss: 0.9376112818717957
2025-06-24 01:24:31,020 INFO Causal Consistency Loss: -0.09658249467611313
2025-06-24 01:24:31,020 INFO Accuracy: 0.6875
2025-06-24 01:24:31,020 INFO MCC: -0.1124
2025-06-24 01:24:31,020 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-24 01:24:31,020 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.34913218 0.34083247 0.01722418 0.01722418 0.01722418]
2025-06-24 01:27:44,685 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 01:27:44,688 INFO 	Eval, eval loss: 0.9695672392845154, acc: 0.487805, mcc: None
2025-06-24 01:32:11,222 INFO 	iter: 1040, batch loss: 0.9097461104393005, batch acc: 0.656250
2025-06-24 01:32:11,223 INFO --- Epoch 7, Batch 1040 ---
2025-06-24 01:32:11,223 INFO Total Loss: 0.9097461104393005
2025-06-24 01:32:11,223 INFO Causal Consistency Loss: -0.11075147241353989
2025-06-24 01:32:11,223 INFO Accuracy: 0.6562
2025-06-24 01:32:11,223 INFO MCC: 0.0000
2025-06-24 01:32:11,223 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99999976 1.         0.9999999  0.05       0.05      ]
2025-06-24 01:32:11,224 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.26012358 0.26552373 0.25090504 0.01314398 0.01314398]
2025-06-24 01:35:17,006 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 01:35:17,007 INFO 	Eval, eval loss: 0.9734318852424622, acc: 0.487805, mcc: None
2025-06-24 01:39:43,729 INFO 	iter: 1060, batch loss: 0.9260039329528809, batch acc: 0.500000
2025-06-24 01:39:43,730 INFO --- Epoch 7, Batch 1060 ---
2025-06-24 01:39:43,730 INFO Total Loss: 0.9260039329528809
2025-06-24 01:39:43,730 INFO Causal Consistency Loss: -0.12197122722864151
2025-06-24 01:39:43,730 INFO Accuracy: 0.5000
2025-06-24 01:39:43,730 INFO MCC: 0.0000
2025-06-24 01:39:43,731 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   1.   1.   0.05]
2025-06-24 01:39:43,731 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.20673646 0.20750721 0.2094355  0.21015708 0.01038524]
2025-06-24 01:42:58,061 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 01:42:58,064 INFO 	Eval, eval loss: 0.9736014604568481, acc: 0.487805, mcc: None
2025-06-24 01:47:15,644 INFO 	iter: 1080, batch loss: 0.8830528259277344, batch acc: 0.593750
2025-06-24 01:47:15,644 INFO --- Epoch 7, Batch 1080 ---
2025-06-24 01:47:15,644 INFO Total Loss: 0.8830528259277344
2025-06-24 01:47:15,644 INFO Causal Consistency Loss: -0.15969422459602356
2025-06-24 01:47:15,644 INFO Accuracy: 0.5938
2025-06-24 01:47:15,644 INFO MCC: 0.0000
2025-06-24 01:47:15,645 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 01:47:15,645 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5112885  0.02572165 0.02572165 0.02572165 0.02572165]
2025-06-24 01:50:35,070 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 01:50:35,073 INFO 	Eval, eval loss: 0.96994948387146, acc: 0.512195, mcc: None
2025-06-24 01:51:42,159 INFO Epoch: loss: 0.947318, acc: 0.497984
2025-06-24 01:51:42,160 INFO Epoch: 8/10 start
2025-06-24 01:56:36,775 INFO 	iter: 1100, batch loss: 0.9835046529769897, batch acc: 0.375000
2025-06-24 01:56:36,776 INFO --- Epoch 8, Batch 1100 ---
2025-06-24 01:56:36,776 INFO Total Loss: 0.9835046529769897
2025-06-24 01:56:36,776 INFO Causal Consistency Loss: -0.08274757117033005
2025-06-24 01:56:36,776 INFO Accuracy: 0.3750
2025-06-24 01:56:36,776 INFO MCC: 0.0000
2025-06-24 01:56:36,776 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 01:56:36,777 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.4928963  0.02668967 0.02668967 0.02668967 0.02668967]
2025-06-24 01:59:58,010 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 01:59:58,013 INFO 	Eval, eval loss: 0.9751620888710022, acc: 0.487805, mcc: None
2025-06-24 02:05:03,309 INFO 	iter: 1120, batch loss: 0.9440987706184387, batch acc: 0.625000
2025-06-24 02:05:03,310 INFO --- Epoch 8, Batch 1120 ---
2025-06-24 02:05:03,310 INFO Total Loss: 0.9440987706184387
2025-06-24 02:05:03,310 INFO Causal Consistency Loss: -0.09800547361373901
2025-06-24 02:05:03,310 INFO Accuracy: 0.6250
2025-06-24 02:05:03,310 INFO MCC: 0.0000
2025-06-24 02:05:03,310 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 02:05:03,311 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5152381  0.02551378 0.02551378 0.02551378 0.02551378]
2025-06-24 02:08:12,954 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 02:08:12,957 INFO 	Eval, eval loss: 0.9662942290306091, acc: 0.487805, mcc: None
2025-06-24 02:13:04,438 INFO 	iter: 1140, batch loss: 0.955739438533783, batch acc: 0.343750
2025-06-24 02:13:04,438 INFO --- Epoch 8, Batch 1140 ---
2025-06-24 02:13:04,438 INFO Total Loss: 0.955739438533783
2025-06-24 02:13:04,438 INFO Causal Consistency Loss: -0.10000808537006378
2025-06-24 02:13:04,438 INFO Accuracy: 0.3438
2025-06-24 02:13:04,439 INFO MCC: -0.0849
2025-06-24 02:13:04,439 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-24 02:13:04,439 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.3443042  0.34530872 0.01724373 0.01724373 0.01724373]
2025-06-24 02:16:27,160 INFO Completed dev evaluation: size=656.0, acc=0.5107
2025-06-24 02:16:27,162 INFO 	Eval, eval loss: 0.9672762751579285, acc: 0.510671, mcc: -0.000645
2025-06-24 02:21:04,084 INFO 	iter: 1160, batch loss: 0.9565854072570801, batch acc: 0.437500
2025-06-24 02:21:04,085 INFO --- Epoch 8, Batch 1160 ---
2025-06-24 02:21:04,085 INFO Total Loss: 0.9565854072570801
2025-06-24 02:21:04,085 INFO Causal Consistency Loss: -0.08853362500667572
2025-06-24 02:21:04,085 INFO Accuracy: 0.4375
2025-06-24 02:21:04,085 INFO MCC: 0.0000
2025-06-24 02:21:04,085 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 02:21:04,085 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.514261   0.02556521 0.02556521 0.02556521 0.02556521]
2025-06-24 02:24:30,916 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 02:24:30,918 INFO 	Eval, eval loss: 0.9629238247871399, acc: 0.512195, mcc: None
2025-06-24 02:29:06,287 INFO 	iter: 1180, batch loss: 0.960049569606781, batch acc: 0.343750
2025-06-24 02:29:06,288 INFO --- Epoch 8, Batch 1180 ---
2025-06-24 02:29:06,288 INFO Total Loss: 0.960049569606781
2025-06-24 02:29:06,288 INFO Causal Consistency Loss: -0.09381920844316483
2025-06-24 02:29:06,288 INFO Accuracy: 0.3438
2025-06-24 02:29:06,288 INFO MCC: -0.0849
2025-06-24 02:29:06,289 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.        0.9999957 0.05      0.05      0.05     ]
2025-06-24 02:29:06,289 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.3539819  0.32843617 0.01764344 0.01764344 0.01764344]
2025-06-24 02:32:28,538 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 02:32:28,540 INFO 	Eval, eval loss: 0.960620641708374, acc: 0.512195, mcc: None
2025-06-24 02:37:07,722 INFO 	iter: 1200, batch loss: 0.9337256550788879, batch acc: 0.406250
2025-06-24 02:37:07,723 INFO --- Epoch 8, Batch 1200 ---
2025-06-24 02:37:07,723 INFO Total Loss: 0.9337256550788879
2025-06-24 02:37:07,723 INFO Causal Consistency Loss: -0.11778398603200912
2025-06-24 02:37:07,723 INFO Accuracy: 0.4062
2025-06-24 02:37:07,723 INFO MCC: -0.3216
2025-06-24 02:37:07,723 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9998754  0.993117   0.9985494  0.99997175 0.99999976]
2025-06-24 02:37:07,724 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.10630791 0.10306247 0.09976273 0.10590247 0.10582836]
2025-06-24 02:40:27,242 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-24 02:40:27,245 INFO 	Eval, eval loss: 0.9637557864189148, acc: 0.489329, mcc: -0.033147
2025-06-24 02:45:00,255 INFO 	iter: 1220, batch loss: 0.8852739334106445, batch acc: 0.750000
2025-06-24 02:45:00,256 INFO --- Epoch 8, Batch 1220 ---
2025-06-24 02:45:00,256 INFO Total Loss: 0.8852739334106445
2025-06-24 02:45:00,256 INFO Causal Consistency Loss: -0.13547347486019135
2025-06-24 02:45:00,256 INFO Accuracy: 0.7500
2025-06-24 02:45:00,256 INFO MCC: 0.0000
2025-06-24 02:45:00,257 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1. 1. 1. 1. 1.]
2025-06-24 02:45:00,257 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17366219 0.1762136  0.1747357  0.17471178 0.16986963]
2025-06-24 02:48:32,034 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 02:48:32,037 INFO 	Eval, eval loss: 0.9724130034446716, acc: 0.487805, mcc: None
2025-06-24 02:52:57,096 INFO 	iter: 1240, batch loss: 0.8845553994178772, batch acc: 0.593750
2025-06-24 02:52:57,097 INFO --- Epoch 8, Batch 1240 ---
2025-06-24 02:52:57,097 INFO Total Loss: 0.8845553994178772
2025-06-24 02:52:57,098 INFO Causal Consistency Loss: -0.1525372713804245
2025-06-24 02:52:57,098 INFO Accuracy: 0.5938
2025-06-24 02:52:57,098 INFO MCC: 0.0000
2025-06-24 02:52:57,098 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99999404 1.         0.9999999  1.         1.        ]
2025-06-24 02:52:57,098 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17289385 0.17546278 0.17456938 0.17252992 0.17338017]
2025-06-24 02:56:30,407 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 02:56:30,410 INFO 	Eval, eval loss: 0.9646601676940918, acc: 0.487805, mcc: None
2025-06-24 02:56:30,877 INFO Epoch: loss: 0.946048, acc: 0.503831
2025-06-24 02:56:30,877 INFO Epoch: 9/10 start
2025-06-24 03:02:56,552 INFO 	iter: 1260, batch loss: 0.9605499505996704, batch acc: 0.468750
2025-06-24 03:02:56,553 INFO --- Epoch 9, Batch 1260 ---
2025-06-24 03:02:56,553 INFO Total Loss: 0.9605499505996704
2025-06-24 03:02:56,553 INFO Causal Consistency Loss: -0.0817088931798935
2025-06-24 03:02:56,553 INFO Accuracy: 0.4688
2025-06-24 03:02:56,553 INFO MCC: 0.0000
2025-06-24 03:02:56,553 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 03:02:56,553 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.51401234 0.0255783  0.0255783  0.0255783  0.0255783 ]
2025-06-24 03:06:27,248 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 03:06:27,251 INFO 	Eval, eval loss: 0.9637959599494934, acc: 0.512195, mcc: None
2025-06-24 03:11:38,866 INFO 	iter: 1280, batch loss: 0.9559685587882996, batch acc: 0.562500
2025-06-24 03:11:38,866 INFO --- Epoch 9, Batch 1280 ---
2025-06-24 03:11:38,866 INFO Total Loss: 0.9559685587882996
2025-06-24 03:11:38,867 INFO Causal Consistency Loss: -0.09517519921064377
2025-06-24 03:11:38,867 INFO Accuracy: 0.5625
2025-06-24 03:11:38,867 INFO MCC: 0.0000
2025-06-24 03:11:38,867 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.        1.        0.9999987 0.9922748 1.       ]
2025-06-24 03:11:38,867 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.17627671 0.17601919 0.17413507 0.16648014 0.17669277]
2025-06-24 03:15:01,506 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 03:15:01,509 INFO 	Eval, eval loss: 1.002447247505188, acc: 0.487805, mcc: None
2025-06-24 03:19:57,350 INFO 	iter: 1300, batch loss: 0.9600961208343506, batch acc: 0.437500
2025-06-24 03:19:57,350 INFO --- Epoch 9, Batch 1300 ---
2025-06-24 03:19:57,350 INFO Total Loss: 0.9600961208343506
2025-06-24 03:19:57,350 INFO Causal Consistency Loss: -0.08660127967596054
2025-06-24 03:19:57,350 INFO Accuracy: 0.4375
2025-06-24 03:19:57,350 INFO MCC: -0.1260
2025-06-24 03:19:57,351 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 03:19:57,351 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5133073  0.02561541 0.02561541 0.02561541 0.02561541]
2025-06-24 03:23:34,975 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-24 03:23:34,978 INFO 	Eval, eval loss: 0.9636540412902832, acc: 0.486280, mcc: -0.040038
2025-06-24 03:28:20,275 INFO 	iter: 1320, batch loss: 0.931448757648468, batch acc: 0.562500
2025-06-24 03:28:20,276 INFO --- Epoch 9, Batch 1320 ---
2025-06-24 03:28:20,276 INFO Total Loss: 0.931448757648468
2025-06-24 03:28:20,276 INFO Causal Consistency Loss: -0.10853786766529083
2025-06-24 03:28:20,276 INFO Accuracy: 0.5625
2025-06-24 03:28:20,276 INFO MCC: 0.0000
2025-06-24 03:28:20,276 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 03:28:20,277 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.51595765 0.02547591 0.02547591 0.02547591 0.02547591]
2025-06-24 03:32:00,522 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 03:32:00,525 INFO 	Eval, eval loss: 0.9861897230148315, acc: 0.487805, mcc: None
2025-06-24 03:36:44,226 INFO 	iter: 1340, batch loss: 0.9590253233909607, batch acc: 0.375000
2025-06-24 03:36:44,227 INFO --- Epoch 9, Batch 1340 ---
2025-06-24 03:36:44,227 INFO Total Loss: 0.9590253233909607
2025-06-24 03:36:44,227 INFO Causal Consistency Loss: -0.10101135075092316
2025-06-24 03:36:44,227 INFO Accuracy: 0.3750
2025-06-24 03:36:44,227 INFO MCC: 0.0000
2025-06-24 03:36:44,228 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1. 1. 1. 1. 1.]
2025-06-24 03:36:44,228 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.14633368 0.15063052 0.1493421  0.14997806 0.15069355]
2025-06-24 03:40:21,273 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 03:40:21,275 INFO 	Eval, eval loss: 0.9662608504295349, acc: 0.487805, mcc: None
2025-06-24 03:45:10,975 INFO 	iter: 1360, batch loss: 0.9451888799667358, batch acc: 0.406250
2025-06-24 03:45:10,975 INFO --- Epoch 9, Batch 1360 ---
2025-06-24 03:45:10,975 INFO Total Loss: 0.9451888799667358
2025-06-24 03:45:10,975 INFO Causal Consistency Loss: -0.10146532207727432
2025-06-24 03:45:10,975 INFO Accuracy: 0.4062
2025-06-24 03:45:10,975 INFO MCC: 0.1391
2025-06-24 03:45:10,976 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-24 03:45:10,976 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.34389058 0.34720185 0.01716154 0.01716154 0.01716154]
2025-06-24 03:48:40,964 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 03:48:40,966 INFO 	Eval, eval loss: 0.9629392027854919, acc: 0.512195, mcc: None
2025-06-24 03:53:25,664 INFO 	iter: 1380, batch loss: 0.9243420958518982, batch acc: 0.437500
2025-06-24 03:53:25,664 INFO --- Epoch 9, Batch 1380 ---
2025-06-24 03:53:25,664 INFO Total Loss: 0.9243420958518982
2025-06-24 03:53:25,664 INFO Causal Consistency Loss: -0.12139049917459488
2025-06-24 03:53:25,665 INFO Accuracy: 0.4375
2025-06-24 03:53:25,665 INFO MCC: 0.0000
2025-06-24 03:53:25,665 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99996114 1.         1.         0.9999982  0.99999976]
2025-06-24 03:53:25,665 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.10559168 0.10477598 0.10463232 0.10466223 0.1057814 ]
2025-06-24 03:57:10,679 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 03:57:10,682 INFO 	Eval, eval loss: 0.9589766263961792, acc: 0.512195, mcc: None
2025-06-24 04:00:34,912 INFO Epoch: loss: 0.945736, acc: 0.508669
2025-06-24 04:00:34,912 INFO Epoch: 10/10 start
2025-06-24 04:02:44,145 INFO 	iter: 1400, batch loss: 0.9510989189147949, batch acc: 0.593750
2025-06-24 04:02:44,146 INFO --- Epoch 10, Batch 1400 ---
2025-06-24 04:02:44,146 INFO Total Loss: 0.9510989189147949
2025-06-24 04:02:44,146 INFO Causal Consistency Loss: -0.07951914519071579
2025-06-24 04:02:44,146 INFO Accuracy: 0.5938
2025-06-24 04:02:44,146 INFO MCC: 0.0000
2025-06-24 04:02:44,147 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 04:02:44,147 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.513223   0.02561984 0.02561984 0.02561984 0.02561984]
2025-06-24 04:06:31,956 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 04:06:31,959 INFO 	Eval, eval loss: 1.0019614696502686, acc: 0.487805, mcc: None
2025-06-24 04:12:20,221 INFO 	iter: 1420, batch loss: 0.967279314994812, batch acc: 0.531250
2025-06-24 04:12:20,222 INFO --- Epoch 10, Batch 1420 ---
2025-06-24 04:12:20,222 INFO Total Loss: 0.967279314994812
2025-06-24 04:12:20,222 INFO Causal Consistency Loss: -0.07806872576475143
2025-06-24 04:12:20,222 INFO Accuracy: 0.5312
2025-06-24 04:12:20,222 INFO MCC: -0.1584
2025-06-24 04:12:20,222 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-24 04:12:20,222 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.33327475 0.3517769  0.01749713 0.01749713 0.01749713]
2025-06-24 04:15:50,506 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 04:15:50,509 INFO 	Eval, eval loss: 0.9672203660011292, acc: 0.512195, mcc: None
2025-06-24 04:20:49,353 INFO 	iter: 1440, batch loss: 0.9573585391044617, batch acc: 0.500000
2025-06-24 04:20:49,354 INFO --- Epoch 10, Batch 1440 ---
2025-06-24 04:20:49,354 INFO Total Loss: 0.9573585391044617
2025-06-24 04:20:49,354 INFO Causal Consistency Loss: -0.09537752717733383
2025-06-24 04:20:49,354 INFO Accuracy: 0.5000
2025-06-24 04:20:49,354 INFO MCC: 0.0000
2025-06-24 04:20:49,354 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 04:20:49,355 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5136571  0.02559699 0.02559699 0.02559699 0.02559699]
2025-06-24 04:24:21,304 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 04:24:21,307 INFO 	Eval, eval loss: 0.9663043022155762, acc: 0.487805, mcc: None
2025-06-24 04:29:16,312 INFO 	iter: 1460, batch loss: 0.9351300597190857, batch acc: 0.656250
2025-06-24 04:29:16,312 INFO --- Epoch 10, Batch 1460 ---
2025-06-24 04:29:16,312 INFO Total Loss: 0.9351300597190857
2025-06-24 04:29:16,312 INFO Causal Consistency Loss: -0.09716946631669998
2025-06-24 04:29:16,313 INFO Accuracy: 0.6562
2025-06-24 04:29:16,313 INFO MCC: 0.0000
2025-06-24 04:29:16,313 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   0.05 0.05 0.05]
2025-06-24 04:29:16,313 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.34469917 0.34488362 0.0172454  0.0172454  0.0172454 ]
2025-06-24 04:32:56,300 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 04:32:56,308 INFO 	Eval, eval loss: 0.9682819843292236, acc: 0.487805, mcc: None
2025-06-24 04:37:44,690 INFO 	iter: 1480, batch loss: 0.9600660800933838, batch acc: 0.468750
2025-06-24 04:37:44,690 INFO --- Epoch 10, Batch 1480 ---
2025-06-24 04:37:44,690 INFO Total Loss: 0.9600660800933838
2025-06-24 04:37:44,690 INFO Causal Consistency Loss: -0.0952775627374649
2025-06-24 04:37:44,690 INFO Accuracy: 0.4688
2025-06-24 04:37:44,690 INFO MCC: 0.0000
2025-06-24 04:37:44,691 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   1.   1.   1.   0.05]
2025-06-24 04:37:44,691 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.20718963 0.2120165  0.20802976 0.20753789 0.01032664]
2025-06-24 04:41:25,543 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 04:41:25,546 INFO 	Eval, eval loss: 0.9696246981620789, acc: 0.487805, mcc: None
2025-06-24 04:46:12,353 INFO 	iter: 1500, batch loss: 0.9440433382987976, batch acc: 0.437500
2025-06-24 04:46:12,353 INFO --- Epoch 10, Batch 1500 ---
2025-06-24 04:46:12,353 INFO Total Loss: 0.9440433382987976
2025-06-24 04:46:12,353 INFO Causal Consistency Loss: -0.1248975396156311
2025-06-24 04:46:12,353 INFO Accuracy: 0.4375
2025-06-24 04:46:12,354 INFO MCC: 0.0000
2025-06-24 04:46:12,354 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 04:46:12,354 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.5133243  0.02561451 0.02561451 0.02561451 0.02561451]
2025-06-24 04:49:55,161 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 04:49:55,164 INFO 	Eval, eval loss: 0.9597861170768738, acc: 0.512195, mcc: None
2025-06-24 04:54:38,846 INFO 	iter: 1520, batch loss: 0.9385743141174316, batch acc: 0.468750
2025-06-24 04:54:38,847 INFO --- Epoch 10, Batch 1520 ---
2025-06-24 04:54:38,847 INFO Total Loss: 0.9385743141174316
2025-06-24 04:54:38,848 INFO Causal Consistency Loss: -0.12387632578611374
2025-06-24 04:54:38,848 INFO Accuracy: 0.4688
2025-06-24 04:54:38,848 INFO MCC: 0.0000
2025-06-24 04:54:38,848 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9999931  0.9999893  0.9999999  0.99999654 0.9997917 ]
2025-06-24 04:54:38,848 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.06345297 0.06275989 0.06202472 0.06295821 0.06307141]
2025-06-24 04:58:23,717 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 04:58:23,720 INFO 	Eval, eval loss: 0.9781322479248047, acc: 0.487805, mcc: None
2025-06-24 05:03:05,092 INFO 	iter: 1540, batch loss: 0.9020270109176636, batch acc: 0.468750
2025-06-24 05:03:05,093 INFO --- Epoch 10, Batch 1540 ---
2025-06-24 05:03:05,093 INFO Total Loss: 0.9020270109176636
2025-06-24 05:03:05,093 INFO Causal Consistency Loss: -0.14548400044441223
2025-06-24 05:03:05,093 INFO Accuracy: 0.4688
2025-06-24 05:03:05,093 INFO MCC: -0.1072
2025-06-24 05:03:05,094 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.9586013 0.9999957 0.9999479 0.991698  1.       ]
2025-06-24 05:03:05,094 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.05022103 0.05016911 0.05032216 0.04990201 0.05033631]
2025-06-24 05:06:52,899 INFO Completed dev evaluation: size=656.0, acc=0.5137
2025-06-24 05:06:52,902 INFO 	Eval, eval loss: 0.9660916924476624, acc: 0.513720, mcc: 0.040038
2025-06-24 05:09:13,567 INFO Epoch: loss: 0.944941, acc: 0.508065
2025-06-24 05:09:14,905 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, session restored!
2025-06-24 05:14:21,715 INFO Completed test evaluation: size=1008.0, acc=0.4246
2025-06-24 05:14:21,720 INFO 	Eval, eval loss: 0.9679247736930847, acc: 0.424603, mcc: -0.026639
2025-06-24 07:14:06,088 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 07:14:06,092 INFO Start graph assembling...
2025-06-24 07:14:35,461 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 07:14:44,257 INFO Word table init: done!
2025-06-24 07:14:44,258 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-24 07:14:44,258 INFO Epoch: 1/10 start
2025-06-24 07:21:39,420 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 07:21:39,423 INFO Start graph assembling...
2025-06-24 07:22:05,702 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 07:22:06,896 INFO Word table init: done!
2025-06-24 07:22:06,896 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-24 07:22:06,896 INFO Epoch: 1/10 start
2025-06-24 07:27:36,455 INFO 	iter: 20, batch loss: 7.761237621307373, batch acc: 0.781250
2025-06-24 07:27:36,457 INFO --- Epoch 1, Batch 20 ---
2025-06-24 07:27:36,457 INFO Total Loss: 7.761237621307373
2025-06-24 07:27:36,457 INFO Causal Consistency Loss: 0.20289060473442078
2025-06-24 07:27:36,457 INFO Accuracy: 0.7812
2025-06-24 07:27:36,457 INFO MCC: 0.5727
2025-06-24 07:27:36,457 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.7557918 0.05      0.05      0.05      0.05     ]
2025-06-24 07:27:36,458 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.05373646 0.04980334 0.04980334 0.04980334 0.04980334]
2025-06-24 07:29:23,776 INFO Completed dev evaluation: size=656.0, acc=0.5716
2025-06-24 07:29:23,780 INFO 	Eval, eval loss: 7.628606796264648, acc: 0.571646, mcc: 0.148648
2025-06-24 07:33:09,339 INFO 	iter: 40, batch loss: 6.728476524353027, batch acc: 0.625000
2025-06-24 07:33:09,340 INFO --- Epoch 1, Batch 40 ---
2025-06-24 07:33:09,340 INFO Total Loss: 6.728476524353027
2025-06-24 07:33:09,340 INFO Causal Consistency Loss: -0.6371557712554932
2025-06-24 07:33:09,340 INFO Accuracy: 0.6250
2025-06-24 07:33:09,340 INFO MCC: 0.2431
2025-06-24 07:33:09,341 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.00000e+00 4.85635e-09 5.00000e-02 5.00000e-02 5.00000e-02]
2025-06-24 07:33:09,341 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.04312627 0.04970502 0.05039826 0.05039826 0.05039826]
2025-06-24 07:34:59,643 INFO Completed dev evaluation: size=656.0, acc=0.5015
2025-06-24 07:34:59,646 INFO 	Eval, eval loss: 6.46085786819458, acc: 0.501524, mcc: 0.004170
2025-06-24 07:38:34,558 INFO 	iter: 60, batch loss: nan, batch acc: 0.531250
2025-06-24 07:38:34,559 INFO --- Epoch 1, Batch 60 ---
2025-06-24 07:38:34,559 INFO Total Loss: nan
2025-06-24 07:38:34,559 INFO Causal Consistency Loss: nan
2025-06-24 07:38:34,559 INFO Accuracy: 0.5312
2025-06-24 07:38:34,559 INFO MCC: 0.0000
2025-06-24 07:38:34,560 INFO Alpha_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:38:34,560 INFO Omega_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:40:25,123 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 07:40:25,126 INFO 	Eval, eval loss: nan, acc: 0.512195, mcc: None
2025-06-24 07:44:02,589 INFO 	iter: 80, batch loss: nan, batch acc: 0.593750
2025-06-24 07:44:02,590 INFO --- Epoch 1, Batch 80 ---
2025-06-24 07:44:02,590 INFO Total Loss: nan
2025-06-24 07:44:02,590 INFO Causal Consistency Loss: nan
2025-06-24 07:44:02,590 INFO Accuracy: 0.5938
2025-06-24 07:44:02,590 INFO MCC: 0.0000
2025-06-24 07:44:02,591 INFO Alpha_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:44:02,591 INFO Omega_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:45:53,911 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 07:45:53,915 INFO 	Eval, eval loss: nan, acc: 0.512195, mcc: None
2025-06-24 07:49:23,022 INFO 	iter: 100, batch loss: nan, batch acc: 0.531250
2025-06-24 07:49:23,023 INFO --- Epoch 1, Batch 100 ---
2025-06-24 07:49:23,023 INFO Total Loss: nan
2025-06-24 07:49:23,023 INFO Causal Consistency Loss: nan
2025-06-24 07:49:23,023 INFO Accuracy: 0.5312
2025-06-24 07:49:23,023 INFO MCC: 0.0000
2025-06-24 07:49:23,024 INFO Alpha_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:49:23,024 INFO Omega_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:51:13,708 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 07:51:13,712 INFO 	Eval, eval loss: nan, acc: 0.512195, mcc: None
2025-06-24 07:54:35,243 INFO 	iter: 120, batch loss: nan, batch acc: 0.437500
2025-06-24 07:54:35,244 INFO --- Epoch 1, Batch 120 ---
2025-06-24 07:54:35,244 INFO Total Loss: nan
2025-06-24 07:54:35,244 INFO Causal Consistency Loss: nan
2025-06-24 07:54:35,244 INFO Accuracy: 0.4375
2025-06-24 07:54:35,244 INFO MCC: 0.0000
2025-06-24 07:54:35,244 INFO Alpha_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:54:35,245 INFO Omega_i (sample 0, day 0, first 5 msgs): [nan nan nan nan nan]
2025-06-24 07:56:27,646 INFO Completed dev evaluation: size=656.0, acc=0.5122
2025-06-24 07:56:27,649 INFO 	Eval, eval loss: nan, acc: 0.512195, mcc: None
2025-06-24 08:04:34,203 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 08:04:34,205 INFO Start graph assembling...
2025-06-24 08:04:57,270 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 08:05:00,635 INFO Word table init: done!
2025-06-24 08:05:02,634 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, session restored!
2025-06-24 08:05:02,634 INFO Epoch: 1/10 start
2025-06-24 08:06:42,914 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 08:06:42,916 INFO Start graph assembling...
2025-06-24 08:07:02,406 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 08:07:03,958 INFO Word table init: done!
2025-06-24 08:07:03,959 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-24 08:07:03,959 INFO Epoch: 1/10 start
2025-06-24 08:10:57,112 INFO 	iter: 20, batch loss: 7.395504951477051, batch acc: 0.593750
2025-06-24 08:10:57,127 INFO --- Epoch 1, Batch 20 ---
2025-06-24 08:10:57,127 INFO Total Loss: 7.395504951477051
2025-06-24 08:10:57,127 INFO Causal Consistency Loss: 0.022423427551984787
2025-06-24 08:10:57,128 INFO Accuracy: 0.5938
2025-06-24 08:10:57,128 INFO MCC: 0.1974
2025-06-24 08:10:57,128 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 08:10:57,128 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.06432143 0.04924624 0.04924624 0.04924624 0.04924624]
2025-06-24 08:12:20,963 INFO Completed dev evaluation: size=656.0, acc=0.5076
2025-06-24 08:12:20,966 INFO 	Eval, eval loss: 7.51434850692749, acc: 0.507622, mcc: 0.046914
2025-06-24 08:15:15,197 INFO 	iter: 40, batch loss: 6.572107315063477, batch acc: 0.718750
2025-06-24 08:15:15,198 INFO --- Epoch 1, Batch 40 ---
2025-06-24 08:15:15,198 INFO Total Loss: 6.572107315063477
2025-06-24 08:15:15,198 INFO Causal Consistency Loss: -0.20045243203639984
2025-06-24 08:15:15,198 INFO Accuracy: 0.7188
2025-06-24 08:15:15,198 INFO MCC: 0.4497
2025-06-24 08:15:15,198 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 08:15:15,199 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.04801739 0.05010435 0.05010435 0.05010435 0.05010435]
2025-06-24 08:16:39,161 INFO Completed dev evaluation: size=656.0, acc=0.5518
2025-06-24 08:16:39,165 INFO 	Eval, eval loss: 6.488983631134033, acc: 0.551829, mcc: 0.109733
2025-06-24 08:19:09,174 INFO 	iter: 60, batch loss: 4.315192222595215, batch acc: 0.781250
2025-06-24 08:19:09,175 INFO --- Epoch 1, Batch 60 ---
2025-06-24 08:19:09,175 INFO Total Loss: 4.315192222595215
2025-06-24 08:19:09,175 INFO Causal Consistency Loss: -0.542056143283844
2025-06-24 08:19:09,175 INFO Accuracy: 0.7812
2025-06-24 08:19:09,175 INFO MCC: 0.5405
2025-06-24 08:19:09,176 INFO Alpha_i (sample 0, day 0, first 5 msgs): [3.3800104e-01 4.1538398e-05 3.2436321e-05 3.5073383e-05 6.6441190e-01]
2025-06-24 08:19:09,176 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.02890159 0.04064588 0.03529014 0.04079247 0.0286255 ]
2025-06-24 08:20:30,622 INFO Completed dev evaluation: size=656.0, acc=0.5229
2025-06-24 08:20:30,623 INFO 	Eval, eval loss: 4.291956424713135, acc: 0.522866, mcc: 0.087688
2025-06-24 08:23:15,466 INFO 	iter: 80, batch loss: 2.997276782989502, batch acc: 0.718750
2025-06-24 08:23:15,470 INFO --- Epoch 1, Batch 80 ---
2025-06-24 08:23:15,470 INFO Total Loss: 2.997276782989502
2025-06-24 08:23:15,470 INFO Causal Consistency Loss: -0.7806913256645203
2025-06-24 08:23:15,470 INFO Accuracy: 0.7188
2025-06-24 08:23:15,470 INFO MCC: 0.4384
2025-06-24 08:23:15,470 INFO Alpha_i (sample 0, day 0, first 5 msgs): [3.1831895e-04 3.2357559e-07 9.2129721e-10 3.9174574e-06 4.1948147e-06]
2025-06-24 08:23:15,471 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.03748728 0.0448444  0.07937747 0.20653607 0.05081778]
2025-06-24 08:25:12,098 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-24 08:25:12,117 INFO 	Eval, eval loss: 3.0207440853118896, acc: 0.496951, mcc: -0.013126
2025-06-24 08:29:57,430 INFO 	iter: 100, batch loss: 2.5112390518188477, batch acc: 0.687500
2025-06-24 08:29:57,464 INFO --- Epoch 1, Batch 100 ---
2025-06-24 08:29:57,464 INFO Total Loss: 2.5112390518188477
2025-06-24 08:29:57,465 INFO Causal Consistency Loss: -1.8631880283355713
2025-06-24 08:29:57,465 INFO Accuracy: 0.6875
2025-06-24 08:29:57,465 INFO MCC: 0.3651
2025-06-24 08:29:57,465 INFO Alpha_i (sample 0, day 0, first 5 msgs): [2.3810272e-09 9.9987662e-01 9.2055277e-05 1.4843643e-08 5.3286726e-07]
2025-06-24 08:29:57,465 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.01173273 0.00212367 0.00329563 0.01164736 0.0059845 ]
2025-06-24 08:33:57,828 INFO Completed dev evaluation: size=656.0, acc=0.5503
2025-06-24 08:33:57,865 INFO 	Eval, eval loss: 2.543351411819458, acc: 0.550305, mcc: 0.099068
2025-06-24 08:38:31,838 INFO 	iter: 120, batch loss: 2.1073403358459473, batch acc: 0.687500
2025-06-24 08:38:31,871 INFO --- Epoch 1, Batch 120 ---
2025-06-24 08:38:31,871 INFO Total Loss: 2.1073403358459473
2025-06-24 08:38:31,871 INFO Causal Consistency Loss: -4.8668060302734375
2025-06-24 08:38:31,871 INFO Accuracy: 0.6875
2025-06-24 08:38:31,871 INFO MCC: 0.3780
2025-06-24 08:38:31,871 INFO Alpha_i (sample 0, day 0, first 5 msgs): [3.4838944e-05 1.3141586e-09 9.9998355e-01 2.6522785e-17 5.0000001e-02]
2025-06-24 08:38:31,872 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.00720079 0.02351736 0.00106452 0.0733963  0.05592632]
2025-06-24 08:41:15,879 INFO Completed dev evaluation: size=656.0, acc=0.5229
2025-06-24 08:41:15,883 INFO 	Eval, eval loss: 2.24894118309021, acc: 0.522866, mcc: 0.053666
2025-06-24 08:45:33,648 INFO 	iter: 140, batch loss: 1.8484408855438232, batch acc: 0.625000
2025-06-24 08:45:33,690 INFO --- Epoch 1, Batch 140 ---
2025-06-24 08:45:33,690 INFO Total Loss: 1.8484408855438232
2025-06-24 08:45:33,690 INFO Causal Consistency Loss: -9.985929489135742
2025-06-24 08:45:33,690 INFO Accuracy: 0.6250
2025-06-24 08:45:33,690 INFO MCC: 0.2277
2025-06-24 08:45:33,691 INFO Alpha_i (sample 0, day 0, first 5 msgs): [4.3291891e-19 9.1982652e-23 9.9678302e-01 1.7162708e-24 5.0000001e-02]
2025-06-24 08:45:33,691 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.7952812e-01 4.3299279e-01 4.0836621e-02 3.4633705e-01 1.9087405e-05]
2025-06-24 08:53:52,640 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-24 08:53:52,687 INFO 	Eval, eval loss: 1.4614949226379395, acc: 0.509146, mcc: 0.027887
2025-06-24 08:57:40,951 INFO Epoch: loss: 3.931352, acc: 0.615524
2025-06-24 08:57:40,989 INFO Epoch: 2/10 start
2025-06-24 09:04:17,029 INFO 	iter: 160, batch loss: 1.0945147275924683, batch acc: 0.687500
2025-06-24 09:04:17,070 INFO --- Epoch 2, Batch 160 ---
2025-06-24 09:04:17,070 INFO Total Loss: 1.0945147275924683
2025-06-24 09:04:17,070 INFO Causal Consistency Loss: -12.569698333740234
2025-06-24 09:04:17,070 INFO Accuracy: 0.6875
2025-06-24 09:04:17,070 INFO MCC: 0.3706
2025-06-24 09:04:17,071 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.99965775 0.05       0.05       0.05       0.05      ]
2025-06-24 09:04:17,071 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.57530314 0.02235246 0.02235246 0.02235246 0.02235246]
2025-06-24 09:09:22,583 INFO Completed dev evaluation: size=656.0, acc=0.4939
2025-06-24 09:09:22,629 INFO 	Eval, eval loss: 1.2544820308685303, acc: 0.493902, mcc: -0.005580
2025-06-24 09:18:12,153 INFO 	iter: 180, batch loss: 1.1400760412216187, batch acc: 0.562500
2025-06-24 09:18:12,663 INFO --- Epoch 2, Batch 180 ---
2025-06-24 09:18:12,663 INFO Total Loss: 1.1400760412216187
2025-06-24 09:18:12,663 INFO Causal Consistency Loss: -12.875072479248047
2025-06-24 09:18:12,663 INFO Accuracy: 0.5625
2025-06-24 09:18:12,663 INFO MCC: 0.1294
2025-06-24 09:18:12,664 INFO Alpha_i (sample 0, day 0, first 5 msgs): [5.79002e-35 0.00000e+00 0.00000e+00 5.00000e-02 5.00000e-02]
2025-06-24 09:18:12,664 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.9305061e-01 4.1671818e-01 3.9020881e-01 1.3182249e-06 1.3182249e-06]
2025-06-24 09:21:39,651 INFO Completed dev evaluation: size=656.0, acc=0.5000
2025-06-24 09:21:39,692 INFO 	Eval, eval loss: 0.9728622436523438, acc: 0.500000, mcc: 0.006962
2025-06-24 09:27:55,529 INFO 	iter: 200, batch loss: 0.7793186902999878, batch acc: 0.718750
2025-06-24 09:27:56,253 INFO --- Epoch 2, Batch 200 ---
2025-06-24 09:27:56,253 INFO Total Loss: 0.7793186902999878
2025-06-24 09:27:56,253 INFO Causal Consistency Loss: -12.978620529174805
2025-06-24 09:27:56,253 INFO Accuracy: 0.7188
2025-06-24 09:27:56,253 INFO MCC: 0.5057
2025-06-24 09:27:56,253 INFO Alpha_i (sample 0, day 0, first 5 msgs): [2.3662542e-24 5.0000001e-02 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 09:27:56,253 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.9871397e-01 6.7685032e-05 6.7685032e-05 6.7685032e-05 6.7685032e-05]
2025-06-24 09:32:58,595 INFO Completed dev evaluation: size=656.0, acc=0.5076
2025-06-24 09:32:58,642 INFO 	Eval, eval loss: 0.7401073575019836, acc: 0.507622, mcc: 0.024130
2025-06-24 09:38:28,927 INFO 	iter: 220, batch loss: 0.5638830661773682, batch acc: 0.531250
2025-06-24 09:38:28,953 INFO --- Epoch 2, Batch 220 ---
2025-06-24 09:38:28,953 INFO Total Loss: 0.5638830661773682
2025-06-24 09:38:28,953 INFO Causal Consistency Loss: -12.92426586151123
2025-06-24 09:38:28,954 INFO Accuracy: 0.5312
2025-06-24 09:38:28,954 INFO MCC: 0.0710
2025-06-24 09:38:28,954 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.   0.05 0.05 0.05 0.05]
2025-06-24 09:38:28,954 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.99982e-01 9.40390e-07 9.40390e-07 9.40390e-07 9.40390e-07]
2025-06-24 09:40:29,091 INFO Completed dev evaluation: size=656.0, acc=0.5320
2025-06-24 09:40:29,094 INFO 	Eval, eval loss: 0.419482946395874, acc: 0.532012, mcc: 0.073418
2025-06-24 09:43:11,786 INFO 	iter: 240, batch loss: 0.26519691944122314, batch acc: 0.500000
2025-06-24 09:43:11,788 INFO --- Epoch 2, Batch 240 ---
2025-06-24 09:43:11,788 INFO Total Loss: 0.26519691944122314
2025-06-24 09:43:11,788 INFO Causal Consistency Loss: -13.012361526489258
2025-06-24 09:43:11,788 INFO Accuracy: 0.5000
2025-06-24 09:43:11,788 INFO MCC: -0.0325
2025-06-24 09:43:11,789 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.   0.05 0.05 0.05 0.05]
2025-06-24 09:43:11,789 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.9995875e-01 2.1709029e-06 2.1709029e-06 2.1709029e-06 2.1709029e-06]
2025-06-24 09:44:52,898 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 09:44:52,901 INFO 	Eval, eval loss: 0.16669228672981262, acc: 0.487805, mcc: -0.019269
2025-06-24 09:47:34,417 INFO 	iter: 260, batch loss: -0.0469132661819458, batch acc: 0.437500
2025-06-24 09:47:34,418 INFO --- Epoch 2, Batch 260 ---
2025-06-24 09:47:34,418 INFO Total Loss: -0.0469132661819458
2025-06-24 09:47:34,418 INFO Causal Consistency Loss: -13.166036605834961
2025-06-24 09:47:34,418 INFO Accuracy: 0.4375
2025-06-24 09:47:34,418 INFO MCC: -0.1429
2025-06-24 09:47:34,418 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.0000000e+00 1.1807283e-19 2.3026761e-22 3.0011085e-26 0.0000000e+00]
2025-06-24 09:47:34,419 INFO Omega_i (sample 0, day 0, first 5 msgs): [7.4467796e-01 1.7750011e-04 6.3340034e-04 3.9400937e-04 4.2128287e-02]
2025-06-24 09:49:16,355 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-24 09:49:16,356 INFO 	Eval, eval loss: -0.10422259569168091, acc: 0.518293, mcc: 0.062752
2025-06-24 09:51:53,799 INFO 	iter: 280, batch loss: -0.3845798969268799, batch acc: 0.781250
2025-06-24 09:51:53,800 INFO --- Epoch 2, Batch 280 ---
2025-06-24 09:51:53,800 INFO Total Loss: -0.3845798969268799
2025-06-24 09:51:53,800 INFO Causal Consistency Loss: -13.20560073852539
2025-06-24 09:51:53,800 INFO Accuracy: 0.7812
2025-06-24 09:51:53,800 INFO MCC: 0.6012
2025-06-24 09:51:53,801 INFO Alpha_i (sample 0, day 0, first 5 msgs): [6.1285471e-10 8.0055034e-25 5.0163385e-09 1.2463821e-03 7.9259522e-02]
2025-06-24 09:51:53,801 INFO Omega_i (sample 0, day 0, first 5 msgs): [2.1315789e-04 1.6267180e-02 2.0892044e-04 1.0130818e-05 9.5939713e-06]
2025-06-24 09:53:37,813 INFO Completed dev evaluation: size=656.0, acc=0.4863
2025-06-24 09:53:37,816 INFO 	Eval, eval loss: -0.35506361722946167, acc: 0.486280, mcc: -0.013062
2025-06-24 09:56:14,982 INFO 	iter: 300, batch loss: -0.5438762903213501, batch acc: 0.531250
2025-06-24 09:56:14,984 INFO --- Epoch 2, Batch 300 ---
2025-06-24 09:56:14,984 INFO Total Loss: -0.5438762903213501
2025-06-24 09:56:14,984 INFO Causal Consistency Loss: -13.19090461730957
2025-06-24 09:56:14,984 INFO Accuracy: 0.5312
2025-06-24 09:56:14,984 INFO MCC: 0.0626
2025-06-24 09:56:14,984 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.4541482e-25 0.0000000e+00 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 09:56:14,984 INFO Omega_i (sample 0, day 0, first 5 msgs): [8.004921e-03 9.919429e-01 2.901311e-06 2.901311e-06 2.901311e-06]
2025-06-24 09:58:00,181 INFO Completed dev evaluation: size=656.0, acc=0.4771
2025-06-24 09:58:00,184 INFO 	Eval, eval loss: -0.5836125612258911, acc: 0.477134, mcc: -0.046401
2025-06-24 09:59:19,270 INFO Epoch: loss: 0.325714, acc: 0.571169
2025-06-24 09:59:19,270 INFO Epoch: 3/10 start
2025-06-24 10:01:52,740 INFO 	iter: 320, batch loss: -0.6748194694519043, batch acc: 0.500000
2025-06-24 10:01:52,741 INFO --- Epoch 3, Batch 320 ---
2025-06-24 10:01:52,741 INFO Total Loss: -0.6748194694519043
2025-06-24 10:01:52,741 INFO Causal Consistency Loss: -13.462459564208984
2025-06-24 10:01:52,741 INFO Accuracy: 0.5000
2025-06-24 10:01:52,741 INFO MCC: -0.0628
2025-06-24 10:01:52,742 INFO Alpha_i (sample 0, day 0, first 5 msgs): [2.7341953e-36 5.0000001e-02 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 10:01:52,742 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.9997866e-01 1.1249934e-06 1.1249934e-06 1.1249934e-06 1.1249934e-06]
2025-06-24 10:03:39,507 INFO Completed dev evaluation: size=656.0, acc=0.4787
2025-06-24 10:03:39,509 INFO 	Eval, eval loss: -0.753616213798523, acc: 0.478659, mcc: -0.037418
2025-06-24 10:06:57,655 INFO 	iter: 340, batch loss: -0.9774442911148071, batch acc: 0.656250
2025-06-24 10:06:57,656 INFO --- Epoch 3, Batch 340 ---
2025-06-24 10:06:57,656 INFO Total Loss: -0.9774442911148071
2025-06-24 10:06:57,656 INFO Causal Consistency Loss: -13.477117538452148
2025-06-24 10:06:57,656 INFO Accuracy: 0.6562
2025-06-24 10:06:57,656 INFO MCC: 0.3131
2025-06-24 10:06:57,656 INFO Alpha_i (sample 0, day 0, first 5 msgs): [4.9953964e-29 1.3942875e-19 1.1275247e-31 8.6177945e-26 3.1563713e-34]
2025-06-24 10:06:57,656 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.09683133 0.0529761  0.15733519 0.10130944 0.591531  ]
2025-06-24 10:08:45,921 INFO Completed dev evaluation: size=656.0, acc=0.4985
2025-06-24 10:08:45,924 INFO 	Eval, eval loss: -0.9722689390182495, acc: 0.498476, mcc: 0.035607
2025-06-24 10:11:46,020 INFO 	iter: 360, batch loss: -1.1419907808303833, batch acc: 0.562500
2025-06-24 10:11:46,021 INFO --- Epoch 3, Batch 360 ---
2025-06-24 10:11:46,021 INFO Total Loss: -1.1419907808303833
2025-06-24 10:11:46,021 INFO Causal Consistency Loss: -13.576240539550781
2025-06-24 10:11:46,021 INFO Accuracy: 0.5625
2025-06-24 10:11:46,021 INFO MCC: 0.1524
2025-06-24 10:11:46,021 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.9573198e-28 0.0000000e+00 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 10:11:46,022 INFO Omega_i (sample 0, day 0, first 5 msgs): [6.0924725e-05 9.9993908e-01 4.2737845e-11 4.2737845e-11 4.2737845e-11]
2025-06-24 10:13:36,246 INFO Completed dev evaluation: size=656.0, acc=0.4878
2025-06-24 10:13:36,249 INFO 	Eval, eval loss: -1.161257266998291, acc: 0.487805, mcc: -0.005341
2025-06-24 10:16:28,678 INFO 	iter: 380, batch loss: -1.3143399953842163, batch acc: 0.531250
2025-06-24 10:16:28,679 INFO --- Epoch 3, Batch 380 ---
2025-06-24 10:16:28,679 INFO Total Loss: -1.3143399953842163
2025-06-24 10:16:28,679 INFO Causal Consistency Loss: -13.530956268310547
2025-06-24 10:16:28,679 INFO Accuracy: 0.5312
2025-06-24 10:16:28,679 INFO MCC: 0.0401
2025-06-24 10:16:28,679 INFO Alpha_i (sample 0, day 0, first 5 msgs): [2.2045694e-31 0.0000000e+00 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 10:16:28,680 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.4219967e-04 9.9985778e-01 2.5719416e-11 2.5719416e-11 2.5719416e-11]
2025-06-24 10:18:20,597 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-24 10:18:20,601 INFO 	Eval, eval loss: -1.3258254528045654, acc: 0.489329, mcc: -0.006026
2025-06-24 10:21:12,039 INFO 	iter: 400, batch loss: -1.5816892385482788, batch acc: 0.718750
2025-06-24 10:21:12,041 INFO --- Epoch 3, Batch 400 ---
2025-06-24 10:21:12,041 INFO Total Loss: -1.5816892385482788
2025-06-24 10:21:12,041 INFO Causal Consistency Loss: -13.556869506835938
2025-06-24 10:21:12,041 INFO Accuracy: 0.7188
2025-06-24 10:21:12,041 INFO MCC: 0.4384
2025-06-24 10:21:12,041 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.   0.05 0.05 0.05 0.05]
2025-06-24 10:21:12,041 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.0000000e+00 4.4142696e-11 4.4142696e-11 4.4142696e-11 4.4142696e-11]
2025-06-24 10:23:05,647 INFO Completed dev evaluation: size=656.0, acc=0.4802
2025-06-24 10:23:05,649 INFO 	Eval, eval loss: -1.4935498237609863, acc: 0.480183, mcc: -0.031931
2025-06-24 10:25:55,579 INFO 	iter: 420, batch loss: -1.6707595586776733, batch acc: 0.531250
2025-06-24 10:25:55,580 INFO --- Epoch 3, Batch 420 ---
2025-06-24 10:25:55,580 INFO Total Loss: -1.6707595586776733
2025-06-24 10:25:55,580 INFO Causal Consistency Loss: -13.562649726867676
2025-06-24 10:25:55,580 INFO Accuracy: 0.5312
2025-06-24 10:25:55,580 INFO MCC: 0.0401
2025-06-24 10:25:55,581 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.0000000e+00 0.0000000e+00 0.0000000e+00 3.0242631e-20 2.9244531e-24]
2025-06-24 10:25:55,581 INFO Omega_i (sample 0, day 0, first 5 msgs): [4.8386133e-01 2.7017012e-01 2.4596547e-01 4.9990376e-09 3.0858732e-06]
2025-06-24 10:27:50,620 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-24 10:27:50,623 INFO 	Eval, eval loss: -1.6539171934127808, acc: 0.509146, mcc: 0.024245
2025-06-24 10:30:37,665 INFO 	iter: 440, batch loss: -1.8061349391937256, batch acc: 0.562500
2025-06-24 10:30:37,667 INFO --- Epoch 3, Batch 440 ---
2025-06-24 10:30:37,667 INFO Total Loss: -1.8061349391937256
2025-06-24 10:30:37,667 INFO Causal Consistency Loss: -13.565386772155762
2025-06-24 10:30:37,667 INFO Accuracy: 0.5625
2025-06-24 10:30:37,667 INFO MCC: 0.0976
2025-06-24 10:30:37,667 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 1.4253391e-28]
2025-06-24 10:30:37,667 INFO Omega_i (sample 0, day 0, first 5 msgs): [4.98234212e-01 1.34508655e-05 5.88101066e-05 7.40088820e-02
 6.22307925e-06]
2025-06-24 10:32:34,019 INFO Completed dev evaluation: size=656.0, acc=0.4970
2025-06-24 10:32:34,021 INFO 	Eval, eval loss: -1.8276952505111694, acc: 0.496951, mcc: 0.008941
2025-06-24 10:35:21,594 INFO 	iter: 460, batch loss: -1.9175575971603394, batch acc: 0.500000
2025-06-24 10:35:21,594 INFO --- Epoch 3, Batch 460 ---
2025-06-24 10:35:21,595 INFO Total Loss: -1.9175575971603394
2025-06-24 10:35:21,595 INFO Causal Consistency Loss: -13.507442474365234
2025-06-24 10:35:21,595 INFO Accuracy: 0.5000
2025-06-24 10:35:21,595 INFO MCC: 0.0120
2025-06-24 10:35:21,595 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.2440506e-29 1.1478722e-20 7.7857037e-20 2.9318424e-28 2.7611189e-23]
2025-06-24 10:35:21,595 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.8867862e-04 5.3286494e-04 1.0806096e-03 7.7988207e-01 2.2934139e-06]
2025-06-24 10:37:21,638 INFO Completed dev evaluation: size=656.0, acc=0.4787
2025-06-24 10:37:21,641 INFO 	Eval, eval loss: -1.9790916442871094, acc: 0.478659, mcc: -0.037052
2025-06-24 10:38:03,560 INFO Epoch: loss: -1.368768, acc: 0.552823
2025-06-24 10:38:03,560 INFO Epoch: 4/10 start
2025-06-24 10:41:37,160 INFO 	iter: 480, batch loss: -2.1400065422058105, batch acc: 0.625000
2025-06-24 10:41:37,161 INFO --- Epoch 4, Batch 480 ---
2025-06-24 10:41:37,161 INFO Total Loss: -2.1400065422058105
2025-06-24 10:41:37,161 INFO Causal Consistency Loss: -13.644926071166992
2025-06-24 10:41:37,161 INFO Accuracy: 0.6250
2025-06-24 10:41:37,161 INFO MCC: 0.2431
2025-06-24 10:41:37,161 INFO Alpha_i (sample 0, day 0, first 5 msgs): [3.927309e-22 5.000000e-02 5.000000e-02 5.000000e-02 5.000000e-02]
2025-06-24 10:41:37,161 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.9920672e-01 4.1751795e-05 4.1751795e-05 4.1751795e-05 4.1751795e-05]
2025-06-24 10:43:37,431 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-24 10:43:37,434 INFO 	Eval, eval loss: -2.1391963958740234, acc: 0.518293, mcc: 0.055556
2025-06-24 10:47:01,287 INFO 	iter: 500, batch loss: -2.300934314727783, batch acc: 0.562500
2025-06-24 10:47:01,288 INFO --- Epoch 4, Batch 500 ---
2025-06-24 10:47:01,288 INFO Total Loss: -2.300934314727783
2025-06-24 10:47:01,288 INFO Causal Consistency Loss: -13.599891662597656
2025-06-24 10:47:01,288 INFO Accuracy: 0.5625
2025-06-24 10:47:01,288 INFO MCC: 0.1395
2025-06-24 10:47:01,288 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.3135256e-23 2.1239664e-33 1.3003529e-32 2.2781247e-20 4.9184744e-35]
2025-06-24 10:47:01,289 INFO Omega_i (sample 0, day 0, first 5 msgs): [7.1642853e-07 2.1576527e-01 1.4989172e-03 1.7112351e-06 6.8677920e-01]
2025-06-24 10:49:02,950 INFO Completed dev evaluation: size=656.0, acc=0.5091
2025-06-24 10:49:03,132 INFO 	Eval, eval loss: -2.2856900691986084, acc: 0.509146, mcc: 0.076902
2025-06-24 10:52:08,869 INFO 	iter: 520, batch loss: -2.3818323612213135, batch acc: 0.406250
2025-06-24 10:52:08,870 INFO --- Epoch 4, Batch 520 ---
2025-06-24 10:52:08,870 INFO Total Loss: -2.3818323612213135
2025-06-24 10:52:08,870 INFO Causal Consistency Loss: -13.624553680419922
2025-06-24 10:52:08,870 INFO Accuracy: 0.4062
2025-06-24 10:52:08,870 INFO MCC: -0.1972
2025-06-24 10:52:08,871 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.00000e+00 0.00000e+00 5.12208e-30 5.00000e-02 5.00000e-02]
2025-06-24 10:52:08,871 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.1223539e-01 8.8774371e-01 2.0959311e-05 2.0095583e-13 2.0095583e-13]
2025-06-24 10:54:11,564 INFO Completed dev evaluation: size=656.0, acc=0.4893
2025-06-24 10:54:11,566 INFO 	Eval, eval loss: -2.4289896488189697, acc: 0.489329, mcc: 0.004226
2025-06-24 10:57:15,192 INFO 	iter: 540, batch loss: -2.51202654838562, batch acc: 0.375000
2025-06-24 10:57:15,194 INFO --- Epoch 4, Batch 540 ---
2025-06-24 10:57:15,194 INFO Total Loss: -2.51202654838562
2025-06-24 10:57:15,194 INFO Causal Consistency Loss: -13.608917236328125
2025-06-24 10:57:15,194 INFO Accuracy: 0.3750
2025-06-24 10:57:15,194 INFO MCC: -0.2431
2025-06-24 10:57:15,194 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.   0.   0.05 0.05 0.05]
2025-06-24 10:57:15,194 INFO Omega_i (sample 0, day 0, first 5 msgs): [1.0773496e-01 8.9226502e-01 1.0016170e-12 1.0016170e-12 1.0016170e-12]
2025-06-24 10:59:19,418 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-24 10:59:19,420 INFO 	Eval, eval loss: -2.575620412826538, acc: 0.518293, mcc: 0.075327
2025-06-24 11:02:21,106 INFO 	iter: 560, batch loss: -2.731977939605713, batch acc: 0.562500
2025-06-24 11:02:21,106 INFO --- Epoch 4, Batch 560 ---
2025-06-24 11:02:21,107 INFO Total Loss: -2.731977939605713
2025-06-24 11:02:21,107 INFO Causal Consistency Loss: -13.623847961425781
2025-06-24 11:02:21,107 INFO Accuracy: 0.5625
2025-06-24 11:02:21,107 INFO MCC: 0.1260
2025-06-24 11:02:21,107 INFO Alpha_i (sample 0, day 0, first 5 msgs): [3.5716283e-15 5.0000001e-02 5.0000001e-02 5.0000001e-02 5.0000001e-02]
2025-06-24 11:02:21,107 INFO Omega_i (sample 0, day 0, first 5 msgs): [9.9977630e-01 1.1772262e-05 1.1772262e-05 1.1772262e-05 1.1772262e-05]
2025-06-24 11:04:27,294 INFO Completed dev evaluation: size=656.0, acc=0.4848
2025-06-24 11:04:27,297 INFO 	Eval, eval loss: -2.7382755279541016, acc: 0.484756, mcc: -0.020708
2025-06-24 11:07:23,985 INFO 	iter: 580, batch loss: -2.878002643585205, batch acc: 0.531250
2025-06-24 11:07:23,986 INFO --- Epoch 4, Batch 580 ---
2025-06-24 11:07:23,986 INFO Total Loss: -2.878002643585205
2025-06-24 11:07:23,986 INFO Causal Consistency Loss: -13.570128440856934
2025-06-24 11:07:23,986 INFO Accuracy: 0.5312
2025-06-24 11:07:23,986 INFO MCC: 0.0164
2025-06-24 11:07:23,987 INFO Alpha_i (sample 0, day 0, first 5 msgs): [0.0000000e+00 0.0000000e+00 5.0848138e-38 6.3110217e-20 1.0846471e-34]
2025-06-24 11:07:23,987 INFO Omega_i (sample 0, day 0, first 5 msgs): [3.2251847e-01 6.6382801e-03 7.6705976e-07 1.1152790e-08 8.8085480e-06]
2025-06-24 11:09:31,621 INFO Completed dev evaluation: size=656.0, acc=0.5198
2025-06-24 11:09:31,624 INFO 	Eval, eval loss: -2.8928773403167725, acc: 0.519817, mcc: 0.056943
2025-06-24 11:32:08,889 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 11:32:08,891 INFO Start graph assembling...
2025-06-24 11:32:32,661 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 11:32:35,922 INFO Word table init: done!
2025-06-24 11:32:38,052 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, session restored!
2025-06-24 11:32:38,053 INFO Epoch: 1/10 start
2025-06-24 11:33:31,726 INFO INIT: #stock: 88, #vocab+1: 29867
2025-06-24 11:33:31,728 INFO Start graph assembling...
2025-06-24 11:33:51,593 INFO ASSEMBLE: word table #replacement: 19482
2025-06-24 11:33:53,124 INFO Word table init: done!
2025-06-24 11:33:53,125 INFO Model: all_days-5.msgs-20-words-30_word_embed-glove.vmd_in-hedge_alpha-0.5.anneal-0.005.rec-zh_batch-32.opt-adam.lr-0.001-drop-0.3-cell-gru-tmp, start a new session!
2025-06-24 11:33:53,125 INFO Epoch: 1/10 start
2025-06-24 11:37:49,262 INFO 	iter: 20, batch loss: 7.615972518920898, batch acc: 0.500000
2025-06-24 11:37:49,263 INFO --- Epoch 1, Batch 20 ---
2025-06-24 11:37:49,263 INFO Total Loss: 7.615972518920898
2025-06-24 11:37:49,263 INFO Causal Consistency Loss: 0.265440970659256
2025-06-24 11:37:49,263 INFO Accuracy: 0.5000
2025-06-24 11:37:49,263 INFO MCC: 0.0159
2025-06-24 11:37:49,264 INFO Alpha_i (sample 0, day 0, first 5 msgs): [1.   0.05 0.05 0.05 0.05]
2025-06-24 11:37:49,264 INFO Omega_i (sample 0, day 0, first 5 msgs): [0.07417073 0.04872786 0.04872786 0.04872786 0.04872786]
2025-06-24 11:39:11,984 INFO Completed dev evaluation: size=656.0, acc=0.5183
2025-06-24 11:39:11,987 INFO 	Eval, eval loss: 7.600137710571289, acc: 0.518293, mcc: 0.041565
